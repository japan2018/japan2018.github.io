<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Experience pyATS! | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Experience pyATS!</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 18, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/network">Network</a></code></small>


<small><code><a href="https://memotut.com/tags/automation">automation</a></code></small>

</p>
<pre><code>*Note
</code></pre>
<p>Rather than about automation, it&rsquo;s featured a lot on the advent calender
What is pyATS/Genie? Various things can be done automatically, but how should I try it?
For those who want to introduce it to people like, I do not know, but I want to touch it anyway!
It will be an article for people such as</p>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>You have a DevNet account.
It&rsquo;s not like a Cisco partner account, it&rsquo;s something anyone can create
Please make it at this opportunity.
The reference URL is given below.</li>
</ul>
<p><a href="https://community.cisco.com/t5/devnet-%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9E%E3%83%93">https://community.cisco.com/t5/devnet-%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9E%E3%83%93</a> %E3%83%AA%E3%83%86%E3%82%A3%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3 %83%88/devnet%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%82%92%E4 %BD%9C%E6%88%90%E3%81%97%E3%82%88%E3%81%86/ta-p/3923720</p>
<ul>
<li>Install Cisco Anyconnect and have access to DevNet&rsquo;s sandbox.
This is also how to access the sandbox lab on the sandbox page after creating a DevNet account
There is a page like this, so please refer to it.
I will introduce it briefly later, so please check it again.</li>
</ul>
<h3 id="reference-materials">Reference materials</h3>
<p>There are several learning pages called Learning Lab on the DevNet page.
There are various contents such as SD-WAN and ACI, but this time we are focusing on pyATS.
Basically, it is designed to be a tutorial if you follow the steps of the learning page one by one.</p>
<p>Introduction to pyATS
<a href="https://developer.cisco.com/learning/lab/intro-to-pyats/step/1">https://developer.cisco.com/learning/lab/intro-to-pyats/step/1</a></p>
<p>This time, let&rsquo;s lower the threshold of the part doing the tutorial through images and logs
It will be an article such as. It is by no means an omission.</p>
<h3 id="step1-introducing-pyats-and-preparing-in-advance">Step1: Introducing pyATS and preparing in advance</h3>
<ul>
<li>First, let&rsquo;s Reserve the Lab.
If you go to the above Introduction to pyATS URL, you should be taken to the step1 page. <img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/374565/369ffc0a-9f35-da26-2178-2463704f52d6.png" alt="reserve1.PNG"></li>
</ul>
<p>Here, let&rsquo;s step on the URL enclosed in the red frame in the image above.
Then you can jump to the Sandbox catalog page.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/374565/f7d16306-0ee4-d911-9538-2aa112b2e5d9.png" alt="reserve2.PNG"></p>
<p>Then, &ldquo;Multi-IOS Cisco Test Network&rdquo; mentioned on the pyATS page
Reserve your lab.
When you press &ldquo;RESERVE&rdquo;, a dialog page like this appears.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/374565/f9e2a65a-6804-9ebf-c0d2-4c39550b1f0e.png" alt="reserve3.PNG"></p>
<p>Specify the time of day to book here. There is one point to note,
Please check if the blue frame is in Japan time.
I got an email saying that I made a reservation in Japan time but I made a reservation in American time and I was ready
Why not come? There are people who have become.</p>
<p>Also, the maximum period of time is about two days. Please note that if you try to take more than that, an error will occur.
When it&rsquo;s time to book, you&rsquo;ll receive an email from Cisco saying it&rsquo;s ready.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/374565/6a285972-95f5-01d8-e2a6-9748e07df485.png" alt="reserve4.PNG"></p>
<p>There you will find VPN information for lab access.
There is an application for VPN connection called Cisco AnyConnect here.
Download it before the scheduled time arrives.</p>
<p>cisco AnyConnect download page
<a href="https://developer.cisco.com/site/sandbox/anyconnect/">https://developer.cisco.com/site/sandbox/anyconnect/</a></p>
<p>Installation guide
<a href="https://devnetsandbox.cisco.com/Docs/VPN_Access/AnyConnect_Installation_Guide.pdf">https://devnetsandbox.cisco.com/Docs/VPN_Access/AnyConnect_Installation_Guide.pdf</a></p>
<p>The URL is also posted on the DevNet page, but just in case</p>
<p>After the installation is complete, use the VPN information contained in the email.
Just enter it into Cisco AnyConnect and allow it to connect to the VPN.
If you are ready, please try to connect with ssh using terminal software such as teraterm.
You can find the connection information on the RESERVE Lab page.</p>
<h3 id="step2-what-is-pyats">Step2: What is pyATS?</h3>
<p>I&rsquo;m very sorry, but I mentioned pyATS before Advent calender
It will be easier to understand if you look at the person who is written.
Anyway, let&rsquo;s touch the main idea! So I will omit the details.</p>
<p>I would like to introduce the pages that I often refer to as an alternative.</p>
<p>Reference page
<a href="https://qiita.com/advent-calendar/2019/network-automation">https://qiita.com/advent-calendar/2019/network-automation</a></p>
<p>pyATS/Genie: Various ways to create testbed.yaml and how to check YAML file
<a href="https://ccieojisan.net/post-1924/">https://ccieojisan.net/post-1924/</a>
↑ In particular, this person&rsquo;s blog is recommended because it is introduced in detail.</p>
<h3 id="step3-play-with-pyats">Step3: Play with pyATS!</h3>
<ul>
<li>Create an environment to try pyATS on DevNet.</li>
</ul>
<p>If you can access Lab of DevNet and SSH connection is possible
After that, you basically just follow the tutorial.
Let&rsquo;s type the commands in the following order.</p>
<ol>
<li>Let&rsquo;s clone the sample code from git
git clone <a href="https://github.com/CiscoDevNet/pyats-ios-sample.git">https://github.com/CiscoDevNet/pyats-ios-sample.git</a></li>
</ol>
<pre><code>[developer@devbox ~]$ git clone https://github.com/CiscoDevNet/pyats-ios-sample.git
Cloning into'pyats-ios-sample'...
remote: Enumerating objects: 73, done.
Unpacking objects: 1% (1/73) Unpacking objects: 2% (2/73) Unpacking objects: 4% (3/73) Unpacking objects: 5% (4/73) Unpacking objects: 6% (5/73) Unpacking objects: 8% (6/73) Unpacking objects: 9% (7/73) Unpacking objects: 10% (8/73) Unpacking objects: 12% (9/73) Unpacking objects: 13% (10/73) remote: Total 73 (delta 0), reused 0 (delta 0), pack-reused 73Unpacking objects:  15% (11/73)   Unpacking objects:  16% (12/73)   Unpacking objects:  17% (13/73)   Unpacking objects:  19% (14/73)   Unpacking objects:  20% (15/73)   Unpacking objects:  21% (16/73)   Unpacking objects:  23% (17/73)   Unpacking objects:  24% (18/73)   Unpacking objects:  26% (19/73)   Unpacking objects:  27% (20/73)   Unpacking objects:  28% (21/73)   Unpacking objects:  30% (22/73)   Unpacking objects:  31% (23/73)   Unpacking objects:  32% (24/73)   Unpacking objects:  34% (25/73)   Unpacking objects:  35% (26/73)   Unpacking objects:  36% (27/73)   Unpacking objects:  38% (28/73)   Unpacking objects:  39% (29/73)   Unpacking objects:  41% (30/73)   Unpacking objects:  42% (31/73)   Unpacking objects:  43% (32/73)   Unpacking objects:  45% (33/73)   Unpacking objects:  46% (34/73)   Unpacking objects:  47% (35/73)   Unpacking objects:  49% (36/73)   Unpacking objects:  50% (37/73)   Unpacking objects:  52% (38/73)   Unpacking objects:  53% (39/73)   Unpacking objects:  54% (40/73)   Unpacking objects:  56% (41/73)   Unpacking objects:  57% (42/73)   Unpacking objects:  58% (43/73)   Unpacking objects:  60% (44/73)   Unpacking objects:  61% (45/73)   Unpacking objects:  63% (46/73)   Unpacking objects:  64% (47/73)   Unpacking objects:  65% (48/73)   Unpacking objects:  67% (49/73)   Unpacking objects:  68% (50/73)   Unpacking objects:  69% (51/73)   Unpacking objects:  71% (52/73)   Unpacking objects:  72% (53/73)   Unpacking objects:  73% (54/73)   Unpacking objects:  75% (55/73)   Unpacking objects:  76% (56/73)   Unpacking objects:  78% (57/73)   Unpacking objects:  79% (58/73)   Unpacking objects:  80% (59/73)   Unpacking objects:  82% (60/73)   Unpacking objects:  83% (61/73)   Unpacking objects:  84% (62/73)   Unpacking objects:  86% (63/73)   Unpacking objects:  87% (64/73)   Unpacking objects:  89% (65/73)   Unpacking objects:  90% (66/73)   Unpacking objects:  91% (67/73)   Unpacking objects:  93% (68/73)   Unpacking objects:  94% (69/73)   Unpacking objects:  95% (70/73)   Unpacking objects:  97% (71/73)   Unpacking objects:  98% (72/73)   Unpacking objects: 100% (73/73)   Unpacking objects: 100% (73/73), done.
[developer@devbox ~]
</code></pre><p>2.directoryを移動してシミュレーション環境を立ち上げましょう
cd pyats-ios-sample
virl up</p>
<pre><code>[developer@devbox ~]$cd pyats-ios-sample
[developer@devbox pyats-ios-sample]$
[developer@devbox pyats-ios-sample]$
[developer@devbox pyats-ios-sample]$virl up
Creating default environment from topology.virl
Localizing rsa modulus 768 with: rsa modulus 1024
[developer@devbox pyats-ios-sample]$

</code></pre><p>3.環境が立ち上がったか確認しましょう
virl nodes
立ち上がっていた場合下記のようになっているかと思います。
もしStateがACTIVEになっていなかった場合、時間がたってからretryしてみてください。</p>
<pre><code>[developer@devbox pyats-ios-sample]$virl nodes
Here is a list of all the running nodes
+-----------+----------+---------+-------------+------------+----------------------+--------------------+
| Node      | Type     | State   | Reachable   | Pro+ocol   | Management Address   | E|+er+al Address   |
+-----------+----------+---------+-------------+------------+----------------------+--------------------+
| ios1      | IOSv     | ACTIVE  | REACHABLE   | telnet     | 10.255.0.5           | N/A                |
+-----------+----------+---------+-------------+------------+----------------------+--------------------+
| ios2      | IOSv     | ACTIVE  | REACHABLE   | telnet     | 10.255.0.6           | N/A                |
+-----------+----------+---------+-------------+------------+----------------------+--------------------+
| ~mgmn-lxc | mgmt-lxc | ACTIVE  | REACHABLE   | ssh        | 10.255.0.4           | 172.16.30.60       |
+-----------+----------+---------+-------------+------------+----------------------+--------------------+
[developer@devbox pyats-ios-sample]$
[developer@devbox pyats-ios-sample]$
</code></pre><p>4.pyATS実行用のtestbed fileを生成します。
virl generate pyats
※今回はsample code内に本シミュレーション用に自動生成してくれるスクリプトがあるのでそちらを使用しています。</p>
<pre><code>[developer@devbox pyats-ios-sample]$virl generate pyats
Writing default_testbed.yaml
</code></pre><p>5.生成されたtestbed fileの中身を確認します。
cat default_testbed.yaml</p>
<pre><code>[developer@devbox pyats-ios-sample]$cat default_testbed.yaml
testbed:

  name: pyats-ios-sample_default_27GGKj

  tacacs:
      username: &quot;%ENV{PYATS_USERNAME}&quot;
  passwords:
      tacacs: &quot;%ENV{PYATS_PASSWORD}&quot;
      enable: &quot;%ENV{PYATS_AUTH_PASS}&quot;
      line: &quot;%ENV{PYATS_PASSWORD}&quot;
  servers:
    
    ~mgmt-lxc:
      address: 172.16.30.60
      server: ~mgmt-lxc

    

devices:

  ios1:
    alias: ios1
    os: ios
    type: IOSv
    connections:

      defaults:
        class: unicon.Unicon
      console:
        protocol: telnet
        ip: 10.10.20.160
        port: 17023
    custom:
      abstraction:
        order: [os, type]

  ios2:
    alias: ios2
    os: ios
    type: IOSv
    connections:

      defaults:
        class: unicon.Unicon
      console:
        protocol: telnet
        ip: 10.10.20.160
        port: 17025
    custom:
      abstraction:
        order: [os, type]

topology:ios1:
    interfaces:
      GigabitEthernet0/1:
        ipv4: 10.10.10.1/24
        link: ios1-to-ios2
        type: ethernet
      GigabitEthernet0/0:
        ipv4: 10.255.0.5/16
        link: guest
        type: ethernet
  ios2:
    interfaces:
      GigabitEthernet0/1:
        ipv4: 10.10.10.2/24
        link: ios1-to-ios2
        type: ethernet
      GigabitEthernet0/0:
        ipv4: 10.255.0.6/16
        link: guest
        type: ethernet
[developer@devbox pyats-ios-sample]$
[developer@devbox pyats-ios-sample]$
</code></pre><p>The generated contents look like this.
It is a yaml file, so it may be easy for people who are used to Ansible.</p>
<ol start="6">
<li>Let&rsquo;s run it.</li>
</ol>
<pre><code>[developer@devbox pyats-ios-sample]$make test
&lt;Omitted&gt;
2019-12-15T11:09:10: %EASYPY-INFO: +---------------------------------- --------------------------------------------+
2019-12-15T11:09:10: %EASYPY-INFO: | Task Result Summary |
2019-12-15T11:09:10: %EASYPY-INFO: +---------------------------------- --------------------------------------------+
2019-12-15T11:09:10: %EASYPY-INFO: Task-1: pyats_ios_example.commonSetup PASSED
2019-12-15T11:09:10: %EASYPY-INFO: Task-1: pyats_ios_example.PingTestcase[device=ios1] PASSED
2019-12-15T11:09:10: %EASYPY-INFO: Task-1: pyats_ios_example.PingTestcase[device=ios2] PASSED
2019-12-15T11:09:10: %EASYPY-INFO: Task-1: pyats_ios_example.VerifyInterfaceCountTestcase[device=ios1] PASSED
2019-12-15T11:09:10: %EASYPY-INFO: Task-1: pyats_ios_example.VerifyInterfaceCountTestcase[device=ios2] PASSED
2019-12-15T11:09:10: %EASYPY-INFO: Task-1: pyats_ios_example.commonCleanup PASSED

</code></pre><p>The whole output result is longer, and a detailed message of what you are doing is output.
Please check it out.</p>
<p>You can understand what you are doing this time by looking at the output message, but for the time being, explain it.</p>
<ol>
<li>Allow to connect to ios1,2
2.Ping communication test between ios1 and 2</li>
<li>Confirm with the following show command
show version
show ip interface brief</li>
</ol>
<h3 id="summary">Summary</h3>
<p>This is the end in terms of experience.
I have not touched on the contents and functions of pyATS at this time, but what kind of learning is necessary by doing this tutorial
I think you will be able to grasp the image.</p>
<p>In order not to finish this tutorial at the level of experience, examine the contents of the execution code from here,
I think you should read the pyATS related documents.</p>
<p>I didn&rsquo;t know how to study if I had no idea how it actually works.
He is the person who finally decided the learning policy by doing this DevNet tutorial and reading the contents of the actually executed code.
Also, I would like to study with my friends, but how to prepare an environment,
Some people found that English documents were uncomfortable, so I tried to post it like this.</p>
<p>We hope that it will help those who want to study.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
