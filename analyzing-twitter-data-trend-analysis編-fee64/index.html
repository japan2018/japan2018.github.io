<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>Analyzing Twitter Data | Trend Analysis編 | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Analyzing Twitter Data | Trend Analysis編</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 20, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/twitter">Twitter</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/pandas">pandas</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/twitterapi">TwitterAPI</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/datascience">DataScience</a></code></small>

</p>
<pre><code>This article is a trend analysis of Twitter Data analysis. I will deepen this series later. Since this is my first article, I will explain this case in detail after briefly analyzing Twitter Data. Because Japanese is tight, I will change it to English. [Git Repository](https://github.com/Bing-Violet/Real-Time-insights-from-social-media/blob/master/notebook.ipynb)
</code></pre>
<hr>
<p>###Why Analyze Twitter Data?
Twitter data analysis is used in a wide range of areas including but not restricted to analyzing the mentions of each political party in an election, detecting the reactions to the introduction of a new product, understanding the geographical scope of discussion of a news story.</p>
<p>###How to analyze twitter data?
Twitter data can be retrieved from twitter API.Data can be wrangled and manipulated according to the purpose of analysis.For example, if we need to get insights on a certain product from twitter data, there&rsquo;re a few strategies we can apply:</p>
<ul>
<li>Collect mentions of the product and identify if people are talking about it positively.
press</li>
<li>Examine the size of the retweet network mentioning the product.</li>
<li>Analyzing the geographical penetration of users mentioning the product.
press</li>
</ul>
<p>###Collecting data via twitter API</p>
<p>This is a slightly complicated procedure if it&rsquo;s your first time to use twitter API.Here I&rsquo;m going to explain how to collect data through twitter API.</p>
<ol>
<li>Log in your twitter account</li>
<li>Apply for a developer account. <a href="https://developer.twitter.com/en/apply-for-access.html">Apply Here!</a>
3.Create a new application.</li>
<li>Go to the application and find <strong>keys and tokens</strong>. (We&rsquo;ll need them later for authentication purposes.)</li>
</ol>
<p>#####Authentication</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tweepy <span style="color:#f92672">import</span> OAuthHandler
<span style="color:#f92672">from</span> tweepy <span style="color:#f92672">import</span> API
<span style="color:#f92672">import</span> json

consumer_key <span style="color:#f92672">=</span> <span style="color:#f92672">...</span>
consumer_secret <span style="color:#f92672">=</span> <span style="color:#f92672">...</span>
access_token <span style="color:#f92672">=</span> <span style="color:#f92672">...</span>
access_token_secret <span style="color:#f92672">=</span> <span style="color:#f92672">...</span>
<span style="color:#75715e"># Consumer key authentication</span>
auth <span style="color:#f92672">=</span> OAuthHandler(consumer_key, consumer_secret)

<span style="color:#75715e"># Access key authentication</span>
auth<span style="color:#f92672">.</span>set_access_token(access_token, access_token_secret)

<span style="color:#75715e"># Set up the API with the authentication handler</span>
api <span style="color:#f92672">=</span> API(auth)

</code></pre></div><h4 id="getting-the-trend">Getting the trend</h4>
<p>Here I&rsquo;m gonna use UK as an example. Information regarding WOE ID can be found <a href="https://blog.twitter.com/engineering/en_us/a/2010/woeids-in-twitters-trends.html">here</a> .</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">UK_WOE_ID <span style="color:#f92672">=</span> <span style="color:#ae81ff">23424975</span>
 
UK_trends <span style="color:#f92672">=</span> api<span style="color:#f92672">.</span>trends_place(UK_WOE_ID)

trends <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(json<span style="color:#f92672">.</span>dumps(UK_trends, indent<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))
</code></pre></div><p>###Local and global thought patterns</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Loading json module</span>
<span style="color:#f92672">import</span> json

<span style="color:#75715e"># Load WW_trends and US_trends data into the the given variables respectively</span>
WW_trends <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(open(<span style="color:#e6db74">&#39;datasets/WWTrends.json&#39;</span>)<span style="color:#f92672">.</span>read())
US_trends <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(open(<span style="color:#e6db74">&#39;datasets/USTrends.json&#39;</span>)<span style="color:#f92672">.</span>read())

<span style="color:#75715e"># Inspecting data by printing out WW_trends and US_trends variables</span>
<span style="color:#66d9ef">print</span>(WW_trends)
<span style="color:#66d9ef">print</span>(US_trends)
</code></pre></div><p>###Prettifying the output</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Pretty-printing the results.First WW and then US trends.</span>

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;WW trends:&#34;</span>)
<span style="color:#66d9ef">print</span>(json<span style="color:#f92672">.</span>dumps(WW_trends, indent<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;US trends:&#34;</span>)
<span style="color:#66d9ef">print</span>(json<span style="color:#f92672">.</span>dumps(US_trends, indent<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))
</code></pre></div><p>###Finding common trends</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Extracting all the WW trend names from WW_trends</span>
world_trends <span style="color:#f92672">=</span> set([trend[<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#66d9ef">for</span> trend <span style="color:#f92672">in</span> WW_trends[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;trends&#39;</span>]])

<span style="color:#75715e"># Extracting all the US trend names from US_trends</span>
us_trends <span style="color:#f92672">=</span> set([trend[<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#66d9ef">for</span> trend <span style="color:#f92672">in</span> US_trends[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;trends&#39;</span>]])

<span style="color:#75715e"># Getting the intersection of the two sets of trends</span>
common_trends <span style="color:#f92672">=</span> world_trends<span style="color:#f92672">.</span>intersection(us_trends)

<span style="color:#75715e"># Inspecting the data</span>
<span style="color:#66d9ef">print</span>(world_trends, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">print</span>(us_trends, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">print</span> (len(common_trends), <span style="color:#e6db74">&#34;common trends:&#34;</span>, common_trends)
</code></pre></div><p>###Exploring the hot trend</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Loading the data</span>
tweets <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(open(<span style="color:#e6db74">&#39;datasets/WeLoveTheEarth.json&#39;</span>)<span style="color:#f92672">.</span>read())

<span style="color:#75715e"># Inspecting some tweets</span>
tweets[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">2</span>]
</code></pre></div><p>###Digging deeper</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Extracting the text of all the tweets from the tweet object</span>
texts <span style="color:#f92672">=</span> [tweet[<span style="color:#e6db74">&#39;text&#39;</span>] <span style="color:#66d9ef">for</span> tweet <span style="color:#f92672">in</span> tweets]

<span style="color:#75715e"># Extracting screen names of users tweeting about #WeLoveTheEarth</span>
names <span style="color:#f92672">=</span> [user_mention[<span style="color:#e6db74">&#39;screen_name&#39;</span>] <span style="color:#66d9ef">for</span> tweet <span style="color:#f92672">in</span> tweets <span style="color:#66d9ef">for</span> user_mention <span style="color:#f92672">in</span> tweet[<span style="color:#e6db74">&#39;entities&#39;</span>][<span style="color:#e6db74">&#39;user_mentions&#39;</span>]]

<span style="color:#75715e"># Extracting all the hashtags being used when talking about this topic</span>
hashtags <span style="color:#f92672">=</span> [hashtag[<span style="color:#e6db74">&#39;text&#39;</span>] <span style="color:#66d9ef">for</span> tweet <span style="color:#f92672">in</span> tweets <span style="color:#66d9ef">for</span> hashtag <span style="color:#f92672">in</span> tweet[<span style="color:#e6db74">&#39;entities&#39;</span>][<span style="color:#e6db74">&#39;hashtags&#39;</span>]]

<span style="color:#75715e"># Inspecting the first 10 results</span>
<span style="color:#66d9ef">print</span> (json<span style="color:#f92672">.</span>dumps(texts[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">10</span>], indent<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>),<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">print</span> (json<span style="color:#f92672">.</span>dumps(names[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">10</span>], indent<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>),<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">print</span> (json<span style="color:#f92672">.</span>dumps(hashtags[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">10</span>], indent<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>),<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</code></pre></div><p>###Frequency analysis</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importing modules</span>
<span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Counter

<span style="color:#75715e"># Counting occcurrences/ getting frequency dist of all names and hashtags</span>
<span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> [names, hashtags]:
    c <span style="color:#f92672">=</span> Counter(item)
    <span style="color:#75715e"># Inspecting the 10 most common items in c</span>
    <span style="color:#66d9ef">print</span> (c<span style="color:#f92672">.</span>most_common(<span style="color:#ae81ff">10</span>), <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</code></pre></div><p>###Activity around the trend</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># Extracting useful information from retweets</span>
retweets <span style="color:#f92672">=</span> [(tweet[<span style="color:#e6db74">&#39;retweet_count&#39;</span>],
             tweet[<span style="color:#e6db74">&#39;retweeted_status&#39;</span>][<span style="color:#e6db74">&#39;favorite_count&#39;</span>],
             tweet[<span style="color:#e6db74">&#39;retweeted_status&#39;</span>][<span style="color:#e6db74">&#39;user&#39;</span>][<span style="color:#e6db74">&#39;followers_count&#39;</span>],
             tweet[<span style="color:#e6db74">&#39;retweeted_status&#39;</span>][<span style="color:#e6db74">&#39;user&#39;</span>][<span style="color:#e6db74">&#39;screen_name&#39;</span>],
             tweet[<span style="color:#e6db74">&#39;text&#39;</span>]) <span style="color:#66d9ef">for</span> tweet <span style="color:#f92672">in</span> tweets <span style="color:#66d9ef">if</span><span style="color:#e6db74">&#39;retweeted_status&#39;</span> <span style="color:#f92672">in</span> tweet]
</code></pre></div><p>###A table that speaks a 1000 words</p>
<pre><code class="language-python#" data-lang="python#">import matplotlib.pyplot as plt
import pandas as pd

# Create a DataFrame and visualize the data in a pretty and insightful format
df = pd.DataFrame(retweets, columns=['Retweets','Favorites', 'Followers', 'ScreenName', 'Text'])

df.style.background_gradient()
df = df.groupby(['ScreenName','Text','Followers']).sum().sort_values(by=['Followers'], ascending= False)
</code></pre><p>###Analyzing used languages</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Extracting language for each tweet and appending it to the list of languages</span>
tweets_languages <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> tweet <span style="color:#f92672">in</span> tweets: 
    tweets_languages<span style="color:#f92672">.</span>append(tweet[<span style="color:#e6db74">&#39;lang&#39;</span>])

<span style="color:#75715e"># Plotting the distribution of languages</span>
<span style="color:#f92672">%</span>matplotlib inline
plt<span style="color:#f92672">.</span>hist(tweets_languages)
</code></pre></div><img width="443" alt="Screen Shot 2020-02-20 at 11.05.21 pm.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/485479/40dcd9b6-bcb0-654e-0d74-839e0d2ab577.png">
<hr>
<p>That&rsquo;s the end of our project. In the next project of this series we&rsquo;ll look into more complicated use of twitter API.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
