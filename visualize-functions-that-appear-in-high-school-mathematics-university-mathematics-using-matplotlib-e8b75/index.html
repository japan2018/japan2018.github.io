<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Visualize functions that appear in high school mathematics &#43; university mathematics using Matplotlib | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Visualize functions that appear in high school mathematics + university mathematics using Matplotlib</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 9, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/matplotlib"> matplotlib</a></code></small>


<small><code><a href="https://memotut.com/tags/math-replay"> math replay</a></code></small>

</p>
<pre><code>This article is from the 12th day of [Kure National College of Technology Advent Calendar 2019](https://qiita.com/advent-calendar/2019/kurekosen).
</code></pre>
<p>#Introduction
As you study math, you will come across various &ldquo;functions&rdquo;. We often differentiate or integrate these functions, or find the extrema or inflection points of the functions. However, since these operations can be calculated by mechanical processing, it is not necessary to pay much attention to what kind of property the original function has and what kind of shape it has. That&rsquo;s a great part of mathematics, but this time, I&rsquo;ll use Python to draw graphs that are described in various forms so that I can properly imagine the graphs of functions that are used in high school and university mathematics.</p>
<p>This article was created with the intention of &ldquo;just copy and paste the code and then rewrite it a little&rdquo;. Therefore, a lot of commented out code is included in the article. The article is getting longer, so please make use of the jump function when reading.</p>
<p>#Environment</p>
<p>Python 3 series</p>
<ul>
<li>Please prepare your own environment</li>
</ul>
<p>numpy</p>
<ul>
<li>can be installed with <code>pip3 install numpy</code></li>
</ul>
<p>matplotlib</p>
<ul>
<li>can be installed with <code>pip3 install matplotlib</code></li>
</ul>
<p>japanize-matplotlib</p>
<ul>
<li>can be installed with <code>pip3 install japanize-matplotlib</code></li>
<li>Make matplotlib handle Japanese</li>
</ul>
<p>#2D graph</p>
<h2 id="y--fx">y = f(x)</h2>
<p>The following is an example to draw a graph of $y = x^2$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/b5fa72b5-5ca4-af4e-13cf-3779668ef1c0.png" alt="fig.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

<span style="color:#75715e">#Specify domain</span>
x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e"># Write function here</span>
y <span style="color:#f92672">=</span> x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>

plt<span style="color:#f92672">.</span>plot(x, y)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

<span style="color:#75715e"># When you want to take the axis automatically</span>
plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)
<span style="color:#75715e"># If you want to take the axis manually</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;)</span>
<span style="color:#75715e"># plt.xlim([-10, 10])</span>
<span style="color:#75715e"># plt.ylim([-100, 100])</span>

plt<span style="color:#f92672">.</span>show()
</code></pre></div><h3 id="specify-domain-range-of-x">Specify domain (range of x)</h3>
<p>It is specified by <code>x = np.linspace(minimum value of x, maximum value of x, number of divisions = 1000000)</code>.</p>
<p>The number of divisions may be fixed at 1000000, but if the processing is heavy, reduce the value.</p>
<h3 id="function-description">Function description</h3>
<p>Replace the <code>y = x**2</code> part with the function you want to draw. When using elementary functions, use the functions in <code>np</code>. Don&rsquo;t use the <code>math</code> module.</p>
<p>For example</p>
<ul>
<li>
<p>If $y = \sin{x}$, <code>y = np.sin(x)</code></p>
</li>
<li>
<p>If $y = e^x$, then <code>y = np.exp(x)</code></p>
</li>
</ul>
<p>will do.</p>
<h3 id="axis-setting">Axis setting</h3>
<p>If you want to take the axis automatically, you can leave it as it is, but you may want to set the maximum and minimum values of the axis yourself.</p>
<p>In that case,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># When you want to take the axis automatically</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;,&#39;datalim&#39;)</span>
<span style="color:#75715e"># If you want to take the axis manually</span>
plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>)
plt<span style="color:#f92672">.</span>xlim([minimum x value, maximum x value])
plt<span style="color:#f92672">.</span>ylim([minimum y value, maximum y value])
</code></pre></div><p>Let&rsquo;s say</p>
<h2 id="draw-two-or-more-graphs-simultaneously">Draw two or more graphs simultaneously</h2>
<p>Here is an example of drawing $y = \sin{x}$ and $y = \cos{x}$ at the same time.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/0c21b7c8-8ee7-e4fd-00f1-afae66d7e87e.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

<span style="color:#75715e">#Specify domain</span>
x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e"># Write function here</span>
y1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(x)
y2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cos(x)

plt<span style="color:#f92672">.</span>plot(x, y1, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sin&#39;</span>)
plt<span style="color:#f92672">.</span>plot(x, y2, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;cos&#39;</span>)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

<span style="color:#75715e"># Label drawing</span>
plt<span style="color:#f92672">.</span>legend()

<span style="color:#75715e"># When you want to take the axis automatically</span>
plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)
<span style="color:#75715e"># If you want to take the axis manually</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;)</span>
<span style="color:#75715e"># plt.xlim([-10, 10])</span>
<span style="color:#75715e"># plt.ylim([0, 100])</span>

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>If you want to draw two or more functions at the same time, add <code>label='label name'</code>.</p>
<p>Even if there are three or more, you can increase the number of functions as well. The color of the graph is also set automatically.</p>
<h2 id="drawing-with-logarithmic-axis">Drawing with logarithmic axis</h2>
<p>The following is an example of drawing the graph of $y = e^{-x} = \exp{(-x)}$ on the logarithmic axis.
I think that many students of electricity work with logarithmic axes.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/ed3121e9-d4e3-5d53-053b-2d2a74424da9.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

<span style="color:#75715e">#Setting domain</span>
x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e"># Write function here</span>
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>x)

plt<span style="color:#f92672">.</span>plot(x, y, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;exp(-x)&#39;</span>)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

<span style="color:#75715e"># Label drawing</span>
plt<span style="color:#f92672">.</span>legend()

<span style="color:#75715e">#Set to logarithmic axis</span>
plt<span style="color:#f92672">.</span>yscale(<span style="color:#e6db74">&#39;log&#39;</span>) <span style="color:#75715e"># add plt.xscale(&#39;log&#39;) if the x-axis is also logarithmic</span>

<span style="color:#75715e"># When you want to take the axis automatically</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;,&#39;datalim&#39;)</span>
<span style="color:#75715e"># If you want to take the axis manually</span>

<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;)</span>
<span style="color:#75715e"># plt.xlim([-10, 10])</span>
<span style="color:#75715e"># plt.ylim([0, 100])</span>

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>Since it is a logarithmic axis this time, the setting &ldquo;Automatically take axis&rdquo; is omitted.</p>
<h2 id="draw-implicit-function">Draw implicit function</h2>
<p>Implicit functions are functions written in the form $F(x, y) = 0$.</p>
<p>For example, $x^2 + y^2-1 = 0$ is an implicit function. This is often used when you cannot explicitly describe $y$ like $y = f(x)$.</p>
<p>The following is an example of drawing $F(x, y) = x^2-2xy-y^2 + 7 = 0$. Can you imagine what the graph will look like?</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/5f43a18c-a634-fb24-307e-d67047263609.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

range of <span style="color:#75715e">#x</span>
x_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1000</span>)
range of <span style="color:#75715e"># y</span>
y_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1000</span>)

x, y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(x_range, y_range)

<span style="color:#75715e"># Implicit function F = 0</span>
F <span style="color:#f92672">=</span> x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>x<span style="color:#f92672">*</span>y<span style="color:#f92672">-</span>y<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">7</span>

When setting the <span style="color:#75715e"># axis automatically</span>
plt<span style="color:#f92672">.</span>gca()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>, adjustable<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;box&#39;</span>)
<span style="color:#75715e">#When setting the axis manually</span>
<span style="color:#75715e"># plt.axis([-10, 10, -10, 10])</span>

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>contour(x, y, F, [<span style="color:#ae81ff">0</span>], colors<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>I don&rsquo;t explain it in detail, but I draw the implicit function by describing the contour lines at the height $z = 0$ of the two-variable function $z = F(x, y)$.</p>
<p>In fact, the only thing that needs to be rewritten is the function $F(x, y)$ and the range of $x$ and $y$.</p>
<h2 id="curved-parameter-display">Curved parameter display</h2>
<p>Parametric representation is a method that does not represent a function in the form of $y=f(x)$ but represents it by a variable $t$ called a parametric variable. If you write it as an expression, it will be as follows.</p>
<pre><code class="language-math" data-lang="math">\left\{
\begin{array}{ll}
x = \varphi(t) \\
y = \psi(t)
\end{array}
\right.
</code></pre><p>The following is</p>
<pre><code class="language-math" data-lang="math">\left\{
\begin{array}{ll}
x = \left(1 + \cos{t} \right) \cos{t} \\
y = \left(1 + \cos{t} \right) \sin{t}
\end{array}
\right.
</code></pre><p>This is an example of drawing a graph.<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/c3195fcd-aa64-e4a7-b714-e8cbca028df1.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

range of <span style="color:#75715e"># t</span>
t <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e"># Write a function</span>
x <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>cos(t))<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>cos(t)
y <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>cos(t))<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>sin(t)

When setting the <span style="color:#75715e"># axis automatically</span>
plt<span style="color:#f92672">.</span>gca()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>, adjustable<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;box&#39;</span>)
<span style="color:#75715e">#When setting the axis manually</span>
<span style="color:#75715e"># plt.axis([-10, 10, -10, 10])</span>

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>plot(x, y)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>An example is the so-called cardioid.</p>
<p>You can easily get interesting graphs by using parametric display.
Reference: <a href="https://mathtrain.jp/sevencurve">7 famous curves displayed as parametric variables-beautiful story of high school mathematics</a></p>
<h2 id="two-dimensional-vector-function">Two-dimensional vector function</h2>
<p>The vectors handled up to high school mathematics were &ldquo;constant vectors&rdquo; whose direction and magnitude were always constant.
On the other hand, from university mathematics, we deal with &ldquo;vector functions&rdquo; in which the size and direction of a vector change depending on variables such as time.</p>
<p>Vector functions are written in the form $\vec{r}(t) = (x(t),\ y(t))$.</p>
<p>The following is an example to draw the graph (trajectory) of $\vec{r}(t) = (\cos^3{t},\ \sin^3{t})$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/ca8dcab9-0f10-999b-308a-b4fc059d94f2.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

range of <span style="color:#75715e"># t</span>
t <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI, <span style="color:#ae81ff">1000000</span>)

Write <span style="color:#75715e">#x(t)</span>
x <span style="color:#f92672">=</span> (np<span style="color:#f92672">.</span>cos(t))<span style="color:#f92672">**</span><span style="color:#ae81ff">3</span>
Write <span style="color:#75715e">#y(t)</span>
y <span style="color:#f92672">=</span> (np<span style="color:#f92672">.</span>sin(t))<span style="color:#f92672">**</span><span style="color:#ae81ff">3</span>

When setting the <span style="color:#75715e"># axis automatically</span>
plt<span style="color:#f92672">.</span>gca()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>, adjustable<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;box&#39;</span>)
<span style="color:#75715e">#When setting the axis manually</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;)</span>
<span style="color:#75715e"># plt.axis([-10, 10, -10, 10])</span>

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>plot(x, y)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>The program is almost the same as &ldquo;parameter display of curve&rdquo;, or it is exactly the same.</p>
<h2 id="vector-locus-nyquist-diagram">Vector locus (Nyquist diagram)</h2>
<p>For complex numbers $z(t) = x(t) + y(t)\cdot i$, a plot of the locus of complex numbers when $t$ is moved is called &ldquo;vector diagram/Nyquist diagram&rdquo;. I will.</p>
<p>To give an example of electric circuit theory, for impedance $\dot{Z} = R + j \omega L$, what happens to impedance $\dot{Z}$ if resistance $R$ changes? Angular frequency $\ It&rsquo;s used to see what happens when you change omega$.</p>
<p>Especially in control engineering, the term Nyquist diagram is preferred. Used to see the frequency response of the transfer function. (Because it will be long if you explain it further, I will stop it.)</p>
<p>The following is</p>
<pre><code class="language-math" data-lang="math">z(\omega) = \dfrac{1}{1-\omega^2 + \omega i}
</code></pre><p>Here is an example of drawing the vector locus when changing $\omega$. In the program, $\omega$ is represented by <code>t</code>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/ea1fe54a-5042-cebb-4644-c51a6353200e.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python" data-lang="Python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
<span style="color:#f92672">import</span> japanise_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>
 
<span style="color:#75715e"># a formula</span>
t <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0.001</span>) <span style="color:#75715e"># np.arange(minimum value of t (normally 0 ), maximum value of t, step)</span>

<span style="color:#75715e"># Write a function</span>
<span style="color:#75715e">## For complex numbers, add 4j etc. and `j`</span>
<span style="color:#75715e">## When you say `variable *i` etc., set it as `variable * 1j`</span>
z <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>t<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> t<span style="color:#f92672">*</span><span style="color:#ae81ff">1j</span>);

<span style="color:#75715e"># Get real and imaginary parts</span>
Re <span style="color:#f92672">=</span> z<span style="color:#f92672">.</span>real
Im <span style="color:#f92672">=</span> z<span style="color:#f92672">.</span>imag

<span style="color:#75715e"># Variable on the horizontal axis. Variable on the vertical axis.</span>
plt<span style="color:#f92672">.</span>plot(Re, Im)

<span style="color:#75715e"># Grid extension line</span>
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

When setting the <span style="color:#75715e"># axis automatically</span>
plt<span style="color:#f92672">.</span>gca()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>, adjustable<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;box&#39;</span>)
<span style="color:#75715e">#When setting the axis manually</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;)</span>
<span style="color:#75715e"># plt.axis([-10, 10, -10, 10])</span>

<span style="color:#75715e"># Execute drawing</span>
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>In Python, the imaginary unit is $j$ instead of $i$ (which is familiar to anyone studying electricity).</p>
<p>For example,</p>
<ul>
<li>
<p>If you want to represent $4i$, you can use <code>4j</code></p>
</li>
<li>
<p><code>2*t * 1j</code> to express $2ti$</p>
</li>
</ul>
<p>will do.</p>
<p>I am happy that if you write it as it is without rationalization, it will be plotted.</p>
<h2 id="two-dimensional-vector">Two-dimensional vector</h2>
<p>matplotlib has a function <code>plt.quiver()</code> that draws vectors, but writing a constant vector is a bit tricky. Therefore, I made a function called <code>plot_vector2D()</code> by myself and made the drawing easy.</p>
<p>The following is</p>
<pre><code class="language-math" data-lang="math">\begin{align}
\vec{v_1} &amp;= (5,\1) \\
\vec{v_2} &amp;= (2,\4) \\
\vec{v_3} &amp;= \vec{v_2}-\vec{v_1}
\end{align}
</code></pre><p>An example of drawing the three vectors of.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/392c32df-a3de-dab8-ce63-8a0868eb44da.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_vector2D</span>(pos, vec, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1.0</span>):
    plt<span style="color:#f92672">.</span>quiver(pos[<span style="color:#ae81ff">0</span>], pos[<span style="color:#ae81ff">1</span>], vec[<span style="color:#ae81ff">0</span>], vec[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span>color, angles<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xy&#39;</span>, scale_units<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xy&#39;</span>, scale<span style="color:#f92672">=</span>scale)

<span style="color:#75715e"># Writing vector</span>
v1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>])
v2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>])
v3 <span style="color:#f92672">=</span> v2<span style="color:#f92672">-</span>v1

plot_vector2D([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], v1, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>)
plot_vector2D([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], v2, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>)
plot_vector2D(v1, v3)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

<span style="color:#75715e">#Axis setting</span>
<span style="color:#75715e">## x maximum value minimum value</span>
plt<span style="color:#f92672">.</span>xlim([<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>])
<span style="color:#75715e">## Maximum value of y Minimum value</span>
plt<span style="color:#f92672">.</span>ylim([<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>])

plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>###plot_vector2D function</p>
<p>The vector is plotted by passing the following arguments to the <code>plot_vector2D()</code> function for plotting a constant vector.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plot_vector2D(start point, direction, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;color (optional)&#39;</span>, scale<span style="color:#f92672">=</span>scale of unit vector (optional))
</code></pre></div><p>For example, to extend a vector from the origin, use <code>plot_vector2D([0, 0], v)</code>.
<code>color</code> and <code>scale</code> are default values <code>blue</code> and <code>1.0</code> respectively.</p>
<p>All vectors are divided by the size specified by <code>scale</code> and drawn.
For example, specifying <code>scale=5.0</code> will reduce the size of all vectors by a factor of 5.</p>
<p>Note that changing the scale does not adjust the starting point position.</p>
<p>Basically, I think that the default value <code>scale=1.0</code> should be fine, but in the vector field described below, it may be better to change the value appropriately.</p>
<h3 id="axis-setting-1">Axis setting</h3>
<p>Even if you use <code>plt.axes().set_aspect('equal','datalim')</code>, it doesn&rsquo;t automatically adjust well, so you have to set it manually.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>xlim([x<span style="color:#f92672">-</span>axis minimum value, x<span style="color:#f92672">-</span>axis maximum value])
plt<span style="color:#f92672">.</span>ylim([minimum y<span style="color:#f92672">-</span>axis value, maximum y<span style="color:#f92672">-</span>axis value])
</code></pre></div><p>Please set like.</p>
<h2 id="two-dimensional-vector-field">Two-dimensional vector field</h2>
<p>Like the flow of water, the vector $\boldsymbol{v}(P) = \boldsymbol{v}(x,\ y)$ is distributed at each place and each point $P(x,\ y)$. Sometimes it is called <strong>vector field</strong>.</p>
<p>The following is a vector field</p>
<pre><code class="language-math" data-lang="math">\boldsymbol{v}(x,\ y) = \left(2y,\ 3x \right)
</code></pre><p>Here is an example of drawing.<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/9c2598ed-a640-166a-5c55-bc9a844ec21e.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

range of <span style="color:#75715e">#x</span>
x_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0.5</span>)
range of <span style="color:#75715e"># y</span>
y_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0.5</span>)
x, y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(x_range, y_range)

<span style="color:#75715e"># Vector field v(x, y) = (u(x, y), v(x, y))</span>
u <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>y
v <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>x

plt<span style="color:#f92672">.</span>quiver(x, y, u, v, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, angles<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xy&#39;</span>, scale_units<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xy&#39;</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">5.0</span>)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

<span style="color:#75715e"># When you want to take the axis automatically</span>
plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)
<span style="color:#75715e"># If you want to take the axis manually</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;)</span>
<span style="color:#75715e"># plt.xlim([-10, 10])</span>
<span style="color:#75715e"># plt.ylim([0, 100])</span>

plt<span style="color:#f92672">.</span>show()
</code></pre></div><h3 id="x-y-range">x, y range</h3>
<p>Until now, <code>np.linspace(minimum value, maximum value, number of divisions)</code> was used as a function to specify the range of $x,\ y$, but here, <code>np.arange( minimum value, maximum value, Interval)</code> is used. This is because it is easier to understand by expressing the fineness of the data by the number of divisions and by expressing the intervals of the arrows.</p>
<h3 id="function-description-1">Function description</h3>
<p>When we express the vector field as $\boldsymbol{v}(x, y) = \left(u(x,\ y),\ v(x,\ y) \right)$, $u(x,\ y ),\ v(x,\ y)$ should be written.</p>
<p>The variables <code>x</code> and <code>y</code> represent the starting point $(x,\ y)$ of the vector.</p>
<h3 id="pltquiver-function">plt.quiver function</h3>
<p>I am plotting a vector with the plt.quiver function,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>quiver(x, y, u, v, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, angles<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xy&#39;</span>, scale_units<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xy&#39;</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">5.0</span>)
</code></pre></div><p>Note the <code>scale=5.0</code> of the arguments to.
If you want to draw at the original scale, specify <code>scale=1.0</code>.
However, at a scale of 1, the arrows are often too long to be visible. Therefore, if you specify a numerical value with <code>scale</code>, the vector will be divided by that size, making it easier to see.</p>
<p>#3D graph</p>
<h2 id="z--fx-y">z = f(x, y)</h2>
<p>The graph of the bivariate function is drawn in the three-dimensional space.</p>
<p>The following is an example to draw the graph of $z = y^2-x^2$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/15c1985e-d306-1e9d-591c-36b35e509df4.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> mpl_toolkits.mplot3d <span style="color:#f92672">import</span> Axes3D
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)

<span style="color:#75715e"># set range of x and y</span>
x_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">1000</span>)
y_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">1000</span>)
x, y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(x_range, y_range)

<span style="color:#75715e"># Write a function</span>
z <span style="color:#f92672">=</span> y<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>

ax<span style="color:#f92672">.</span>plot_surface(x, y, z, cmap <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;summer&#34;</span>)
ax<span style="color:#f92672">.</span>contour(x, y, z, colors <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gray&#34;</span>, offset <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e"># draw contour lines on the bottom</span>

<span style="color:#75715e">#No description when setting axes automatically</span>

<span style="color:#75715e"># When setting the axis manually</span>
<span style="color:#75715e"># ax.set_xlim(-20, 20)</span>
<span style="color:#75715e"># ax.set_ylim(-20, 20)</span>
<span style="color:#75715e"># ax.set_zlim(-1500, 1500)</span>

ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>)
ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#34;z&#34;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>The mood of the code has changed a little, but the messing around is not so different from the case of 2D. If it rewrites it, it will be the description of $z = f(x, y)$ and the setting of the axis.</p>
<p>Be careful when setting the axis (scale). This time, the axis is set automatically to emphasize the appearance. Therefore, the scales of the x, y axis and the z axis are different.(Since the scale of z tends to be larger than the scales of x and y in the case of a two-variable function, it will be a subtle feeling when manually adjusting the scale. But&hellip;)</p>
<p>Anyway, when you look at the graph, don&rsquo;t forget to check the axis scale.</p>
<h2 id="three-dimensional-vector-function">Three-dimensional vector function</h2>
<p>The following is an example to draw the graph of $\vec{r}(t) = (\sin{t},\ \cos{t},\ t)$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/7c8d5b8e-8d26-1e7f-64ef-feddb7347021.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> mpl_toolkits.mplot3d <span style="color:#f92672">import</span> Axes3D
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)

Set the range of <span style="color:#75715e">#parameter t</span>
t <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span><span style="color:#f92672">*</span>PI, <span style="color:#ae81ff">6</span><span style="color:#f92672">*</span>PI, <span style="color:#ae81ff">1000</span>)

Write <span style="color:#75715e">#x(t)</span>
x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cos(t)
Write <span style="color:#75715e">#y(t)</span>
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(t)
Write <span style="color:#75715e">#z(t)</span>
z <span style="color:#f92672">=</span> t

ax<span style="color:#f92672">.</span>plot(x, y, z)

<span style="color:#75715e">#No description when setting axes automatically</span>

<span style="color:#75715e"># When setting the axis manually</span>
<span style="color:#75715e"># ax.set_xlim(-20, 20)</span>
<span style="color:#75715e"># ax.set_ylim(-20, 20)</span>
<span style="color:#75715e"># ax.set_zlim(-1500, 1500)</span>

ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>)
ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#34;z&#34;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>Speaking of physics, velocity $\vec{v}(t)$ and position $\vec{x}(t)$ are examples of 3D vector functions.</p>
<h2 id="three-dimensional-vector">three-dimensional vector</h2>
<p>We use the function <code>plt.quiver()</code> that draws a vector, but like 2D, writing a constant vector is a bit trickier.
Therefore, I made a function called <code>plot_vector3D()</code> by myself and made the drawing easy.</p>
<p>The following is</p>
<pre><code class="language-math" data-lang="math">\vec{v_1} = (1,\ 2,\ 3) \\
\vec{v_2} = (-4,\ 5,\ 1) \\
\vec{v_3} = \vec{v_2}-\vec{v_1}
</code></pre><p>An example of drawing the three vectors of.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/83f17050-325e-ea92-8cf7-b7a0664d2eb4.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> mpl_toolkits.mplot3d <span style="color:#f92672">import</span> Axes3D
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_vector3D</span>(ax, pos, vec, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1.0</span>):
    ax<span style="color:#f92672">.</span>quiver(pos[<span style="color:#ae81ff">0</span>], pos[<span style="color:#ae81ff">1</span>], pos[<span style="color:#ae81ff">2</span>], vec[<span style="color:#ae81ff">0</span>], vec[<span style="color:#ae81ff">1</span>], vec[<span style="color:#ae81ff">2</span>], color<span style="color:#f92672">=</span>color, length<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>scale)

<span style="color:#75715e"># Writing vector</span>
v1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
v2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>])
v3 <span style="color:#f92672">=</span> v2<span style="color:#f92672">-</span>v1

plot_vector3D(ax, [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], v1, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>)
plot_vector3D(ax, [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], v2, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>)
plot_vector3D(ax, v1, v3)

<span style="color:#75715e">#Axis setting</span>
ax<span style="color:#f92672">.</span>set_xlim([<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>])
ax<span style="color:#f92672">.</span>set_ylim([<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>])
ax<span style="color:#f92672">.</span>set_zlim([<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>])

ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>)
ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#34;z&#34;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>Vectors can be plotted by passing the following arguments to the <code>plot_vector3D()</code> function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plot_vector3D(ax, start point, direction, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;color (optional)&#39;</span>, scale<span style="color:#f92672">=</span>scale of unit vector)
</code></pre></div><p>Note that changing the scale does not adjust the starting point position.</p>
<p>It&rsquo;s almost the same as the 2D case.</p>
<h2 id="three-dimensional-vector-field">Three-dimensional vector field</h2>
<p>A three-dimensional vector field is defined as well as a two-dimensional one.</p>
<p>The following is a vector field</p>
<pre><code class="language-math" data-lang="math">\boldsymbol{v}(t) = \left( x(x+y+z),\ y(x+y+z),\ z(x+y+z) \right)
</code></pre><p>Here is an example of drawing.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/cc846f16-0920-635c-0079-3a6ad3e507d4.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> mpl_toolkits.mplot3d <span style="color:#f92672">import</span> Axes3D
<span style="color:#f92672">import</span> japanize_matplotlibPI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)

range of <span style="color:#75715e">#x</span>
x_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
range of <span style="color:#75715e"># y</span>
y_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># z range</span>
z_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
x, y, z <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(x_range, y_range, z_range)

<span style="color:#75715e"># Vector field v(x, y, z) = (u(x, y, z), v(x, y, z), w(x, y, z))</span>
u <span style="color:#f92672">=</span> x<span style="color:#f92672">*</span>(x <span style="color:#f92672">+</span> y <span style="color:#f92672">+</span> z)
v <span style="color:#f92672">=</span> y<span style="color:#f92672">*</span>(x <span style="color:#f92672">+</span> y <span style="color:#f92672">+</span> z)
w <span style="color:#f92672">=</span> z<span style="color:#f92672">*</span>(x <span style="color:#f92672">+</span> y <span style="color:#f92672">+</span> z)

ax<span style="color:#f92672">.</span>quiver(x, y, z, u, v, w, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5.0</span>, normalize<span style="color:#f92672">=</span>False)

ax<span style="color:#f92672">.</span>set_xlim([<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>])
ax<span style="color:#f92672">.</span>set_ylim([<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>])
ax<span style="color:#f92672">.</span>set_zlim([<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>])

ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>)
ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#34;z&#34;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>It is almost the same as the two-dimensional case.</p>
<p>Note that the unit vector scale is specified as <code>length</code> instead of <code>scale</code>.
The unit vector is drawn with a scale of <code>length</code> times.</p>
<h2 id="uv-curved-surface">uv curved surface</h2>
<p>A surface in 3D space is a function of the position vector $\boldsymbol{r}$ with two variables $u,\ v$ and $\boldsymbol{r} = \boldsymbol{r}(u,\ v)$ Can be represented This is called the $uv$ surface.</p>
<p>It is often used in the field of vector analysis.</p>
<p>The following is an example to draw the graph (surface) of $\boldsymbol{r}(u,v) = (2u,\ 3v,\ u^2 + v^2)$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/8a551fea-89a0-3b2a-e33b-b02f928c113f.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> mpl_toolkits.mplot3d <span style="color:#f92672">import</span> Axes3D
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)

specify a range of <span style="color:#75715e"># u</span>
urange <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">1000</span>)
specify a range of <span style="color:#75715e"># v</span>
vrange <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">1000</span>)
u, v <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(urange, vrange)

<span style="color:#75715e"># Describe the surface r(u, v)</span>
x <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>u
y <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>v
z <span style="color:#f92672">=</span> u<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> v<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>

ax<span style="color:#f92672">.</span>plot_surface(x, y, z, cmap <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;summer&#34;</span>)
ax<span style="color:#f92672">.</span>contour(x, y, z, colors <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gray&#34;</span>, offset <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e"># draw contour lines on the bottom</span>

ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>)
ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#34;z&#34;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><h1 id="application">Application</h1>
<h2 id="decorate-the-graph">Decorate the graph</h2>
<p>There are many ways to decorate a graph, but here are some.</p>
<p>The following is an example of drawing Ohm&rsquo;s law $V = RI$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/6fedfc7f-dd13-610b-3b43-d68115451984.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

<span style="color:#75715e">#Specify domain</span>
I <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e"># Write function here</span>
R <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
V <span style="color:#f92672">=</span> R<span style="color:#f92672">*</span>I

plt<span style="color:#f92672">.</span>plot(I, V)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

<span style="color:#75715e"># Add a title</span>
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;Ohm&#39;</span>s Law (Resistance <span style="color:#960050;background-color:#1e0010">$</span>R <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">$</span> [<span style="color:#960050;background-color:#1e0010">$</span>{\rm \Omega}<span style="color:#960050;background-color:#1e0010">$</span>])<span style="color:#e6db74">&#39;)</span>

plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Current $I$ [A]&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Voltage $V$ [V]&#39;</span>)

<span style="color:#75715e"># When you want to take the axis automatically</span>
plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)
<span style="color:#75715e"># If you want to take the axis manually</span>
<span style="color:#75715e"># plt.axes().set_aspect(&#39;equal&#39;)</span>
<span style="color:#75715e"># plt.xlim([-10, 10])</span>
<span style="color:#75715e"># plt.ylim([-100, 100])</span>

<span style="color:#75715e"># Add one tick</span>
plt<span style="color:#f92672">.</span>xticks(np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))
plt<span style="color:#f92672">.</span>yticks(np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))

<span style="color:#75715e"># Make the x and y axes solid</span>
plt<span style="color:#f92672">.</span>hlines([<span style="color:#ae81ff">0</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>vlines([<span style="color:#ae81ff">0</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span><span style="color:#f92672">*</span>R, <span style="color:#ae81ff">5</span><span style="color:#f92672">*</span>R, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><h3 id="add-a-title-or-label">Add a title or label</h3>
<p>You can add a title or label to a graph by using <code>plt.title('')</code>, <code>plt.xlabel('')</code>, or <code>plt.ylabel('')</code>.</p>
<p>You can also use the $\TeX$ notation by wrapping it in <code>$</code>, but if you use the backslash <code>\</code>, you need to put <code>r</code> in front of the quotes around the string.</p>
<h3 id="change-the-fineness-of-the-scale">change the fineness of the scale</h3>
<p>Use <code>plt.xticks(np.arange(-5, 5+1, 1))</code> and <code>plt.yticks(np.arange(-5, 5+1, 1))</code> to set the x and y You can change each detail.</p>
<p><code>np.arange(minimum, maximum, interval (tolerance))</code> but note that the range is <code>[minimum, maximum)</code>. (It means that the maximum value is not included.)</p>
<h3 id="make-the-x-and-y-axes-solid">Make the x and y axes solid</h3>
<p>I tried to draw the x and y axes using the function <code>plt.hlines()</code> that draws horizontal lines and the function <code>plt.vlines()</code> that draws vertical lines.</p>
<h3 id="draw-auxiliary-lines">draw auxiliary lines</h3>
<p>In our example using Ohm&rsquo;s law, we used <code>plt.hlines()</code> and <code>plt.vlines()</code> to draw the x and y axes, but these functions are useful for drawing auxiliary lines. is.</p>
<p>About $y = \sin{x}$</p>
<pre><code class="language-math" data-lang="math">\begin{align}
x &amp;= \pi,\ 2\pi \\
y &amp;= -1,\ -\frac{\sqrt{2}}{2},\ \frac{\sqrt{2}}{2},\ 1
\end{align}
</code></pre><p>This is an example of drawing an auxiliary line in the part of.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/83628533-339e-9d70-1c4f-7c0a5e8fc9e7.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI <span style="color:#f92672">+</span> PI<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1000000</span>)

y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(x)

plt<span style="color:#f92672">.</span>plot(x, y)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$y = \sin{x}$&#39;</span>)

plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>)
plt<span style="color:#f92672">.</span>xlim([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI <span style="color:#f92672">+</span> PI<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>])
plt<span style="color:#f92672">.</span>ylim([<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>])

<span style="color:#75715e"># Draw a horizontal extension line</span>
plt<span style="color:#f92672">.</span>hlines([<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span>np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI <span style="color:#f92672">+</span> PI<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;- -&#39;</span>)
<span style="color:#75715e"># Draw a vertical auxiliary line</span>
plt<span style="color:#f92672">.</span>vlines([PI, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI], <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>hlines([<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>PI <span style="color:#f92672">+</span> PI<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>vlines([<span style="color:#ae81ff">0</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>The meanings of the function arguments are as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>hlines([list of y values to start drawing auxiliary lines], minimum x value, maximum x value, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;color&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;- or --or :&#39;</span>)
plt<span style="color:#f92672">.</span>vlines([list of x values to start drawing auxiliary lines], minimum y value, maximum y value, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;color&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;- or --or :&#39;</span>)
</code></pre></div><h2 id="draw-two-or-more-graphs-side-by-side">Draw two or more graphs side by side</h2>
<p>To draw two or more graphs side by side, use the <code>fig.add_subplot()</code> function.</p>
<p>The following is an example of drawing the surface $z = x^2 + y^2-1$ and the curve $F(x, y) = x^2 + y^2-1 = 0$ at the same time.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/7e3fdd6d-df3d-cb27-1908-8f22503134b8.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> mpl_toolkits.mplot3d <span style="color:#f92672">import</span> Axes3D
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

x_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1000</span>)
y_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1000</span>)
x, y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(x_range, y_range)

<span style="color:#75715e"># Implicit function</span>
z <span style="color:#f92672">=</span> x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> y<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>

<span style="color:#75715e"># Specify window size (assuming 8 per graph)</span>
fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">8</span>))

<span style="color:#75715e">#Drawing settingsax1 = fig.add_subplot(1, 2, 1, projection=&#34;3d&#34;)</span>
ax1<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Surface z = f(x, y)&#39;</span>)
ax1<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)
ax1<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)
ax1<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#34;z&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)
ax1<span style="color:#f92672">.</span>plot_surface(x, y, z, cmap <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;summer&#34;</span>)
ax1<span style="color:#f92672">.</span>contour(x, y, z, colors <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, offset <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e"># draw contour lines on the bottom</span>
ax1<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>, adjustable<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datalim&#39;</span>)

ax2 <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
ax2<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Curve f(x, y) = 0&#39;</span>)
ax2<span style="color:#f92672">.</span>axis([<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>])
ax2<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>, adjustable<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datalim&#39;</span>)
ax2<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
ax2<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
ax2<span style="color:#f92672">.</span>contour(x, y, z, [<span style="color:#ae81ff">0</span>], colors<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>When dealing with two or more graphs, consider setting and plotting each graph using a variable called <code>ax</code>.</p>
<p>First, create a single <code>ax</code> using the <code>fig.add_subplot()</code> function.
Specify an argument such as &ldquo;what ** row ** what ** column ** in which graph the graph is placed **&rdquo;.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">For <span style="color:#75715e">#2D</span>
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(row, column, number)
For <span style="color:#75715e">#3D</span>
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(row, number of columns, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)
</code></pre></div><p>Next, set and plot using <code>ax</code>. The functions in <code>ax</code> are quite similar to those in <code>plt</code>, but the function names are not exactly the same, so check each one.</p>
<p>Then create as many graphs as you want to display this <code>ax</code>.</p>
<h2 id="special-functions">Special functions</h2>
<p>Consider drawing a periodic function or a function with conditional branches.
After all, if you do not know because it is how to handle the <code>np.ndarray</code> type, you may do a search using <code>np.ndarray</code> as a keyword.</p>
<p>Here are some examples.</p>
<h3 id="relu-function-ramp-function">ReLU function (ramp function)</h3>
<p>The ReLU function (ramp function) is defined as follows.</p>
<pre><code class="language-math" data-lang="math">f(x) = \left\{
\begin{array}{ll}
x &amp; (x \geq 0) \\
0 &amp; (x \lt 0)
\end{array}
\right.
</code></pre><p>You can write a function successfully by using <code>np.maximum(a, b)</code> of <code>numpy</code>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/7c096087-0ab8-4f5c-e30e-a7132453173a.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e"># ReLU function</span>
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>maximum(x, <span style="color:#ae81ff">0</span>)

plt<span style="color:#f92672">.</span>plot(x, y)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;ReLU function&#39;</span>)

plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)

plt<span style="color:#f92672">.</span>xticks(np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))
plt<span style="color:#f92672">.</span>yticks(np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))

plt<span style="color:#f92672">.</span>hlines([<span style="color:#ae81ff">0</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>vlines([<span style="color:#ae81ff">0</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><h3 id="function-with-conditional-branch">Function with conditional branch</h3>
<pre><code class="language-math" data-lang="math">f(x) = \left\{
\begin{array}{ll}
\dfrac{3}{2}x &amp; (0 \leq x &lt;2) \\
3 &amp; (2 \leq x &lt;4) \\
- \dfrac{3}{2}x + 9 &amp; (otherwise)
\end{array}
\right.
</code></pre><p>Consider drawing a graph of.</p>
<p>The <code>np.where()</code> function extracts the elements that meet the conditions in <code>np.ndarray</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">np<span style="color:#f92672">.</span>where(conditional expression, value when True, value when False)
</code></pre></div><p>I will use it. To combine multiple conditional expressions, use <code>&amp;</code> and <code>|</code> instead of <code>and</code> and <code>or</code>.</p>
<p>An example of implementation is shown below.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/00560f29-5638-ec06-c400-7d3e0c60efeb.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e">#Function definition</span>
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where((<span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;=</span> x) <span style="color:#f92672">&amp;</span> (x <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">1.5</span><span style="color:#f92672">*</span>x, np<span style="color:#f92672">.</span>where((<span style="color:#ae81ff">2</span> <span style="color:#f92672">&lt;=</span> x) <span style="color:#f92672">&amp;</span> (x <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4</span>), <span style="color:#ae81ff">3</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.5</span><span style="color:#f92672">*</span>x <span style="color:#f92672">+</span> <span style="color:#ae81ff">9</span>))

plt<span style="color:#f92672">.</span>plot(x, y)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)

plt<span style="color:#f92672">.</span>xticks(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))
plt<span style="color:#f92672">.</span>yticks(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))

plt<span style="color:#f92672">.</span>hlines([<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>vlines([<span style="color:#ae81ff">0</span>], min(y)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, max(y)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>The implementation of the function is pretty hard to read, but you can do it.</p>
<blockquote>
<p>This function may be interesting~</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Function definition</span>
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(x)
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(np<span style="color:#f92672">.</span>abs(y)<span style="color:#f92672">&gt;</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>, np<span style="color:#f92672">.</span>sign(y)<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>, y)
</code></pre></div><h3 id="periodic-function">Periodic function</h3>
<p>You can write a periodic function with the idea of calculating the modulo of the period (MOD).</p>
<p>The following is an example to draw the graph of $f(x) = x^2,\ \ f(x+2) = f(x)$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/1050a5b7-c4fd-c618-a817-3e354f1ec91f.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1000000</span>)

<span style="color:#75715e">#Function of period T</span>
T <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
y <span style="color:#f92672">=</span> (x <span style="color:#f92672">%</span>T)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>


plt<span style="color:#f92672">.</span>plot(x, y)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)

plt<span style="color:#f92672">.</span>xticks(np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))
plt<span style="color:#f92672">.</span>yticks(np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))

plt<span style="color:#f92672">.</span>hlines([<span style="color:#ae81ff">0</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>vlines([<span style="color:#ae81ff">0</span>], <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><h2 id="draw-tangent-equation">Draw tangent equation</h2>
<p>Draw the tangent equation of the function $f(x)$ at some point $x = a$.</p>
<p>First, find the tangent slope $f&rsquo;(a)$. From the definition formula, $f&rsquo;(a)$ is</p>
<pre><code class="language-math" data-lang="math">f'(a) = \lim_{h \to 0} \frac{f(a+h)-f(a)}{h}
</code></pre><p>You can ask at.</p>
<p>By the way, if a human calculates it, we can transform this definition formula into a messy formula, but with a computer, a small value for $h$ is calculated like $h = 10^{-10}$. By substituting, the derivative coefficient can be calculated approximately. However, if the original definition formula is used, the difference between $a$ point and $a+h$ point / $h$ is not possible, so it is not possible to differentiate accurately at $a$ point. Therefore,</p>
<pre><code class="language-math" data-lang="math">f'(a) = \lim_{h \to 0} \frac{f(a+h)-f(a-h)}{2h}
</code></pre><p>By doing, the derivative at the $a$ point is accurately obtained.</p>
<p>Next, find the tangent equation. From the formula of passing points and straight lines,</p>
<pre><code class="language-math" data-lang="math">y = f'(a) (x-a) + f(a)
</code></pre><p>is. All you have to do now is implement it.</p>
<p>The following is an example to draw the graph of $y = x^2 + 2x + 1$ and the graph of tangent line at $x = 1$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211490/343f2fc0-81f6-32ed-8930-9a5cd1545eca.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib
PI <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># Make PI available to PI</span>

<span style="color:#75715e"># Target function</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(x):
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> x <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.5</span>

<span style="color:#75715e">#Derivative</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">diff</span>(fun, a):
    h <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">**</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>)<span style="color:#66d9ef">return</span> (fun(a <span style="color:#f92672">+</span> h)<span style="color:#f92672">-</span>fun(a<span style="color:#f92672">-</span>h)) <span style="color:#f92672">/</span> (<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>h)

<span style="color:#75715e">#Function definition</span>
<span style="color:#75715e">## Target function</span>
x1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1000000</span>)
y1 <span style="color:#f92672">=</span> f(x1)

<span style="color:#75715e">## Tangent</span>
x2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1000000</span>)
a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
k <span style="color:#f92672">=</span> diff(f, a)
y2 <span style="color:#f92672">=</span> k<span style="color:#f92672">*</span>(x2<span style="color:#f92672">-</span>a) <span style="color:#f92672">+</span> f(a)

plt<span style="color:#f92672">.</span>plot(x1, y1, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;$y=x^2 + 2x + 1$&#39;</span>)
plt<span style="color:#f92672">.</span>plot(x2, y2, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tangent&#39;</span>)

plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;major&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
plt<span style="color:#f92672">.</span>grid(which<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;minor&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)

plt<span style="color:#f92672">.</span>legend()

plt<span style="color:#f92672">.</span>axes()<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>,<span style="color:#e6db74">&#39;datalim&#39;</span>)

plt<span style="color:#f92672">.</span>show()
</code></pre></div><h1 id="finally">Finally</h1>
<p>There are many functions in Matplotlib other than those introduced here. Please give it a try.</p>
<p>Depending on my mood, I might add more samples.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
