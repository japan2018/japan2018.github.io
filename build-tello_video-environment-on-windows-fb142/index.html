<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>Build Tello_Video environment on Windows | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Build Tello_Video environment on Windows</h1>
<p>
  <small class="text-secondary">
  
  
  Mar 13, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/windows">Windows</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/tello">tello</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>This page is</p>
<p><a href="https://qiita.com/hsgucci/items/c9082690c6d0695b722f">Run Tello-Python sample &ldquo;Tello_Video&rdquo;</a></p>
<p>This is a supplementary page of.</p>
<p>Or not only for &ldquo;Tello_Video&rdquo;,
If you want to do &ldquo;Tello-Python&rdquo; on Windows, you need to do this first, including installing Python.</p>
<p>#Overview</p>
<p>Of the DJI official Python sample program for Tello &ldquo;Tello-Python&rdquo;,
<a href="https://github.com/dji-sdk/Tello-Python/tree/master/Tello_Video">Tello_Video</a>
In order to try</p>
<ul>
<li>Installation of various dependent libraries</li>
</ul>
<p>Should do</p>
<p>git <a href="https://github.com/dji-sdk/Tello-Python/tree/master/Tello_Video#installation">Tello-Python page</a></p>
<pre><code>・Windows

Go to the &quot;install\Windows&quot; folder,select and run the correct &quot;windows_install.bat&quot; according to your computer operating system bits.
</code></pre><p>is what it reads.
That is,</p>
<pre><code class="language-bash:" data-lang="bash:">&gt; cd install \Windows\
&gt; windows_install.bat
</code></pre><p>And type the command.
<font color="blue"><strong>windows_install.bat</strong></font> is a batch file that automatically builds the environment for Windows.</p>
<p>However, if you do this,</p>
<ul>
<li>The specified Python version is 2.7.15. I just want to install the final version 2.7.17</li>
<li>In the automatically installed Python, you cannot use pip at the command prompt, so you need to install manually again.</li>
<li>The specified ffmpeg version is old and the file does not exist, so it cannot be downloaded</li>
<li>Boost does not download properly, resulting in an error</li>
<li>Download of Visual Studio runtime does not work, resulting in an error</li>
<li>Since MD5 of downloaded files is checked one by one, it is difficult to support different versions</li>
</ul>
<p>Well, troubles/troublesomes occur.
Various work is necessary to solve this.</p>
<p>#Prerequisite</p>
<p>Tello-Python is installed in the home folder (c:\Users(user name)),
In other words, let&rsquo;s proceed with the assumption that there is a folder called <code>c:\Users\(user name)\Tello-Python-master</code>.</p>
<p>Also,</p>
<ul>
<li>Start Windows command prompt</li>
<li>Change character code of text file (actually BAT file)</li>
</ul>
<p>It is also a major premise that you have the skills to understand that.
Windows is convenient, but if you try something strange, it&rsquo;s a tough environment (&gt;_&lt;</p>
<h1 id="move-folder">Move folder</h1>
<p>First, in Explorer, move to the install\Windows folder in Tello-Video.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/256470/81926e7f-4dd3-c6fd-30a1-8e403f3522bb.png" alt="tello_video_folder.png">
There are <code>install.bat</code> and <code>uninstall.bat</code> in the folder.
<strong><font color=red> Please note that this install.bat does not work. </font></strong></p>
<p>Using this folder as a work area, we will work on the following items.</p>
<h1 id="create-a-new-bat-file">Create a new BAT file</h1>
<p>Windows BAT files do not work well unless the character code is Shift-JIS.
(I hate Windows because it&rsquo;s such annoyance)</p>
<p><strong><font color=blue> Copy and paste the following code into Notepad, and select [Character code]-[ANSI] from [File]-[Save As]. </font></strong>
If you are using any text editor, save it with [Shift-JIS].
The file name is <code>install_new2020Mar12.bat</code>.</p>
<p>For the time being, the file is also placed on <a href="https://raw.githubusercontent.com/hsgucci404/tello/master/Tello_Video_win/install_new2020Mar12.bat">github</a>, but the character code is UTF-8. , It cannot be used as it is.
Please convert the character code to [Shift-JIS].</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-:install_new2020Mar12.bat" data-lang=":install_new2020Mar12.bat"><span style="color:#66d9ef">echo</span>=1/*&gt;nul&amp;@<span style="color:#66d9ef">cls</span>
@<span style="color:#66d9ef">echo</span> off
<span style="color:#66d9ef">setlocal</span> enableDelayedExpansion
:<span style="color:#75715e">:runas administrator</span>
%1 start <span style="color:#e6db74">&#34;&#34;</span> mshta vbscript:CreateObject(<span style="color:#e6db74">&#34;Shell.Application&#34;</span>).ShellExecute(<span style="color:#e6db74">&#34;cmd.exe&#34;</span>,<span style="color:#e6db74">&#34;/c </span>%~s0<span style="color:#e6db74"> ::&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;runas&#34;</span>,1)(window.close)&amp;&amp;<span style="color:#66d9ef">exit</span>
<span style="color:#66d9ef">cls</span>
:<span style="color:#75715e">:setlocal</span>
<span style="color:#66d9ef">call</span> :setdir
<span style="color:#66d9ef">call</span> :configx86orx64
<span style="color:#66d9ef">set</span> extract=extract
<span style="color:#66d9ef">set</span> pythonLib=<span style="color:#e6db74">&#34;C:\Python27\Lib\site-packages\&#34;</span>
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> maxRetry<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----

:<span style="color:#75715e">:-------------------down python2.7 and install-------------------</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----
<span style="color:#66d9ef">echo</span> Downloading python2.7
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----
:<span style="color:#75715e">: This registry key is used to enable support for multiple versions of ssl and tls and is used to resolve a problem denying access to the official Python website.</span>
REG ADD <span style="color:#e6db74">&#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&#34;</span> /v SecureProtocols /t REG_DWORD /d 2728 /f &gt;nul
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">%%</span># <span style="color:#66d9ef">in</span> (certutil.exe) <span style="color:#66d9ef">do</span> (
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exist</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">%%</span><span style="color:#e6db74">~f$PATH:#&#34;</span> (
<span style="color:#66d9ef">goto</span> downpython
)
)
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">exist</span> %pythonPackage% <span style="color:#66d9ef">goto</span> :downpythoncheck
:downpython
<span style="color:#66d9ef">call</span> :down %pythonDown% %pythonPackage%
:downpythoncheck
<span style="color:#66d9ef">call</span> :checkMD5 %pythonPackage% %pythonMD5% MD5pass
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%MD5pass%<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;NO&#34;</span> (
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=!</span>retryCount!+1 &amp;&amp; if !retryCount<span style="color:#f92672">!</span> <span style="color:#f92672">==</span> <span style="color:#f92672">%</span>maxRetry<span style="color:#f92672">%</span> (
<span style="color:#66d9ef">echo</span> Retried %maxRetry% times, all failed. Skip.
<span style="color:#66d9ef">goto</span> downpythonend
) <span style="color:#66d9ef">else</span> (
<span style="color:#66d9ef">echo</span> Download %pythonPackage% failed. Retrying... !retryCount! of %maxRetry%
<span style="color:#66d9ef">goto</span> downpython
)
<span style="color:#75715e">)</span>
<span style="color:#66d9ef">call</span> :installmsiPackage %pythonPackage%
:<span style="color:#75715e">: Add python2.7 environment variable</span>
:<span style="color:#75715e">:wmic does not take effect immediately, so set</span>
<span style="color:#66d9ef">echo</span> %PATH%|findstr <span style="color:#e6db74">&#34;c:\python27&#34;</span> &gt;nul
<span style="color:#66d9ef">if</span> %errorlevel% <span style="color:#f92672">neq</span> 0 (
wmic ENVIRONMENT where <span style="color:#e6db74">&#34;name=&#39;PATH&#39; and username=&#39;&lt;system&gt;&#39;&#34;</span> set VariableValue=<span style="color:#e6db74">&#34;</span>%PATH%<span style="color:#e6db74">;c:\python27&#34;</span>
<span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;path=</span>%path%<span style="color:#e6db74">;c:\python27;&#34;</span>
)
<span style="color:#66d9ef">echo</span> %PATHEXT%|findstr <span style="color:#e6db74">&#34;.PY;.PYM&#34;</span> &gt;nul
<span style="color:#66d9ef">if</span> %errorlevel% <span style="color:#f92672">neq</span> 0 (
wmic ENVIRONMENT where <span style="color:#e6db74">&#34;name=&#39;PATHEXT&#39; and username=&#39;&lt;system&gt;&#39;&#34;</span> set VariableValue=<span style="color:#e6db74">&#34;</span>%PATHEXT%<span style="color:#e6db74">;.PY;.PYM&#34;</span>
<span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;pathext=</span>%pathext%<span style="color:#e6db74">;.PY;.PYM;&#34;</span>
)
:downpythonend
:<span style="color:#75715e">:-------------------python pip installation-------------------</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----
<span style="color:#66d9ef">echo</span> Downloading pip
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">%%</span># <span style="color:#66d9ef">in</span> (certutil.exe) <span style="color:#66d9ef">do</span> (
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exist</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">%%</span><span style="color:#e6db74">~f$PATH:#&#34;</span> (
<span style="color:#66d9ef">goto</span> downpip
)
)
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">exist</span> %pipPackage% <span style="color:#66d9ef">goto</span> :downpipcheck
:downpip
<span style="color:#66d9ef">call</span> :down %pipDown% %pipPackage%
:downpipcheck
<span style="color:#66d9ef">call</span> :checkMD5 %pipPackage% %pipMD5% MD5pass
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%MD5pass%<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;NO&#34;</span> (
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=!</span>retryCount!+1 &amp;&amp; if !retryCount<span style="color:#f92672">!</span> <span style="color:#f92672">==</span> <span style="color:#f92672">%</span>maxRetry<span style="color:#f92672">%</span> (
<span style="color:#66d9ef">echo</span> Retried %maxRetry% times, all failed. Skip.
<span style="color:#66d9ef">goto</span> downpipend
) <span style="color:#66d9ef">else</span> (
<span style="color:#66d9ef">echo</span> Download %pipPackage% failed. Retrying... !retryCount! of %maxRetry%goto downpip
 )
<span style="color:#75715e">)</span>
python %pipPackage%
python -m pip install -U pip
:downpipend
:<span style="color:#75715e">:-------------------libboost-all-devのインストール-------------------</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>                Downloading libboost                   
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span> Please wait a few minutes...
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">%%</span># <span style="color:#66d9ef">in</span> (certutil.exe) <span style="color:#66d9ef">do</span> (
 <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exist</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">%%</span><span style="color:#e6db74">~f$PATH:#&#34;</span> (
  <span style="color:#66d9ef">goto</span> downlibboost
 )
)
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">exist</span> %libboostPackage% <span style="color:#66d9ef">goto</span> :downlibboostcheck
:downlibboost
<span style="color:#66d9ef">call</span> :down %libboostDown% %libboostPackage%
:downlibboostcheck
<span style="color:#66d9ef">call</span> :checkMD5 %libboostPackage% %libboostMD5% MD5pass
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%MD5pass%<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;NO&#34;</span> (
 <span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=!</span>retryCount!+1 &amp;&amp; if !retryCount<span style="color:#f92672">!</span> <span style="color:#f92672">==</span> <span style="color:#f92672">%</span>maxRetry<span style="color:#f92672">%</span> (
  <span style="color:#66d9ef">echo</span> Retried %maxRetry% times, all failed. Skip.
  <span style="color:#66d9ef">goto</span> downlibboostend
 ) <span style="color:#66d9ef">else</span> (
  <span style="color:#66d9ef">echo</span> Download %libboostPackage% failed. Retrying... !retryCount! of %maxRetry%
  <span style="color:#66d9ef">goto</span> downlibboost
 )
<span style="color:#75715e">)</span>
<span style="color:#66d9ef">call</span> %libboostPackage% /SILENT /NORESTART
:downlibboostend
:<span style="color:#75715e">:-------------------ffmpegのインストールは、Linuxのlibavcodec-dev libswscale-devの2つに依存します-------------------</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>                  Downloading ffmpeg                   
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">%%</span># <span style="color:#66d9ef">in</span> (certutil.exe) <span style="color:#66d9ef">do</span> (
 <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exist</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">%%</span><span style="color:#e6db74">~f$PATH:#&#34;</span> (
  <span style="color:#66d9ef">goto</span> downffmpeg
 )
)
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">exist</span> %ffmpegPackage% <span style="color:#66d9ef">goto</span> :downffmpegcheck
:downffmpeg
<span style="color:#66d9ef">call</span> :down %ffmpegDown% %ffmpegPackage%
:downffmpegcheck
<span style="color:#66d9ef">call</span> :checkMD5 %ffmpegPackage% %ffmpegMD5% MD5pass
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%MD5pass%<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;NO&#34;</span> (
 <span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=!</span>retryCount!+1 &amp;&amp; if !retryCount<span style="color:#f92672">!</span> <span style="color:#f92672">==</span> <span style="color:#f92672">%</span>maxRetry<span style="color:#f92672">%</span> (
  <span style="color:#66d9ef">echo</span> Retried %maxRetry% times, all failed. Skip.
  <span style="color:#66d9ef">goto</span> downffmpegend
 ) <span style="color:#66d9ef">else</span> (
  <span style="color:#66d9ef">echo</span> Download %ffmpegPackage% failed. Retrying... !retryCount! of %maxRetry%
  <span style="color:#66d9ef">goto</span> downffmpeg
 )
<span style="color:#75715e">)</span>
<span style="color:#66d9ef">call</span> :unpack %ffmpegPackage% %extract%
:downffmpegend
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>              Downloading VS2013 runtime         
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">%%</span># <span style="color:#66d9ef">in</span> (certutil.exe) <span style="color:#66d9ef">do</span> (
 <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exist</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">%%</span><span style="color:#e6db74">~f$PATH:#&#34;</span> (
  <span style="color:#66d9ef">goto</span> downvs2013
 )
)
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">exist</span> %vs2013package% <span style="color:#66d9ef">goto</span> :downvs2013check
:downvs2013
<span style="color:#66d9ef">call</span> :down %vs2013depend% %vs2013package%
:downvs2013check
<span style="color:#66d9ef">call</span> :checkMD5 %vs2013package% %vs2013MD5% MD5pass
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%MD5pass%<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;NO&#34;</span> (
 <span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/a</span> retryCount<span style="color:#f92672">=!</span>retryCount!+1 &amp;&amp; if !retryCount<span style="color:#f92672">!</span> <span style="color:#f92672">==</span> <span style="color:#f92672">%</span>maxRetry<span style="color:#f92672">%</span> (
  <span style="color:#66d9ef">echo</span> Retried %maxRetry% times, all failed. Skip.
  <span style="color:#66d9ef">goto</span> downvs2013end
 ) <span style="color:#66d9ef">else</span> (
  <span style="color:#66d9ef">echo</span> Download %vs2013package% failed. Retrying... !retryCount! of %maxRetry%
  <span style="color:#66d9ef">goto</span> downvs2013
 )
<span style="color:#75715e">)</span>
<span style="color:#66d9ef">call</span> %vs2013package% /passive /NORESTART
:downvs2013end
:<span style="color:#75715e">:-------------------python-numpy python-matplotlib opencv-pythonのインストール(pip方式)-------------------</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>                  Downloading numpy                    
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
python -m pip install numpy
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>                Downloading matplotlib                 
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
python -m pip install matplotlib
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>              Downloading opencv-python                   
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
python -m pip install -v opencv-python==3.4.2.17
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>                  Downloading pillow                   
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
python -m pip install pillow
:copydependencies
:<span style="color:#75715e">:-------------------依存ライブラリのすべてのdllをc：\ python27 \ lib \ site-packagesに配置します-------------------</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>                 Copying dependencies                  
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span> %extract%\%ffmpegPackage:~0,-4%\bin\ 
<span style="color:#66d9ef">echo</span> %libboostPackageCopy%
<span style="color:#66d9ef">echo</span> %libh264%
xcopy /Y /E /I %extract%\%ffmpegPackage:~0,-4%\bin\*.dll %pythonLib%
xcopy /Y /E /I %libboostPackageCopy% %pythonLib%
xcopy /Y /E /I %libh264%\*.pyd %pythonLib%
<span style="color:#66d9ef">endlocal</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">echo</span>                  Installation done.                
<span style="color:#66d9ef">echo</span> ------------------------------------------------------
<span style="color:#66d9ef">pause</span>
<span style="color:#66d9ef">goto</span> :eof

:<span style="color:#75715e">:--------------------------------------------------------------------------------------------</span>

:<span style="color:#75715e">:-----------------以下はMD5チェックの定義エリアです------------------</span>
:checkMD5
<span style="color:#66d9ef">set</span> file=%~1
<span style="color:#66d9ef">call</span> :MD5get %file% MD5
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%MD5%<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">equ</span> <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">&#34;</span> (
      <span style="color:#66d9ef">echo</span> MD5 identical.
   <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;</span>%~3<span style="color:#e6db74">=YES&#34;</span>
) <span style="color:#66d9ef">else</span> (
   <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%MD5%<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">equ</span> <span style="color:#e6db74">&#34;skip&#34;</span> (
  <span style="color:#66d9ef">echo</span> MD5 check skipped.
  <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;</span>%~3<span style="color:#e6db74">=YES&#34;</span>
   ) <span style="color:#66d9ef">else</span> (
  <span style="color:#66d9ef">echo</span> Warning: MD5 does not match!
  <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;</span>%~3<span style="color:#e6db74">=NO&#34;</span>
   )
)
<span style="color:#66d9ef">goto</span> :eof

:<span style="color:#75715e">:-----------------以下はMD5チェックの定義エリアです------------------</span>
:MD5get
<span style="color:#66d9ef">echo</span> %~1
<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">%%</span># <span style="color:#66d9ef">in</span> (certutil.exe) <span style="color:#66d9ef">do</span> (
 <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exist</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">%%</span><span style="color:#e6db74">~f$PATH:#&#34;</span> (
  <span style="color:#66d9ef">echo</span> certutil.exe not foundecho for Windows XP professional and Windows 2003
<span style="color:#66d9ef">echo</span> you need Windows Server 2003 Administration Tools Pack
<span style="color:#66d9ef">echo</span> https://www.microsoft.com/en-us/download/details.aspx?id=16770
<span style="color:#66d9ef">echo</span> now skip the MD5 check
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">neq</span> <span style="color:#e6db74">&#34;&#34;</span> (
<span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">=skip&#34;</span>
)
:<span style="color:#75715e">:exit /b 4</span>
<span style="color:#66d9ef">goto</span> :eof
)
)

<span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;md5=&#34;</span>
<span style="color:#66d9ef">for</span> <span style="color:#66d9ef">/f</span> <span style="color:#e6db74">&#34;skip=1 tokens=* delims=&#34;</span> <span style="color:#ae81ff">%%</span># <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;certutil -hashfile &#34;</span>%~f1<span style="color:#e6db74">&#34; MD5&#39;</span>) <span style="color:#66d9ef">do</span> (
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">defined</span> md5 (
<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">%%</span>Z <span style="color:#66d9ef">in</span> (<span style="color:#ae81ff">%%</span>#) <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;md5=!md5!</span><span style="color:#ae81ff">%%</span><span style="color:#e6db74">Z&#34;</span>
)
)

<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">neq</span> <span style="color:#e6db74">&#34;&#34;</span> (
<span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">=</span>%md5%<span style="color:#e6db74">&#34;</span>
) <span style="color:#66d9ef">else</span> (
<span style="color:#66d9ef">echo</span> %md5%
)

<span style="color:#66d9ef">goto</span> :eof

:<span style="color:#75715e">:-----------------The following is the directory switching definition area------------------</span>
:<span style="color:#75715e">: When run in admin mode the default path is changed and the directory goes back here</span>
:setdir
<span style="color:#66d9ef">set</span> char=%~dp0%
%char:~0,2%
<span style="color:#66d9ef">cd</span> %~dp0%
<span style="color:#66d9ef">goto</span> :eof

:<span style="color:#75715e">:-----------------The following is the version function definition area------------------</span>
:configx86orx64
<span style="color:#66d9ef">IF</span> %PROCESSOR_ARCHITECTURE% <span style="color:#f92672">==</span> AMD64 (
<span style="color:#66d9ef">set</span> versionFlag=win64
) <span style="color:#66d9ef">else</span> (
<span style="color:#66d9ef">set</span> versionFlag=win32
)

<span style="color:#66d9ef">echo</span> Windows Version: %versionFlag%
<span style="color:#66d9ef">if</span> %versionFlag%<span style="color:#f92672">==</span>win64 (
<span style="color:#66d9ef">set</span> pythonDown=<span style="color:#e6db74">&#34;https://www.python.org/ftp/python/2.7.17/python-2.7.17.amd64.msi&#34;</span>
<span style="color:#66d9ef">set</span> pythonPackage=python-2.7.17.amd64.msi
<span style="color:#66d9ef">set</span> pythonMD5=<span style="color:#e6db74">&#34;55040ce1c1ab34c32e71efe9533656b8&#34;</span>

<span style="color:#66d9ef">set</span> pipDown=<span style="color:#e6db74">&#34;https://bootstrap.pypa.io/get-pip.py&#34;</span>
<span style="color:#66d9ef">set</span> pipPackage=get-pip.py
<span style="color:#66d9ef">set</span> pipMD5=<span style="color:#e6db74">&#34;b7666e8e7f98f513096601d4203fb007&#34;</span>

<span style="color:#66d9ef">set</span> ffmpegDown=<span style="color:#e6db74">&#34;https://ffmpeg.zeranoe.com/builds/win64/shared/ffmpeg-20200311-36aaee2-win64-shared.zip&#34;</span>
<span style="color:#66d9ef">set</span> ffmpegPackage=ffmpeg-20200311-36aaee2-win64-shared.zip
<span style="color:#66d9ef">set</span> ffmpegMD5=<span style="color:#e6db74">&#34;500f89e0a230c26722bb128edc82d103&#34;</span>

<span style="color:#66d9ef">set</span> libboostDown=<span style="color:#e6db74">&#34;https://nchc.dl.sourceforge.net/project/boost/boost-binaries/1.68.0/boost_1_68_0-msvc-12.0-64.exe&#34;</span>
<span style="color:#66d9ef">set</span> libboostPackage=<span style="color:#e6db74">&#34;boost_1_68_0-msvc-12.0-64.exe&#34;</span>
<span style="color:#66d9ef">set</span> libboostPackageCopy=<span style="color:#e6db74">&#34;c:\local\boost_1_68_0\lib64-msvc-12.0\boost_python27-vc120-mt-x64-1_68.dll&#34;</span>
<span style="color:#66d9ef">set</span> libboostMD5=<span style="color:#e6db74">&#34;4e6b11a971502639ba5cc564c7f2d568&#34;</span>
It&#39;s a sequel.
<span style="color:#66d9ef">set</span> libh264=..\..\h264decoder\windows\x64
It&#39;s a sequel.
<span style="color:#66d9ef">set</span> vs2013depend=<span style="color:#e6db74">&#34;https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x64.exe&#34;</span>
<span style="color:#66d9ef">set</span> vs2013package=vcredist_x64.exe
<span style="color:#66d9ef">set</span> vs2013MD5=<span style="color:#e6db74">&#34;96b61b8e069832e6b809f24ea74567ba&#34;</span>
It&#39;s a sequel.
) <span style="color:#66d9ef">else</span> (
<span style="color:#66d9ef">set</span> pythonDown=<span style="color:#e6db74">&#34;https://www.python.org/ftp/python/2.7.17/python-2.7.17.msi&#34;</span>
<span style="color:#66d9ef">set</span> pythonPackage=python-2.7.17.msi
<span style="color:#66d9ef">set</span> pythonMD5=<span style="color:#e6db74">&#34;4cc27e99ad41cd3e0f2a50d9b6a34f79&#34;</span>

<span style="color:#66d9ef">set</span> pipDown=<span style="color:#e6db74">&#34;https://bootstrap.pypa.io/get-pip.py&#34;</span>
<span style="color:#66d9ef">set</span> pipPackage=get-pip.py
<span style="color:#66d9ef">set</span> pipMD5=<span style="color:#e6db74">&#34;b7666e8e7f98f513096601d4203fb007&#34;</span>
It&#39;s a sequel.
<span style="color:#66d9ef">set</span> ffmpegDown=<span style="color:#e6db74">&#34;https://ffmpeg.zeranoe.com/builds/win32/shared/ffmpeg-20200311-36aaee2-win32-shared.zip&#34;</span>
<span style="color:#66d9ef">set</span> ffmpegPackage=ffmpeg-20200311-36aaee2-win32-shared.zip
<span style="color:#66d9ef">set</span> ffmpegMD5=<span style="color:#e6db74">&#34;bc9eae5466ca033e54588d7c25fe3ea9&#34;</span>
It&#39;s a sequel.
<span style="color:#66d9ef">set</span> libboostDown=<span style="color:#e6db74">&#34;https://excellmedia.dl.sourceforge.net/project/boost/boost-binaries/1.68.0/boost_1_68_0-msvc-12.0-32.exe&#34;</span>
<span style="color:#66d9ef">set</span> libboostPackage=<span style="color:#e6db74">&#34;boost_1_68_0-msvc-12.0-32.exe&#34;</span>
<span style="color:#66d9ef">set</span> libboostPackageCopy=<span style="color:#e6db74">&#34;c:\local\boost_1_68_0\lib32-msvc-12.0\boost_python27-vc120-mt-x32-1_68.dll&#34;</span>
<span style="color:#66d9ef">set</span> libboostMD5=<span style="color:#e6db74">&#34;d5d5ee205c87078245eb7df72789f407&#34;</span>
It&#39;s a sequel.
<span style="color:#66d9ef">set</span> libh264=..\..\h264decoder\windows\x86
It&#39;s a sequel.
<span style="color:#66d9ef">set</span> vs2013depend=<span style="color:#e6db74">&#34;https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x86.exe&#34;</span>
<span style="color:#66d9ef">set</span> vs2013 package=vcredist_x86.exe
<span style="color:#66d9ef">set</span> vs2013MD5=<span style="color:#e6db74">&#34;0fc525b6b7b96a87523daa7a0013c69d&#34;</span>
)

<span style="color:#66d9ef">goto</span> :eof

:<span style="color:#75715e">:-----------------This is the h264 function definition area------------------</span>
:h264install
<span style="color:#66d9ef">cd</span> h264decoder
<span style="color:#66d9ef">if</span> <span style="color:#66d9ef">exist</span> build (
<span style="color:#66d9ef">rd</span> /s /q build
<span style="color:#66d9ef">mkdir</span> build
) <span style="color:#66d9ef">else</span> (
<span style="color:#66d9ef">mkdir</span> build
)
<span style="color:#66d9ef">cd</span> build
cmake ..
make
<span style="color:#66d9ef">goto</span> :eof

:<span style="color:#75715e">:-----------------The following is the download function definition area------------------</span>
:down
<span style="color:#66d9ef">echo</span> Source: <span style="color:#e6db74">&#34;</span>%~1<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">echo</span> Destination: <span style="color:#e6db74">&#34;</span>%~f2<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">echo</span> Start downloading <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">&#34;</span>...
cscript -nologo -e:jscript <span style="color:#e6db74">&#34;</span>%~f0<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;download&#34;</span> <span style="color:#e6db74">&#34;</span>%~1<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">&#34;</span>
:<span style="color:#75715e">:echo Download &#34;%~2&#34; OK!</span>
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----
<span style="color:#66d9ef">goto</span> :eof

:<span style="color:#75715e">:-----------------The definition area of the decompression function is as follows------------------</span>
:unpack
<span style="color:#66d9ef">echo</span> Source: <span style="color:#e6db74">&#34;</span>%~f1<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">echo</span> Destination: <span style="color:#e6db74">&#34;</span>%~f2<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">echo</span> Start unpacking <span style="color:#e6db74">&#34;</span>%~1<span style="color:#e6db74">&#34;</span>...
cscript -nologo -e:jscript <span style="color:#e6db74">&#34;</span>%~f0<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;unpack&#34;</span> <span style="color:#e6db74">&#34;</span>%~1<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>%~2<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>%~dp0<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">echo</span> Unpack <span style="color:#e6db74">&#34;</span>%~1<span style="color:#e6db74">&#34;</span> OK!
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----
<span style="color:#66d9ef">goto</span> :eof
:<span style="color:#75715e">:-----------------The following is the installation function definition area-----------------</span>
:installmsiPackage
<span style="color:#66d9ef">echo</span> Source: <span style="color:#e6db74">&#34;</span>%~f1<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">echo</span> Strat installing <span style="color:#e6db74">&#34;</span>%~f1<span style="color:#e6db74">&#34;</span>...
msiexec /i <span style="color:#e6db74">&#34;</span>%~f1<span style="color:#e6db74">&#34;</span> /passive
<span style="color:#66d9ef">echo</span> install <span style="color:#e6db74">&#34;</span>%~1<span style="color:#e6db74">&#34;</span> OK!
<span style="color:#66d9ef">echo</span> ------------------------------------------------- -----
<span style="color:#66d9ef">goto</span> :eof
*/

function download(DownSource, DownDestination)
{
var DownPost
,DownGet;
It&#39;s a sequel.
DownDestination=DownDestination.toLowerCase();
DownSource=DownSource.toLowerCase();
//DownPost = new ActiveXObject(<span style="color:#e6db74">&#34;Msxml2&#34;</span>+String.fromCharCode(0x2e)+<span style="color:#e6db74">&#34;ServerXMLHTTP&#34;</span>);
//DownPost = new ActiveXObject(<span style="color:#e6db74">&#34;Microsoft&#34;</span>+String.fromCharCode(0x2e)+<span style="color:#e6db74">&#34;XMLHTTP&#34;</span>);
//DownPost.setOption(2, 13056);
var DownPost=null;
try{
DownPost=new XMLHttpRequest();
}catch(e){
try{
DownPost=new ActiveXObject(<span style="color:#e6db74">&#34;Msxml2.XMLHTTP&#34;</span>);
DownPost.setOption(2, 13056);
}catch(ex){
try{
DownPost=new ActiveXObject(<span style="color:#e6db74">&#34;Microsoft.XMLHTTP&#34;</span>);
}catch(e3){
DownPost=null;
}
}
}
DownPost.open(<span style="color:#e6db74">&#34;GET&#34;</span>,DownSource,0);
DownPost.send();
DownGet = new ActiveXObject(<span style="color:#e6db74">&#34;ADODB&#34;</span>+String.fromCharCode(0x2e)+<span style="color:#e6db74">&#34;Stream&#34;</span>);
DownGet.Mode = 3;
DownGet.Type = 1;DownGet.Open(); 
 DownGet.Write(DownPost.responseBody);
 DownGet.SaveToFile(DownDestination,2); 
}

function unpack(PackedFileSource, UnpackFileDestination, ParentFolder)
{
 var FileSysObject = new Object
 ,ShellObject = new ActiveXObject(<span style="color:#e6db74">&#34;Shell.Application&#34;</span>)
 ,intOptions = 4 + 16
 ,DestinationObj
 ,SourceObj;
 
 <span style="color:#66d9ef">if</span> (!UnpackFileDestination)<span style="color:#960050;background-color:#1e0010"> UnpackFileDestination = &#39;.&#39;;</span>
 var FolderTest = ShellObject.NameSpace(ParentFolder + UnpackFileDestination);
 FileSysObject = ShellObject.NameSpace(ParentFolder);
 while (!FolderTest) 
 {
  WSH.Echo (&#39;Unpack Destination Folder Not Exist, Creating...&#39;);
  FileSysObject.NewFolder(UnpackFileDestination);
  FolderTest = ShellObject.NameSpace(ParentFolder + UnpackFileDestination);
  <span style="color:#66d9ef">if</span> (FolderTest)<span style="color:#960050;background-color:#1e0010"> </span>
  WSH.Echo(&#39;Unpack Destination Folder Created.&#39;);
 }
 DestinationObj = ShellObject.NameSpace(ParentFolder + UnpackFileDestination); 
 SourceObj = ShellObject.NameSpace(ParentFolder + PackedFileSource);
    <span style="color:#66d9ef">for</span> (var i = 0; i &lt; SourceObj.Items().Count; i++) 
 {
  try {
   if (SourceObj) {
    WSH.Echo(&#39;Unpacking &#39; + SourceObj.Items().Item(i) + &#39;... &#39;);
    DestinationObj.CopyHere(SourceObj.Items().Item(i), intOptions);
    WSH.Echo(&#39;Unpack &#39; + SourceObj.Items().Item(i) + &#39; Done.&#39;);
   }
  }
  catch(e) {
   WSH.Echo(&#39;Failed: &#39; + e);
  }
 }
}

switch (WScript.Arguments(0)){
 case <span style="color:#e6db74">&#34;download&#34;</span>:
  download(WScript.Arguments(1), WScript.Arguments(2));
  break;
 case <span style="color:#e6db74">&#34;unpack&#34;</span>:
  unpack(WScript.Arguments(1), WScript.Arguments(2), WScript.Arguments(3));
  break;
 default:
}
</code></pre></div><p><strong><font color=red>ただし，まだこの batファイルでインストールは始めないでください．</font></strong>
ほとんどの場合，うまくいきません．</p>
<p>batファイルの中で指定されている依存ライブラリを手動でダウンロードし，同じフォルダに置いておくのが安全策です．</p>
<p>#必要なファイルのダウンロード</p>
<p>以下のファイルをダウンロードし，上記フォルダに置いてください．</p>
<p>64bitのWindowsの場合：</p>
<p><a href="https://www.python.org/ftp/python/2.7.17/python-2.7.17.amd64.msi">https://www.python.org/ftp/python/2.7.17/python-2.7.17.amd64.msi</a></p>
<p><a href="https://bootstrap.pypa.io/get-pip.py">https://bootstrap.pypa.io/get-pip.py</a>
<code>get-pip.py</code>は右クリックして[名前をつけて保存]を使ってください．</p>
<p><a href="https://ffmpeg.zeranoe.com/builds/win64/shared/ffmpeg-20200311-36aaee2-win64-shared.zip">https://ffmpeg.zeranoe.com/builds/win64/shared/ffmpeg-20200311-36aaee2-win64-shared.zip</a></p>
<p><a href="https://nchc.dl.sourceforge.net/project/boost/boost-binaries/1.68.0/boost_1_68_0-msvc-12.0-64.exe">https://nchc.dl.sourceforge.net/project/boost/boost-binaries/1.68.0/boost_1_68_0-msvc-12.0-64.exe</a>
sourceforgeは右クリック[名前を付けて保存]でダウンロードできないので、リンクをクリックしてページを開いてください。</p>
<p><a href="https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x64.exe">https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x64.exe</a></p>
<p>32bitのWindowsの場合：</p>
<p><a href="https://www.python.org/ftp/python/2.7.17/python-2.7.17.msi">https://www.python.org/ftp/python/2.7.17/python-2.7.17.msi</a></p>
<p><a href="https://bootstrap.pypa.io/get-pip.py%22">https://bootstrap.pypa.io/get-pip.py&quot;</a>
<code>get-pip.py</code>は右クリックして[名前をつけて保存]を使ってください．</p>
<p><a href="https://ffmpeg.zeranoe.com/builds/win32/shared/ffmpeg-20200311-36aaee2-win32-shared.zip">https://ffmpeg.zeranoe.com/builds/win32/shared/ffmpeg-20200311-36aaee2-win32-shared.zip</a></p>
<p><a href="https://excellmedia.dl.sourceforge.net/project/boost/boost-binaries/1.68.0/boost_1_68_0-msvc-12.0-32.exe">https://excellmedia.dl.sourceforge.net/project/boost/boost-binaries/1.68.0/boost_1_68_0-msvc-12.0-32.exe</a>
sourceforgeは右クリック[名前を付けて保存]でダウンロードできないので、リンクをクリックしてページを開いてください。</p>
<p><a href="https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x86.exe">https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x86.exe</a></p>
<p>これらのファイルを手動でダウンロードしておくことで，batファイルの実行エラーを防ぐことができます．</p>
<p>#BATファイルの実行
全てのファイルがダウンロードし終わったフォルダの中は，この様になっているはずです．(64bitの場合)</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/256470/0545c849-2a7c-3132-47be-2d3455d2d70b.png" alt="tello_video_folder.png"></p>
<p>それでは，<code>install_new2020Mar12.bat</code>をダブルクリックしてインストールを開始してください．</p>
<ol>
<li>Pythonのインストール</li>
<li>pipのインストール</li>
<li>bootsのインストール</li>
<li>ffmpegのインストール</li>
<li>Microsoftランタイムのインストール</li>
<li>numpy，matplotlib，opencv-python，pillowのpipインストール</li>
<li>dllのコピー</li>
</ol>
<p>が自動的に行われます．</p>
<p>うまくインストールが進んでいれば，コマンドプロンプト画面が以下のように表示されます．
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/256470/dcf68075-6066-bd34-dc5f-d6214a599053.png" alt="tello_video_install.png"></p>
<p><strong><font color=red>コマンドプロンプトが一瞬で閉じてしまう場合は，文字コードがShift-JISになっていない，などの原因で失敗しています．</font></strong></p>
<p>インストールが終わったら，<strong>ＰＣを再起動</strong>しておきましょう．
環境変数が追加されたので，有効にするためです．</p>
<p>#Pythonの手動再インストール</p>
<p>BATファイルでインストールが終わった状態では，コマンドプロンプトで</p>
<pre><code class="language-bash:" data-lang="bash:">&gt; pip install モジュール名
</code></pre><p>と打っても，「ファイルがありません」になります．</p>
<p>そこで，<code>python-2.7.17.amd64.msi</code>(64bitの場合)をダブルクリックして，インストーラを起動します．</p>
<p>以下の図のように，「Add python.exe to Path」を有効にして再インストールしておきましょう．
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/256470/c1c44eca-16e6-03cf-8a32-c851353fa04a.png" alt="re_python.png"></p>
<p>#Tello_Videoの実行</p>
<p>「Tello_Video」を実行するには，コマンドプロンプトで</p>
<pre><code class="language-bash:" data-lang="bash:">&gt; python main.py
</code></pre><p>と打っていもよいのですが,
Windowsの便利なところは[関連付け実行]です.
以下の図のように,<code>main.py</code>をダブルクリックすれば，プログラムが実行されます.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/256470/7c2aef38-90cf-bf6e-af8c-a06aee370323.png" alt="tello_video_main.png"></p>
<p>こんな風に実行画面が出ます．詳細は<a href="https://qiita.com/hsgucci/items/c9082690c6d0695b722f">Tello-Pythonのサンプル「Tello_Video」を動かす</a>で説明しています．
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/256470/5a1d6658-0d31-c097-7834-801dc43bea35.png" alt="tello_video_window.png"></p>
<p>#おわりに</p>
<p>Windowsの環境設定は，本当に「面倒臭い」ですね(&gt;_&lt;</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
