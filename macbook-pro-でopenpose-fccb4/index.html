<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>MacBook Pro でOpenPose | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>MacBook Pro でOpenPose</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 15, 2019
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/mac">Mac</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/openpose">OpenPose</a></code></small>

</p>
<pre><code>While studying machine learning and Deep Leaning articles on MacBook Pro, I posted an article that you can detect posture on Mac
</code></pre>
<p>I found some and tried variously, but it worked, so I will write it as a memorandum.</p>
<p>#environment</p>
<ul>
<li>MacBook Pro 15in 2018 2.2 GHz Core i7 32GB Memory</li>
<li>Mojave 10.14.6</li>
<li>python 3.7.5</li>
<li>Install python, virtualenv and wget with homebrew</li>
</ul>
<h1 id="setup-steps">Setup steps</h1>
<h2 id="preparation">Preparation</h2>
<p>In preparation, set up a Python virtual environment.</p>
<pre><code>Create a python virtual environment.
$ virtualenv mppose

Enter the python virtual environment.
$ source mppose/bin/activate
</code></pre><h2 id="openpose-settings">OpenPose settings</h2>
<p>Set up OpenPose.</p>
<pre><code>Install the packages needed for it to work.
$ pip3 install tensorflow ipython configobj keras pillow opencv-python

Clone the Keras backend OpenPose repository and move it.
$ git clone https://github.com/michalfaber/keras_Realtime_Multi-Person_Pose_Estimation.git
$ cd keras_Realtime_Multi-Person_Pose_Estimation/

Go to the model directory in the repository and download the learning model for caffe and keras.
$ cd model
$ sh get_caffe_model.sh
$ sh get_keras_model.sh

Create an empty init.py. (In my environment, if this was not created, the python module under the model directory could not be read when running the later python script, and it became an error)
$ touch __init.py__

Go back to the top of the repository and dump caffe's numpy learning model layer.
$ cd ../
$ docker run -v `pwd`:/workspace -it bvlc/caffe:cpu python dump_caffe_layers.py

Convert the learning model layer of caffe for keras.
$python caffe_to_keras.py
</code></pre><p>This completes the settings.</p>
<h1 id="operation-check">Operation check</h1>
<pre><code>Let's try the posture detection of the sample photograph.
$ python demo_image.py --image sample_images/ski.jpg

Start the camera and try posture detection.
$python demo_camera.py
</code></pre><p>When I tried to detect the posture with a camera, it seems that it can be detected in about 0.07 sec processing time, and it seems that it can work reasonably with only the CPU. There are other attitude detection systems, so I&rsquo;ll try again if there is something I can do.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
