<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Environment installation by introducing Docker Image of Kaggle on Windows | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Environment installation by introducing Docker Image of Kaggle on Windows</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 3, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/docker">Docker</a></code></small>


<small><code><a href="https://memotut.com/tags/windows10">Windows10</a></code></small>


<small><code><a href="https://memotut.com/tags/kaggle">Kaggle</a></code></small>

</p>
<pre><code>I will record as a reminder the part that was clogged up when I tried to easily build the environment on my windows notebook using Kaggle's Docker Image.
</code></pre>
<p>Basically, I am referring to the article of &ldquo;<a href="https://amalog.hateblo.jp/entry/data-analysis-docker">Tenshiki Graffiti</a>&rdquo;, so please refer to here first, and OS is not Win10 Pro except windows. And if you are using Docker toolbox, I think it will be helpful.</p>
<h2 id="stumble-point--execution-of-yaml-of-docker-compose-does-not-work-due-to-error-of-volume-name">Stumble point ① Execution of yaml of docker-compose does not work due to error of volume name</h2>
<p>After creating the docker-compose yaml file as in the above article, I got an error.</p>
<pre><code>version: &quot;3&quot;
services:
  jupyter:
    build:.
    volumes:
      -$PWD:/tmp/working
    working_dir: /tmp/working
    ports:
      -8888:8888
    command: jupyter notebook --ip=0.0.0.0 --allow-root --no-browser
</code></pre><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/328424/38264263-54d8-0c26-4068-040ac9e80e33.png" alt="image.png">
I get the error &ldquo;volume name is too short, names should be at least two alphanumeric characters&rdquo;. <a href="https://gist.github.com/DQNEO/c7c68f8f6e06eb4cfa9e#gistcomment-2114149">Results of checking</a>,theenvironmentvariablenotationofvolumesintheyamlfileis<code>$PWD</code>,butintheenvironmentathandItdoesn&rsquo;twork,itseemstoworkbetterbyrunningthe<code>${PWD}</code>andPWD(getcurrentdirectorypath) commands.
So it worked better with <code>${PWD}/tmp/working</code> instead of <code>$PWD:/tmp/working</code> (because I&rsquo;m new to Docker, I&rsquo;d appreciate it if you could comment on why it&rsquo;s more detailed).</p>
<h2 id="stumbled-point--i-can-not-connect-to-docker-with-a-browser">Stumbled point ② I can not connect to Docker with a browser</h2>
<p>When executed with the yaml file modified with <code>docker-compose up --build</code>, I was able to successfully build the container with the jupyter notebook running in the analysis environment of kaggle.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/328424/59d86ff5-3671-67c5-d0f7-70e6c381eef5.png" alt="image.png">
However, in the browser &ldquo;http://localhost:8888/?token=XXXX&rdquo;
When I try to connect to the jupyter notebook via Docker&rsquo;s 8888 port by typing
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/328424/72bbc720-dc4d-fa3d-e2d7-7e40a8b39ea5.png" alt="image.png">
In the case of Docker toolbox, it is not possible to connect directly to localhost (local host), so obtain the IP address of the virtual machine running on Docker Toolbox and enter it in the URL instead of localhost <a href="https://qiita.com/jusotech10/items/b292ac38197926fc6afa">invention</a> is required.</p>
<pre><code>&gt; docker-machine ip default
192.168.XX.XX
</code></pre><p>Then I was able to successfully connect to the jupyter notebook.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/328424/c5a7bcb0-a30d-a9ee-0a19-df34472cacb3.png" alt="image.png"></p>
<h2 id="stumbled-point--cannot-mount-on-the-host-os-directory-properly">Stumbled point ③ Cannot mount on the host OS directory properly</h2>
<p>The <code>volume</code> part of the yaml file mentioned above represents the directory to mount, but in reality, in my environment, mounting did not work well and the directory on the host OS (local) and VM did not synchronize.
As a result of investigation, it was found that the following was the cause.</p>
<ol>
<li>
<p>Oracle VirtualBox folder sharing is not set</p>
</li>
<li>
<p>The version of the VM boot file (boot2docker.iso) on the docker side does not match the version of VirtualBox that was installed when the docker toolbox was installed.</p>
</li>
<li>
<p>Launch the &ldquo;Oracle VM VirtualBox Manager&rdquo; and run the docker machine VM you are currently using.
You can mount it by checking Advanced&gt; Shared Folder&gt; Add New Shared Folder&gt; Auto Mount/Make Persistent. Since the docker toolbox for windows is via VirtualBox, the docker command will not have any effect unless such settings are made.
<strong>VM VirtualBox icon</strong>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/328424/1a93e9a5-c240-95f4-ea0a-ba7141b1ed10.png" alt="image.png">
<strong>VM VirtualBox Manager</strong>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/328424/9fb088c5-f9ae-16f4-71aa-c3cc76077edf.png" alt="image.png">
<strong>VM details shared folder settings window</strong>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/328424/3cc9673f-b77a-0f0e-f99d-5a26f9c2538d.png" alt="image.png">
However, the mount did not work even if I set about 1. The cause is that the version of VirtualBox installed first and the version of the boot file of VM of Docker did not match. (I don&rsquo;t know why this happened)
I could change the boot file to match the current VirtualBox version, but I re-installed VirtualBox to the latest version and updated the boot file at the same time.
The boot file is stored as <code>C://Users/{users}/.docker/machine/cache/boot2docker.iso</code>. This file is available at <a href="https://github.com/boot2docker/boot2docker/releases?after=v18.09.7"><strong>here</strong></a>.
You can check the VirtualBox version at Help&gt; About VirtualBox, and you can download the installer from <a href="https://www.virtualbox.org/wiki/Download_Old_Builds_5_2"><strong>here</strong></a>.
Replace the boot file, reinstall VirtualBox, and delete the old docker VM machine with VirtualBox Manager. When you start Docker Quick Start Terminal, it automatically launches a new VM for docker based on the boot file.
Although it is a small detail, the difference between the version of the boot file and the version of VirtualBox remains the same, but the version of the configuration file GuestAdditions.iso used for mounting the host OS is also different, which causes mounting to fail.</p>
</li>
</ol>
<h2 id="stumbled-point--i-dont-want-to-launch-the-jupyter-notebook-every-time">Stumbled point ④ I don&rsquo;t want to launch the jupyter notebook every time</h2>
<p>I created a Docker container with a yaml file based on the Docker image, but every time I launch the container, the command to launch the jupyter notebook is included, so the jupyter notebook will be launched with the container each time. At that time, by launching the container with the following command and attaching it, you can access the container with the same settings except that you do not launch the jupyter notebook in the settings of the above yaml file.</p>
<pre><code>docker run -t -i --name {container name} -p 8888:8888 -v $PWD:/tmp/working:/tmp/working -w /tmp/working {Docker image name} /bin/bash
</code></pre><p>After installing various installs and directories, <code>jupyter notebook --ip=0.0.0.0 --allow-root --no-browser You can also start up and use the jupyter notebook with </code>. Similarly, you can also create and execute a yaml file that matches the above docker command. (I will omit it here)
The docker commands that are often used for reference are listed below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-docker" data-lang="docker"><span style="color:#75715e"># Launch VM</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker-machine start <span style="color:#f92672">{</span>VM name<span style="color:#f92672">}</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">#List of images currently created</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker images<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">#Currently created container list</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker ps -a<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">#Start the container confirmed above by name or ID</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker start <span style="color:#f92672">{</span>container name/container ID<span style="color:#f92672">}</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Attach to the started container</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker attach <span style="color:#f92672">{</span>container name/container ID<span style="color:#f92672">}</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Exit VM</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker-machine stop <span style="color:#f92672">{</span>VM name<span style="color:#f92672">}</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e">#Delete unwanted images</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker rmi <span style="color:#f92672">{</span>image name/image ID<span style="color:#f92672">}</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Delete unnecessary containers</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>docker rm <span style="color:#f92672">{</span>container name/container ID<span style="color:#f92672">}</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>##Finally
Docker is a very useful software if you want to easily analyze it with a commercially available Windows notebook but do not want to pollute the environment. I have summarized the points that stumbled when I introduced it with general Windows 10 Home Edition. I&rsquo;m glad if you can use it as a reference.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
