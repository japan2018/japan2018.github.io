<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Analyze the source code of your own simple search engine written in Python with the code visualization tool SOURCE TRAIL | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Analyze the source code of your own simple search engine written in Python with the code visualization tool SOURCE TRAIL</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 25, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/devops"> devops</a></code></small>


<small><code><a href="https://memotut.com/tags/project-management"> project management</a></code></small>


<small><code><a href="https://memotut.com/tags/search-engine"> search engine</a></code></small>


<small><code><a href="https://memotut.com/tags/sourcetrail"> sourcetrail</a></code></small>

</p>
<pre><code>![image](https://user-images.githubusercontent.com/17031124/69477854-9d62be00-0e2e-11ea-87d5-8d4da2481162.png)
</code></pre>
<p><img src="https://user-images.githubusercontent.com/17031124/69481474-0bba7700-0e55-11ea-867d-3fc9bee8007f.png" alt="image"></p>
<p>I am a software engineer <a href="http://bit.ly/2qGILex">r2en</a>of<a href="http://bit.ly/33fuxi1">white,inc</a>.Wearedoingconsultantworkcenteringonnewbusinessesatourcompany,andtheengineerteamusuallydevelops<a href="http://bit.ly/33iJeRe">Freecloudtypetooltodevelopnewbusinesses</a>, From consulting to PoC development</p>
<p>I was searching for a tool that can interactively understand the source code in the succession of development from the PoC development phase to the operation phase, or in the operation of existing software, but I found SOURCETEAIL, so I touched it so I shared it let me try</p>
<p><a href="http://bit.ly/33iJeRe"><img src="https://user-images.githubusercontent.com/17031124/70364775-4b5f7500-18d1-11ea-91bc-857813d89762.png" alt="image"></a></p>
<h2 id="overview">Overview</h2>
<p>SOURCETEAIL is a tool that helps developers code productively by analyzing and visualizing source code so that developers do not spend too much time understanding source code written by others.</p>
<h2 id="tldr">TL;DR</h2>
<p>The impression after actually using it is that the operation is easy and there are few things to learn about the tool, but it is relatively easy to see and relatively easy to use.</p>
<p>Although it&rsquo;s not completely understandable, I think it will definitely help you decipher the source code, so I think it&rsquo;s worth continuing to use it in the future.</p>
<h2 id="sourceteail-how-to-install">SOURCETEAIL How to install</h2>
<p><a href="https://www.sourcetrail.com/">https://www.sourcetrail.com/</a>
Jump to the sourcetrail site and click the download button</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69477854-9d62be00-0e2e-11ea-87d5-8d4da2481162.png" alt="image"></p>
<p>Download the image of your OS environment to jump to the github page of sourcetrail</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69477860-ace20700-0e2e-11ea-8ccd-58069c12a201.png" alt="image"></p>
<p>Unzip and move to application</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69477872-d438d400-0e2e-11ea-91b6-1072469f1466.png" alt="image"></p>
<h2 id="sourceteail-how-to-use">SOURCETEAIL How to use</h2>
<p>[Click here for a description of the source code used](<a href="https://qiita.com/r2en/items/e4f8145f54d6c5b4e77e#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%25(E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89)">https://qiita.com/r2en/items/e4f8145f54d6c5b4e77e#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%(E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89)</a></p>
<p>The following screen will be displayed when it starts.
Press New Project.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69477878-e3b81d00-0e2e-11ea-9c12-249836da55c1.png" alt="image"></p>
<p>When soucetail performs static analysis, files are automatically created in the analyzed repository (directory). Select the project name and project location for that time</p>
<p>Select add source group</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481250-0c520e00-0e53-11ea-9f6a-1dd1a35bfa24.png" alt="image"></p>
<p>Choose your programming language and choose next</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481255-1542df80-0e53-11ea-8249-72553acbc136.png" alt="image"></p>
<p>Input language environment, external module, module etc. here
It supports drag &amp; drop, so drop the repository as it is into Files &amp; Directories to Index.</p>
<ul>
<li>Operates without selecting environment or external module</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/17031124/69481275-3c011600-0e53-11ea-9a21-76871d64fe1c.png" alt="image"></p>
<p>Screen that refers to the dropped file with show files in the above screen</p>
<p>Is properly imported</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481281-46bbab00-0e53-11ea-89a6-642f64ca12f2.png" alt="image"></p>
<p>Select create after you have completed the entries to some extent</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481321-ab770580-0e53-11ea-8205-414c232772a3.png" alt="image"></p>
<p>Select start because the screen for static analysis of the source code will be displayed.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481328-b336aa00-0e53-11ea-8910-a30b33519a73.png" alt="image"></p>
<p>As the following folder, seach_engine.srctrlbm, seach_engine.srctrldb, seach_engine.srctrlprj are generated.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481341-c8133d80-0e53-11ea-8f70-66dc05918c37.png" alt="image"></p>
<p>It seems to deepen the static analysis again, so select start in-depth indexing</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481345-da8d7700-0e53-11ea-95ed-e669daf66fbc.png" alt="image"></p>
<p>select start</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481346-e1b48500-0e53-11ea-8d5c-221e22eb0fd8.png" alt="image"></p>
<p>There is an error, but this time I did not refer to external modules (numpy, pandas, etc.) during the initial setting. This time it doesn&rsquo;t matter, so proceed as it is</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481351-f2fd9180-0e53-11ea-83c7-8881418b1351.png" alt="image"></p>
<h3 id="source-code-overview-modules-classes-functions-variables">Source code overview (modules, classes, functions, variables)</h3>
<p>Let&rsquo;s see if we can display the source code components</p>
<p>Files existing in repository are displayed in alphabetical order</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481362-11fc2380-0e54-11ea-84e8-f307fa9d0d29.png" alt="image"></p>
<p>Modules existing in repository are displayed in alphabetical order</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481372-20e2d600-0e54-11ea-87db-403a7e4078c8.png" alt="image"></p>
<p>Classes existing in repository are displayed in alphabetical order</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481374-293b1100-0e54-11ea-8039-c4112a77bf4a.png" alt="image"></p>
<p>Functions existing in repository are displayed in alphabetical order</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481380-33f5a600-0e54-11ea-9fd8-a778d99f982e.png" alt="image"></p>
<p>Global variables existing in repository are displayed in alphabetical order</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481384-3e17a480-0e54-11ea-86ee-4a20557981f5.png" alt="image"></p>
<h3 id="source-code-analysis-module">Source code analysis (module)</h3>
<p>Now let&rsquo;s see if you can see more detailed analysis of source code and dependencies</p>
<p>First let&rsquo;s look at the module</p>
<p>In the app.py file, since the responder server is started, api is called in the global variable,
Originally, it should be batch processed instead of real-time APi,</p>
<p>Since a simple search engine is created this time, data index is created and it is created only at the first startup, so it exists in the global variable.</p>
<p>In the function, there is a batch_process function for creating index and bow, and search_engine which is a search engine API exists.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481550-ad41c880-0e55-11ea-9707-81907f4ded1e.png" alt="image"></p>
<p>This time, the search_engine in app.py is the basis of all the processing, so try selecting this function.</p>
<p>You can see that it is composed of global variables bow and index and functions query_engine, query_post_processor and query_pre_processor.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481461-e6c60400-0e54-11ea-8db9-48d6fe9bdb81.png" alt="image"></p>
<p>Select query_pre_processor to look a little deeperUnfortunately, there are CountVector and TfidfVector classes that inherit the BaseVector class, but this chart makes it difficult to understand the dependencies.</p>
<p>MecabMorphologicalAnalysis originally inherits the BaseMorphologicalAnalysis class, but it is not displayed at first glance.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481474-0bba7700-0e55-11ea-867d-3fc9bee8007f.png" alt="image"></p>
<p>Look at each other</p>
<p>You can see that query_engine uses cosine_similarity</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481486-22f96480-0e55-11ea-838d-0d13c1ff8846.png" alt="image"></p>
<p>You can see that query_post_prosessor is closed without using other classes or functions.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481494-360c3480-0e55-11ea-8c1a-b84231bf352e.png" alt="image"></p>
<h3 id="source-code-dependency-class">Source code dependency (class)</h3>
<p>Looking at CountVector, you can see that it inherits from BaseVector
Also, it can be seen that it is called from the indexer module, indexer function, and query_pre_processor function.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481517-5936e400-0e55-11ea-82a3-ea54edb7f32d.png" alt="image"></p>
<p>Conversely, if you look at BaseVector, it is called from count_vector module and tfidf_vector module,
You can see that it is the parent of CountVector class and TfidfVector class.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/69481537-86839200-0e55-11ea-83d1-6388f6a9e0f3.png" alt="image"></p>
<h2 id="source-code-used">Source code used</h2>
<p>This part is not related to SOURCETEAIL, so please read if you want to have a deeper understanding of what you are parsing</p>
<p>The reason for choosing this source code is to consider a system with multiple files (modules) and a simple configuration that is easy to understand while verifying whether it can be used in projects etc. with code that has some dependency. When the corresponding code was a simple search engine</p>
<h3 id="overview-1">Overview</h3>
<p>When the user sends a query to the API asking, &ldquo;What is the animal that cries?&rdquo;, the following question list &ldquo;What is the animal with a long nose?&rdquo; From &ldquo;What is the animal with a long neck?&rdquo;, &ldquo;Who is the king of beasts?&rdquo;, &ldquo;What is the animal that screams?&rdquo;, &ldquo;What is the animal that screams?&rdquo; It is a system that selects a question sentence that is the closest to the query and returns the answer &ldquo;dog&rdquo; as a response as a response.</p>
<h3 id="logical-configuration">Logical configuration</h3>
<p>The theoretical components of a search engine are referenced below</p>
<p>The data to be searched is pre-processed through product information management and generated as an index, and if a search query flies due to a request from the user, the query pre-processor performs the same pre-processing and searches for the same element with the query engine. Then, it is a very simple and minimal search engine that formats the results with a query post processor and returns the search results as a response.</p>
<p><img src="https://user-images.githubusercontent.com/17031124/68522906-cc3c4880-02f4-11ea-878f-8d9f70675b5d.png" alt="Image of iOS (1)"></p>
<p>I borrowed a diagram from the book <a href="https://amzn.to/2rjoWtO">Machine Learning for AI Algorithm Marketing Automation</a></p>
<p>I don&rsquo;t think it&rsquo;s much talked about in the neighborhood, but if you want to search and recommend, this book is a great learning experience, so I hope everyone will read it.</p>
<p>Since it is quoted without permission, it will be deleted immediately if there is a contact from the author or related parties.</p>
<h3 id="directory-structure">Directory structure</h3>
<p>It will be in the following form when dropped concretely</p>
<p>Since the relevance tuning part changes depending on business requirements this time, I omit it this time.</p>
<p>The source code I wrote this time is on github, so if you want to see it in detail, please access the following.</p>
<p><a href="https://github.com/r2en/simple_search_engine">https://github.com/r2en/simple_search_engine</a></p>
<pre><code>    ├── app.py &lt;- Responder API server receives a search request and returns the search result
    │
    │
    ├── indexer.py &lt;- Preprocess catalog data (document) and generate index (vectorization of preprocessed document)
    │
    │
    ├── query_engine.py &lt;- Performs query and catalog data matching and scoring
    │
    │
    ├── query_pre_processor.py &lt;- Performs almost the same process as the preprocessing performed by the indexer that processes the query (user search request) in the index format.
    │
    │
    ├── query_post_processor.py &lt;- Generate search results from matching results of query and catalog data
    │
    │
    ├── product_information_management.py &lt;- Manipulate the retrieved data
    │ 
    │
    ├── catalog_data &lt;- Stores the searched data
    │ │ │
    │ │ │
    │ ├── answer.csv &lt;- Stores the answer data requested by the query
    │ │ │
    │ │ │
    │ └── question.csv &lt;- Stores the same question data as the query
    │
    │
    ├── morphological_analysis &lt;- Tools for morphological analyzer of natural language
    │ │ │
    │  ├── base_morphological_analysis.py &lt;- Parent class of the base morphological analyzer
    │ │ │
    │ │ │
    │ ├── mecab_morphological_analysis.py &lt;- Stores the mecab of the morphological analyzer
    │ │ │
    │ │ │
    │ └── __init__.py
    │
    │
    ├── search &lt;- Search for similarity between cataloged data and vectorized queries
    │ │ │
    │  ├── cosine_similarity.py &lt;- Search for similarity by cosine similarity
    │ │ │
    │ │ │
    │ └── __init__.py
    │
    │
    └── word_embedding &lt;- Create a data structure and index that enable you to search queries and catalog data
       │
       │
      ├── base_vector.py &lt;- parent class of the base vector converter
       │
       │
      ├── count_vector.py &lt;- BoW count-based vector converter
       │
       │
       │
      ├── tfidf_vector.py &lt;- BoW Tf-Idf based vector converter
       │
       │
       └── __init__.py
</code></pre><h2 id="impression">Impression</h2>
<p>The impression after actually using it is that the operation is easy and there are few things to learn about the tool, but it is relatively easy to see and relatively easy to use.</p>
<p>Although it&rsquo;s not completely understandable, I think it will definitely help you decipher the source code, so I think it&rsquo;s worth continuing to use it in the future.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
