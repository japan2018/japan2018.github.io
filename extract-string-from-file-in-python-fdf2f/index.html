<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>Extract string from file in Python | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Extract string from file in Python</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 2, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>

</p>
<pre><code>## Introduction
</code></pre>
<p><strong>What to explain in this article</strong>
Sample code for the following features.</p>
<ul>
<li>Create a list of files under the specified directory</li>
<li>Find out if the text in a file contains a certain string</li>
<li>Extract text within a file from a range enclosed by a specific string</li>
</ul>
<p><strong>Development environment</strong></p>
<ul>
<li>python 2.7 or above</li>
</ul>
<h2 id="create-a-list-of-files-under-the-specified-directory">Create a list of files under the specified directory</h2>
<h4 id="code">code</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_file_list</span>(dirpath_to_search):
    file_list <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> dirpath, dirnames, filenames <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(dirpath_to_search):
        <span style="color:#66d9ef">for</span> filename <span style="color:#f92672">in</span> filenames:
             file_list<span style="color:#f92672">.</span>append(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(dirpath,filename))

    <span style="color:#66d9ef">return</span> file_list
</code></pre></div><h4 id="how-to-use">how to use</h4>
<p>The following directory structure is a sample when you want to recursively obtain the file names under sample1.</p>
<pre><code class="language-txt:" data-lang="txt:">sample1/
├── dir01
│  ├── dir11
│  │  └── file21.txt
│  └── file11.txt
├── file01.txt
└── file02.txt
</code></pre><pre><code class="language-python:" data-lang="python:">file_list = generate_file_list('sample1')
for file in file_list:
    print(file)

# Output
# sample1/file01.txt
# sample1/file02.txt
# sample1/dir01/file11.txt
# sample1/dir01/dir11/file21.txt
</code></pre><h4 id="api-used">API used</h4>
<p><a href="https://docs.python.org/ja/3/library/os.html#os.walk">os.walk(top, topdown=True, onerror=None, followlinks=False)</a></p>
<blockquote>
<p>Create file names under the directory tree by scanning the tree top down or bottom up. Yield a tuple (dirpath, dirnames, filenames) for each directory (including top itself) in the directory tree rooted at directory top.</p>
</blockquote>
<h2 id="check-if-the-text-in-the-file-contains-a-certain-string">Check if the text in the file contains a certain string</h2>
<h4 id="code-1">code</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">contain_text_in_file</span>(filepath, text):
    <span style="color:#66d9ef">with</span> open(filepath) <span style="color:#66d9ef">as</span> f:
        <span style="color:#66d9ef">return</span> any(text <span style="color:#f92672">in</span> line <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f)
</code></pre></div><h4 id="how-to-use-1">how to use</h4>
<p>There is a file called <code>contain.txt</code> and <code>not_contain.txt</code> as below, and you want to know the file that contains &ldquo;2020/02/02&rdquo; in the file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt:contain.txt" data-lang="txt:contain.txt">Updated: 02/02/2020
This article is about python file operation.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt:not_contain.txt" data-lang="txt:not_contain.txt">Updated: 2019/10/15
This article is about python file operation.
</code></pre></div><pre><code class="language-python:" data-lang="python:">filepath1 ='./contain.txt'
text = '2020/02/02'
result1 = contain_text_in_file(filepath1, text)
print(result1) # True

filepath2 ='./not_contain.txt'
text = '2020/02/02'
result2 = contain_text_in_file(filepath2, text)
print(result2) # False
</code></pre><h4 id="api-used-1">API used</h4>
<p><a href="https://docs.python.org/en/3/library/functions.html#open">open(file, mode='r&rsquo;, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</a></p>
<blockquote>
<p>Opens file and returns the corresponding file object.</p>
</blockquote>
<p><a href="https://docs.python.org/ja/3/library/functions.html#any">any(iterable)</a></p>
<blockquote>
<p>Returns True if any element of iterable is true. Returns False if iterable is empty. Is equivalent to the following code:</p>
</blockquote>
<h2 id="extract-the-text-within-the-range-enclosed-by-a-specific-string-from-the-text-in-the-file">Extract the text within the range enclosed by a specific string from the text in the file</h2>
<h4 id="code-2">code</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> re

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">extract_text_in_file</span>(filepath, pattern_prev, pattern_next):
    extracted_text_array <span style="color:#f92672">=</span> []
    pattern <span style="color:#f92672">=</span> pattern_prev <span style="color:#f92672">+</span><span style="color:#e6db74">&#39;(.*)&#39;</span> <span style="color:#f92672">+</span> pattern_next
    <span style="color:#66d9ef">with</span> open(filepath) <span style="color:#66d9ef">as</span> f:
        lines <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>readlines()
        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> lines:
            tmp_extracted_text_array <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(pattern, line)
            extracted_text_array<span style="color:#f92672">.</span>extend(tmp_extracted_text_array)

    <span style="color:#66d9ef">return</span> extracted_text_array
</code></pre></div><h4 id="how-to-use-2">how to use</h4>
<p>A sample when there is a file <code>file.txt</code> like the following and you want to extract the date part between &ldquo;update date&rdquo; and &ldquo;by&rdquo;.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt:file.txt" data-lang="txt:file.txt">Updated: 2020/02/01 by taro
This article is about python file operation.

Updated: 02/02/2020 by jiro
This article is about python file operation.
</code></pre></div><pre><code class="language-python:" data-lang="python:">filepath ='./file.txt'
pattern_prev ='Update date:'
pattern_next ='by'
extracted_text_array = extract_text_in_file(filepath, pattern_prev, pattern_next)

for extracted_text in extracted_text_array:
    print(extracted_text)

# Output
#2020/02/01
#2020/02/02
</code></pre><h4 id="api-used-2">API used</h4>
<p><a href="https://docs.python.org/ja/3/library/re.html#re.findall">re.findall(pattern, string, flags=0)</a></p>
<blockquote>
<p>Returns a list of all unique matches of pattern in string. The string is scanned from left to right and the matches are returned in the order found. If there is more than one group in the pattern, return a list of groups. If the pattern has multiple groups it will be a list of tuples. Empty matches are included in the result.</p>
</blockquote>
<p><a href="https://docs.python.org/en/3/library/functions.html#open">open(file, mode='r&rsquo;, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</a></p>
<blockquote>
<p>Opens file and returns the corresponding file object.</p>
</blockquote>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
