<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] To people who are offered but not recruited | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] To people who are offered but not recruited</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 19, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/api"> api</a></code></small>


<small><code><a href="https://memotut.com/tags/natural-language-processing"> natural language processing</a></code></small>


<small><code><a href="https://memotut.com/tags/news-item"> news item</a></code></small>


<small><code><a href="https://memotut.com/tags/cotoha"> COTOHA</a></code></small>

</p>
<pre><code>** [Twitter](https://twitter.com/omiita_atiimo)introducesartificialintelligenceandarticleswritteninothermedia**,soifyouwanttoknowmoreaboutartificialintelligence,**Pleasefeelfreetofollowus(https://twitter.com/omiita_atiimo)! **
</code></pre>
<!-- <2/25 (Tue) update> ** Add Shinjiro Koizumi syntax [Add](https://qiita.com/omiita/items/0f811f15e569bf2539b8#6-%E7%95%AA%E5%A4%96%E7%B7%A8%E5%B0%8F%E6%B3%89%E9%80%B2%E6%AC%A1%E9%83%8E%E6%A7%8B%E6%96%87) Did. ** -->
<h2 id="1-i-teach-but-i-dont-explain">1. I teach, but I don&rsquo;t explain</h2>
<p>Prime Minister Abe&rsquo;s <a href="https://headlines.yahoo.co.jp/hl?a=20200129-00000050-dal-ent">Remark</a> <strong>&ldquo;I am recruiting but not recruiting&rdquo;</strong> I was inspired and created a program that automatically converts the input sentence into a sentence &ldquo;I&rsquo;m recruiting but not recruiting&rdquo;**!</p>
<p>If you enter &ldquo;Recruit people&rdquo;, it will be converted into the sentence &ldquo;We are recruiting people but not recruiting&rdquo;.</p>
<pre><code class="language-shell:" data-lang="shell:">$ python abe.py &quot;See the cherry blossoms&quot;
I see the cherry blossoms, but I don't see them
</code></pre><h2 id="2-im-using-it-but-im-not-using-it">2. I&rsquo;m using it, but I&rsquo;m not using it</h2>
<table>
<thead>
<tr>
<th align="center">Used</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="https://www.python.org/">Python 3.7.0</a></td>
<td align="left">Code</td>
</tr>
<tr>
<td align="center"><a href="https://api.ce-cotoha.com/contents/index.html">COTOHA API</a></td>
<td align="left">Morphological analysis and similarity calculation</td>
</tr>
<tr>
<td align="center"><a href="http://compling.hss.ntu.edu.sg/wnja/index.ja.html">WordNet</a></td>
<td align="left">Synonyms</td>
</tr>
<tr>
<td align="center"><a href="http://taku910.github.io/mecab/#download">IPA Dictionary</a></td>
<td align="left">Verb conjugations</td>
</tr>
</tbody>
</table>
<h2 id="3-i-have-taught-the-mechanism-in-detail-but-i-have-not-explained-it-in-detail">3. I have taught the mechanism in detail, but I have not explained it in detail</h2>
<p><img src="https://imgur.com/9MKcVBb.png" alt="Purpose"></p>
<h3 id="31-extract-nouns-and-verbs">3.1 Extract nouns and verbs</h3>
<p><img src="https://imgur.com/WgftLmY.png" alt="Step 1"></p>
<h3 id="32-list-synonyms">3.2 List synonyms</h3>
<p><img src="https://imgur.com/ncZjP5T.png" alt="Step 2"></p>
<h3 id="33-extract-only-nouns">3.3 Extract only nouns</h3>
<p><img src="https://imgur.com/Flh5c5G.png" alt="Step 3"></p>
<h3 id="34-similarity-measurement-between-original-text-and-synonyms">3.4 Similarity measurement between original text and synonyms</h3>
<p><img src="https://imgur.com/anRUwNH.png" alt="Step 4"></p>
<h3 id="35-convert-to-continuous-connection">3.5 Convert to continuous connection</h3>
<p><img src="https://imgur.com/oKCTEIr.png" alt="Step 5"></p>
<h3 id="36-join">3.6 join</h3>
<p><img src="https://imgur.com/cy54CsV.png" alt="Step 6"></p>
<h2 id="4-code-is-shown-but-not-shown">4. Code is shown but not shown</h2>
<details><summary>code (click)</summary><div>
<h3 id="import">Import</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:abe.py" data-lang="python:abe.py"><span style="color:#75715e"># -*- coding:utf-8 -*-</span>

<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> urllib.request
<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> configparser
<span style="color:#f92672">import</span> codecs
<span style="color:#f92672">import</span> csv
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> sqlite3
<span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> namedtuple
<span style="color:#f92672">import</span> types
</code></pre></div><h3 id="cotoha">COTOHA</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:abe.py" data-lang="python:abe.py"><span style="color:#75715e">#/_/_/_/_/_/_/_/_/_/_/_/_/COTOHA_/_/_/_/_/_/_/_/_/_/_/_/ _/_/_/</span>
<span style="color:#75715e"># The code here is taken from here.</span>
<span style="color:#75715e"># https://qiita.com/gossy5454/items/83072418fb0c5f3e269f</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CotohaApi</span>:
    <span style="color:#75715e"># Initialization</span>
    <span style="color:#66d9ef">def</span> __init__(self, client_id, client_secret, developer_api_base_url, access_token_publish_url):
        self<span style="color:#f92672">.</span>client_id <span style="color:#f92672">=</span> client_id
        self<span style="color:#f92672">.</span>client_secret <span style="color:#f92672">=</span> client_secret
        self<span style="color:#f92672">.</span>developer_api_base_url <span style="color:#f92672">=</span> developer_api_base_url
        self<span style="color:#f92672">.</span>access_token_publish_url <span style="color:#f92672">=</span> access_token_publish_url
        self<span style="color:#f92672">.</span>getAccessToken()

    <span style="color:#75715e"># Get access token</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getAccessToken</span>(self):
        <span style="color:#75715e"># Specify access token acquisition URL</span>
        url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>access_token_publish_url

        <span style="color:#75715e">#Header specification</span>
        headers<span style="color:#f92672">=</span>{
            <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/json;charset=UTF-8&#34;</span>
        }

        <span style="color:#75715e"># Request body specification</span>
        data <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#34;grantType&#34;</span>: <span style="color:#e6db74">&#34;client_credentials&#34;</span>,
            <span style="color:#e6db74">&#34;clientId&#34;</span>: self<span style="color:#f92672">.</span>client_id,
            <span style="color:#e6db74">&#34;clientSecret&#34;</span>: self<span style="color:#f92672">.</span>client_secret
        }
        <span style="color:#75715e"># Encode request body specification in JSON</span>
        data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(data)<span style="color:#f92672">.</span>encode()

        <span style="color:#75715e">#Request generation</span>
        req <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(url, data, headers)

        <span style="color:#75715e">#Send requests and receive responses</span>
        res <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)

        <span style="color:#75715e"># Get response body</span>
        res_body <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>read()

        <span style="color:#75715e"># Decode response body from JSON</span>
        res_body <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(res_body)

        <span style="color:#75715e"># Get access token from response body</span>
        self<span style="color:#f92672">.</span>access_token <span style="color:#f92672">=</span> res_body[<span style="color:#e6db74">&#34;access_token&#34;</span>]


    <span style="color:#75715e"># Parsing API</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(self, sentence):
        <span style="color:#75715e"># Specify parsing API URL</span>
        url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>developer_api_base_url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;v1/parse&#34;</span>
        <span style="color:#75715e">#Header specification</span>
        headers<span style="color:#f92672">=</span>{
            <span style="color:#e6db74">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;Bearer &#34;</span><span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>access_token,
            <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/json;charset=UTF-8&#34;</span>,
        }
        <span style="color:#75715e"># Request body specification</span>
        data <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#34;sentence&#34;</span>: sentence
        }
        <span style="color:#75715e"># Encode request body specification in JSON</span>
        data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(data)<span style="color:#f92672">.</span>encode()
        <span style="color:#75715e">#Request generation</span>
        req <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(url, data, headers)
        <span style="color:#75715e">#Send requests and receive responses</span>
        <span style="color:#66d9ef">try</span>:
            res <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)
        <span style="color:#75715e"># Processing when error occurs in request</span>
        <span style="color:#66d9ef">except</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>HTTPError <span style="color:#66d9ef">as</span> e:
            <span style="color:#75715e"># If the status code is 401 Unauthorized, get the access token again and request again</span>
            <span style="color:#66d9ef">if</span> e<span style="color:#f92672">.</span>code <span style="color:#f92672">==</span> <span style="color:#ae81ff">401</span>:
                <span style="color:#66d9ef">print</span> (<span style="color:#e6db74">&#34;get access token&#34;</span>)
                self<span style="color:#f92672">.</span>access_token <span style="color:#f92672">=</span> getAccessToken(self<span style="color:#f92672">.</span>client_id, self<span style="color:#f92672">.</span>client_secret)
                headers[<span style="color:#e6db74">&#34;Authorization&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Bearer &#34;</span><span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>access_token
                req <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(url, data, headers)
                res <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)
            If the error <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#75715e">#401, the cause is displayed.</span>
            <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">print</span> (<span style="color:#e6db74">&#34;&lt;Error&gt; &#34;</span><span style="color:#f92672">+</span> e<span style="color:#f92672">.</span>reason)

        <span style="color:#75715e"># Get response body</span>
        res_body <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>read()
        <span style="color:#75715e"># Decode response body from JSON</span>
        res_body <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(res_body)
        <span style="color:#75715e"># Get analysis result from response body</span>
        <span style="color:#66d9ef">return</span> res_body


    <span style="color:#75715e"># Similarity calculation API</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">similarity</span>(self, s1, s2):
        <span style="color:#75715e"># Similarity calculation API URL specification</span>
        url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>developer_api_base_url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;v1/similarity&#34;</span>
        <span style="color:#75715e">#Header specification</span>
        headers<span style="color:#f92672">=</span>{
            <span style="color:#e6db74">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;Bearer &#34;</span><span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>access_token,
            <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/json;charset=UTF-8&#34;</span>,
        }
        <span style="color:#75715e"># Request body specification</span>
        data <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#34;s1&#34;</span>: s1,
            <span style="color:#e6db74">&#34;s2&#34;</span>: s2
        }
        <span style="color:#75715e"># Encode request body specification in JSON</span>
        data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(data)<span style="color:#f92672">.</span>encode()
        <span style="color:#75715e">#Request generation</span>
        req <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(url, data, headers)
        <span style="color:#75715e">#Send requests and receive responses</span>
        <span style="color:#66d9ef">try</span>:res <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)
        <span style="color:#75715e"># Processing when error occurs in request</span>
        <span style="color:#66d9ef">except</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>HTTPError <span style="color:#66d9ef">as</span> e:
            <span style="color:#75715e"># If the status code is 401 Unauthorized, get the access token again and request again</span>
            <span style="color:#66d9ef">if</span> e<span style="color:#f92672">.</span>code <span style="color:#f92672">==</span> <span style="color:#ae81ff">401</span>:
                <span style="color:#66d9ef">print</span> (<span style="color:#e6db74">&#34;get access token&#34;</span>)
                self<span style="color:#f92672">.</span>access_token <span style="color:#f92672">=</span> getAccessToken(self<span style="color:#f92672">.</span>client_id, self<span style="color:#f92672">.</span>client_secret)
                headers[<span style="color:#e6db74">&#34;Authorization&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Bearer &#34;</span><span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>access_token
                req <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>Request(url, data, headers)
                res <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(req)
            If the error <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#75715e">#401, the cause is displayed.</span>
            <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">print</span> (<span style="color:#e6db74">&#34;&lt;Error&gt; &#34;</span><span style="color:#f92672">+</span> e<span style="color:#f92672">.</span>reason)

        <span style="color:#75715e"># Get response body</span>
        res_body <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>read()
        <span style="color:#75715e"># Decode response body from JSON</span>
        res_body <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(res_body)
        <span style="color:#75715e"># Get analysis result from response body</span>
        <span style="color:#66d9ef">return</span> res_body
</code></pre></div><h3 id="convert-to-continuous-connection">Convert to continuous connection</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:abe.py" data-lang="python:abe.py"><span style="color:#75715e">#/_/_/_/_/_/_/_/_/_/_/_/_/CONVERSION_/_/_/_/_/_/_/_/_/_/_/_/ _/_/_/</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">convert</span>(word):
    file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./data/Verb.csv&#34;</span>
    <span style="color:#66d9ef">with</span> open(file_name,<span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> f:
        handler <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>reader(f)
        <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> handler:
            <span style="color:#66d9ef">if</span> word <span style="color:#f92672">==</span> row[<span style="color:#ae81ff">10</span>]: <span style="color:#75715e">#Part of speech discovery</span>
                <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;Continuous data connection&#34;</span> <span style="color:#f92672">in</span> row[<span style="color:#ae81ff">9</span>]: <span style="color:#75715e"># Utilization discovery</span>
                    <span style="color:#66d9ef">return</span> row[<span style="color:#ae81ff">0</span>]
    <span style="color:#66d9ef">return</span> None
</code></pre></div><h3 id="synonyms">synonyms</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:abe.py" data-lang="python:abe.py"><span style="color:#75715e">#/_/_/_/_/_/_/_/_/_/_/_/_/SYNONYM_/_/_/_/_/_/_/_/_/_/_/_/ _/_/_/</span>
<span style="color:#75715e"># The code here is taken from here.</span>
<span style="color:#75715e"># https://www.yoheim.net/blog.php?q=20160201</span>

conn <span style="color:#f92672">=</span> sqlite3<span style="color:#f92672">.</span>connect(<span style="color:#e6db74">&#34;./data/wnjpn.db&#34;</span>)

Word <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;Word&#39;</span>,<span style="color:#e6db74">&#39;wordid lang lemma pron pos&#39;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getWords</span>(lemma):
  cur <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;select * from word where lemma=?&#34;</span>, (lemma,))
  <span style="color:#66d9ef">return</span> [Word(<span style="color:#f92672">*</span>row) <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> cur]


Sense <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;Sense&#39;</span>,<span style="color:#e6db74">&#39;synset wordid lang rank lexid freq src&#39;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getSenses</span>(word):
  cur <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;select * from sense where wordid=?&#34;</span>, (word<span style="color:#f92672">.</span>wordid,))
  <span style="color:#66d9ef">return</span> [Sense(<span style="color:#f92672">*</span>row) <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> cur]

Synset <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;Synset&#39;</span>,<span style="color:#e6db74">&#39;synset pos name src&#39;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getSynset</span>(synset):
  cur <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;select * from synset where synset=?&#34;</span>, (synset,))
  <span style="color:#66d9ef">return</span> Synset(<span style="color:#f92672">*</span>cur<span style="color:#f92672">.</span>fetchone())

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getWordsFromSynset</span>(synset, lang):
  cur <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;select word.* from sense, word where synset=? and word.lang=? and sense.wordid = word.wordid;&#34;</span>, (synset,lang))
  <span style="color:#66d9ef">return</span> [Word(<span style="color:#f92672">*</span>row) <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> cur]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getWordsFromSenses</span>(sense, lang<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;jpn&#34;</span>):
  synonym <span style="color:#f92672">=</span> {}
  <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> sense:
    lemmas <span style="color:#f92672">=</span> []
    syns <span style="color:#f92672">=</span> getWordsFromSynset(s<span style="color:#f92672">.</span>synset, lang)
    <span style="color:#66d9ef">for</span> sy <span style="color:#f92672">in</span> syns:
      lemmas<span style="color:#f92672">.</span>append(sy<span style="color:#f92672">.</span>lemma)
    synonym[getSynset(s<span style="color:#f92672">.</span>synset)<span style="color:#f92672">.</span>name] <span style="color:#f92672">=</span> lemmas
  <span style="color:#66d9ef">return</span> synonym

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getSynonym</span> (word):
    synonym <span style="color:#f92672">=</span> {}
    words <span style="color:#f92672">=</span> getWords(word)
    <span style="color:#66d9ef">if</span> words:
        <span style="color:#66d9ef">for</span> w <span style="color:#f92672">in</span> words:
            sense <span style="color:#f92672">=</span> getSenses(w)
            s <span style="color:#f92672">=</span> getWordsFromSenses(sense)
            synonym <span style="color:#f92672">=</span> dict(list(synonym<span style="color:#f92672">.</span>items()) <span style="color:#f92672">+</span> list(s<span style="color:#f92672">.</span>items()))
    <span style="color:#66d9ef">return</span> synonym
</code></pre></div><h3 id="main">Main</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:abe.py" data-lang="python:abe.py"><span style="color:#75715e">#/_/_/_/_/_/_/_/_/_/_/_/_/MAIN_/_/_/_/_/_/_/_/_/_/_/_/ _/_/_/</span>
<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    <span style="color:#75715e">#Get source file location</span>
    APP_ROOT <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>abspath( __file__)) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span>

    <span style="color:#75715e">#Get set value</span>
    config <span style="color:#f92672">=</span> configparser<span style="color:#f92672">.</span>ConfigParser()
    config<span style="color:#f92672">.</span>read(APP_ROOT <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;config.ini&#34;</span>)
    CLIENT_ID <span style="color:#f92672">=</span> config<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;COTOHA API&#34;</span>, <span style="color:#e6db74">&#34;Developer Client id&#34;</span>)
    CLIENT_SECRET <span style="color:#f92672">=</span> config<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;COTOHA API&#34;</span>, <span style="color:#e6db74">&#34;Developer Client secret&#34;</span>)
    DEVELOPER_API_BASE_URL <span style="color:#f92672">=</span> config<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;COTOHA API&#34;</span>, <span style="color:#e6db74">&#34;Developer API Base URL&#34;</span>)
    ACCESS_TOKEN_PUBLISH_URL <span style="color:#f92672">=</span> config<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;COTOHA API&#34;</span>, <span style="color:#e6db74">&#34;Access Token Publish URL&#34;</span>)

    <span style="color:#75715e"># COTOHA API instance generation</span>
    cotoha_api <span style="color:#f92672">=</span> CotohaApi(CLIENT_ID, CLIENT_SECRET, DEVELOPER_API_BASE_URL, ACCESS_TOKEN_PUBLISH_URL)

    <span style="color:#75715e"># Statement to be analyzed</span>
    <span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">2</span>:
        sentence <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">TypeError</span>

    <span style="color:#75715e"># Take the verb from the original sentence and convert it to a continuous form connection</span>
    result <span style="color:#f92672">=</span> cotoha_api<span style="color:#f92672">.</span>parse(sentence)
    ret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    verb <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> chunk <span style="color:#f92672">in</span> result[<span style="color:#e6db74">&#34;result&#34;</span>]:
        <span style="color:#66d9ef">for</span> token <span style="color:#f92672">in</span> chunk[<span style="color:#e6db74">&#34;tokens&#34;</span>]:
            <span style="color:#66d9ef">if</span> token[<span style="color:#e6db74">&#34;pos&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;verb stem&#34;</span>:
                verb <span style="color:#f92672">=</span> token[<span style="color:#e6db74">&#34;lemma&#34;</span>]
                form <span style="color:#f92672">=</span> token[<span style="color:#e6db74">&#34;form&#34;</span>]
                conv_verb <span style="color:#f92672">=</span> convert(verb)
                <span style="color:#66d9ef">if</span> conv_verb<span style="color:#f92672">==</span>None:
                    ret <span style="color:#f92672">+=</span> form
                <span style="color:#66d9ef">else</span>:
                    ret <span style="color:#f92672">+=</span> conv_verb

                <span style="color:#66d9ef">if</span> ret[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;n&#34;</span>:
                    ret <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;Although it is,&#34;</span>
                <span style="color:#66d9ef">else</span>:
                    ret <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;Yes, but&#34;</span>
                <span style="color:#66d9ef">break</span>
            <span style="color:#66d9ef">else</span>:
                ret <span style="color:#f92672">+=</span> token[<span style="color:#e6db74">&#34;form&#34;</span>]

    <span style="color:#75715e"># Take a synonym for a verb</span>
    synonym <span style="color:#f92672">=</span> getSynonym(verb)
    noun <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    sim <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.</span>

    <span style="color:#75715e"># Extract synonyms for the most similar noun</span>
    <span style="color:#66d9ef">for</span> syns <span style="color:#f92672">in</span> synonym<span style="color:#f92672">.</span>values():
        <span style="color:#66d9ef">for</span> syn <span style="color:#f92672">in</span> syns:
            result <span style="color:#f92672">=</span> cotoha_api<span style="color:#f92672">.</span>parse(syn)[<span style="color:#e6db74">&#39;result&#39;</span>][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;tokens&#39;</span>][<span style="color:#ae81ff">0</span>]
            <span style="color:#66d9ef">if</span> result[<span style="color:#e6db74">&#39;pos&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;noun&#39;</span>:
                cand <span style="color:#f92672">=</span> result[<span style="color:#e6db74">&#39;form&#39;</span>]
                cand_sim <span style="color:#f92672">=</span> cotoha_api<span style="color:#f92672">.</span>similarity(sentence, cand<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;do&#39;</span>)[<span style="color:#e6db74">&#39;result&#39;</span>][<span style="color:#e6db74">&#39;score&#39;</span>]
                <span style="color:#66d9ef">if</span> cand_sim<span style="color:#f92672">&gt;</span> sim:
                    noun <span style="color:#f92672">=</span> result[<span style="color:#e6db74">&#39;form&#39;</span>]
                    sim <span style="color:#f92672">=</span> cand_sim
    ret <span style="color:#f92672">+=</span> noun
    ret <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;I haven&#39;t done&#34;</span>

    <span style="color:#75715e">#Final output</span>
    <span style="color:#66d9ef">print</span>(ret)
</code></pre></div><h3 id="configini">config.ini</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell:config.ini" data-lang="shell:config.ini"><span style="color:#75715e"># To use COTOHA API, register to COTOHA API, get ID and SECRET,</span>
<span style="color:#75715e"># You need to create a config.ini file.</span>
<span style="color:#75715e"># https://api.ce-cotoha.com/contents/index.html</span>

<span style="color:#66d9ef">[COTOHA API]</span>
<span style="color:#a6e22e">Developer API Base URL: https://api.ce-cotoha.com/api/dev/nlp/Developer Client id: IDIDIDIDIDIDIDIDIDIDIDIDIDIDIDIDI</span>
<span style="color:#a6e22e">Developer Client secret: SECRETSECRETSECRETSECRET</span>
<span style="color:#a6e22e">Access Token Publish URL: https://api.ce-cotoha.com/v1/oauth/accesstokens</span>
</code></pre></div></div></details>
<h2 id="5-ive-tried-but-not-tried">5. I&rsquo;ve tried but not tried</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;drink&#34;</span>
I<span style="color:#960050;background-color:#1e0010">&#39;</span>m drinking, but not drinking
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;go home&#34;</span>
I<span style="color:#e6db74">&#39;m home but I&#39;</span>m not home
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;See the cherry blossoms&#34;</span>
I see the cherry blossoms, but I don<span style="color:#960050;background-color:#1e0010">&#39;</span>t see them
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;eat sushi&#34;</span>
I<span style="color:#e6db74">&#39;m eating sushi but I&#39;</span>m not eating
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;Invite to the eve&#34;</span>
I have been invited to the eve of the festival, but not invited
</code></pre></div><details><summary>**Other things I tried**(click)</summary><div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;Stay at a hotel&#34;</span>
I<span style="color:#960050;background-color:#1e0010">&#39;</span>m staying at a hotel but not
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;answer the question&#34;</span>
Answers questions, but does not answer
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;sleep at night&#34;</span>
I<span style="color:#960050;background-color:#1e0010">&#39;</span>m sleeping at night, but not sleeping
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;Walk outside&#34;</span>
I<span style="color:#960050;background-color:#1e0010">&#39;</span>m walking outside but not walking
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;Watch the Net&#34;</span>
I<span style="color:#e6db74">&#39;m watching the net, but I&#39;</span>m not checking
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;buy meat&#34;</span>
I buy meat, but not meat
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python abe.py <span style="color:#e6db74">&#34;Burning a fire&#34;</span>
Burns fire, but does not burn
</code></pre></div></div></details>
<h2 id="6-extra-edition-shinjiro-koizumi-syntax">6. <Extra edition> Shinjiro Koizumi Syntax</h2>
<p>Shinjiro Koizumi&rsquo;s **&ldquo;I said that I am reflecting, but I am reflecting.&rdquo; **Inspired by <a href="https://togetter.com/li/1471113">remark</a>, ** I made a program that automatically converts the input sentence to the Shinjiro Koizumi syntax! **</p>
<p>** If you call the above things Shinzo Abe syntax **, in Shinzo Abe syntax it will be called &ldquo;affirmative sentence + similar negative sentence&rdquo;.</p>
<p><img src="https://imgur.com/EI6YHEZ.png" alt="Shinzo Abe Syntax"></p>
<p>On the other hand, <strong>Shinjiro Koizumi syntax is simply &ldquo;affirmative sentence + similar positive sentence&rdquo;</strong>, and I said that it is similar to Shinzo Abe&rsquo;s syntax, but it is similar**. (It just changes the method of combination in step 3.6.)</p>
<p><img src="https://imgur.com/iPpUWQD.png" alt="Shinjiro Koizumi Syntax"></p>
<h3 id="61-i-said-im-trying-but-im-trying">6.1 I said I&rsquo;m trying, but I&rsquo;m trying</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python sexy.py<span style="color:#e6db74">&#39;Keep my promise&#39;</span>
I said that you keep your promise, but you <span style="color:#66d9ef">do</span>.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python sexy.py<span style="color:#e6db74">&#39;Entertaining foreigners&#39;</span>
I said that I am hospitable to foreigners, but I welcome them.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python sexy.py<span style="color:#e6db74">&#39;leave the company&#39;</span>
I said I<span style="color:#e6db74">&#39;m absent from work, but I&#39;</span>m resting.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python sexy.py<span style="color:#e6db74">&#39;Work on environmental issues&#39;</span>
I said I am working on environmental issues, but I am facing it.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python sexy.py<span style="color:#e6db74">&#39;Break NHK&#39;</span>
I said that I am destroying nhk, but I am destroying it.
</code></pre></div><h2 id="7-i-have-summarized-but-not-summarized">7. I have summarized, but not summarized</h2>
<p>We have created a program that automatically converts a sentence into a sentence that says &ldquo;I&rsquo;m recruiting, but not recruiting&rdquo;!
**We are soliciting &ldquo;likes&rdquo; and &ldquo;comments&rdquo;, but not soliciting **.
(If there is a sentence that makes you wonder what the output will be, I will try it, so feel free to comment!)</p>
<h2 id="8-im-watching-but-im-not-referring">8. I&rsquo;m watching but I&rsquo;m not referring</h2>
<ul>
<li><a href="https://api.ce-cotoha.com/contents/api-all.html">COTOHA API List</a></li>
<li><a href="https://qiita.com/gossy5454/items/83072418fb0c5f3e269f">I tried using the COTOHA API rumored to be easy to handle natural language processing with Python</a></li>
<li><a href="https://www.yoheim.net/blog.php?q=20160201">[Natural language] Extracting synonyms with Wordnet Ã— Python</a></li>
<li><a href="http://adsmedia.hatenablog.com/entry/2016/10/20/002211">How to get the utilized adjective by entering the adjective (verb, adjective, adjective verb) and inflected form</a></li>
<li><a href="https://twitter.com/omiita_atiimo">Twitter</a></li>
</ul>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
