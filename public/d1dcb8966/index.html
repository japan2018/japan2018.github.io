<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Getting started with Pydantic | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Getting started with Pydantic</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 4, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/sqlalchemy">sqlalchemy</a></code></small>


<small><code><a href="https://memotut.com/tags/validation">Validation</a></code></small>


<small><code><a href="https://memotut.com/tags/fastapi">FastAPI</a></code></small>


<small><code><a href="https://memotut.com/tags/pydantic">pydantic</a></code></small>

</p>
<pre><code>Hello, are you Kakyo.
</code></pre>
<p>This time, I would like to write an article about pydantic.</p>
<h2 id="what-is-pydantic">What is Pydantic</h2>
<p>Pydantic is a library that uses Python type annotations to provide run-time type hints and to easily provide error settings when validating data.</p>
<p>This library will help you define your database model in SQLAlchemy.</p>
<h2 id="model">model</h2>
<p>First of all, in defining it, define as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime
<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List
<span style="color:#f92672">from</span> pydantic <span style="color:#f92672">import</span> BaseModel

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Summer</span>(BaseModel):
    id: int
    declare the type <span style="color:#66d9ef">as</span> name: str <span style="color:#75715e"># (variable): (type)</span>
    You can also define a default value using friends: List[int] <span style="color:#f92672">=</span> [] <span style="color:#75715e"># &#34;=&#34;</span>
    created_at: datetime


external_data<span style="color:#f92672">=</span>{
    <span style="color:#e6db74">&#39;id&#39;</span>: <span style="color:#e6db74">&#39;1&#39;</span>,
    <span style="color:#e6db74">&#39;name&#39;</span>:<span style="color:#e6db74">&#39;Beast senior&#39;</span>,
    <span style="color:#e6db74">&#39;created_at&#39;</span>: <span style="color:#e6db74">&#39;2019-11-03 03:34&#39;</span>,
    <span style="color:#e6db74">&#39;friends&#39;</span>: [<span style="color:#ae81ff">114</span>,<span style="color:#e6db74">&#39;514&#39;</span>]
}
summer <span style="color:#f92672">=</span> Summer(<span style="color:#f92672">**</span>external_data)

<span style="color:#66d9ef">print</span>(summer<span style="color:#f92672">.</span>id)

<span style="color:#75715e">#&gt; 1 # Even if the input value is string type, it will be converted to Int type automatically</span>

<span style="color:#66d9ef">print</span>(repr(summer<span style="color:#f92672">.</span>created_at))

<span style="color:#75715e">#&gt; datetime.datetime(2019, 11, 3, 3, 34)</span>

<span style="color:#66d9ef">print</span>(user<span style="color:#f92672">.</span>friends)

<span style="color:#75715e">#&gt; [114,514]</span>

<span style="color:#66d9ef">print</span>(user<span style="color:#f92672">.</span>dict())

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">{
</span><span style="color:#e6db74">   &#39;id&#39;: 1,
</span><span style="color:#e6db74">   &#39;name&#39;:&#39;Beast senior&#39;,
</span><span style="color:#e6db74">   &#39;created_at&#39;: datetime.datetime(2019, 11, 3, 3, 34),
</span><span style="color:#e6db74">   &#39;friends&#39;: [114, 514]
</span><span style="color:#e6db74">}
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</code></pre></div><p>Then, when a Validation Error occurs, it looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">try</span>:
    User(created_at<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black paint&#34;</span>, friends<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;2&#39;</span>,<span style="color:#e6db74">&#39;luxury car&#39;</span>]])

<span style="color:#66d9ef">except</span> ValidationError <span style="color:#66d9ef">as</span> e:
    <span style="color:#66d9ef">print</span>(e<span style="color:#f92672">.</span>json())

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">[
</span><span style="color:#e6db74">  {
</span><span style="color:#e6db74">    &#34;loc&#34;: [
</span><span style="color:#e6db74">      &#34;id&#34;
</span><span style="color:#e6db74">    ],
</span><span style="color:#e6db74">    &#34;msg&#34;: &#34;field required&#34;,
</span><span style="color:#e6db74">    &#34;type&#34;: &#34;value_error.missing&#34;
</span><span style="color:#e6db74">  },
</span><span style="color:#e6db74">  {
</span><span style="color:#e6db74">    &#34;loc&#34;: [
</span><span style="color:#e6db74">      &#34;name&#34;
</span><span style="color:#e6db74">    ],
</span><span style="color:#e6db74">    &#34;msg&#34;: &#34;field required&#34;,
</span><span style="color:#e6db74">    &#34;type&#34;: &#34;value_error.missing&#34;
</span><span style="color:#e6db74">  },
</span><span style="color:#e6db74">  {
</span><span style="color:#e6db74">    &#34;loc&#34;: [
</span><span style="color:#e6db74">      &#34;created_at&#34;
</span><span style="color:#e6db74">    ],
</span><span style="color:#e6db74">    &#34;msg&#34;: &#34;invalid datetime format&#34;,
</span><span style="color:#e6db74">    &#34;type&#34;: &#34;type_error.datetime&#34;
</span><span style="color:#e6db74">  },
</span><span style="color:#e6db74">  {
</span><span style="color:#e6db74">    &#34;loc&#34;: [
</span><span style="color:#e6db74">      &#34;friends&#34;,
</span><span style="color:#e6db74">      2
</span><span style="color:#e6db74">    ],
</span><span style="color:#e6db74">    &#34;msg&#34;: &#34;value is not a valid integer&#34;,
</span><span style="color:#e6db74">    &#34;type&#34;: &#34;type_error.integer&#34;
</span><span style="color:#e6db74">  }
</span><span style="color:#e6db74">]
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</code></pre></div><p>Here are the objects returned when an error occurs:</p>
<ul>
<li>loc
-It tells you where the error is occurring in list form.
-The first element shows the error location and the next element shows the location of the nested error location.</li>
<li>type
-Indicates the type of error</li>
<li>msg
-Explains the reason for the error.</li>
<li>ctx:
-Return any object set by itself
-Set to return error message to use this function</li>
</ul>
<h2 id="try-combining-with-sqlalchemy">Try combining with SQLAlchemy</h2>
<p>Now, using SQLAlchemy which is Python ORM Wrapper,
You can design the SQL model.</p>
<p>The following code is from <a href="https://pydantic-docs.helpmanual.io/usage/models/">here</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List
<span style="color:#f92672">from</span> sqlalchemy <span style="color:#f92672">import</span> Column, Integer, String
<span style="color:#f92672">from</span> sqlalchemy.dialects.postgresql <span style="color:#f92672">import</span> ARRAY
<span style="color:#f92672">from</span> sqlalchemy.ext.declarative <span style="color:#f92672">import</span> declarative_base
<span style="color:#f92672">from</span> pydantic <span style="color:#f92672">import</span> BaseModel, constr

Base <span style="color:#f92672">=</span> declarative_base()

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CompanyOrm</span>(Base):
    __tablename__ <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;companies&#39;</span>
    id <span style="color:#f92672">=</span> Column(Integer, primary_key<span style="color:#f92672">=</span>True, nullable<span style="color:#f92672">=</span>False)
    public_key <span style="color:#f92672">=</span> Column(String(<span style="color:#ae81ff">20</span>), index<span style="color:#f92672">=</span>True, nullable<span style="color:#f92672">=</span>False, unique<span style="color:#f92672">=</span>True)
    name <span style="color:#f92672">=</span> Column(String(<span style="color:#ae81ff">63</span>), unique<span style="color:#f92672">=</span>True)
    domains <span style="color:#f92672">=</span> Column(ARRAY(String(<span style="color:#ae81ff">255</span>)))

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CompanyModel</span>(BaseModel):
    id: int
    public_key: constr(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
    name: constr(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">63</span>)
    domains: List[constr(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">255</span>)]

    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Config</span>:
        orm_mode <span style="color:#f92672">=</span> True
        
co_orm <span style="color:#f92672">=</span> CompanyOrm(
    id<span style="color:#f92672">=</span><span style="color:#ae81ff">123</span>,
    public_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;foobar&#39;</span>,
    name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Testing&#39;</span>,
    domains<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;example.com&#39;</span>,<span style="color:#e6db74">&#39;foobar.com&#39;</span>]
)
<span style="color:#66d9ef">print</span>(co_orm)
<span style="color:#75715e">#&gt; &lt;orm_mode.CompanyOrm object at 0x7f0de1bc1cd0&gt;</span>
co_model <span style="color:#f92672">=</span> CompanyModel<span style="color:#f92672">.</span>from_orm(co_orm)
<span style="color:#66d9ef">print</span>(co_model)
<span style="color:#75715e">#&gt; id=123 public_key=&#39;foobar&#39; name=&#39;Testing&#39; domains=[&#39;example.com&#39;,</span>
<span style="color:#75715e">#&gt;&#39;foobar.com&#39;]</span>

</code></pre></div><h2 id="validators">Validators</h2>
<p>The <strong>Validator Decorator</strong> can be used to refer to the correctness of the entered values and the complex relationships between objects.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pydantic <span style="color:#f92672">import</span> BaseModel, ValidationError, validator

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserModel</span>(BaseModel):
    name: str
    username: str
    password1: str
    password2: str

    <span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;name&#39;</span>)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">name_must_contain_space</span>(cls, v):
        <span style="color:#66d9ef">if</span><span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> v:
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;must contain a space&#39;</span>)
        <span style="color:#66d9ef">return</span> v<span style="color:#f92672">.</span>title()

    <span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;password2&#39;</span>)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">passwords_match</span>(cls, v, values, <span style="color:#f92672">**</span>kwargs):
        <span style="color:#66d9ef">if</span><span style="color:#e6db74">&#39;password1&#39;</span> <span style="color:#f92672">in</span> values <span style="color:#f92672">and</span> v <span style="color:#f92672">!=</span> values[<span style="color:#e6db74">&#39;password1&#39;</span>]:
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;passwords do not match&#39;</span>)
        <span style="color:#66d9ef">return</span> v

    <span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;username&#39;</span>)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">username_alphanumeric</span>(cls, v):
        <span style="color:#66d9ef">assert</span> v<span style="color:#f92672">.</span>isalpha(),<span style="color:#e6db74">&#39;must be alphanumeric&#39;</span>
        <span style="color:#66d9ef">return</span> v

<span style="color:#66d9ef">print</span>(UserModel(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;samuel colvin&#39;</span>, username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;scolvin&#39;</span>, password1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;zxcvbn&#39;</span>,
                password2<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;zxcvbn&#39;</span>))
<span style="color:#75715e">#&gt; name=&#39;Samuel Colvin&#39; username=&#39;scolvin&#39; password1=&#39;zxcvbn&#39; password2=&#39;zxcvbn&#39;</span>

<span style="color:#66d9ef">try</span>:
    UserModel(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;samuel&#39;</span>, username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;scolvin&#39;</span>, password1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;zxcvbn&#39;</span>,
              password2<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;zxcvbn2&#39;</span>)
<span style="color:#66d9ef">except</span> ValidationError <span style="color:#66d9ef">as</span> e:
    <span style="color:#66d9ef">print</span>(e)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">2 validation errors for UserModel
</span><span style="color:#e6db74">name
</span><span style="color:#e6db74">  must contain a space (type=value_error)
</span><span style="color:#e6db74">password2
</span><span style="color:#e6db74">  passwords do not match (type=value_error)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</code></pre></div><h3 id="pre-and-per-item-validators">Pre and per-item validators</h3>
<p>Use the following arguments <code>pre</code>,<code>pre_item</code> to set the priority order when starting Validator.
<code>pre</code> starts Validator before other Validators that have been set.
If you set <code>each_item=True</code>, Validation will be executed for each element such as list and dictionary.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List
<span style="color:#f92672">from</span> pydantic <span style="color:#f92672">import</span> BaseModel, ValidationError, validator

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DemoModel</span>(BaseModel):
    square_numbers: List[int] <span style="color:#f92672">=</span> []
    cube_numbers: List[int] <span style="color:#f92672">=</span> []

    <span style="color:#75715e">#&#39;*&#39; is the same as&#39;cube_numbers&#39;,&#39;square_numbers&#39; here:</span>
    <span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;*&#39;</span>, pre<span style="color:#f92672">=</span>True)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">split_str</span>(cls, v):
        <span style="color:#66d9ef">if</span> isinstance(v, str):
            <span style="color:#66d9ef">return</span> v<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;|&#39;</span>)
        <span style="color:#66d9ef">return</span> v<span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;cube_numbers&#39;</span>, <span style="color:#e6db74">&#39;square_numbers&#39;</span>)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_sum</span>(cls, v):
        <span style="color:#66d9ef">if</span> sum(v) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">42</span>:
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(f<span style="color:#e6db74">&#39;sum of numbers greater than 42&#39;</span>)
        <span style="color:#66d9ef">return</span> v

    <span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;square_numbers&#39;</span>, each_item<span style="color:#f92672">=</span>True)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_squares</span>(cls, v):
        <span style="color:#66d9ef">assert</span> v <span style="color:#f92672">**</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>, f<span style="color:#e6db74">&#39;{v} is not a square number&#39;</span>
        <span style="color:#66d9ef">return</span> v

    <span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;cube_numbers&#39;</span>, each_item<span style="color:#f92672">=</span>True)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_cubes</span>(cls, v):
        <span style="color:#75715e"># 64 ** (1 / 3) == 3.9999999999999996 (!)</span>
        <span style="color:#75715e"># this is not a good way of checking cubes</span>
        <span style="color:#66d9ef">assert</span> v <span style="color:#f92672">**</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>, f<span style="color:#e6db74">&#39;{v} is not a cubed number&#39;</span>
        <span style="color:#66d9ef">return</span> v

<span style="color:#66d9ef">print</span>(DemoModel(square_numbers<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>]))
<span style="color:#75715e">#&gt; square_numbers=[1, 4, 9] cube_numbers=[]</span>
<span style="color:#66d9ef">print</span>(DemoModel(square_numbers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1|4|16&#39;</span>))
<span style="color:#75715e">#&gt; square_numbers=[1, 4, 16] cube_numbers=[]</span>
<span style="color:#66d9ef">print</span>(DemoModel(square_numbers<span style="color:#f92672">=</span>[<span style="color:#ae81ff">16</span>], cube_numbers<span style="color:#f92672">=</span>[<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">27</span>]))
<span style="color:#75715e">#&gt; square_numbers=[16] cube_numbers=[8, 27]</span>
<span style="color:#66d9ef">try</span>:
    DemoModel(square_numbers<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>])
<span style="color:#66d9ef">except</span> ValidationError <span style="color:#66d9ef">as</span> e:
    <span style="color:#66d9ef">print</span>(e)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">1 validation error for DemoModel
</span><span style="color:#e6db74">square_numbers -&gt; 2
</span><span style="color:#e6db74">  2 is not a square number (type=assertion_error)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#66d9ef">try</span>:
    DemoModel(cube_numbers<span style="color:#f92672">=</span>[<span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">27</span>])
<span style="color:#66d9ef">except</span> ValidationError <span style="color:#66d9ef">as</span> e:
    <span style="color:#66d9ef">print</span>(e)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">1 validation error for DemoModel
</span><span style="color:#e6db74">cube_numbers
</span><span style="color:#e6db74">  sum of numbers greater than 42 (type=value_error)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</code></pre></div><h3 id="validate-always">Validate Always</h3>
<p>パフォーマンスの理由から、デフォルトで、値が与えられていない場合ではこのValidatorは起動しません。しかし、値が与えられていない場合でも実行させるためには、引数を<code>always= True</code> と設定する必要があります。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime

<span style="color:#f92672">from</span> pydantic <span style="color:#f92672">import</span> BaseModel, validator

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DemoModel</span>(BaseModel):
    ts: datetime <span style="color:#f92672">=</span> None

    <span style="color:#a6e22e">@validator</span>(<span style="color:#e6db74">&#39;ts&#39;</span>, pre<span style="color:#f92672">=</span>True, always<span style="color:#f92672">=</span>True)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_ts_now</span>(cls, v):
        <span style="color:#66d9ef">return</span> v <span style="color:#f92672">or</span> datetime<span style="color:#f92672">.</span>now()

<span style="color:#66d9ef">print</span>(DemoModel())
<span style="color:#75715e">#&gt; ts=datetime.datetime(2019, 10, 24, 15, 7, 51, 449261)</span>
<span style="color:#66d9ef">print</span>(DemoModel(ts<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2017-11-08T14:00&#39;</span>))
<span style="color:#75715e">#&gt; ts=datetime.datetime(2017, 11, 8, 14, 0)</span>

</code></pre></div><h2 id="最後に">最後に</h2>
<p>以上が、基本的なPydantic の使い方です。これを利用して、 SQLのスチーマにバリデーションや型をPythonで設定できます。
詳細な設定については、以下の公式ドキュメントを参照ください。</p>
<h2 id="参考文献">参考文献</h2>
<p>Pydanit 公式ドキュメント(<a href="https://pydantic-docs.helpmanual.io/">https://pydantic-docs.helpmanual.io/</a>)</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
