<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] [Competition Pro] Use the route to solve the number of M cards taken out from N cards [Explanation with the figure] | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] [Competition Pro] Use the route to solve the number of M cards taken out from N cards [Explanation with the figure]</h1>
<p>
  <small class="text-secondary">
  
  
  Mar 11, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/algorithms"> algorithms</a></code></small>


<small><code><a href="https://memotut.com/tags/mathematics"> mathematics</a></code></small>


<small><code><a href="https://memotut.com/tags/competitive-programming"> competitive programming</a></code></small>

</p>
<pre><code>I found an interesting problem, so I tried solving it.
</code></pre>
<h1 id="problem">Problem</h1>
<blockquote>
There are $N$ cards, and the $i$th card has $A_i$ written on it. <br>
T picks out $M$ from this at the same time. How many pairs of numbers are there on the removed card? <br>
However, it does not distinguish pairs such as $(1,2)$ and $(2,1)$ whose order is changed. <br>
<br>
For example, consider the case where $N=5$, $M=2$, $\{A\}=\{1,2,2,3,4\}$. In this case, $(1,2),(1,3),(1,4),(2,2),(2,3),(2,4),(3,4)$ $7$ streets There is a pair.
</blockquote>
<p><a href="https://qiita.com/Rho/items/1e0f72cf7e1cbc28a51a">I&rsquo;m not scared of counting anymore ~35 competitive pro counting problems ~-Qiita</a> has been partially modified.</p>
<h1 id="the-person-who-wrote-this-article">The person who wrote this article</h1>
<p>The person who writes this article is new to competitive programming.
I don&rsquo;t really know the manners of competitive professionals, so please be patient.</p>
<h1 id="prerequisite-knowledge">Prerequisite knowledge</h1>
<h2 id="number-of-grid-paths">Number of grid paths</h2>
<p>Consider such a grid-like path.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/1fd8a14a-e8e0-b48c-af62-aff353d03c54.png" alt="n_m_lattice.png"></p>
<p>If you can only go to the right or up, the number of routes from $P$ to $Q$ is</p>
<pre><code class="language-math" data-lang="math">{}_{n+m} \mathrm{C} _m
</code></pre><p>is.</p>
<h2 id="calculate-the-number-of-routes-for-each-step">Calculate the number of routes for each step</h2>
<p>In the above-mentioned problem of the number of lattice paths, the number of paths to a certain point $(p, q)$ is $(p-1, q)$ with $p$ on the horizontal axis and $q$ on the vertical axis. And the number of routes to $(p, q-1)$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/e0bee428-fb15-cf9e-b99f-b40e7ab73a0c.png" alt="p_q_plus_from_previous.png"></p>
<p>Using this property, the distance <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> from $P$ is increased by $1$. Going to the end, you will get the desired value.
Let&rsquo;s check with the grid of $ 4 \times 3 $.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/6e9f581e-4aec-6ea2-7420-a602403ad8b8.png" alt="step_lattice_1.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/e1ed7fc9-3216-eac6-5b31-e5669dba7a07.png" alt="step_lattice_2.png"></p>
<p>It turns out that the number of paths in the lattice of $4 \times 3$ is 35. This result matches ${}_7 \mathrm{C} _3=35$.</p>
<h2 id="grid-deformation">Grid deformation</h2>
<p>A grid like this will appear in the following sections. The number of combinations does not change even if the vertical axis is diagonal.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/0ae35abb-628e-474e-1505-221e012f701a.png" alt="sloping_lattice.png"></p>
<h1 id="main-algorithm">Main algorithm</h1>
<blockquote>
There are $N$ cards, and the $i$th card has $A_i$ written on it. <br>
T picks out $M$ from this at the same time. How many pairs of numbers are there on the removed card? <br>
However, it does not distinguish pairs such as $(1,2)$ and $(2,1)$ whose order is changed. <br>
</blockquote>
<p>Consider the case of $N=7$, $M=4$, $\{A\}=\{1,2,2,3,3,3,4\}$.</p>
<h2 id="creating-a-grid">Creating a grid</h2>
<p>First, create the following grid.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/d7933da3-5bdb-ba4a-721e-2805934658a6.png" alt="choice_lattice.png"></p>
<p>Write the numbers included in $A$ on the horizontal axis of the grid. If the numbers are the same, write them consecutively.
The solid black line indicates whether to use the numbers written below. Moving to the upper right means using that number, and moving to the right means not using that number.</p>
<p>For example,</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/7dcfcc2c-c041-48bf-d811-a50f758b9552.png" alt="choice_1234.png"></p>
<p>Paths shown in pink indicate selecting $(1, 2, 3, 4)$.</p>
<p>Similarly,</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/e6ad714a-53c3-e3b3-ba3d-e40dac26dd75.png" alt="choice_2233.png"></p>
<p>Means select $( 2, 2, 3, 3)$.</p>
<h2 id="duplicate-combination">Duplicate combination</h2>
<p>in this way,</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/1474916f-f3ce-1abc-c46a-59d2fe5613d9.png" alt="choice_2334_1.png"></p>
<p>When</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/a868bdd9-50a0-bb84-37d9-ff4c3e099879.png" alt="choice_2334_2.png"></p>
<p>Both indicate that $(2, 3, 3, 4)$ is selected, and there are multiple routes for a combination.</p>
<h2 id="avoid-duplicate-combinations">Avoid duplicate combinations</h2>
<p>Change the route so that there is one route for one combination.
When selecting a number, change to the route <strong>If there is the same number, select all the same numbers to the right of the selected number</strong>. This will eliminate duplicate combinations.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/ded9a3fc-5227-94d2-c348-cf56b10b13d6.png" alt="change_choice_path.png"></p>
<p>The light blue line is the deleted route, and the red line is the added route. If you select $2$ on the left, also select $2$ on the right. Similarly, if you select the leftmost $3$, select the remaining two $3$, and if you select the middle $3$, select the right $3$.</p>
<p>As a result, the following routes are the only routes that select $(2, 3, 3, 4)$.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/4bf2dd8f-b0af-3155-29a4-3bca3f1c0ebc.png" alt="choice_2334_fix.png"></p>
<h2 id="counting">counting</h2>
<p>Count up with the created route.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/d9bab8ba-ebbb-b528-d638-223f91a7fad2.png" alt="step_wind_lattice_1.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/ca4d136b-b7e9-b25e-f66d-8e5ff7e20575.png" alt="step_wind_lattice_2.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/df000293-1c35-3083-11c2-c853837faa94.png" alt="step_wind_lattice_3.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/c1f68c43-4a5f-eb8a-74da-7e91f4372844.png" alt="step_wind_lattice_4.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/d3ee0975-c1cd-295f-3a99-db4349bab9ca.png" alt="step_wind_lattice_5.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/a2cbe66d-0337-6d41-8cfe-b22a5d2501f7.png" alt="step_wind_lattice_6.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/a22db930-a9ac-c0df-422b-3ab706285264.png" alt="step_wind_lattice_7.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/675555cb-9241-804e-a27d-f9a7a2f873cd.png" alt="step_wind_lattice_8.png"></p>
<p>By this operation, it turns out that the number when choosing four from $\{A\}=\{1,2,2,3,3,3,4\}$ is $11$. It was</p>
<h2 id="how-to-select-duplicate-numbers">How to select duplicate numbers</h2>
<p>Here, pay attention to the part shown in red.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/4d0a5d81-3623-1c0e-6ba2-2114b80e061e.png" alt="three_from_1.png"></p>
<p>This number is the sum of the orange boxes.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/20f4dc00-21a8-38b3-9281-a31d98bd1cb8.png" alt="three_from_2.png"></p>
<p>Similarly, the part shown in red in the following figure is the addition of the part surrounded by orange.<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/4e74a857-7b5f-92b8-7825-c790df4a0e21.png" alt="three_from_3.png"></p>
<p>Similarly, the part shown in red in the following figure is the addition of the part surrounded by orange.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/175fd375-0921-24fc-0f68-20fa94c2b759.png" alt="two_from_1.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/9b43325c-375a-63ef-8d19-985947d98cdb.png" alt="two_from_2.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/19ee5c25-a857-d0a0-2cbb-b401b3a3d64b.png" alt="two_from_3.png"></p>
<p>In a normal grid, the number of paths to the point $(p, q)$ is the sum of the number of paths to $(p-1, q)$ and the number of paths to $(p, q-1)$. did.</p>
<p>Similarly, if there are two same numbers, the number of routes to $(p, q)$ is $(p-2, q)$, $(p-1, q-1)$, $(p, q -2)$ The total number of routes.</p>
<p>Similarly, if there are three same numbers, the number of routes to $(p, q)$ is $(p-3, q)$, $(p-2, q-1)$, $(p-1 , p-2)$, $(p, q-3)$ The number of each route is added.</p>
<p>You can see that the route diagram can be rewritten as:</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/deb866ee-1c4a-c9db-c0a1-f7b0a6ce5d6c.png" alt="duplicated_choice_lattice.png"></p>
<h2 id="count-again">Count (again)</h2>
<p>Count again with the rewritten path.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/577e7f98-c8a8-28a8-c779-efdb65e79754.png" alt="step_last_lattice_1.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/455a3611-f19b-9399-2f32-b925899ded99.png" alt="step_last_lattice_2.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/07a44fcd-8b28-89a3-cc23-2a04523f1b25.png" alt="step_last_lattice_3.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/e493a755-77be-7bb1-3197-f6eb7d900f30.png" alt="step_last_lattice_4.png">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/4af6a1d6-ddc3-d8de-2284-b92075b0e8ba.png" alt="step_last_lattice_5.png"></p>
<p>So far, we have seen a concrete example of an algorithm that selects $M$ cards from $N$ cards that contain duplicate numbers.</p>
<h1 id="algorithm">Algorithm</h1>
<p>Generalize the above algorithm.</p>
<ul>
<li>$A$ represents a set of cards</li>
<li>$route(p, q)$ represents the number of routes to the point (p, q)$. $route(0, 0) = 1$</li>
<li>Express the distance from the origin with $step$. The initial value of step is $0$</li>
</ul>
<ol>
<li>Repeat the following until $A$ is empty
2. Take out one type of number $a$ from $A$ and delete from $A$. Let $c$ be the number of $a$
3. Add $c$ to $step$
4.For an integer $(p, q)$ that satisfies $p + q = step\ (0 \leqq p \leqq N-M, 0 \leqq q \leqq M)$,
$route(p, q) = route(p-c, q) + route(p-c + 1, q -1) + route(p-c + 2, q-2) + &hellip; + route(p -1, q- (c -1)) + route(p, q-c)$</li>
<li>$route(N-M, M)$ is the required number.</li>
</ol>
<h1 id="algorithm-correction">Algorithm correction</h1>
<p>The algorithm above is $M=2$, $M=2$, $\{A\}=\{1,2,2,3,3,3,4\}$, $M$ It won&rsquo;t work if you have a number with a higher degree of duplication (this time there are three $3$). If there are more than $M$ duplicate numbers, you need to reduce the degree of duplication to $M$ in advance.</p>
<h1 id="algorithm-improvements">Algorithm improvements</h1>
<h2 id="arrange-by-the-degree-of-duplication-of-numbers">Arrange by the degree of duplication of numbers</h2>
<p>Let&rsquo;s arrange the numbers according to the degree of overlap. Write the number that appears only once on the left side.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/aa58e896-745a-c2d4-2328-ae31eff70233.png" alt="sort_by_duplication.png"></p>
<p>If it appears only once, the number can be calculated.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/288329/7e2771a1-1591-fbdd-63a7-c1f152965661.png" alt="calc_one_combi.png"></p>
<p>(This is why $step$ does not start at $0$ in the linked program.)</p>
<p>In the case of a simple lattice, the coefficient when expanding $(x + y)^n$ appears on the diagonal (Pascal&rsquo;s triangle/binomial theorem).</p>
<p>Similarly, there is regularity when the same number appears twice, but it has not been generalized well (I). The number of two occurrences is related to the coefficient of $(x^2 + x + 1)^n$. This property can be used to further improve the algorithm.</p>
<p>#Code
I implemented the above algorithm in Python (version 3.7).
<a href="https://github.com/yucatio/python-permutation-combination/blob/master/permcombi/combination.py#L24">combination.count_uniq_combination_lattice</a></p>
<p>I&rsquo;m checking if the program is correct by checking if it is the same as this stupid solution.
<a href="https://github.com/yucatio/python-permutation-combination/blob/master/permcombi/combination.py#L15">combination.count_uniq_combination_simple</a></p>
<h1 id="reference-link">Reference link</h1>
<ul>
<li>[Primary Number Theory/Pascal&rsquo;s Triangle-Wikibooks](<a href="https://en.wikibooks.org/wiki/%E5%88%9D%E7%AD%89%E6%95%B4%E6%95%B0%E8%AB%96/%E3%83%91%E3%82%B9%E3%82%AB%E3%83%AB%E3%81%AE%E4%B8%89%E8%A7%92%E5(%BD%A2)">https://en.wikibooks.org/wiki/%E5%88%9D%E7%AD%89%E6%95%B4%E6%95%B0%E8%AB%96/%E3%83%91%E3%82%B9%E3%82%AB%E3%83%AB%E3%81%AE%E4%B8%89%E8%A7%92%E5(%BD%A2)</a></li>
</ul>
<p>#Postscript
When I first saw the problem, I thought, &ldquo;I don&rsquo;t know where to start.&rdquo;
Now that I&rsquo;ve written a commentary article, I&rsquo;m starting to think, &ldquo;That&rsquo;s surprisingly simple, and it might be common sense in the competitive professional world.&rdquo;
Maybe there is a similar commentary article already, but I will publish it because it was good for organizing myself.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>The distance here is the length of the nearest intersection from the grid intersection as 1. <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
