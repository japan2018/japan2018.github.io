<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Disguise IP using tor on macOS and check with python | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Disguise IP using tor on macOS and check with python</h1>
<p>
  <small class="text-secondary">
  
  
  Jan 28, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/mac"> Mac</a></code></small>


<small><code><a href="https://memotut.com/tags/scraping"> scraping</a></code></small>


<small><code><a href="https://memotut.com/tags/tor"> Tor</a></code></small>


<small><code><a href="https://memotut.com/tags/ip-address"> IP address</a></code></small>

</p>
<pre><code>I was writing because I was thinking of scraping with python,
</code></pre>
<p>If the same IP address is accessed for a certain period of time, the access will be denied for a while.
When a site like this appears, it may not be possible to scrape well, so
I will try to impersonate the IP address and scrape.</p>
<p>However, since the operation is confirmed only for macOS, I think that the method is a little different especially for windows.</p>
<p>By the way, camouflage has a bad impression, but it does not mean that it is bad.
Of course, when scraping, please consider the execution time of the program so as not to load the target server.</p>
<h1 id="things-necessary">Things necessary</h1>
<ul>
<li>macOS</li>
<li>python3
-requests library
-beautifulsoup4 library</li>
<li>tor</li>
</ul>
<h2 id="python-installation">Python installation</h2>
<p>Please install 3 system.
(I think that it works with 2 system, but the operation has not been confirmed)</p>
<h2 id="requests-library-installation">requests library installation</h2>
<p>It is a library that calls an external URL (API) from python.
It&rsquo;s like ajax in javascript.</p>
<p>Install with the following command</p>
<pre><code>pip install requests
</code></pre><h2 id="beautifulsoup4-library-installation">beautifulsoup4 library installation</h2>
<p>It is a library that you can get the text after requesting the text and adding more detailed conditions.</p>
<pre><code>pip install beautifulsoup4
</code></pre><h2 id="tor">tor</h2>
<p>This is tor that allows anonymous communication. Use this for IP disguise.
<a href="https://www.torproject.org/">https://www.torproject.org/</a></p>
<p>Install with the following command.</p>
<pre><code>brew install tor
</code></pre><p>After installation, enter the following command</p>
<pre><code>tor
</code></pre><p>Various processing will be started.
It is completed when the following conditions occur.</p>
<pre><code>Jan 28 00:29:59.000 [notice] Bootstrapped 100% (done): Done
</code></pre><p>Then start tor.</p>
<pre><code>brew services start tor
</code></pre><p>It is OK if you can get <strong>successfully</strong> English.</p>
<h2 id="python-programming">python programming</h2>
<p>Now let&rsquo;s write python.
This time, I tried to access the URL to get my own IP address and see the result.</p>
<p>You can check your own IP address at the following site.
<a href="https://grupo.jp/myip/">https://grupo.jp/myip/</a></p>
<p><strong>test.py</strong></p>
<pre><code>#UTF-8
import requests
from bs4 import BeautifulSoup

get = requests.get('http://httpbin.org/ip').text
soup = BeautifulSoup(get,'html.parser')
ip = soup.find('table', class_='pubwaku')

print(get)

</code></pre><p>First, execute normal scraping</p>
<pre><code>python test.py
</code></pre><p>The following results are returned.
A lot of HTML data will be returned, but look for the location where the IP address and remote host are written as follows.</p>
<pre><code>&lt;tr&gt;&lt;th&gt;IP address&lt;/th&gt;&lt;td style=&quot;font-size:18px;font-weight:bold;&quot;&gt;153.999.999.99&lt;/td&gt;&lt;td class=&quot;commentary&quot;&gt;Currently connected IP address&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;th&gt;Remote host&lt;/th&gt;&lt;td&gt;p554999-************.*****.ne.jp&lt;/td&gt;&lt;td class=&quot;commentary&quot; &gt;Host name associated with IP address&lt;/td&gt;&lt;/tr&gt;
</code></pre><p><strong>IP address</strong>
153.999.999.99</p>
<p><strong>Remote host</strong>
p554999-*******<em><strong><strong>.</strong></strong></em>.ne.jp</p>
<p>*Some changes and ambiguous letters have been made.</p>
<h3 id="this-is-normal-scraping-but-by-changing-the-description-below-it-will-be-scraping-using-tor">This is normal scraping, but by changing the description below, it will be scraping using tor.</h3>
<p><strong>test.py</strong></p>
<pre><code>#UTF-8
import requests
from bs4 import BeautifulSoup

get = requests.get('https://grupo.jp/myip/',
                    proxies=dict(http='socks5://127.0.0.1:9050',
                                 https='socks5://127.0.0.1:9050')).text

soup = BeautifulSoup(get,'html.parser')
ip = soup.find('table', class_='pubwaku')
                                 
print(ip)

</code></pre><p>Added proxies part in requests.</p>
<p>Execution</p>
<pre><code>python test.py
</code></pre><p>Let&rsquo;s see the result.
Again find the location where the IP and remote host are written.</p>
<p>The following results are returned.
A lot of HTML data will be returned, but look for the location where the IP address and remote host are written as follows.</p>
<pre><code>&lt;tr&gt;&lt;th&gt;IP address&lt;/th&gt;&lt;td style=&quot;font-size:18px;font-weight:bold;&quot;&gt;82.223.99.999&lt;/td&gt;&lt;td class=&quot;commentary&quot;&gt;Currently connected IP address&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;th&gt;Remote host&lt;/th&gt;&lt;td&gt;tornode3.*******.net&lt;/td&gt;&lt;td class=&quot;commentary&quot;&gt;Host name associated with IP address&lt;/td &gt;&lt;/tr&gt;
</code></pre><p><strong>IP address</strong>
82.223.99.999</p>
<p><strong>Remote host</strong>
tornode3.*******.net</p>
<p>*Some changes and ambiguous letters have been made.</p>
<p>As you can see, the remote host is suitable as well as the IP address.</p>
<h4 id="even-if-you-run-testpy-again-the-ip-address-remains-as-it-is-if-you-want-to-change-the-ip-address-again-restart-tor">Even if you run test.py again, the IP address remains as it is. If you want to change the IP address again, restart tor.</h4>
<p>Reboot</p>
<pre><code>brew services restart tor
</code></pre><p>run test.py</p>
<pre><code>python test.py
</code></pre><p>Check the result.</p>
<pre><code>&lt;tr&gt;&lt;th&gt;IP address&lt;/th&gt;&lt;td style=&quot;font-size:18px;font-weight:bold;&quot;&gt;109.70.999.99&lt;/td&gt;&lt;td class=&quot;commentary&quot;&gt;Currently connected IP address&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;th&gt;remote host&lt;/th&gt;&lt;td&gt;tor-exit-anonymizer.********.net&lt;/td&gt;&lt;td class=&quot;commentary&quot;&gt;Linked to IP address Host name &lt;/td&gt;&lt;/tr&gt;
</code></pre><p><strong>IP address</strong>
109.70.999.99</p>
<p><strong>Remote host</strong>
tor-exit-anonymizer.********.net</p>
<p>*Some changes and ambiguous letters have been made.</p>
<h2 id="summary">Summary</h2>
<p>What do you think.
As mentioned above, it is easy to falsify IP addresses.
So, in terms of DoS attacks, IP checking is useless.
To change the IP address, you have to restart the tor, and restarting will take some time.
Therefore, it is difficult to attack with different IP addresses hundreds of times per second.
Therefore, if there is a certain number of accesses from the same IP address, a program that temporarily refuses it is effective to some extent.
<strong>However, it has no effect on DDos attacks</strong></p>
<p>Stop wasting access and mischief with scraping.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
