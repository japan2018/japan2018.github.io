<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] How to use machine learning for work? 03_Python coding procedure | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] How to use machine learning for work? 03_Python coding procedure</h1>
<p>
  <small class="text-secondary">
  
  
  Jan 2, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/machine-learning"> machine learning</a></code></small>


<small><code><a href="https://memotut.com/tags/scikit-learn"> scikit-learn</a></code></small>


<small><code><a href="https://memotut.com/tags/deep-learning"> deep learning</a></code></small>


<small><code><a href="https://memotut.com/tags/ai"> AI</a></code></small>

</p>
<pre><code>## Introduction
</code></pre>
<p>So far, I&rsquo;ve delivered an article with the theme &ldquo;How to use machine learning for work?&rdquo;
In this third installment, we will introduce concrete programming under the theme of &ldquo;Python coding procedure&rdquo;.</p>
<p>If you also read the back number, you can understand the whole from machine learning basics to Python coding, so please use it.</p>
<ul>
<li><a href="https://qiita.com/Saku731/items/a708ec5c7cbc54e2c1ef">Part 1: Understanding the purpose of machine learning</a></li>
<li><a href="https://qiita.com/Saku731/items/4bbb0798cd55a17e34f0">Part 2: Overview of AI development project</a></li>
</ul>
<p>Since various information is also sent on SNS, please feel free to read the article.
<a href="https://twitter.com/Koji21825331">Twitter account &ldquo;Saku731&rdquo;</a> would be happy to follow you.</p>
<h2 id="programming-skills-required-for-machine-learning">Programming skills required for machine learning</h2>
<p>First, the skills required to acquire machine learning are as follows.
Let&rsquo;s code these one by one.</p>
<ul>
<li>
<ol>
<li>Visualization of data: Determine the preprocessing policy by grasping the overall feeling of the data</li>
</ol>
</li>
<li>
<ol start="2">
<li>Data pre-processing: Clean the data so that the prediction accuracy is high.</li>
</ol>
</li>
<li>
<ol start="3">
<li>Selection of algorithm: Decide appropriate algorithm for data</li>
</ol>
</li>
<li>
<ol start="4">
<li>Model learning: Let the computer learn the law of data</li>
</ol>
</li>
<li>
<ol start="5">
<li>Model validation: Confirm the prediction accuracy of the completed model</li>
</ol>
</li>
</ul>
<h2 id="build-python-environment-even-if-you-skip-it">Build Python environment (even if you skip it)</h2>
<p><strong>Jupyter Notebook</strong> is required for programming in Python.</p>
<p>If your PC does not have a programming environment, please refer to the following to prepare.
This is a very polite document, so don&rsquo;t worry if you are a beginner.</p>
<ul>
<li><a href="https://play.kikagaku.co.jp/src/00_windows.html">For Windows</a></li>
<li><a href="https://play.kikagaku.co.jp/src/00_mac.html">For Mac users</a></li>
</ul>
<h2 id="preparation-acquisition-of-data-to-be-used">Preparation) Acquisition of data to be used</h2>
<p>Recently, &ldquo;Titanic&rdquo; data is often used in every web service including Kaggle. In other words, even if you have trouble studying, there are many reference articles, so I will use Titanic data in this article as well.</p>
<p>Please download the data from <a href="https://drive.google.com/drive/folders/1pZb23ZVB6PGXmawt7BXOzTtmVhVpn7IO?usp=sharing">here</a>.
Now, let&rsquo;s code the sequence of machine learning.</p>
<h2 id="1-data-visualization">1) Data visualization</h2>
<p>The purpose of data visualization is to &ldquo;get an overall sense of the data and decide the preprocessing policy&rdquo;.</p>
<h3 id="read-data">Read data</h3>
<p>First, check what kind of content the data is.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">%</span>matplotlib inline
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e"># Read CSV data</span>
df_train <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;train.csv&#39;</span>)

<span style="color:#75715e"># Check the read CSV data</span>
df_train<span style="color:#f92672">.</span>head()
</code></pre></div><p>If it works, it will be displayed as shown below.
Remember that this type of data is called <strong>DataFrame format</strong>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/79aff84b-3235-1bd7-49f1-96c8754159ec.png" alt="image.png"></p>
<p>The explanation of each line is as follows.
This time, since it is a problem to predict &ldquo;survival result&rdquo;, &ldquo;Survived&rdquo; will be the target of prediction.</p>
<ul>
<li>PassengerID: Passenger ID</li>
<li>Survived: Survival result (1: survival, 2: death)</li>
<li>Pclass: passenger class</li>
<li>Name: Passenger name</li>
<li>Sex: Gender</li>
<li>Age: Age</li>
<li>SibSp: Number of siblings, spouse.</li>
<li>Parch: Number of parents and children.</li>
<li>Ticket: Ticket number.</li>
<li>Fare: Boarding fee.</li>
<li>Cabin: Room number</li>
<li>Embarked: Port on board</li>
</ul>
<h3 id="check-basic-statistics">Check basic statistics</h3>
<p>Next, check the average value of the data and the standard deviation indicating the variation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df_train<span style="color:#f92672">.</span>describe()
</code></pre></div><p>The points to check here are as follows.
It is a skill to learn how to use the average value and standard deviation after getting used to it a little, so I will introduce it in another article.</p>
<ul>
<li>mean: average value of data</li>
<li>std: Standard deviation of data (variation of numerical values)</li>
<li>min: minimum value of data</li>
<li>50%: median of data</li>
<li>max: maximum value of data</li>
</ul>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/3b36db8a-2f91-6a54-b1da-c3cc8b43296d.png" alt="image.png"></p>
<h3 id="missing-value-handling">missing value handling</h3>
<p>The next thing to do is process the <strong>missing values</strong>. A missing value is a state where data is missing for some reason.
As it is, errors will occur during the progress of the program, so it is necessary to deal with it at an early stage.</p>
<p>If you want to know more, please refer to <a href="https://qiita.com/0NE_shoT_/items/8db6d909e8b48adcb203">[here]</a> to understand the detailed programming procedure.
To check if your data contains missing values, run the following code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df_train<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/77e60f95-6a7c-26fc-60ed-40ab086b063c.png" alt="image.png"></p>
<p>This time, it seems that there are missing values in the &ldquo;Age&rdquo; and &ldquo;Cabin&rdquo; columns.
In general, there are two ways to deal with missing values: &ldquo;remove&rdquo; and &ldquo;complement&rdquo;.</p>
<ul>
<li>Elimination: If a missing value is included, it is deleted for each row and the data itself is absent</li>
<li>Complement: Compensate the missing value with some numerical value (average, median, etc.) to make it not missing</li>
</ul>
<p>This is easier to do, so this time use <code>dropna()</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df_train <span style="color:#f92672">=</span> df_train<span style="color:#f92672">.</span>dropna()
</code></pre></div><p>Let&rsquo;s check if the missing values have been removed successfully.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df_train<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()
</code></pre></div><p>In this way, it was confirmed that there were 0 missing values in all rows, so you can proceed to the previous processing.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/bd9a4772-bc1d-6694-9f98-b7838fc23eca.png" alt="image.png"></p>
<h3 id="draw-a-graph">draw a graph</h3>
<p>After this is done, draw various graphs to grasp the trend of the data.</p>
<p>There is no fixed pattern that works well, but &ldquo;Full disclosure of the method used in machine learning&rdquo; (<a href="https://qiita.com/Saku731/items/61b629fe608ede59a3f5">https://qiita.com/Saku731/items/61b629fe608ede59a3f5</a>) introduced in &ldquo;1) Data If you check &ldquo;Visualization&rdquo;, you can get the whole picture of necessary skills.</p>
<p>For example, if you use the histogram that is most frequently used in graphing, you can draw a graph like the one below.</p>
<p>■ Preparation: Import library</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">%</span>matplotlib inline
</code></pre></div><p>■ Graph 1: Confirm the number of survivors and deaths of passengers</p>
<p>First, we will compare the number of survivors and deaths from the data.
I ran the code and checked the histogram and found that it was &ldquo;60 viable: 120 mortal&rdquo; **.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">plt<span style="color:#f92672">.</span>hist(df_train[<span style="color:#e6db74">&#39;Survived&#39;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/a97ba866-bbb7-d615-2cd8-01c78171ddc1.png" alt="image.png"></p>
<p>■ Graph 2: Draw the distribution of age
If you draw the distribution of age, you can see that the number of passengers aged 35-40 was the most. In addition, considering that there are many passengers aged 0-5 years old, we can get a guess such as &ldquo;<strong>There was a parent who was on board with infants</strong>&rdquo;.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">plt<span style="color:#f92672">.</span>hist(df_train[<span style="color:#e6db74">&#39;Age&#39;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>)
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/dfe3b1a0-9ac9-f35c-a641-71e5f524ca73.png" alt="image.png"></p>
<p>■ Graph 3: Distribution by gender
If you draw the distribution of gender, you can see that almost the same number of men and women were on board.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">plt<span style="color:#f92672">.</span>hist(df_train[<span style="color:#e6db74">&#39;Sex&#39;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/aacf2bda-54a2-7383-5fc6-81e408551dee.png" alt="image.png"></p>
<p>■ Graph 4: Drawing the distribution of gender x survival rate
This is a little applied, but when graphing it is often the case that data is aggregated.</p>
<p>The whole feeling of what kind of method is available is introduced in &ldquo;1) Visualization of data&rdquo; <a href="https://qiita.com/Saku731/items/61b629fe608ede59a3f5">Full disclosure of method used in machine learning</a> However, this time I&rsquo;ll try using a method called <strong>cross tabulation</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e">#Cross tabulation</span>
df_survived <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>crosstab(df_train[<span style="color:#e6db74">&#39;Sex&#39;</span>], df_train[<span style="color:#e6db74">&#39;Survived&#39;</span>])
df_survived
</code></pre></div><p>If you check the results of the cross tabulation, you can see that females have a significantly higher survival rate.
*Survived=1 means “survival”.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/e46606c2-1a3d-4dad-0acf-d6436420fbae.png" alt="image.png"></p>
<p>It&rsquo;s a bit difficult to understand, so divide it by the total number and cross-tabulate it with <strong>survival rate</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e">#Cross tabulation</span>
df_survived <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>crosstab(df_train[<span style="color:#e6db74">&#39;Sex&#39;</span>], df_train[<span style="color:#e6db74">&#39;Survived&#39;</span>], normalize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;index&#39;</span>)
df_survived
<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`!</span>[image<span style="color:#f92672">.</span>png](https:<span style="color:#f92672">//</span>qiita<span style="color:#f92672">-</span>image<span style="color:#f92672">-</span>store<span style="color:#f92672">.</span>s3<span style="color:#f92672">.</span>ap<span style="color:#f92672">-</span>northeast<span style="color:#f92672">-</span><span style="color:#ae81ff">1.</span>amazonaws<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span><span style="color:#ae81ff">0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">555158</span><span style="color:#f92672">/</span><span style="color:#ae81ff">851</span>c5bdc<span style="color:#f92672">-</span>b800<span style="color:#f92672">-</span><span style="color:#ae81ff">34</span>ce<span style="color:#f92672">-</span>b232<span style="color:#f92672">-</span>a150a883fa88<span style="color:#f92672">.</span>png)


If you graph this, you can clearly see that there <span style="color:#f92672">is</span> a difference <span style="color:#f92672">in</span> survival rate between men <span style="color:#f92672">and</span> women<span style="color:#f92672">.</span>
<span style="color:#f92672">**</span>The survival rate of women <span style="color:#f92672">is</span> overwhelmingly high<span style="color:#f92672">**</span>, so women would have been rescued first<span style="color:#f92672">.</span>

<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span>py
<span style="color:#75715e"># Get male/female survival/mortality ratio</span>

<span style="color:#75715e"># Survivor ratio</span>
df_survived_1 <span style="color:#f92672">=</span> df_survived[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>values

<span style="color:#75715e"># Male and female ratio of the dead</span>
df_survived_0 <span style="color:#f92672">=</span> df_survived[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>tolist()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e"># Survival ratio</span>
plt<span style="color:#f92672">.</span>bar(x<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array([<span style="color:#e6db74">&#39;female&#39;</span>,<span style="color:#e6db74">&#39;male&#39;</span>]), height<span style="color:#f92672">=</span>df_survived_1)
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/96344ebc-53b2-ac9e-66f2-907a47466fc4.png" alt="image.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e"># Male and female ratio of mortality</span>
plt<span style="color:#f92672">.</span>bar(x<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array([<span style="color:#e6db74">&#39;female&#39;</span>,<span style="color:#e6db74">&#39;male&#39;</span>]), height<span style="color:#f92672">=</span>df_survived_0)
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/14f7149b-59c0-662b-557b-cb4f741a3937.png" alt="image.png"></p>
<p>By drawing various graphs in this way, we will grasp the characteristics of the data.
There are various other methods, so those who are interested should study at <a href="https://qiita.com/nkay/items/d1eb91e33b9d6469ef51">[here]</a>.</p>
<h2 id="2-data-pre-processing">2) Data pre-processing</h2>
<p>After confirming the data, pre-processing is performed so that the data can be used in machine learning (data with good prediction accuracy).</p>
<p>Originally, various data processing is performed by referring to the information obtained by visualization, but since it is too difficult for the first study, we will deal with the easiest and most important &ldquo;encoding&rdquo;.</p>
<h3 id="categorical-variable-encoding">Categorical variable encoding</h3>
<p>Next, we need to process the <strong>categorical variable</strong>.
A simple explanation of categorical variables is &ldquo;<strong>character data</strong>&rdquo;.
*Although it may not always be character data, it is sufficient as an introductory understanding.</p>
<p>Try to display the data displayed first again.
Then, <strong>character data</strong> such as &ldquo;<strong>male</strong>&rdquo; and &ldquo;<strong>female</strong>&rdquo; is included.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df_train<span style="color:#f92672">.</span>head()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/79aff84b-3235-1bd7-49f1-96c8754159ec.png" alt="image.png"></p>
<p>The data used in machine learning has a constraint that &ldquo;<strong>Use numerical data</strong>&rdquo;.
Therefore, it is necessary to convert character data into numerical data by some method.</p>
<p><strong>One-Hot encoding</strong> using <code>get_dummies()</code> is used as the most popular method.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e"># One-Hot encoding</span>
df_train <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(df_train)

<span style="color:#75715e"># Check the converted data</span>
df_train<span style="color:#f92672">.</span>head()
</code></pre></div><p>As shown in the figure below, the character data has been replaced with &ldquo;0&rdquo; and &ldquo;1&rdquo;, so the data can be used for machine learning.
If you want to understand the detailed background, please refer to the article <a href="https://blog.shikoan.com/pandas-get-dummies/">[here]</a>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/6a8f5736-8b8b-a91e-dd8b-47d34b1685c7.png" alt="image.png"></p>
<h2 id="3-selection-of-algorithm">3) Selection of algorithm</h2>
<h3 id="what-is-an-algorithm">What is an algorithm</h3>
<p>In order for machine learning to extract laws from data, <strong>analytical method suitable for data</strong> is required.
The analysis method is called an algorithm.</p>
<p>There are various types of algorithms, and the typical ones are as follows.
For more information about individual algorithms, please refer to <a href="https://avinton.com/academy/classification-regression/">[here]</a>.</p>
<ul>
<li>Regression (forecast of sales, number of stores, etc.)
-Linear regression (single regression, multiple regression)
-Regression tree
-Random forest regression</li>
<li>Classification (prediction of choice problems such as A or B)
-Logistic regression
-Decision tree
-Random forest
-Support Vector Machine (SVM)</li>
<li>Can be used for both
-Neural network (deep learning)
-XGBoost
-LightGBM</li>
</ul>
<h3 id="algorithm-used-this-time">Algorithm used this time</h3>
<p>It is important to understand that the results change as the algorithm used changes.
So. Let&rsquo;s use three types: SVM, decision tree, and random forest.</p>
<p>It is convenient to use <code>sklearn</code> as most algorithms are included.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e"># Support Vector Machine (SVM)</span>
<span style="color:#f92672">from</span> sklearn.svm <span style="color:#f92672">import</span> SVC

<span style="color:#75715e"># Decision Tree</span>
<span style="color:#f92672">from</span> sklearn.tree <span style="color:#f92672">import</span> DecisionTreeClassifier

<span style="color:#75715e"># Random Forest</span>
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
</code></pre></div><h2 id="4-learning-the-model">4) Learning the model</h2>
<p>Now that we have the algorithm to use, let&rsquo;s train the model.
First, we need to split the data into training and validation data.</p>
<p>The reason is that after training the model,
This is because a verification phase is required to confirm whether the learning was successful.</p>
<p>A method called <strong>holdout method</strong> is famous for dividing data.</p>
<ul>
<li>Divide the data into &ldquo;explanatory variables&rdquo; and &ldquo;objective variables&rdquo;</li>
<li>Each is divided into training data: verification data = 7:3</li>
</ul>
<h3 id="split-into-explanatory-and-objective-variables">Split into explanatory and objective variables</h3>
<p>First, let&rsquo;s divide it into &ldquo;explanatory variables&rdquo; and &ldquo;objective variables&rdquo;.</p>
<ul>
<li>Objective variable: Target to be predicted by AI (the column of &ldquo;Survived&rdquo; because it is a survival condition this time)</li>
<li>Explanatory variable: Information used to predict the objective variable (column other than &ldquo;Survived&rdquo;)</li>
</ul>
<p>Notice the column name of the data you just displayed.
&ldquo;Survived&rdquo; is in the second column, and the other columns are in the third and subsequent columns.</p>
<ul>
<li>&ldquo;Passenger Id: Passenger ID&rdquo; is a column number and is not required.</li>
</ul>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/6a8f5736-8b8b-a91e-dd8b-47d34b1685c7.png" alt="image.png"></p>
<p>It is convenient to use <code>iloc[]</code> to divide DataFrame format data into explanatory variables and target variables.
For details, see the article on <a href="http://ailaby.com/lox_iloc_ix/">[here]</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e">#Explanatory variable</span>
X <span style="color:#f92672">=</span> df_train<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">2</span>:]

<span style="color:#75715e"># Objective variable</span>
t <span style="color:#f92672">=</span> df_train<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">1</span>]
</code></pre></div><p>If you check the explanatory variable <code>X</code>, the columns after &ldquo;Pclass&rdquo; are correctly extracted as shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">X<span style="color:#f92672">.</span>head()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/675ca20d-847a-ff28-a88c-f6548ede3d27.png" alt="image.png"></p>
<p>Also, if you check the <code>t</code>, you can extract the survival status &ldquo;0 / 1&rdquo;.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">t<span style="color:#f92672">.</span>head()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/7595eff1-fdb7-a235-9f2e-4d21a1bffc66.png" alt="image.png"></p>
<h3 id="training-data-verification-data--divided-into-73">Training data: verification data = divided into 7:3</h3>
<p>Next, the explanatory and objective variables are divided into <strong>training data</strong> and <strong>validation data</strong>.
Use <code>train_test_split</code> of <code>sklearn</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e">#Import library</span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split

<span style="color:#75715e">#7: Split execution at 3:</span>
X_train, X_valid, t_train, t_valid <span style="color:#f92672">=</span> train_test_split(X, t, train_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</code></pre></div><p>You can check the amount of data by using <code>len()</code>, so let&rsquo;s confirm that it is properly divided into 7:3.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e"># raw data</span>
<span style="color:#66d9ef">print</span>(len(df_train))

<span style="color:#75715e">#Data after division</span>
<span style="color:#66d9ef">print</span>(len(X_train), len(X_valid))
</code></pre></div><h3 id="hyper-parameter-setting">Hyper Parameter Setting</h3>
<p>After preparing the algorithm and data, we need to set the numerical value called <strong>hyperparameter</strong> at the end.</p>
<p>Hyperparameters are settings that are responsible for fine-tuning the algorithm to fit the data.</p>
<ul>
<li>Algorithm: The purpose is to determine the <strong>analysis point</strong> for the data</li>
<li>Hyperparameter: The purpose is to make <strong>fine-tuning</strong> so that the algorithm fits the data</li>
</ul>
<p>Let&rsquo;s set three hyperparameters for each algorithm so that you can understand the effects of the algorithm and hyperparameters. In other words, &ldquo;3 algorithms x 3 hyperparameters = 9 models&rdquo; will be learned.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#75715e"># Support Vector Machine (SVM)</span>
model_svm_1 <span style="color:#f92672">=</span> SVC(C<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>)
model_svm_2 <span style="color:#f92672">=</span> SVC(C<span style="color:#f92672">=</span><span style="color:#ae81ff">1.0</span>)
model_svm_3 <span style="color:#f92672">=</span> SVC(C<span style="color:#f92672">=</span><span style="color:#ae81ff">10.0</span>)

model_svm_1<span style="color:#f92672">.</span>fit(X_train, t_train)
model_svm_2<span style="color:#f92672">.</span>fit(X_train, t_train)
model_svm_3<span style="color:#f92672">.</span>fit(X_train, t_train)


<span style="color:#75715e"># Decision Tree</span>
model_dt_1 <span style="color:#f92672">=</span> DecisionTreeClassifier(max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
model_dt_2 <span style="color:#f92672">=</span> DecisionTreeClassifier(max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
model_dt_3 <span style="color:#f92672">=</span> DecisionTreeClassifier(max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)

model_dt_1<span style="color:#f92672">.</span>fit(X_train, t_train)model_dt_2<span style="color:#f92672">.</span>fit(X_train, t_train)
model_dt_3<span style="color:#f92672">.</span>fit(X_train, t_train)


<span style="color:#75715e"># Random Forest</span>
model_rf_1 <span style="color:#f92672">=</span> RandomForestClassifier(max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
model_rf_2 <span style="color:#f92672">=</span> RandomForestClassifier(max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
model_rf_3 <span style="color:#f92672">=</span> RandomForestClassifier(max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)

model_rf_1<span style="color:#f92672">.</span>fit(X_train, t_train)
model_rf_2<span style="color:#f92672">.</span>fit(X_train, t_train)
model_rf_3<span style="color:#f92672">.</span>fit(X_train, t_train)
</code></pre></div><h2 id="5-model-validation">5) Model validation</h2>
<p>Now that you have learned about nine types of models, let&rsquo;s check the prediction accuracy of each model.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;SVM_1 prediction accuracy:&#39;</span>, round(model_svm_1<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;SVM_2 prediction accuracy:&#39;</span>, round(model_svm_2<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;SVM_3 prediction accuracy:&#39;</span>, round(model_svm_3<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Prediction accuracy of decision tree_1:&#39;</span>, round(model_dt_1<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Prediction accuracy of decision tree_2:&#39;</span>, round(model_dt_2<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Decision tree_3 prediction accuracy:&#39;</span>, round(model_dt_3<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Prediction accuracy of Random Forest_1:&#39;</span>, round(model_rf_1<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Prediction accuracy of Random Forest_2:&#39;</span>, round(model_rf_2<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Prediction accuracy of Random Forest_3:&#39;</span>, round(model_rf_3<span style="color:#f92672">.</span>score(X_valid, t_valid) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span>),<span style="color:#e6db74">&#39;%&#39;</span>)
</code></pre></div><p>When you run the above code, the result will be:
It can be confirmed that the result (prediction accuracy) also changes depending on the algorithm and hyperparameter.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/555158/c9f31943-2e8e-53ae-f540-4be020a1ae68.png" alt="image.png"></p>
<p>This time, the second decision tree has the best prediction accuracy.</p>
<p>When actually performing AI development, you can tune hyperparameters more easily using <strong>Grid Search</strong> etc. introduced earlier. If you want to know more, you can check the mounting method by looking at <a href="">Reference article</a>.</p>
<h2 id="at-the-end">at the end</h2>
<p>The above is the basic series of machine learning steps required to develop an AI (learned model).
Based on this flow, it is better to understand the complicated method that can give better prediction accuracy.</p>
<p>If you also read the back number, you can understand the whole from basics of machine learning to coding of Python.</p>
<ul>
<li><a href="https://qiita.com/Saku731/items/a708ec5c7cbc54e2c1ef">Part 1: Understanding the purpose of machine learning</a></li>
<li><a href="https://qiita.com/Saku731/items/4bbb0798cd55a17e34f0">Part 2: Overview of AI development project</a></li>
</ul>
<p>If you want to deepen your programming further, please refer to the article covering all the necessary skills.</p>
<ul>
<li><a href="https://qiita.com/Saku731/items/61b629fe608ede59a3f5">Full disclosure of methods used in machine learning</a></li>
</ul>
<p><strong>P.S.</strong>
Since various information is also sent on SNS, please feel free to read the article.
<a href="https://twitter.com/Koji21825331">Twitter account &ldquo;Saku731&rdquo;</a> would be happy to follow you.</p>
<p>~~ Also, at the end of the sentence, we are doing a &ldquo;Team development experience project **&rdquo; for a limited time. ~~
~~ If you are interested, please check the details in <a href="https://forms.gle/5Jf6EaVkKt8eM4S49">[Application Sheet]</a>. ~~
(Addition)
The deadline is due to full capacity.
The next time is scheduled for March 2019, so if you would like information, please fill in <a href="https://forms.gle/62troSMPQv8wLitQ8">[Reservation Form]</a>.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
