<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Harlem] There are too many to choose! 13 ways to calculate pi in Python | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Harlem] There are too many to choose! 13 ways to calculate pi in Python</h1>
<p>
  <small class="text-secondary">
  
  
  Jan 19, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/numerical-calculation"> Numerical calculation</a></code></small>


<small><code><a href="https://memotut.com/tags/python3"> Python3</a></code></small>


<small><code><a href="https://memotut.com/tags/pi"> Pi</a></code></small>

</p>
<pre><code>Hello from the abyss of the universe!
</code></pre>
<pre><code class="language-math" data-lang="math">\displaystyle\int {\rm d}\boldsymbol{r}\hat{\psi}^{\dagger}(\boldsymbol{r}) Poppin Friends \hat{\psi}(\boldsymbol{r})
</code></pre><p>is! This time, I would like to introduce **13 <strong>methods of calculating the circle ratio $\pi$ in Python</strong>.</p>
<p>In the past, I read the article [&ldquo;I&rsquo;m not worried about pi anymore! 10 ways to find pi&rdquo;]&rdquo; (<a href="https://www.procrasist.com/entry/pi_1">https://www.procrasist.com/entry/pi_1</a>) (famous in pi region) , The desire to &ldquo;π seek&rdquo; was amplified, so I came to write this article. And this time, I tried to implement almost all of the method of finding $\pi$ in the article in Python **!</p>
<p>When I tried it, **Python basic knowledge ** (functions, Numpy, for statement, while statement, if statement, class etc.) was abundantly included **, so programming (like me) It is highly recommended for beginners to practice Python!</p>
<p>The environment is as follows.</p>
<ul>
<li>Bassocon: MacBook Pro(15-inch, 2018)</li>
<li>CPU: 2.2 GHz 6 core Intel Core i7</li>
<li>Memory: 16 GB 2400 MHz DDR4</li>
<li>Python environment: Anaconda, Jupyter Notebook(6.0.1), python 3.7.4</li>
</ul>
<p>Then, please enjoy the harem ** that the methods for calculating the pi factor weave!</p>
<p>Use the basic functions of #Numpy
Python has a library called Numpy (for Anaconda, it is prepared from the beginning), and it has very convenient functions for vector and matrix calculations and other mathematical calculations. In the following, I will show you how to calculate the pi with the basic functions of Numpy!</p>
<p>##1.numpy.pi
The first is the method of using <strong>numpy.pi</strong>. There is a guy in Numpy that gives you a value for pi, called <code>numpy.pi</code>, and this is the quickest way to use it. I haven&rsquo;t even calculated it anymore w</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np <span style="color:#75715e">#numpy import</span>

pi <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>pi <span style="color:#75715e"># assign np.pi to variable pi</span>
<span style="color:#66d9ef">print</span>(pi) <span style="color:#75715e"># output</span>
</code></pre></div><p>The output looks like this:</p>
<pre><code>3.141592653589793
</code></pre><p>##2. Inverse function of tan
One day, you suddenly got stuck in <strong>&ldquo;A curse that only numpy.pi of Numpy&rsquo;s features can no longer be used&rdquo;</strong>.</p>
<p>It&rsquo;s tough! You can&rsquo;t get pi with the first method! However, other features of Numpy are still available, so let&rsquo;s explore other ways. By the way, there is a legendary method that has been passed down from prehistoric times. That&rsquo;s how to use the inverse of tan.</p>
<pre><code class="language-math" data-lang="math">\tan\left(\frac{\pi}{4}\right)=1\Longleftrightarrow\arctan(1)=\frac{\pi}{4}\tag{1}
</code></pre><p>If you take advantage of</p>
<pre><code class="language-math" data-lang="math">\pi = 4\arctan(1) \tag{2}
</code></pre><p>Can be asked. Let&rsquo;s do it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>arctan(<span style="color:#ae81ff">1</span>) <span style="color:#75715e"># assign 4*tanh(1) to variable pi</span>
<span style="color:#66d9ef">print</span>(pi) <span style="color:#75715e"># output</span>
</code></pre></div><p>The output looks like this:</p>
<pre><code>3.141592653589793
</code></pre><p>I got exactly the same result as the first method! By the way, this method is handed down from prehistoric times when <strong>Fortran</strong>, the first &ldquo;language&rdquo; of mankind, was born. It is the wisdom of the ancestors!</p>
<h1 id="calculate-from-area">Calculate from area</h1>
<p>** &ldquo;The area of a circle with a radius of $r$ is $S=\pi r^2$&rdquo;**, I think everyone knows that it is a universal common sense deeply engraved in the deep psychology of all human beings! Below, let&rsquo;s find the pi using the area of this circle that everyone knows!</p>
<p>##3. Regular polygon approximation
<img width="1103" alt="Screenshot 2020-01-19 15.26.09.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502809/827340aa-d0ea-15cf-86d6-25799757d171.png"></p>
<p>▽ By increasing the area of the regular $n$ polygon that is inscribed in the circle, the value gets closer to the area of the circle. The area of a regular $n$ polygon inscribed in a circle of radius $r$ is</p>
<pre><code class="language-math" data-lang="math">S_n=n\times\frac{r^2}{2}\sin\left(\frac{360^\circ}{n}\right)\to\pi r^2\ (n\to\infty) \ tag{3}
</code></pre><p>Will be asked for. Let&rsquo;s implement it assuming a radius of $r=1$!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Polygonal approximation</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">RegularPolygon</span>(N):
    theta <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>radians(<span style="color:#ae81ff">360</span> <span style="color:#f92672">/</span> N) <span style="color:#75715e"># 360 degree is divided into N equal parts and converted from the frequency method to the radian method</span>
    pi <span style="color:#f92672">=</span> N <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sin(theta) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#75715e"># Calculate the area of a regular N polygon</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;RegularPolygon(100) = &#34;</span><span style="color:#f92672">+</span> str(RegularPolygon(<span style="color:#ae81ff">100</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;RegularPolygon(1000) = &#34;</span><span style="color:#f92672">+</span> str(RegularPolygon(<span style="color:#ae81ff">1000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;RegularPolygon(10000) = &#34;</span><span style="color:#f92672">+</span> str(RegularPolygon(<span style="color:#ae81ff">10000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;RegularPolygon(100000) = &#34;</span><span style="color:#f92672">+</span> str(RegularPolygon(<span style="color:#ae81ff">100000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;RegularPolygon(1000000) = &#34;</span><span style="color:#f92672">+</span> str(RegularPolygon(<span style="color:#ae81ff">1000000</span>)))
</code></pre></div><p>The function <code>np.radius()</code> used in the code is a function that depends on the value of the pi, and it is personal to use the function that depends on the pi to find the pi. I&rsquo;m sick of it, but I didn&rsquo;t think of any other good way, so I&rsquo;ve left it this time (if you know a good way, please let me know).</p>
<p>The output result is as follows. It&rsquo;s gradually approaching the pi!</p>
<pre><code>RegularPolygon(100) = 3.1395259764656687
RegularPolygon(1000) = 3.141571982779475
RegularPolygon(10000) = 3.141592446881286
RegularPolygon(100000) = 3.141592651522708
RegularPolygon(1000000) = 3.1415926535691225
</code></pre><p>##4. Numerical integration (rectangle approximation)
There are other methods to calculate the area of a circle besides polygonal approximation. This time, let&rsquo;s use the idea of <strong>integral</strong> (partial quadrature).</p>
<img width="540" alt="Screenshot 2020-01-19 14.47.38.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502809/ffe9156c-8004-71b4-5626-96c32097316e.png">
<p>Consider finding the area $S$ surrounded by the function $y = f(x)$, the straight line $x=a,\ x=b\ (a&lt;b)$, and the $x$ axis. The $x$ axis section $[a,\ b]$ is equally divided into $n$, and the equal points are divided into $x_0,\ x_1,\ x_2, \cdots,\ x_n\ (however \ x_0=a,\ x_n=b)$. In addition, the interval between adjacent minutia is $\Delta x = (b-a)/n$. At this time, the area $S_i$ of the section $[x_i,\ x_{i+1}]$ is **$S_i=f(x_i)\Delta x$**, that is, **the base is $\Delta x Approximate as a rectangle with height $f(x_i)$ at $**. After that, $S_i$ is calculated for all intervals $[x_i,\ x_{i+1}]\ (i=0,\ 2,\cdots,\ n-1)$, and they are approximated by summing them. Area $S_n$ is obtained. Then, if you increase the number $n$ that divides the interval $[a,\ b]$ equally, you will eventually come closer to the true area $S$.</p>
<pre><code class="language-math" data-lang="math">S_n = \sum_{i=0}^{n-1} f(x_i)\frac{b-a}{n}\to S\ (n\to\infty) \tag{4}

</code></pre><p>Let&rsquo;s apply this method to the area of a circle. The equation for the unit circle (center of origin, radius 1) in the $x-y$ plane is</p>
<pre><code class="language-math" data-lang="math">x^2+y^2=1\Longleftrightarrow y=\pm\sqrt{1-x^2} \tag{5}
</code></pre><p>However, plus means the upper half and minus means the lower half. This time, find the area of the part (quadrant) where $x&gt;=0$ in the upper half. The calculated area is $[a,\b]=[0,\1]$, so if we apply this to the formula (4) of the piecewise quadrature,</p>
<pre><code class="language-math" data-lang="math">S_n=\sum_{i=0}^{n-1} \frac{\sqrt{1-\left(\frac{i}{n}\right)^2}}{n}\to \frac{\ pi}{4}\ (n\to\infty) \tag{6}
</code></pre><p>Will be.</p>
<p>Let&rsquo;s implement it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Rectangle approximation function. Divide the interval [0,1] into N equal parts.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Rectangle</span>(N):
    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(N) <span style="color:#f92672">/</span> N <span style="color:#75715e">#0 to (N-1)/N element array up to N</span>
    Calculate y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>) <span style="color:#75715e">#y=root(1-x^2)</span>
    pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(y) <span style="color:#f92672">/</span> N <span style="color:#75715e"># calculate area</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Rectangle(100) = &#34;</span><span style="color:#f92672">+</span> str(Rectangle(<span style="color:#ae81ff">100</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Rectangle(1000) = &#34;</span><span style="color:#f92672">+</span> str(Rectangle(<span style="color:#ae81ff">1000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Rectangle(10000) = &#34;</span><span style="color:#f92672">+</span> str(Rectangle(<span style="color:#ae81ff">10000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Rectangle(100000) = &#34;</span><span style="color:#f92672">+</span> str(Rectangle(<span style="color:#ae81ff">100000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Rectangle(1000000) = &#34;</span><span style="color:#f92672">+</span> str(Rectangle(<span style="color:#ae81ff">1000000</span>)))
</code></pre></div><p>The result will be</p>
<pre><code>Rectangle(100) = 3.160417031779046
Rectangle(1000) = 3.1435554669110277
Rectangle(10000) = 3.141791477611322Rectangle(100000) = 3.1416126164019866
Rectangle(1000000) = 3.141594652413813
</code></pre><p>Although it converges slower than the polygonal approximation, the value converges to the pi as the fractional $n$ increases.
##5. Numerical integration (trapezoidal approximation)</p>
<p>▽Accuracy is much higher than that of the rectangle approximation** just by adding a device to the piecewise quadrature. The area of the minute section was approximated with a rectangle earlier, but it is ** upper base $f(x_i)$, lower base $f(x_{i+1})$, height $\Delta x$ Is approximated as a trapezoid ** of. So the following formula is used.</p>
<pre><code class="language-math" data-lang="math">S_n = \sum_{i=0}^{n-1} \frac{f(x_i)+f(x_{i+1})}{2}\cdot\frac{ba}{n}\to S\ (n\to\infty) \tag{7}
</code></pre><p>As you can see from the figure below, the rectangle approximation has a lot of extra or missing parts at the top, but the trapezoidal shape reduces it considerably.</p>
<img width="527" alt="Screenshot 2020-01-19 15.04.10.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502809/3b7ea6e7-776e-fa91-7c2d-052c8eaffd82.png">
<p>Let&rsquo;s implement it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e"># Trapezoidal approximation</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Trapezoid</span>(N):
    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> element array <span style="color:#f92672">from</span> <span style="color:#75715e">#0 to 1</span>
    Calculate y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>) <span style="color:#75715e">#y=root(1-x^2)</span>
    z <span style="color:#f92672">=</span> (y[<span style="color:#ae81ff">0</span>:N] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">1</span>:N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#75715e"># Calculate trapezoidal (top base + bottom base)/2</span>
    pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(z) <span style="color:#f92672">/</span> N <span style="color:#75715e"># calculate area</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Trapezoid(100) = &#34;</span><span style="color:#f92672">+</span> str(Trapezoid(<span style="color:#ae81ff">100</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Trapezoid(1000) = &#34;</span><span style="color:#f92672">+</span> str(Trapezoid(<span style="color:#ae81ff">1000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Trapezoid(10000) = &#34;</span><span style="color:#f92672">+</span> str(Trapezoid(<span style="color:#ae81ff">10000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Trapezoid(100000) = &#34;</span><span style="color:#f92672">+</span> str(Trapezoid(<span style="color:#ae81ff">100000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Trapezoid(1000000) = &#34;</span><span style="color:#f92672">+</span> str(Trapezoid(<span style="color:#ae81ff">1000000</span>)))
</code></pre></div><p>The following is the execution result. Although it is slightly inferior to the polygonal approximation, it can be seen that the convergence is faster than the rectangular approximation.</p>
<pre><code>Trapezoid(100) = 3.1404170317790454
Trapezoid(1000) = 3.141555466911028
Trapezoid(10000) = 3.141591477611322
Trapezoid(100000) = 3.1415926164019865
Trapezoid(1000000) = 3.1415926524138094
</code></pre><h1 id="find-from-series">Find from series</h1>
<p>There is a method of expressing the pi using an infinite series that is the sum of an infinite number sequence. Let&rsquo;s use it to find the pi! (Because the proof is quite troublesome or impossible for the author, I will omit it.)</p>
<p>##6. Basel series
It is known that the pi appears in the following series.</p>
<pre><code class="language-math" data-lang="math">1+\frac{1}{2^2}+\frac{1}{3^2}+\dots+\frac{1}{n^2}+\dots=\sum_{n=1}^\infty \frac{1}{n^2}=\frac{\pi^2}{6} \tag{8}
</code></pre><p>It is a formula that adds all the reciprocals of the squares of natural numbers, but surprisingly and surprisingly, the result includes the pi. When I&rsquo;m doing mathematics, it&rsquo;s interesting to enjoy the fun like &ldquo;Is there $\pi$?&rdquo;!
<a href="https://mathtrain.jp/basel">Click here for details on the Basel series</a></p>
<p>Similar to the case of numerical integration, it is impossible for a computer to carry out infinitely continuous operations, so here the sum is truncated and an approximate value is calculated. Let&rsquo;s implement it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e"># Basel series. Sum up to the Nth term.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Basel</span>(N):
    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) An array of natural numbers <span style="color:#f92672">from</span> <span style="color:#75715e">#1 to N</span>
    pi <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">6</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(<span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)) <span style="color:#75715e"># Calculate the inverse sum of squares of each element of the array and multiply by 6 to square.</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Basel(100) = &#34;</span><span style="color:#f92672">+</span> str(Basel(<span style="color:#ae81ff">100</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Basel(1000) = &#34;</span><span style="color:#f92672">+</span> str(Basel(<span style="color:#ae81ff">1000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Basel(10000) = &#34;</span><span style="color:#f92672">+</span> str(Basel(<span style="color:#ae81ff">10000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Basel(100000) = &#34;</span><span style="color:#f92672">+</span> str(Basel(<span style="color:#ae81ff">100000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Basel(1000000) = &#34;</span><span style="color:#f92672">+</span> str(Basel(<span style="color:#ae81ff">1000000</span>)))
</code></pre></div><p>Below are the results. It can be seen that the pi converges as the number of summing terms increases.</p>
<pre><code>Basel(100) = 3.132076531809106
Basel(1000) = 3.1406380562059932
Basel(10000) = 3.14149716394721
Basel(100000) = 3.1415831043264415
Basel(1000000) = 3.1415916986604673
</code></pre><p>##7. Leibniz series
There are other series in which the pi appears. The Leibniz series below is one of them.</p>
<pre><code class="language-math" data-lang="math">1-\frac{1}{3}+\frac{1}{5}-\frac{1}{7}+\dots+\frac{(-1)^{n-1}}{2n-1} +\dots=\sum_{n=1}^\infty\frac{(-1)^{n-1}}{2n-1}=\frac{\pi}{4} \tag{9}
</code></pre><p>This time, it is a calculation that adds the odd reciprocal numbers plus and minus alternately, but the pi appears here!
<a href="https://mathtrain.jp/glseries">Click here for details on the Leibniz series</a></p>
<p>Let&rsquo;s implement it in the same way as the Basel series.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e"># Leibniz series. Sum up to the Nth term.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Leibniz</span>(N):
    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) An array of natural numbers <span style="color:#f92672">from</span> <span style="color:#75715e">#1 to N</span>
    y <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> x<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e"># compute the array of odd reciprocals</span>
    pm <span style="color:#f92672">=</span> (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">**</span> (x<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e"># Calculate sequence of alternating Plamai 1</span>
    pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>dot(y, pm) Calculate the sum of Pramai alternation by the inner product of <span style="color:#75715e">#y and pm, and multiply by 4 at the end</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Leibniz(100) = &#34;</span><span style="color:#f92672">+</span> str(Leibniz(<span style="color:#ae81ff">100</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Leibniz(1000) = &#34;</span><span style="color:#f92672">+</span> str(Leibniz(<span style="color:#ae81ff">1000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Leibniz(10000) = &#34;</span><span style="color:#f92672">+</span> str(Leibniz(<span style="color:#ae81ff">10000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Leibniz(100000) = &#34;</span><span style="color:#f92672">+</span> str(Leibniz(<span style="color:#ae81ff">100000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Leibniz(1000000) = &#34;</span><span style="color:#f92672">+</span> str(Leibniz(<span style="color:#ae81ff">1000000</span>)))
</code></pre></div><p>The following is the execution result. It&rsquo;s steadily converging!</p>
<pre><code>Leibniz(100) = 3.131592903558553
Leibniz(1000) = 3.140592653839795
Leibniz(10000) = 3.141492653590045
Leibniz(100000) = 3.141582653589825
Leibniz(1000000) = 3.141591653589752
</code></pre><p>##8. Ramanujan series
Lastly, I will introduce a ghostly series ** &ldquo;Ramanujan series&rdquo; **. Here is the formula:</p>
<pre><code class="language-math" data-lang="math">\begin{align}
\frac{1}{\pi} = \frac{2\sqrt{2}}{99^2}\sum_{n=0}^\infty\frac{(4n)!(1103+26390n)}{( 396^{n}n!)^4} \tag{10}
\\
\frac{4}{\pi} = \sum_{n=0}^\infty\frac{(-1)^n(4n)!(1123+21460n)}{882^{2n+1}(4^ nn!)^4} \tag{11}
\end{align}
</code></pre><p>I don&rsquo;t understand the meaning anymore. .. .. Ramanujan is an Indian mathematician who leaves behind a number of incomprehensible formulas such as the one above. When asked, &ldquo;How did you come up with the ceremony,&rdquo; he answered, &ldquo;In a dream, the goddess will teach me.&rdquo; It&rsquo;s a pervert.
<a href="https://mikan-alpha.hatenablog.com/entry/2019/02/01/001035">Learn more about Ramanujan series</a>
<a href="https://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%A5%E3%83%AA%E3%83%8B%E3%83%B4%E3%82%A1%E3%83%BC%E3%82%B5%E3%83%BB%E3%83%A9%E3%83%9E%E3%83%8C%E3%82%B8%E3%83%A3%E3%83%B3">About Ramanujan</a></p>
<p>Then, let&rsquo;s implement it! This time, I will implement equation (11).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e"># Ramanujan series. Sum up to the Nth term.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Ramanujan</span>(N):
    sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span> <span style="color:#75715e"># Sum value. Initial value 0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N): execute the following <span style="color:#66d9ef">while</span> <span style="color:#75715e">#i is from 0 to N-1</span>
        numerator <span style="color:#f92672">=</span> ((<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">**</span>i) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>math<span style="color:#f92672">.</span>factorial(<span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> i) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1123</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">21460</span> <span style="color:#f92672">*</span> i) <span style="color:#75715e"># Compute the numerator of the i-th term</span>
        denominator <span style="color:#f92672">=</span> (<span style="color:#ae81ff">882</span><span style="color:#f92672">**</span>(<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">*</span> ((<span style="color:#ae81ff">4</span><span style="color:#f92672">**</span>i) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>math<span style="color:#f92672">.</span>factorial(i))<span style="color:#f92672">**</span><span style="color:#ae81ff">4</span> <span style="color:#75715e"># denominator calculation of i-th term</span>
        sum <span style="color:#f92672">=</span> sum <span style="color:#f92672">+</span> numerator <span style="color:#f92672">/</span> denominator <span style="color:#75715e">#sum plus i term</span>
    pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">/</span> sum <span style="color:#75715e"># Pi calculation</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Ramanujan(1) = &#34;</span><span style="color:#f92672">+</span> str(Ramanujan(<span style="color:#ae81ff">1</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Ramanujan(2) = &#34;</span><span style="color:#f92672">+</span> str(Ramanujan(<span style="color:#ae81ff">2</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Ramanujan(3) = &#34;</span><span style="color:#f92672">+</span> str(Ramanujan(<span style="color:#ae81ff">3</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Ramanujan(4) = &#34;</span><span style="color:#f92672">+</span> str(Ramanujan(<span style="color:#ae81ff">4</span>)))<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Ramanujan(5) = &#34;</span><span style="color:#f92672">+</span> str(Ramanujan(<span style="color:#ae81ff">5</span>)))
</code></pre></div><p>Since the convergence of the Ramanujan series is very fast, and the factorial ($n!$) that appears in the equation has a sharp divergence and there is a risk of overflow if a large value is entered, the sum term is a Basel series or Far less than the Leibniz series.</p>
<p>The following are the results. Only the first item matches up to the fourth digit of the decimal, and the third and subsequent items have the same value within the range of the number of digits displayed on the personal computer. The overwhelming speed of convergence!</p>
<pre><code>Ramanujan(1) = 3.1415850400712375
Ramanujan(2) = 3.141592653597622
Ramanujan(3) = 3.1415926535897936
Ramanujan(4) = 3.1415926535897936
Ramanujan(5) = 3.1415926535897936
</code></pre><h1 id="use-random-numbers">Use random numbers</h1>
<p>You can also obtain $\pi$ by using a random number. Random numbers, as the name implies, are random numbers, such as the rolls of a dice. However, a large amount of samples ($\sim$ millions) are required to calculate $\pi$ using random numbers, and it is too tedious for a human to drop the dice 1 million times. Let&rsquo;s introduce a computer to make the troublesome routine work more efficient. Below, we will show you how to find $\pi$ using random numbers!</p>
<p>##9. Monte Carlo method
<img width="370" alt="Screenshot 2020-01-19 16.25.31.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502809/6a46ad17-0826-ab85-e233-6b3e24633422.png"></p>
<p>Consider a $1\times 1$ square and a quadrant centered on one of its vertices. The square to quadrant area ratio is $1 :\pi/4$. Dot the dots completely randomly within this square. When the number of points increases, it becomes &ldquo;total number of points: number of points included in quadrant $\simeq1 :\pi/4$&rdquo;. For example, if $n$ of $N$ points are included in the quadrant,</p>
<pre><code class="language-math" data-lang="math">\frac{n}{N}\simeq\frac{\pi}{4} \tag{12}
</code></pre><p>Will be. Use this to find the pi.</p>
<p>Let&rsquo;s implement it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Monte Carlo method. Take N samples.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Monte</span> Carlo(N):
    xy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">2</span>, N) <span style="color:#75715e"># (2 × N) matrix of uniformly distributed random numbers in the interval [0,1). Each row corresponds to the coordinates of a point on the plane.</span>
    r <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sum(xy<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>, axis <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#75715e"># Calculate the distance from the origin of each sample point. Square each component and take the sum of the elements in the same column.</span>
    r <span style="color:#f92672">=</span> r[r<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">1</span>] <span style="color:#75715e"># Extract only samples with distance less than 1 (=in quadrant)</span>
    
    n <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>size <span style="color:#75715e">#Calculate the number of points in the circle #Calculate the pi</span>
    
    pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> n <span style="color:#f92672">/</span> N <span style="color:#75715e"># Calculate Pi</span>
    <span style="color:#66d9ef">return</span> pi

np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(seed<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) <span style="color:#75715e"># Random seed setting (this will give the same output every time)</span>

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MonteCarlo(100) = &#34;</span><span style="color:#f92672">+</span> str(MonteCarlo(<span style="color:#ae81ff">100</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MonteCarlo(1000) = &#34;</span><span style="color:#f92672">+</span> str(MonteCarlo(<span style="color:#ae81ff">1000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MonteCarlo(10000) = &#34;</span><span style="color:#f92672">+</span> str(MonteCarlo(<span style="color:#ae81ff">10000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MonteCarlo(100000) = &#34;</span><span style="color:#f92672">+</span> str(MonteCarlo(<span style="color:#ae81ff">100000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MonteCarlo(1000000) = &#34;</span><span style="color:#f92672">+</span> str(MonteCarlo(<span style="color:#ae81ff">1000000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;MonteCarlo(10000000) = &#34;</span><span style="color:#f92672">+</span> str(MonteCarlo(<span style="color:#ae81ff">10000000</span>)))
</code></pre></div><p>The following are the results. Generally, the error of the value due to random numbers converges in the order of $1 / \sqrt{N}$ for the number of samples $N$ (comparatively slow), so the accuracy is quite low.</p>
<pre><code>MonteCarlo(100) = 3.24
MonteCarlo(1000) = 3.068
MonteCarlo(10000) = 3.1508
MonteCarlo(100000) = 3.13576
MonteCarlo(1000000) = 3.140048
MonteCarlo(10000000) = 3.1424264
</code></pre><p>##10. Buffon needles
<img width="462" alt="Screenshot 2020-01-19 16.15.43.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502809/e58841c9-8d12-1b7e-721d-481e2c9f79e8.png"></p>
<p>❖ Drop a needle with a length of $l$ on a number of parallel lines drawn at intervals of $t$. Let $n$ be the number of needles that intersect a line of $N$ needles. When the number of needles $N$ is large enough,</p>
<pre><code class="language-math" data-lang="math">\frac{2lN}{tn}\sim\pi \tag{13}
</code></pre><p>Is known to be. It&rsquo;s the one who came again, &ldquo;Is it here that $\pi$ comes out?&rdquo; w The seemingly mysterious thing is that the pi appears in that probability even though you just drop the needle on the parallel lines. happen.
<a href="https://mathtrain.jp/buffon">Click here for details on Buffon needles</a></p>
<p>Let&rsquo;s implement it! The distance between the center of the needle and the line is uniform at $0\sim t/2$, and the angle between the needle and the parallel line is uniform at $0^\circ \sim 90^\circ$. Also, this time, the needle length is $l=2$ and the interval between parallel lines is $t=4$.</p>
<p>There are times when you need to be careful when sampling the angle of the needle from random numbers. It is necessary to convert the power method to the radian method when sampling the angle directly, but the <code>np.radius()</code> that will be used at this time is a function depending on the value of the pi .. You can use it to perform simulations, but it&rsquo;s personally unpleasant, so I&rsquo;ll make some efforts this time. <strong>The method of sampling the coordinates of the points in the unit quadrant and finding the value of sin from it</strong> is used. By limiting the range of sample points to the unit quadrant, the angle between the points and the $x$ axis is
It has a uniform distribution of $0^\circ \sim 90^\circ$.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Buffon&#39;s needle. Drop N needles.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Buffon</span>(N):
    n <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e"># Number of needles that overlap the line. Initial value is 0.</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N): Repeat the following <span style="color:#66d9ef">while</span> <span style="color:#75715e">#i is 0 to N-1.</span>
        <span style="color:#75715e"># Needle angle sampling. Eliminate the value dependence of pi by sampling the points within the unit circle instead of directly sampling the angle.</span>
        r <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#75715e"># The distance of the sample point from the origin. Set the initial value to 2 to execute the following while statement.</span>
        <span style="color:#66d9ef">while</span> r <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>: repeat sample until <span style="color:#75715e">#r&lt;=1</span>
            dx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand() <span style="color:#75715e">#x coordinate</span>
            dy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand() <span style="color:#75715e">#y coordinate</span>
            r <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(dx <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> dy <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>) <span style="color:#75715e"># Calculate distance from origin</span>
        
        h <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand() <span style="color:#f92672">+</span> dy <span style="color:#f92672">/</span> r <span style="color:#75715e"># Calculate the height (higher) of the tip of the tuft</span>
        <span style="color:#66d9ef">if</span> h<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>: <span style="color:#75715e"># When the height of the needle tip ends the height of the parallel line</span>
            n <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> <span style="color:#75715e"># Add the number of needles that overlap the line</span>
    
    pi <span style="color:#f92672">=</span> N <span style="color:#f92672">/</span> n <span style="color:#75715e"># Calculate Pi</span>
    <span style="color:#66d9ef">return</span> pi

np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(seed<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) <span style="color:#75715e"># Random seed setting (this will give the same output every time)</span>

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Buffon(100) = &#34;</span><span style="color:#f92672">+</span> str(Buffon(<span style="color:#ae81ff">100</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Buffon(1000) = &#34;</span><span style="color:#f92672">+</span> str(Buffon(<span style="color:#ae81ff">1000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Buffon(10000) = &#34;</span><span style="color:#f92672">+</span> str(Buffon(<span style="color:#ae81ff">10000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Buffon(100000) = &#34;</span><span style="color:#f92672">+</span> str(Buffon(<span style="color:#ae81ff">100000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Buffon(1000000) = &#34;</span><span style="color:#f92672">+</span> str(Buffon(<span style="color:#ae81ff">1000000</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Buffon(10000000) = &#34;</span><span style="color:#f92672">+</span> str(Buffon(<span style="color:#ae81ff">10000000</span>)))
</code></pre></div><p>Generate the angles of $N$ needles with theta = np.radians(rand.rand(N) * 90). Since rand.rand() has a uniform distribution on the interval $[0, 1)$, multiplying by 90 gives a uniform distribution on $[0, 90)$.</p>
<p>Next, calculate the $y$ coordinate of the needle tip with y = 2 * rand.rand(N) + np.sin(theta). 2 * rand.rand(N) gives the coordinates of the needle center, and np.sin(theta) gives the height difference between the needle center and the tip. It is judged by [y&gt;2] whether the tip of the needle intersects the parallel line (if $y&gt;2$, it intersects, otherwise it does not intersect). After that, calculate the number of needles intersecting with y.size and scramble it to finish.</p>
<p>The following is the output result. The result is not stable. .. .. (Sweat)</p>
<pre><code>Buffon(100) = 2.7777777777777777
Buffon(1000) = 2.881844380403458
Buffon(10000) = 3.1259768677711786
Buffon(100000) = 3.11284046692607
Buffon(1000000) = 3.1381705093564554
Buffon(10000000) = 3.1422055392056127
</code></pre><p>#Use algorithm
The <strong>algorithm</strong> is, roughly speaking, a set of certain procedures**. In the following, we will show you how to find the pi by repeating certain steps!</p>
<p>##11. Gauss-Legendre&rsquo;s algorithm
The Gauss-Legendre algorithm is a method of calculating the pi according to the procedure &ldquo;iteratively calculates the terms of a sequence according to the simultaneous recurrence formula&rdquo; as follows.</p>
<pre><code class="language-math" data-lang="math">\begin{align}
&amp;a_0=1,\quad b_0=\frac{1}{\sqrt{2}},\quad t_0=\frac{1}{4},\quad p_0=1\\
&amp;a_{n+1}=\frac{a_n+b_n}{2}\\
&amp;b_{n+1}=\sqrt{a_nb_n}\\&amp;t_{n+1}=t_n-p_n(a_n-a_{n+1})^2\\
&amp;p_{n+1}=2p_n\\
\\
&amp;\frac{a_n+b_n}{4t_n}\to\pi(n\to\infty)
\end{align}
\tag{14}
</code></pre><p>This algorithm is known to increase the number of digits that match the exact value approximately twice as the calculation progresses, and it is possible to easily and accurately determine the pi.
Gauss and Legendre, who independently devised this algorithm, are both superstars in the mathematical and physical world.
<a href="http://www.oishi.info.waseda.ac.jp/~samukawa/GaussLeg2.pdf">Click here for details on the Gauss-Legendre algorithm</a>
<a href="https://en.wikipedia.org/wiki/%E3%82%AB%E3%83%BC%E3%83%AB%E3%83%BB%E3%83%95%E3%83%AA%E3%83%BC%E3%83%89%E3%83%AA%E3%83%92%E3%83%BB%E3%82%AC%E3%82%A6%E3%82%B9">Learn more about Gauss</a>
[Learn more about Legendre](<a href="https://en.wikipedia.org/wiki/%E3%82%A2%E3%83%89%E3%83%AA%E3%82%A2%E3%83%B3%EF%BC%9D%E3%83%9E%E3%83%AA%E3%83%BB%E3%83%AB%E3%82%B8%E3%83%A3%E3%83%B3%E3(%83%89%E3%83%AB)">https://en.wikipedia.org/wiki/%E3%82%A2%E3%83%89%E3%83%AA%E3%82%A2%E3%83%B3%EF%BC%9D%E3%83%9E%E3%83%AA%E3%83%BB%E3%83%AB%E3%82%B8%E3%83%A3%E3%83%B3%E3(%83%89%E3%83%AB)</a></p>
<p>Now, let&rsquo;s implement it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Gauss-Legendre&#39;s algorithm. Repeat N times</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GaussRegendre</span>(N):
    <span style="color:#75715e">#First paragraph</span>
    a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
    b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
    t <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>
    p <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N): repeats the following <span style="color:#66d9ef">while</span> <span style="color:#75715e">#i is 0 to N-1</span>
        <span style="color:#75715e"># Compute the next term according to the recurrence formula</span>
        a_new <span style="color:#f92672">=</span> (a <span style="color:#f92672">+</span> b) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        b_new <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(a <span style="color:#f92672">*</span> b)
        t_new <span style="color:#f92672">=</span> t<span style="color:#f92672">-</span>p <span style="color:#f92672">*</span> (a<span style="color:#f92672">-</span>a_new)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>
        p_new <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> p

        <span style="color:#75715e"># Replace old value with new value</span>
        a <span style="color:#f92672">=</span> a_new
        b <span style="color:#f92672">=</span> b_new
        t <span style="color:#f92672">=</span> t_new
        p <span style="color:#f92672">=</span> p_new
        
    pi <span style="color:#f92672">=</span> (a <span style="color:#f92672">+</span> b)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> t) <span style="color:#75715e"># Circularity calculation</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;GaussRegendre(1) = &#34;</span><span style="color:#f92672">+</span> str(GaussRegendre(<span style="color:#ae81ff">1</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;GaussRegendre(2) = &#34;</span><span style="color:#f92672">+</span> str(GaussRegendre(<span style="color:#ae81ff">2</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;GaussRegendre(3) = &#34;</span><span style="color:#f92672">+</span> str(GaussRegendre(<span style="color:#ae81ff">3</span>)))
</code></pre></div><p>Below are the results. The first time is up to the second decimal place, the second time is up to the seventh decimal place, and the third time is up to the last displayed digit. Convergence is quite fast!</p>
<pre><code>GaussRegendre(1) = 3.1405792505221686
GaussRegendre(2) = 3.141592646213543
GaussRegendre(3) = 3.141592653589794
</code></pre><p>#Use physics
Pi is hidden not only in the mathematical world but also in the natural world. In the following, we will show you how to calculate pi using physics!</p>
<p>##12. Single vibration cycle
In physics, motions that have been actively studied, including <strong>vibration</strong>, are the basics of all periodic motions. A simple vibration is a motion where the position $x$ follows the equation:</p>
<pre><code class="language-math" data-lang="math">\frac{d^2x}{dt^2}=-\omega^2x \tag{15}
</code></pre><p>An equation that includes the derivative of a function, such as equation (15), is called a <strong>differential equation</strong>. Many differential equations in the world cannot be solved exactly, but equation (15) can be solved exactly, and the solution is as follows.</p>
<pre><code class="language-math" data-lang="math">x=A\sin(\omega t + \phi) \tag{16}
</code></pre><p>You can see that $x$ oscillates over time because the position $x$ is represented by $\sin$ as a function of time $t$. $A$ is the amplitude of vibration and $\phi$ is a constant called the initial phase, which is a quantity related to the position of the object at $t=0$. And the cycle of this vibration is</p>
<pre><code class="language-math" data-lang="math">T=\frac{2\pi}{\omega} \tag{17}
</code></pre><p>Will be. If $\omega = 1$, the half cycle of vibration is the pi.</p>
<p>This time, we will calculate the period of vibration by numerically simulating a differential equation. The Runge ≡ Kutta method ** is used to simulate the differential equation. A detailed explanation of the Runge ≡ Kutta method is omitted here, but a brief explanation is as follows: “Following a certain procedure, the position or speed value at a certain time will be used to find a position or speed value in the future. It&rsquo;s a way to repeat that.&rdquo;</p>
<pre><code class="language-math" data-lang="math">\begin{align}
&amp; Time interval: h,\quad Differential equation:\frac{dx}{dt}=f(x, t)\\
&amp;{k}_1=h\times {f}(x_i, t)\\
&amp;{k}_2=h\times {f}(x_i+\frac{k_1}{2}, t+\frac{h}{2})\\
&amp;{k}_3=h\times {f}(x_i+\frac{k_2}{2}, t+\frac{h}{2})\\
&amp;{k}_4=h\times {f}(x_i+k_3, t+h)\\
\\
&amp;{k}=\frac{{k}_1+2{k}_2+2{k}_3+{k}_4}{6}\\
&amp;x_{i+1}=x_i+{k}
\end{align}
\tag{18}
</code></pre><p><a href="http://hooktail.org/computer/index.php?Runge-Kutta%CB%A1">Click here for a detailed explanation of the Runge-Kutta method</a></p>
<p>I have written another article using the Runge-Kutta method, so please read it if you like!
<a href="https://qiita.com/POPPIN_FRIENDS/items/d41330782e3a7041cf93">Simulation of chaos in Unity using Runge-Kutta method</a></p>
<p>Now, let&rsquo;s implement it! The Runge-Kutta method of equation (18) is used for the first-order differential equation by default, but since the differential equation of equation (15) is the second-order differential equation, it is divided into two first-order differential equations as follows. I will end up.</p>
<pre><code class="language-math" data-lang="math">\begin{align}
&amp;\frac{dx}{dt}=v\\
&amp;\frac{dv}{dt}=-\omega^2x
\end{align}
\tag{19}
</code></pre><p>The initial position and initial velocity are $(x_0,v_0)=(1,0)$. In this way, the movement of the object starts from the highest point of vibration. After that, the position decreases for a while, reaches the lowest point of vibration just after half a cycle, and then the position rises. Then, by advancing the time only while the position of the object is decreasing, and cutting off when the position increases, a half-cycle time (≈circumferential ratio) can be obtained.
<img width="739" alt="Screenshot 2020-01-19 16.32.49.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502809/8e0c3992-aec6-4020-85bb-957bf6f015a2.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Differential equation. r: vector summarizing position and velocity</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(r):
    x <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">0</span>] <span style="color:#75715e"># get value at position</span>
    v <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">1</span>] <span style="color:#75715e"># extract velocity value</span>

    <span style="color:#75715e">#Calculate the right side of the differential equation</span>
    xdot <span style="color:#f92672">=</span> v
    vdot <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>x

    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>array([xdot, vdot])

<span style="color:#75715e"># Runge-Kutta method</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">RungeKutta</span>(r, h):
    k1 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> f(r)
    k2 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> f(r <span style="color:#f92672">+</span> k1 <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
    k3 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> f(r <span style="color:#f92672">+</span> k2 <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
    k4 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> f(r <span style="color:#f92672">+</span> k3)
    
    k <span style="color:#f92672">=</span> (k1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> k2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> k3 <span style="color:#f92672">+</span> k4) <span style="color:#f92672">/</span> <span style="color:#ae81ff">6</span>
    
    <span style="color:#66d9ef">return</span> r <span style="color:#f92672">+</span> k

<span style="color:#75715e"># Simple vibration. Runge-Kutta method with time interval h=10^(-N).</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Vibration</span>(N):
    Calculate h <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">**</span>(<span style="color:#f92672">-</span>N) <span style="color:#75715e">#h</span>
    t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#75715e"># Initial value of integer corresponding to time</span>
    isDecrease <span style="color:#f92672">=</span> True <span style="color:#75715e"># Flag if position is decreasing</span>
    r <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1.0</span>, <span style="color:#ae81ff">0.0</span>]) <span style="color:#75715e"># initial position and velocity values</span>
    x_old <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">0</span>] <span style="color:#75715e"># Initial value substitution of old position. Used for position increase/decrease judgment.</span>

    <span style="color:#66d9ef">while</span> isDecrease <span style="color:#f92672">==</span> True <span style="color:#f92672">and</span> t <span style="color:#f92672">*</span> h <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4.0</span>: <span style="color:#75715e"># repeat the following while position is decreasing and time is 4 or less</span>
    Preventing accidentally entering an infinite loop by imposing <span style="color:#75715e">#*t*h&lt;4.0</span>

        r <span style="color:#f92672">=</span> RungeKutta(r, h) <span style="color:#75715e"># Update position/velocity by Runge-Kutta method</span>
        x_new <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">0</span>] <span style="color:#75715e"># new position value</span>

        <span style="color:#66d9ef">if</span> x_old <span style="color:#f92672">&gt;</span>x_new: <span style="color:#75715e">#If the old position is greater than the new position (=the position is decreasing)</span>
            x_old <span style="color:#f92672">=</span> x_new <span style="color:#75715e"># replace old value</span>
            t <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> <span style="color:#75715e"># Advance time</span>
        <span style="color:#66d9ef">else</span> :<span style="color:#75715e"># otherwise</span>
            isDecrease <span style="color:#f92672">=</span> False <span style="color:#75715e"># Flag that it is decreasing to False → Loop ends</span>
    pi <span style="color:#f92672">=</span> t <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">**</span> N
    <span style="color:#66d9ef">return</span> pi <span style="color:#75715e"># Return half cycle (≒π)</span>

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Vibration(1) = &#34;</span><span style="color:#f92672">+</span> str(Vibration(<span style="color:#ae81ff">1</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Vibration(2) = &#34;</span><span style="color:#f92672">+</span> str(Vibration(<span style="color:#ae81ff">2</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Vibration(3) = &#34;</span><span style="color:#f92672">+</span> str(Vibration(<span style="color:#ae81ff">3</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Vibration(4) = &#34;</span><span style="color:#f92672">+</span> str(Vibration(<span style="color:#ae81ff">4</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Vibration(5) = &#34;</span><span style="color:#f92672">+</span> str(Vibration(<span style="color:#ae81ff">5</span>)))
</code></pre></div><p>Below are the results. You can see that the accuracy is improved as the width of $h$ is made smaller. However, the number of loops required will increase accordingly, which will take time.</p>
<pre><code>Vibration(1) = 3.1
Vibration(2) = 3.14
Vibration(3) = 3.142
Vibration(4) = 3.1416
Vibration(5) = 3.14159
</code></pre><p>##13. Number of collisions of two ballsAs the 13th, that is, the last method, I will introduce the method of impact to find the pi. What, <strong>the number of collisions between two spheres and a wall is the circumference ratio</strong>. I don&rsquo;t think I know what you&rsquo;re talking about, so I&rsquo;ll post the video and the original paper.</p>
<p>Video: <a href="https://www.youtube.com/watch?v=4UhPTrHIprk&amp;feature=emb_title"><img src="http://img.youtube.com/vi/4UhPTrHIprk/0.jpg" alt="IMAGE ALT TEXT HERE"></a></p>
<p>Original Paper: <a href="https://www.maths.tcd.ie/~lebed/Galperin.%20Playing%20pool%20with%20pi.pdf">PLAYING POOL WITH π (THE NUMBER π FROM A BILLIARD POINT OF VIEW)</a></p>
<p>Prepare two spheres with a mass ratio of $1: 100^N$ and hit a light sphere with a heavy sphere at a speed of 1 while the light sphere is stationary. Prepare a wall at the destination of the light ball after the collision and bounce it with a coefficient of restitution of 1. Repeated collisions will cause the heavy sphere to move in the opposite direction of the wall, and the light sphere will not collide when it cannot catch up with the heavy sphere. Counting the number of times a light sphere has collided with a heavy sphere and a wall up to this point, it is a figure of $N$ digits of pi.</p>
<p>Let&rsquo;s implement it! First, calculate the change in speed due to a collision in advance. The calculation method is a combination of the <strong>momentum conservation law</strong> and <strong>definition coefficient definition formula</strong> that are familiar in high school physics. The velocities of the light and heavy spheres before the collision are $v and V$ respectively, and the velocities after the collision are $v&rsquo; and V'$ respectively. Let the mass ratio of the light sphere to the heavy sphere be $1:r$. At this time, the following two equations are valid before and after the collision.</p>
<pre><code class="language-math" data-lang="math">\begin{align}
&amp;v+rV=v'+rV'\\
&amp;e=-\frac{v'-V'}{v-V}
\end{align}
\tag{20}
</code></pre><p>This time, all collisions are elastic, so $e=1$. Solving the simultaneous equations for $v&rsquo;, V'$,</p>
<pre><code class="language-math" data-lang="math">v'=\frac{(1-r)v+2rV}{1+r},\quad V'=\frac{2v+(r-1)V}{1+r} \tag{21}
</code></pre><p>Will be. Let&rsquo;s implement based on this!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#2 Ball collision. Find up to the Nth digit.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Ball</span> Collision(N):
    v <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span> <span style="color:#75715e"># Light ball initial velocity</span>
    V <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.0</span> <span style="color:#75715e"># initial velocity of heavy sphere</span>
    r <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">**</span> N <span style="color:#75715e"># mass ratio</span>
    count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#75715e"># initial number of collisions</span>

    <span style="color:#66d9ef">while</span> v <span style="color:#f92672">&gt;</span>V: <span style="color:#75715e">#While the speed of the light sphere is greater than the speed of the heavy sphere, repeat the following</span>
        v_new <span style="color:#f92672">=</span> ((<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>r) <span style="color:#f92672">*</span> v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> r <span style="color:#f92672">*</span> V) <span style="color:#f92672">/</span> (r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#75715e"># velocity of light ball after collision</span>
        V_new <span style="color:#f92672">=</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> v <span style="color:#f92672">+</span> (r<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> V) <span style="color:#f92672">/</span> (r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#75715e"># velocity of heavy sphere after collision</span>
        count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> <span style="color:#75715e"># add collision count</span>
        
        <span style="color:#66d9ef">if</span>(v_new <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0.0</span>): <span style="color:#75715e"># If the speed of the light ball is negative</span>
            v_new <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>v_new <span style="color:#75715e"># Velocity is reversed due to collision with wall</span>
            count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> <span style="color:#75715e"># add collision count</span>
        
        v <span style="color:#f92672">=</span> v_new <span style="color:#75715e"># lightball velocity replacement</span>
        V <span style="color:#f92672">=</span> V_new <span style="color:#75715e"># Velocity replacement of heavy sphere</span>
    
    pi <span style="color:#f92672">=</span> count <span style="color:#f92672">/</span> (<span style="color:#ae81ff">10</span> <span style="color:#f92672">**</span> N) <span style="color:#75715e"># Circularity calculation</span>
    <span style="color:#66d9ef">return</span> pi

<span style="color:#75715e">#output</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;BallCollision(&#34;</span> <span style="color:#f92672">+</span> str(i) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;) = &#34;</span><span style="color:#f92672">+</span> str(BallCollision(i)))
</code></pre></div><p>The following is the execution result. The pi is really up to the Nth digit! However, it seems to be inconvenient because it requires 100 times more calculation to increase the accuracy by one digit.</p>
<pre><code>BallCollision(0) = 3.0
BallCollision(1) = 3.1
BallCollision(2) = 3.14
BallCollision(3) = 3.141
BallCollision(4) = 3.1415
BallCollision(5) = 3.14159
BallCollision(6) = 3.141592
BallCollision(7) = 3.1415926
</code></pre><h1 id="i-tried-to-put-everything-together-in-a-class">I tried to put everything together in a class</h1>
<p>Finally, I&rsquo;ve put together all the methods I have implemented up to now into classes! Collecting all of them in this way is quite a volume. .. .. !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python" data-lang="Python"><span style="color:#75715e">#Description of class Pi_Harem</span>
<span style="color:#75715e"># A harem class made up of 13 ways to find the pi.</span>
<span style="color:#75715e"># Find your Pi around the way you like!</span>
<span style="color:#75715e"># * You need import numpy as np to use it.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#Function description:</span>
All <span style="color:#75715e"># functions have return values.</span>
<span style="color:#75715e"># 1. pi():</span>
Returns the value of <span style="color:#75715e">#np.pi. No argument.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 2. Arctan():</span>
Returns the value of <span style="color:#75715e">#4*np.arctan(1). No argument.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 3. RegularPokygon(N):</span>
<span style="color:#75715e"># Calculate the pi from the area of a regular polygon and return the value. Argument N = number of vertices of regular polygon.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 4. Rectangle(N):</span>
<span style="color:#75715e"># Calculate the pi from the numerical integration (rectangle approximation) and return the value. Argument N = equal number of integration intervals.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 5. Trapezoid(N):</span>
<span style="color:#75715e"># Calculate the pi from the numerical integration (trapezoid approximation) and return the value. Argument N = equal number of integration intervals.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 6. Basel(N):</span>
<span style="color:#75715e"># Calculate the pi from the Basel series and return the value. Argument N = number of terms for which the sum is taken.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 7. Leibniz(N):</span>
<span style="color:#75715e">#Calculate the pi from the Leibniz series and return the value. Argument N = number of terms for which the sum is taken.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 8. Ramanujan(N):</span>
<span style="color:#75715e"># Obtain the pi from the Ramanujan series and return the value. Argument N = number of terms for which the sum is taken.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 9. MonteCarlo(N):</span>
<span style="color:#75715e"># Calculate the pi from the Monte Carlo quadrature of the quadrant and return the value. Argument N = number of samples.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 10. Buffon(N):</span>
<span style="color:#75715e"># Obtain the pi from the Buffon needle simulation and return the value. Argument N = number of samples.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 11. GaussRegendre(N):</span>
<span style="color:#75715e"># Calculate the pi from the Gauss-Legendre algorithm and return the value. Argument N = number of iterations of the algorithm.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 12. Vibration(N):</span>
<span style="color:#75715e"># Obtain the pi from the simple vibration simulation and return the value. Argument N = variable that determines the time step size h. h=10^(-N)</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># 13. BallCollision(N):</span>
<span style="color:#75715e">#2 Obtain the pi from the simulation of a ball collision and return the value. Argument N = the number of digits you want to find.</span>

<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Class definition</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Pi_Harem</span>():
    <span style="color:#75715e">#Numpy basic functions</span>
    Exact value of <span style="color:#75715e"># 1.π (use numpy.pi)</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pi</span>(self):
        <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>pi
    
    <span style="color:#75715e"># 2. Inverse function of tan</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Arctan</span>(self):
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>arctan(<span style="color:#ae81ff">1</span>)
    
    <span style="color:#75715e">#area</span>
    <span style="color:#75715e"># 3. Polygonal approximation</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">RegularPolygon</span>(self, N):
        theta <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>radians(<span style="color:#ae81ff">360</span> <span style="color:#f92672">/</span> N)
        pi <span style="color:#f92672">=</span> N <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sin(theta) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e"># 4. Rectangle approximation</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Rectangle</span>(self, N):
        x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(N) <span style="color:#f92672">/</span> N
        y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
        pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(y) <span style="color:#f92672">/</span> N
        
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e">#5 trapezoidal approximation</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Trapezoid</span>(self, N):
        x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> N
        y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
        z <span style="color:#f92672">=</span> (y[<span style="color:#ae81ff">0</span>:N] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">1</span>:N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(z) <span style="color:#f92672">/</span> N
        
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e">#series</span>
    <span style="color:#75715e"># 6. Basel series</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Basel</span>(self, N):
        x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
        pi <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">6</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(<span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>))
        
        <span style="color:#66d9ef">return</span> pi

    <span style="color:#75715e"># 7. Leibniz series</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Leibniz</span>(self, N):
        x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
        y <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> x<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>dot(<span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> y, (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">**</span>(x<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))
        
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e"># 8. Ramanujan series</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Ramanujan</span>(self, N):
        sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
        
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
            numerator <span style="color:#f92672">=</span> ((<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">**</span>i) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>math<span style="color:#f92672">.</span>factorial(<span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> i) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1123</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">21460</span> <span style="color:#f92672">*</span> i)
            denominator <span style="color:#f92672">=</span> (<span style="color:#ae81ff">882</span><span style="color:#f92672">**</span>(<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">*</span> ((<span style="color:#ae81ff">4</span><span style="color:#f92672">**</span>i) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>math<span style="color:#f92672">.</span>factorial(i))<span style="color:#f92672">**</span><span style="color:#ae81ff">4</span>
            sum <span style="color:#f92672">=</span> sum <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>sum(numerator <span style="color:#f92672">/</span> denominator)
            
        pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">/</span> sum
        
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e">#random number</span>
    <span style="color:#75715e"># 9. Monte Carlo method</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">MonteCarlo</span>(self, N):
        xy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">2</span>, N)
        r <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sum(xy<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>, axis <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
        r <span style="color:#f92672">=</span> r[r<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">1</span>]
        n <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>size
        
        pi <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> n <span style="color:#f92672">/</span> N
        
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e"># 10. Buffon Needle</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Buffon</span>(self, N):
        n <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
            r <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
            <span style="color:#66d9ef">while</span> r <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>:
                dx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand()dy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand()
                r <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(dx <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> dy <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
        
            h <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand() <span style="color:#f92672">+</span> dy <span style="color:#f92672">/</span> r
            <span style="color:#66d9ef">if</span> h<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>:
                n <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    
        pi <span style="color:#f92672">=</span> N <span style="color:#f92672">/</span> n
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e">#algorithm</span>
    <span style="color:#75715e"># 11. Gauss-Legendre&#39;s algorithm</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GaussRegendre</span>(self, N):
        a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
        b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        t <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>
        p <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
        
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
            a_new <span style="color:#f92672">=</span> (a <span style="color:#f92672">+</span> b) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
            b_new <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(a <span style="color:#f92672">*</span> b)
            t_new <span style="color:#f92672">=</span> t<span style="color:#f92672">-</span>p <span style="color:#f92672">*</span> (a<span style="color:#f92672">-</span>a_new)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>
            p_new <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> p
            
            a <span style="color:#f92672">=</span> a_new
            b <span style="color:#f92672">=</span> b_new
            t <span style="color:#f92672">=</span> t_new
            p <span style="color:#f92672">=</span> p_new
        
        pi <span style="color:#f92672">=</span> (a <span style="color:#f92672">+</span> b)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> t)
        <span style="color:#66d9ef">return</span>(pi)
    
    <span style="color:#75715e">#Physics</span>
    <span style="color:#75715e"># 12. Simple vibration</span>
    <span style="color:#75715e"># Differential equation (Private function)</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__f</span>(self, r):
        x <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">0</span>]
        v <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">1</span>]
        xdot <span style="color:#f92672">=</span> v
        vdot <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>x
        <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>array([xdot, vdot])
    
    <span style="color:#75715e"># Runge-Kutta method (Private function)</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__RungeKutta</span>(self, r, h):
        k1 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>__f(r)
        k2 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>__f(r <span style="color:#f92672">+</span> k1 <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
        k3 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>__f(r <span style="color:#f92672">+</span> k2 <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
        k4 <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>__f(r <span style="color:#f92672">+</span> k3)
    
        k <span style="color:#f92672">=</span> (k1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> k2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> k3 <span style="color:#f92672">+</span> k4) <span style="color:#f92672">/</span> <span style="color:#ae81ff">6</span>
    
        <span style="color:#66d9ef">return</span> r <span style="color:#f92672">+</span> k
    
    <span style="color:#75715e"># Cycle calculation</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Vibration</span>(self, N):
        h <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">**</span> (<span style="color:#f92672">-</span>N)
        t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        isDecrease <span style="color:#f92672">=</span> True
        r <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1.0</span>, <span style="color:#ae81ff">0.0</span>])
        x_old <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">0</span>]
        
        <span style="color:#66d9ef">while</span> isDecrease <span style="color:#f92672">==</span> True <span style="color:#f92672">and</span> t <span style="color:#f92672">*</span> h <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4.0</span>:
            r <span style="color:#f92672">=</span> RungeKutta(r, h)
            x_new <span style="color:#f92672">=</span> r[<span style="color:#ae81ff">0</span>]

            <span style="color:#66d9ef">if</span> x_old <span style="color:#f92672">&gt;</span>x_new:
                x_old <span style="color:#f92672">=</span> x_new
                t <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">else</span>:
                isDecrease <span style="color:#f92672">=</span> False
            
        pi <span style="color:#f92672">=</span> t <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">**</span> (N)
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e">#13.2 Ball collision</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">BallCollision</span>(self, N):
        v <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
        V <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.0</span>
        r <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">**</span> N
        count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">while</span> v <span style="color:#f92672">&gt;</span>V:
            v_new <span style="color:#f92672">=</span> ((<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>r) <span style="color:#f92672">*</span> v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> r <span style="color:#f92672">*</span> V) <span style="color:#f92672">/</span> (r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
            V_new <span style="color:#f92672">=</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> v <span style="color:#f92672">+</span> (r<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> V) <span style="color:#f92672">/</span> (r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
            count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        
            <span style="color:#66d9ef">if</span>(v_new <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0.0</span>):
                v_new <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>v_new
                count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        
            v <span style="color:#f92672">=</span> v_new
            V <span style="color:#f92672">=</span> V_new
    
        pi <span style="color:#f92672">=</span> count <span style="color:#f92672">/</span> (<span style="color:#ae81ff">10</span> <span style="color:#f92672">**</span> N)
        <span style="color:#66d9ef">return</span> pi
    
    <span style="color:#75715e">#that&#39;s all</span>
</code></pre></div><p>In the case of jupyter notebook, you can execute the above code in one cell and then execute the following code in another cell (when using the <code>Basel()</code> function in the class).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pi_harem <span style="color:#f92672">=</span> Pi_Harem() <span style="color:#75715e">#Pi_Harem() is assigned to the variable pi_harem (only needs to be done once)</span>
pi <span style="color:#f92672">=</span> pi_harem<span style="color:#f92672">.</span>Basel(<span style="color:#ae81ff">1000</span>) <span style="color:#75715e"># Assign the value of the function Barsel(1000) in the class to the variable pi</span>
<span style="color:#66d9ef">print</span>(pi) <span style="color:#75715e"># output</span>
</code></pre></div><p>#Summary
How was it? This time, I dealt with 13 ways to calculate pi in Python. It was quite a volume and it took a lot of time to write (sweat)</p>
<p>There were many methods from the royal road method to the non-trivial method and the quirky method! I wasn&rsquo;t tired of seeing any of the methods, and it was difficult for me to attach them personally. .. ..</p>
<p>We plan to post articles focusing on physics and programming in the future. **If you have any theme you want to handle, please leave a comment! **</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
