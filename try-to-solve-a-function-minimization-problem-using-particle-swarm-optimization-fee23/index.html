<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>Try to solve a function minimization problem using particle swarm optimization | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Try to solve a function minimization problem using particle swarm optimization</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 1, 2019
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/optimization"> optimization</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/pso"> PSO</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/particle-swarm-optimization"> particle swarm optimization</a></code></small>

</p>
<pre><code># Particle swarm optimization
</code></pre>
<p>Particle Swarm Optimization (PSO) is a type of swarm intelligence used as a solution search method for combinatorial optimization problems.
By repeating the update of the two information of particle velocity and position, the process proceeds with the search.
The figure below is an image of particle swarm optimization.
<img width="400" alt="pso2.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/319132/f65377f9-3c5c-79cc-3f00-6ae98069509c.png"></p>
<p>##algorithm
The algorithm for particle swarm optimization is as follows.
<img width="400" alt="Screenshots 2019-11-25 15.33.15.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/319132/74082680-960d-1f0e-8c28-ff59d68aaf77.png"></p>
<h2 id="update-formula">Update formula</h2>
<p>The particle velocity and position are updated using the following update formula.
Simply put, velocity represents the direction in which a particle evolves and position represents a parameter of the particle itself.
<img width="400" alt="Screenshots 2019-11-25 15.35.13.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/319132/bf601880-0ee8-19c3-06b6-1628e722b34e.png"></p>
<p>#Experiment
Let&rsquo;s actually solve the optimization problem.
This time</p>
<pre><code class="language-math" data-lang="math">x^2 + y^2
</code></pre><p>Let&rsquo;s solve the minimization problem of.
Therefore, (x,y)=(0,0) is the optimal solution.
The code I used looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> random

<span style="color:#75715e"># Evaluation function</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate</span>(particle):
    z <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(particle)):
        z <span style="color:#f92672">+=</span> particle[i] <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">return</span> z

<span style="color:#75715e"># Position update</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update_position</span>(particle, velocity):
    new_particle <span style="color:#f92672">=</span> particle <span style="color:#f92672">+</span> velocity
    <span style="color:#66d9ef">return</span> new_particle

<span style="color:#75715e"># Speed update</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update_velocity</span>(particle, velocity, pbest, gbest, w<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, max<span style="color:#f92672">=</span><span style="color:#ae81ff">0.15</span>):
    new_velocity <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">0.0</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(particle))])
    <span style="color:#75715e">#new_velocity = [0.0 for i in range(len(particle))]</span>
    r1 <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, max)
    r2 <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, max)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(particle)):
        new_velocity[i] <span style="color:#f92672">=</span> (w <span style="color:#f92672">*</span> float(velocity[i]) <span style="color:#f92672">+</span> r1 <span style="color:#f92672">*</span> (float(pbest[i])<span style="color:#f92672">-</span>float(particle[i])) <span style="color:#f92672">+</span> r2 <span style="color:#f92672">*</span> (float(gbest[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">-</span>float(particle [i])))

    <span style="color:#66d9ef">return</span> new_velocity

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    N <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#75715e"># number of particles</span>
    length <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#75715e"># number of dimensions</span>
    para_max <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#75715e"># maximum value of parameter</span>
    <span style="color:#75715e"># Initialize particle position</span>
    ps <span style="color:#f92672">=</span> [[random<span style="color:#f92672">.</span>uniform(<span style="color:#f92672">-</span>para_max, para_max) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(length)] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N)]
    vs <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0.0</span> <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(length)] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N)]
    <span style="color:#75715e"># Personal best</span>
    personal_best_position <span style="color:#f92672">=</span> ps
    <span style="color:#75715e">#Personal best rating</span>
    personal_best_scores <span style="color:#f92672">=</span> [evaluate(p) <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> ps]
    <span style="color:#75715e">#Index of the particle with the smallest evaluation value</span>
    best_particle <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>argmin(personal_best_scores)
    <span style="color:#75715e">#Global best</span>
    global_best_position <span style="color:#f92672">=</span> personal_best_position[best_particle]

    generation <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span> <span style="color:#75715e"># maximum number of generations</span>
    <span style="color:#75715e"># Loop for generations</span>
    <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> range(generation):
        file <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;data/pso/pso&#34;</span> <span style="color:#f92672">+</span> str(t<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>)
        <span style="color:#75715e"># Particle count loop</span>
        <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(N):
            <span style="color:#75715e">#Write file</span>
            file<span style="color:#f92672">.</span>write(str(ps[n][<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">+</span> str(ps[n][<span style="color:#ae81ff">1</span>]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
            <span style="color:#75715e"># Particle velocity update</span>
            vs[n] <span style="color:#f92672">=</span> update_velocity(ps[n], vs[n], personal_best_position[n], global_best_position)
            <span style="color:#75715e"># Update particle position</span>
            ps[n] <span style="color:#f92672">=</span> update_position(ps[n], vs[n])

            <span style="color:#75715e">#Calculate the evaluation value and seek the personal best</span>
            score <span style="color:#f92672">=</span> evaluate(ps[n])
            <span style="color:#66d9ef">if</span> score <span style="color:#f92672">&lt;</span>personal_best_scores[n]:
                personal_best_scores[n] <span style="color:#f92672">=</span> score
                personal_best_position[n] <span style="color:#f92672">=</span> ps[n]
        <span style="color:#75715e"># Update global best</span>
        best_particle <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>argmin(personal_best_scores)
        global_best_position <span style="color:#f92672">=</span> personal_best_position[best_particle]
        file<span style="color:#f92672">.</span>close()

    <span style="color:#66d9ef">print</span>(global_best_position)
    <span style="color:#66d9ef">print</span>(min(personal_best_scores))

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    main()
</code></pre></div><p>##Experimental result
Individuals of generations 1, 10, 20, and 30 are color-coded and plotted in the figure.
You can see the particles converge to (0,0) as the generations progress.
<img width="400" alt="PSO.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/319132/6641cd98-fc4f-676b-b212-f9a9e789ac39.png"></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
