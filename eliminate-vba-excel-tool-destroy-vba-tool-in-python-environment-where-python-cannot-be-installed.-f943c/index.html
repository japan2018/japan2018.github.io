<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Eliminate VBA Excel tool! Destroy VBA tool in Python environment where Python cannot be installed. | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Eliminate VBA Excel tool! Destroy VBA tool in Python environment where Python cannot be installed.</h1>
<p>
  <small class="text-secondary">
  
  
  Jul 2, 2016
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/xlwings">xlwings</a></code></small>

</p>
<pre><code>Even though I can't install Python, Python!?
</code></pre>
<p>I don&rsquo;t know what you&rsquo;re talking about, but I&rsquo;m not sure&hellip; it&rsquo;s a story that anyone who understands can understand.</p>
<p>VBA-based Excel tools are still actively used in certain industries.</p>
<p>After all, the presence of Excel in user work is overwhelming,
Therefore absolutely ExcelVBA becomes necessary.</p>
<p>That&rsquo;s why I know it&rsquo;s best to write VBA normally, but</p>
<p>But after all VBA does not accept the body,</p>
<p>I want to make tools in more popular (?) languages like Ruby and Python!</p>
<p>So, the story of destroying Excel VBA tool with Python.</p>
<p>However, in certain industries it is difficult to install Python on business terminals.
(Of course, it may be possible after adjustment)</p>
<p>Therefore, even in an environment where Python can not be installed, Excel tool made with Python base
Try writing the steps to do it.</p>
<h2 id="before-that">before that</h2>
<p>This post is specifically for tools that use xlwings to make and get around Excel in Python.</p>
<p>If you don&rsquo;t know about xlwings, please read the following post in advance.</p>
<p><a href="http://qiita.com/katzhide/items/8e37f4077950f7d6e7e2">Try operating Excel using Python(Xlwings)</a>
<a href="http://qiita.com/katzhide/items/60d0336b322105bf8fe9">Run Python from Excel</a></p>
<h2 id="environment-for-creating-tools">Environment for creating tools</h2>
<table>
<thead>
<tr>
<th>Environment</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>window</td>
<td>7</td>
</tr>
<tr>
<td>python</td>
<td>3.4.3 (Anaconda 2.3.0)</td>
</tr>
<tr>
<td>pyinstaller</td>
<td>3.2</td>
</tr>
</tbody>
</table>
<p>*The environment for executing the created tool is windows7</p>
<h2 id="method">Method</h2>
<ul>
<li>Convert the python script you want to execute from Excel to exe</li>
<li>Run the exe created from Excel using xlwings to do the actual processing</li>
</ul>
<h2 id="preparation">Preparation</h2>
<p>install the package <code>pyinstaller</code> to turn it into an exe</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">conda install pyinstaller

pyinstaller -v

</code></pre></div><h2 id="procedure">Procedure</h2>
<h3 id="convert-the-created-python-script-into-an-exe">Convert the created python script into an exe</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">
pyinstaller tool.py --onefile

</code></pre></div><h3 id="define-a-macro-to-execute-the-created-exe-file-from-excel">Define a macro to execute the created exe file from Excel</h3>
<pre><code class="language-vba" data-lang="vba">
Sub SampleCall()
    RunFrozenPython (&quot;tool.exe&quot;)
End Sub

</code></pre><p>Image that replaces the following code with the above code when executing the previously written python script</p>
<pre><code class="language-vba" data-lang="vba">
Sub SampleCall()
    RunPython (&quot;import myproject;myproject.myfunction()&quot;)
End Sub

</code></pre><p>However, when calling exe, it seems that you can not specify the function you want to execute,
On the python script side, if the script is executed
The function you want to call needs to be executed.</p>
<h3 id="the-end">the end</h3>
<p>Now, if you execute the registered macro, the executed python script will be executed, and that process will be executed.</p>
<p>Now you can get the data from the DB, process it, paste the values on Excel,
A tool to create a form started to be written in Python without writing VBA at all (^o^)/</p>
<h2 id="impression">Impression</h2>
<p>Well, if it&rsquo;s such a roundabout trip, I&rsquo;m talking about writing VBA gently.
For the time being I can make a tool properly, but if I make an exe a script using xlwings
That alone will be a tool of about 130MB (bitter smile)</p>
<p>Speaking of using it in this work&hellip;('・ω・`)</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
