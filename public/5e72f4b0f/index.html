<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] [Python framework] Super easy REST API implementation with Flask | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] [Python framework] Super easy REST API implementation with Flask</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 8, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/flask">Flask</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>Hi, this is <a href="https://qiita.com/advent-calendar/2019/rakus">Lux Advent Calendar</a>of8daysincharge<a href="https://qiita.com/MasaKu">MasaKu</a>.</p>
<p><a href="https://qiita.com/MasaKu/items/82b9743383e73cb62c3e">Previously posted API news article</a>makesmefeelbetterifIstillgetagoodfeeling,andIwanttoattackthisyear&rsquo;sarticlewithAPInews.Itwas.(Fullviewofthelowerheart)</p>
<p>This time, I will introduce a super simple REST API creation method using <a href="https://a2c.bitbucket.io/flask/">Flask</a> which is a Python framework.</p>
<p>Because REST API can be created with a simple notation, it is also recommended for those who want to study the front firmly for personal development but want to make the back end quickly.</p>
<p>What is # Flask</p>
<p>The following is a summary of important points from <a href="https://en.wikipedia.org/wiki/Flask">Wikipedia</a>.</p>
<p>Flask calls itself a &ldquo;microframework&rdquo; because it keeps the functionality provided by the standard to a minimum.
Flask itself doesn&rsquo;t have the database abstraction layer and form value validation that other frameworks have in common.
At this stage, they are being extended and provided by third parties.</p>
<ul>
<li>Object Relational Mapper</li>
<li>Form value validation</li>
<li>File upload</li>
<li>User login</li>
<li>Authentication</li>
</ul>
<p>In short, <a href="https://a2c.bitbucket.io/flask/">Flask</a> itself has only the minimum functions for developing a Web application, and users will incorporate necessary parts. It&rsquo;s like style.
That&rsquo;s why we call it a microframework.</p>
<p>I read the history of <a href="https://a2c.bitbucket.io/flask/">Flask</a>describedin<a href="https://ja.wikipedia.org/wiki/Flask">Wikipedia</a> and laughed a little. Less than.</p>
<blockquote>
<p>Flask was developed by Armin Ronacher. &ldquo;I made it as an April Fools joke, but when it became famous, it became a full-blown application,&rdquo; he said.</p>
</blockquote>
<p>#Preparation</p>
<p>It is assumed that Python and pip are already installed, but Flask is installed as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install Flask
</code></pre></div><p>#First, try returning Hello World!</p>
<p>First, let&rsquo;s create an API that returns <code>Hello World!</code>.</p>
<p>Create a file called <code>hello.py</code> and describe it as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask

app <span style="color:#f92672">=</span> Flask(__name__)

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#34;/&#34;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Hello World!&#34;</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    app<span style="color:#f92672">.</span>run()
</code></pre></div><p>I will briefly explain the code.</p>
<ol>
<li>First, import Flask</li>
<li>Define the Flask application to launch</li>
<li>Route with <code>@app.route()</code></li>
<li>Execute the routed process (hello method)</li>
<li>Return <code>Hello World!</code> by return</li>
<li>Start the application with <code>app.run()</code></li>
</ol>
<p>This is the only flow.</p>
<p>Now open the console and run <code>hello.py</code> to see it in action.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">python hello.py
</code></pre></div><p>You should see a message like this:</p>
<pre><code> * Serving Flask app &quot;hello&quot; (lazy loading)
 * Environment: production
   WARNING: This is a development server.Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: off
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
</code></pre><p>Since it is started using the built-in server included in Flask, I am warned that you should only try it in the development environment.</p>
<p>Now go to <code>http://127.0.0.1:5000/</code> in your browser.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/214717/255d840c-f3f5-8842-794c-595e5edaf7aa.png%22http://127.0Accessing.0.1:5000/returns%22HelloWorld!%22%22" alt="1.PNG"></p>
<p>As above, we were able to return <code>Hello World!</code>.</p>
<p>Of course, you can define multiple routes like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#34;/&#34;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Hello World!&#34;</span>

<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#34;/home&#34;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">home</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;This is Home page.&#34;</span>

</code></pre></div><p>*If you want to check the movement, exit <code>hello.py</code> once and then start it again.</p>
<p>In this way, it can be implemented very easily if it is about returning the processed value from the routing.</p>
<p>#Receive a part of URL as an argument</p>
<p>You can pass a part of the URL as a variable to the routed method as an argument when accessing.</p>
<p>You can access the page of the account just by accessing the article of qiita at <code>https://qiita.com/&lt;username&gt;</code>.
Flask can do the same thing.</p>
<p>Add the following code to <code>hello.py</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/message/&lt;message&gt;&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">showMessage</span>(message):
    <span style="color:#66d9ef">return</span> message
</code></pre></div><p>As above, you can pass the value entered in the URL to the argument of the routed method by doing <code>path/&lt;argument&gt;</code>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/214717/6c513161-f390-965f-6464-34aa419bb0de.png%22http://127.0Ifyouenteranyvalueafter.0.1:5000/message/,youcanreceivethatvalueasanargument%22" alt="2.PNG"></p>
<p>You can also specify the type in the URL parameter.</p>
<p>The notation is as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/messageId/&lt;int:messageId&gt;&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">showMessageId</span>(messageId):
    messages <span style="color:#f92672">=</span> [
        <span style="color:#e6db74">&#34;zero&#34;</span>,
        <span style="color:#e6db74">&#34;one&#34;</span>,
        <span style="color:#e6db74">&#34;two&#34;</span>,
        <span style="color:#e6db74">&#34;three&#34;</span>,
    ]
    <span style="color:#66d9ef">return</span> messages[messageId]
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/214717/4ad061e0-e107-9d3e-8092-9fe3a490c9a0.png%22http://127.0Ifyouenteranumberafter.0.1:5000/message/id/,youcanspecifythetypeandaccepttheinput.%22" alt="3.PNG"></p>
<p>If you pass a String type parameter, it becomes NotFaund.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/214717/36b2ccf0-f4b5-565a-0fd2-882380b06d5e.png%22StringtypeURLIfyouenterit,itwillnotberoutedandwillbecomeNotFound%22" alt="4.PNG"></p>
<p>By the way, you can use the following other than int.</p>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">int</td>
<td align="left">Accepts an integer</td>
</tr>
<tr>
<td align="left">float</td>
<td align="left">Accepts floating point as int</td>
</tr>
<tr>
<td align="left">path</td>
<td align="left">Same as default, but also accepts slash</td>
</tr>
</tbody>
</table>
<p>Divide processing by # method</p>
<p>Next, let&rsquo;s divide the processing by the <code>GET</code> and <code>POST</code> methods.</p>
<p>Flask needs to import a package called <code>reuqest</code> in order to process HTTP requests.</p>
<p>Modify the line beginning of <code>hello.py</code> as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, request
</code></pre></div><p>After the modification is completed, we will describe the processing that divides the processing by the method.</p>
<p>Add processing as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/getRequest&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;GET&#39;</span>,<span style="color:#e6db74">&#39;POST&#39;</span>])
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getRequest</span>():
    <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>method <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;POST&#39;</span>:
        <span style="color:#66d9ef">return</span> request<span style="color:#f92672">.</span>form[<span style="color:#e6db74">&#39;message&#39;</span>]
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;GET Method&#34;</span>
</code></pre></div><p>A method can be specified as the second argument of the routing definition.</p>
<p>Let&rsquo;s create the following simple HTML and check the operation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">html</span>&gt;
  &lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;
      Index
    &lt;/<span style="color:#f92672">title</span>&gt;
  &lt;/<span style="color:#f92672">head</span>&gt;
  &lt;<span style="color:#f92672">body</span>&gt;
    &lt;<span style="color:#f92672">section</span>&gt;
      &lt;<span style="color:#f92672">hi</span>&gt;POST&lt;/<span style="color:#f92672">hi</span>&gt;
      &lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;POST&#34;</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1:5000/getRequest&#34;</span>&gt;
        &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;message&#34;</span> /&gt;
        &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> /&gt;
      &lt;/<span style="color:#f92672">form</span>&gt;
    &lt;/<span style="color:#f92672">section</span>&gt;
    &lt;<span style="color:#f92672">section</span>&gt;
      &lt;<span style="color:#f92672">hi</span>&gt;GET&lt;/<span style="color:#f92672">hi</span>&gt;
      &lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;GET&#34;</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1:5000/getRequest&#34;</span>&gt;
        &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> /&gt;
      &lt;/<span style="color:#f92672">form</span>&gt;
    &lt;/<span style="color:#f92672">section</span>&gt;
  &lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>When you access <code>/getRequest</code> by POST request, the process is to return request parameters.<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/214717/226c0f77-b946-fdeb-3518-8d1ce0d6d60e.png%22IfyouexecutePOST,POSTSideprocessingisexecuted%22" alt="5.PNG"></p>
<p>When you access <code>/getRequest</code> by GET request, it returns <code>GET Method</code>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/214717/4e87b05c-3f40-8935-25a6-417b36ef16af.png%22GetGETSideprocessingisexecuted%22" alt="6.PNG"></p>
<h1 id="error-page-customization">Error page customization</h1>
<p>Lastly, it is about customizing the error page.</p>
<p>Flask can return the specified status code and template page if any error occurs.</p>
<p>First, import the package to customize the error page.</p>
<p>Please correct the beginning of the line as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask, render_template
</code></pre></div><p>Next, create a page to display when an error occurs.</p>
<p>When an error occurs, execute the method <code>render_template</code> and read the template file.</p>
<p>In that case, look for the target file in the folder called <code>templates</code>.</p>
<p>Therefore, first, create a folder called <code>templates</code> and create a file called <code>404.html</code> in it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">html</span>&gt;
  &lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;
      The page can not be found
    &lt;/<span style="color:#f92672">title</span>&gt;
  &lt;/<span style="color:#f92672">head</span>&gt;

  &lt;<span style="color:#f92672">body</span>&gt;
    &lt;<span style="color:#f92672">section</span>&gt;
      &lt;<span style="color:#f92672">div</span>&gt;
        The page can not be found.
      &lt;/<span style="color:#f92672">div</span>&gt;
    &lt;/<span style="color:#f92672">section</span>&gt;
  &lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>Finally, add processing to customize the error page when a 404 error occurs in <code>hello.py</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@app.errorhandler</span>(<span style="color:#ae81ff">404</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">page_not_found</span>(error):
    <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;404.html&#39;</span>), <span style="color:#ae81ff">404</span>
</code></pre></div><p>Now try to access the non-routed <code>/hoge</code>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/214717/ad747914-097d-716d-5f50-b65edb69f537.png%22http://127.0Accessing.0.1:5000/hogewillload404.html%22" alt="7.PNG"></p>
<p>You can see that the file specified in the template is read and the status code is 404.</p>
<h1 id="in-conclusion">in conclusion</h1>
<p>What did you think.</p>
<p>I think you got the feeling that you can quickly create a simple API.</p>
<p>The impression is that it is not difficult to create an API that works at the minimum level, assuming that you use an external service such as authentication processing.</p>
<p>If you want to make the front firmly but want to make the back end quickly, why not give it a try?</p>
<p>that&rsquo;s all!
Tomorrow is an article by <a href="https://qiita.com/chorei">chorei</a>.
looking forward to!</p>
<h1 id="reference-article">Reference article</h1>
<p>Wiki pedia -Flask
<a href="https://ja.wikipedia.org/wiki/Flask">https://ja.wikipedia.org/wiki/Flask</a></p>
<p>Welcome to Flask
<a href="https://a2c.bitbucket.io/flask/">https://a2c.bitbucket.io/flask/</a></p>
<p>Flask Quick Start
<a href="https://a2c.bitbucket.io/flask/quickstart.html">https://a2c.bitbucket.io/flask/quickstart.html</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
