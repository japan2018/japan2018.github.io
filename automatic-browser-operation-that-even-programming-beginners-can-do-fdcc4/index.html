<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Automatic browser operation that even programming beginners can do | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Automatic browser operation that even programming beginners can do</h1>
<p>
  <small class="text-secondary">
  
  
  Jun 28, 2016
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/selenium">Selenium</a></code></small>


<small><code><a href="https://memotut.com/tags/visual-studio-code">Visual Studio Code</a></code></small>

</p>
<pre><code>I think that the biggest hurdle for beginners in programming is environment construction.
</code></pre>
<p>This time, the environment construction has been reduced as much as possible,
And I chose a language with few meaningless descriptions.
However, it has become long after all.
This time we will move the chrome automatically.</p>
<h2 id="what-to-download-this-time">What to download this time</h2>
<p>(I don&rsquo;t install the huge software that seems to be written in a beginner book of a common program)</p>
<ul>
<li>Editor
<strong>Visual Studio Code (VS Code)</strong></li>
<li>Language
<strong>Python</strong></li>
<li>Tools necessary for automatic browser operation
<strong>chromedriver.exe (selenium)</strong></li>
</ul>
<h2 id="for-the-time-being-output-characters">For the time being, output characters</h2>
<h3 id="vs-code-installation">VS Code installation</h3>
<p>First, download the editor called Visual Studio Code.
It is an easy-to-use editor because there are too many items such as IDE (ultra-high-performance editor such as eclipse, netbeans, and Visual Studio) so beginners do not have to throw it out.
There are various other editors like this, but my impression is that atom -&gt; slow start-up, annoying, not for windows, sublime,brackets -&gt; various kinds of self-expanding tediousness)
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/5e1dfebe-2c7b-0778-3e40-6f60e5e03548.png" width="400px" /></p>
<p>Of course, it is Japanese automatically. Someone who recommends English tools to beginners in programming.
Check it to make it easier to work later. (It will be registered in the right-click menu of the file. People do not have to check it because of such a trouble.)
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/da36f8a5-7854-2edf-80a3-e91431843009.png" width="400px" /></p>
<h3 id="install-python">Install Python</h3>
<p>Then download and install Python
<a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a>
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/867aed65-2bd8-16a1-f383-d99916c7eb97.png" width="400px" /></p>
<p>Check Add to PATH. (You will be able to type python and pip commands. If you forget to check it, add it to the environment variable yourself.)
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/53023498-6a55-f1d7-3c0b-9741585824aa.png" width="200px" /></p>
<p>(By the way, selenium is the tool used for automatic browser operation this time, but it can be used in any language. Probably there are 3 of Java C# Python.
However, Java and C# are often troublesome for beginners, so I chose Python.)</p>
<p>I also need chromedriver.exe, but I will do it later</p>
<p>###Implementation
I will put out the characters for the time being.
Create an appropriate folder.
Right click the folder and click Open with Code
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/174a7f2f-4bce-4170-7caf-a643c708b881.png" alt="Screenshot_17.png"></p>
<p>Then right-click on the left menu screen → create a new file with the name &ldquo;hello.py&rdquo;.
<img src="http://i.imgur.com/H2UtyGN.gif" alt="Screenshot_20.gif"></p>
<p>Once created</p>
<pre><code>print(&quot;konnnitiwa seaki&quot;)
</code></pre><p>Type in <kbd>Ctrl+S</kbd> and save.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/6f400411-60e4-1c63-bbfb-d648c6eb5a5d.png" alt="Screenshot_21.png"></p>
<p>After saving, press <kbd>Ctrl + Shift + C</kbd> in VS Code to open the command prompt.
Enter python hello.py.
If you see konnnitiwa sekai, it&rsquo;s a success.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/8623f3fd-a6ef-b7d1-1bc5-bbb87a89e9d5.png" alt="Screenshot_22_.png"></p>
<h3 id="easy-to-use-vs-code">Easy to use VS Code</h3>
<p>However, this is the same as a simple notepad, so enable error display and automatic input.
Install VS Code python extension
If you press <kbd>CTRL+P</kbd> in VS Code, this screen will appear.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/afc657cf-22d6-e28e-7de3-3f60d9d6551d.png" alt="Screenshot_23.png"></p>
<p>Type <code>ext install Python</code> and click on the 5th and most DL&rsquo;ed Python below to install.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/fdd8ac51-6398-8aa6-09fb-608a9481f097.png" alt="Screenshot_18.png"></p>
<p>While installing, the lower left is spinning.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/ce62088a-308a-21bd-79b0-44829b9a79f0.png" alt="Screenshot_24_.png"></p>
<p>Reboot when finished.
Then I think I got the above message. (It will appear if you save the file by playing around with it)
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/fe12dc14-8fc7-fb1e-2277-85c55addcecc.png" alt="Screenshot_25.png">
It is said that you can put in a code checker called pylint.
Open the command prompt with Mokkakai <kbd>Ctrl+Shift+C</kbd>,
Install pylint with <code>pip install pylint</code>.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/300d8511-b339-3e87-75c5-5ede92b34e79.png" alt="Screenshot_26.png">
This will check your code for errors when you save. (No need to restart VS Code)
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/afcb66eb-8563-73ed-e369-d563bafd5a6d.png" alt="Screenshot_27.png">
When running each program, it&rsquo;s not enough to open the command prompt and enter the data, so the program execution is automated with a shortcut.
(Please wait a while for automatic browser operation)
Also, bring up this screen with <kbd>Ctrl+P</kbd>
Enter <code>&gt;tasks config</code> and click the task liner configuration → click Others.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/6a610bf0-27e6-7a6a-3e8d-382aa5b3b222.png" alt="Screenshot_28.png">
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/d758742d-6d35-6a52-5b13-0c6e4fd88f38.png" alt="Screenshot_29.png"></p>
<p>A setting folder called .vscode will be created and a setting file called tasks.json will be created, so change it as follows.
(You can change only the command and args parts)
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/b07b658f-b063-6dfe-5f4a-767db5d69fbb.png" alt="Screenshot_30.png"></p>
<p>Now, if you return to the hello.py screen and press <kbd>Ctrl+Shift+B</kbd>, the program will be executed in VS Code without the need to type a command.
<img src="http://i.imgur.com/HmXtR5q.gif" alt="sekai.gif"></p>
<p>(This is a configuration file that only executes the command python file name with <kbd>Ctrl+Shift+B</kbd>)
(By the way, vscode, Japanese in the console is garbled for the compliment.
If you execute the file from the command prompt, Japanese garbled characters will not occur. )
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/5445d65a-08df-76d0-cfd7-730b8ed3aa5c.png" alt="Screenshot_32.png"></p>
<h2 id="browser-automatic-operation">Browser automatic operation</h2>
<h3 id="preparation">Preparation</h3>
<p>It is finally browser operation.
Download chromedriver.exe.
<a href="https://sites.google.com/a/chromium.org/chromedriver/downloads">https://sites.google.com/a/chromium.org/chromedriver/downloads</a>
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/4fcd923d-0244-cf9b-c6f0-67d4cc15ec5f.png" alt="Screenshot_14_.png">
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/d87a5087-d63f-73a7-b416-7c103bfd2740.png" alt="Screenshot_16_.png"></p>
<p>Unzip and put chromedriver.exe in the same folder as hello.py.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/469a1718-237f-20b4-3a5e-5c95428900ce.png" alt="Screenshot_33_.png"></p>
<p>Also open a command prompt,
<code>pip install selenium</code>
Type. You can use selenium with python.
The tool for browser operation requires this selenium and chromedriver.exe.</p>
<h3 id="implementation">Implementation</h3>
<p>Copy and paste the following code to hello.py.</p>
<pre><code class="language-py:hello.pyfrom" data-lang="py:hello.pyfrom">
driver = webdriver.Chrome(&quot;./chromedriver.exe&quot;) # Use chromedriver.exe just downloaded
driver.get(&quot;http://www.yahoo.co.jp/&quot;) Start #chrome and move to yahoo
searchBox = driver.find_element_by_css_selector(&quot;#srchtxt&quot;) # find html in search input box
searchBox.send_keys(&quot;I hate the world&quot;) # Type &quot;Hate the world&quot; in the search box
kensakuBotan = driver.find_element_by_css_selector(&quot;#srchbtn&quot;) Find the search button from #html
kensakuBotan.click() # Click the search button
</code></pre><h3 id="run">run</h3>
<p>Save with <kbd>Ctrl+S</kbd>, then execute with <kbd>Ctrl+Shift+B</kbd>
Then, chrome will stand up and search freely.
<img src="https://qiita-image-store.s3.amazonaws.com/0/131295/f4f9ae12-65d1-5798-7aca-ba2cf9f6566e.png" alt="Screenshot_22.png">
Did you do it? Now you and you are scripters from today
For the contents of find_element_by_css_selector(), actually open yahoo in the browser and inspect the html source.
With chrome, the developer tools can be used with F12, and this kind of html component css selector can be taken.
<img src="http://i.imgur.com/fxIBpqm.gif" alt="chrome.gif"></p>
<p>Digression</p>
<hr>
<p>pip is like an app store for python. You can DL various things that can be used in python with pip install ○○ command.
The one installed with pip install selenium is
It&rsquo;s probably in C:\Users\username\AppData\Local\Programs\Python\Python35-32
Probably the library will be messed up, so it seems like I&rsquo;m usually creating a virtual environment, but I didn&rsquo;t do it because it&rsquo;s troublesome
I&rsquo;m new to selenium so I don&rsquo;t know if any scripters in the world are using it.
Also, I haven&rsquo;t written python.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
