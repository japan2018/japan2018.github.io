<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>I also wanted to check type hints with numpy | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>I also wanted to check type hints with numpy</h1>
<p>
  <small class="text-secondary">
  
  
  Jan 19, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/numpy">numpy</a></code></small>


<small><code><a href="https://memotut.com/tags/mypy">mypy</a></code></small>


<small><code><a href="https://memotut.com/tags/nptyping">nptyping</a></code></small>

</p>
<pre><code>## Overview
</code></pre>
<p>Type hints added in <a href="https://www.python.org/dev/peps/pep-0484/">PEP484</a> since Python 3.5.
I think that it can be applied to ndarray of <a href="https://numpy.org">numpy</a>,anditisatypehintstaticchecktool<a href="https://mypy.readthedocs.io/en/latest/index.html">mypy</a>, and the results of the wp investigation, such as dealing with third party modules.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In conclusion, type hint checking of numpy.ndarray using mypy is possible using <a href="https://github.com/numpy/numpy-stubs">numpy-stubs</a>.
However, as of now (January 2020), mypy check cannot be performed by specifying the dtype and shape of ndarray.
On the other hand, if you want to add type hints including dtype and shape as annotations for readability, the option to use <a href="numpy-type-hints-in-python-pep-484">nptyping</a> seems good.</p>
<h2 id="preparation">Preparation</h2>
<p>Install at least the following with <code>pip</code>. (Enclosed in brackets is the environment at the time of my verification)</p>
<ul>
<li>numpy (1.18.1)</li>
<li>mypy (0.761)</li>
</ul>
<h2 id="type-checking-with-mypy">Type checking with mypy</h2>
<p>First of all, I was trying to experiment because it was a state of type checking.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ex1.py</span>

<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Tuple

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center</span>(points: List[Tuple[int, int]]) <span style="color:#f92672">-&gt;</span> Tuple[float, float]:
    <span style="color:#e6db74">&#39;&#39;&#39;Find the center of gravity from the list of points&#39;&#39;&#39;</span>
    n <span style="color:#f92672">=</span> len(points)
    x, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> points:
        x <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">0</span>]
        y <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">/</span>n, y<span style="color:#f92672">/</span>n

points_invalid <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>], [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>]]

<span style="color:#66d9ef">print</span>(calc_center(points_invalid)) <span style="color:#75715e"># TypeHint Error</span>
</code></pre></div><p>The above code, of course, succeeds, but I&rsquo;ll check the type hint with mypy.
If you have installed mypy with pip etc, you should be able to run <code>mypy</code> in your terminal.</p>
<pre><code>&gt;mypy ex1.py
ex1.py:16: error: Argument 1 to &quot;calc_center&quot; has incompatible type &quot;List[List[int]]&quot;; expected &quot;List[Tuple[int, int]]&quot;
Found 1 error in 1 file (checked 1 source file)
&gt;python ex1.py
(1.75, 3.0)
</code></pre><p>In this way, it points out where the type hints are violated. If you modify as follows, the check by mypy will pass.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ex2.py</span>

<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Tuple

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center</span>(points: List[Tuple[int, int]]) <span style="color:#f92672">-&gt;</span> Tuple[float, float]:
    <span style="color:#e6db74">&#39;&#39;&#39;Find the center of gravity from the list of points&#39;&#39;&#39;</span>
    n <span style="color:#f92672">=</span> len(points)
    x, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> points:
        x <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">0</span>]
        y <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">/</span>n, y<span style="color:#f92672">/</span>n

points <span style="color:#f92672">=</span> [(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>)]

<span style="color:#66d9ef">print</span>(calc_center(points)) <span style="color:#75715e"># Success</span>
</code></pre></div><pre><code>&gt;mypy ex2.py
Success: no issues found in 1 source file
</code></pre><h2 id="type-checking-against-third-party-modules">Type checking against third party modules</h2>
<p>Numpy&rsquo;s ndarray is useful for calculating coordinate points, so I would like to change it.
However, if you add <code>import numpy</code> to the code above and run mypy, the following error will occur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ex3.py</span>

<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Tuple
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center</span>(points: List[Tuple[int, int]]) <span style="color:#f92672">-&gt;</span> Tuple[float, float]:
    <span style="color:#e6db74">&#39;&#39;&#39;Find the center of gravity from the list of points&#39;&#39;&#39;</span>
    n <span style="color:#f92672">=</span> len(points)
    x, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> points:
        x <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">0</span>]
        y <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">/</span>n, y<span style="color:#f92672">/</span>n

points <span style="color:#f92672">=</span> [(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>)]

<span style="color:#66d9ef">print</span>(calc_center(points)) <span style="color:#75715e"># Success</span>
</code></pre></div><pre><code>&gt;mypy ex3.py
ex3.py:4: error: No library stub file for module'numpy'
ex3.py:4: note: (Stub files are from https://github.com/python/typeshed)
Found 1 error in 1 file (checked 1 source file)
</code></pre><p>The reason for the error is that the numpy package itself does not support type hints.
So what are you going to do? Let&rsquo;s divide the measures into the following three cases.</p>
<h3 id="method-1-ignore-third-party-type-hints">Method 1. Ignore third-party type hints</h3>
<p>This seems to be the easiest and most common method.
To do this, create a file with the name mypy.ini, describe as follows, and put it in the current directory.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ini" data-lang="ini"><span style="color:#66d9ef">[mypy]</span>

<span style="color:#66d9ef">[mypy-numpy]</span>
<span style="color:#a6e22e">ignore_missing_imports</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">True</span>
</code></pre></div><p>The 3rd and 4th lines are set to ignore the type hint check error for numpy.
If you want to apply it to other 3rd party modules, copy and paste the 3rd and 4th lines and change the <code>numpy</code> part.
For other specifications about mypy.ini, refer to the official <a href="https://mypy.readthedocs.io/en/latest/config_file.html">here</a> page.</p>
<p>Now you can run mypy check successfully. However, note that the type hint check of ndarray itself is also ignored (last line).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ex4.py (ignore_missing_imports)</span>

<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Tuple
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center</span>(points: List[Tuple[int, int]]) <span style="color:#f92672">-&gt;</span> Tuple[float, float]:
    <span style="color:#e6db74">&#39;&#39;&#39;Find the center of gravity from the list of points&#39;&#39;&#39;</span>
    n <span style="color:#f92672">=</span> len(points)
    x, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> points:
        x <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">0</span>]
        y <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">/</span>n, y<span style="color:#f92672">/</span>n

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center_np</span>(points: np<span style="color:#f92672">.</span>ndarray) <span style="color:#f92672">-&gt;</span> np<span style="color:#f92672">.</span>ndarray:
    <span style="color:#e6db74">&#39;&#39;&#39;Calculate the center of gravity from the list of points (ndarray version)&#39;&#39;&#39;</span>
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>average(points, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

points <span style="color:#f92672">=</span> [(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>)]

<span style="color:#66d9ef">print</span>(calc_center(points)) <span style="color:#75715e"># Success</span>

np_points <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(points, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>int)

<span style="color:#66d9ef">print</span>(calc_center_np(np_points)) <span style="color:#75715e"># Success</span>
<span style="color:#66d9ef">print</span>(calc_center_np(points)) <span style="color:#75715e"># Success?</span>
</code></pre></div><pre><code>&gt;mypy ex4.py
Success: no issues found in 1 source file
</code></pre><h3 id="method-2-create-stub-for-type-hint">Method 2. Create stub for type hint</h3>
<p>By creating an empty function (stub) for the type hint of the module you want to use, mypy will see them for you. Stub files are managed with the extension .pyi.</p>
<p>A numpy stub <a href="https://github.com/numpy/numpy-stubs">numpy-stubs</a> is available on github.</p>
<p>First, bring up the &ldquo;numpy-stubs&rdquo; folder with <code>git clone https://github.com/numpy/numpy-stubs.git</code> etc.
Change the &ldquo;numpy-stubs&rdquo; folder to &ldquo;numpy&rdquo;.</p>
<p>The folder structure is as follows.</p>
<pre><code>numpy-stubs/
└── numpy
    ├── __init__.pyi
    └── core
        ├── numeric.pyi
        ├── numerictypes.pyi
        ├── _internal.pyi
        └── __init__.pyi
</code></pre><p>In addition, add the root folder path where the stub is placed to the environment variable called <code>MYPYPATH</code> and execute it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ex5.py (numpy-stubs)</span>

<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Tuple
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center</span>(points: List[Tuple[int, int]]) <span style="color:#f92672">-&gt;</span> Tuple[float, float]:
    <span style="color:#e6db74">&#39;&#39;&#39;Find the center of gravity from the list of points&#39;&#39;&#39;</span>
    n <span style="color:#f92672">=</span> len(points)
    x, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> points:
        x <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">0</span>]
        y <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">/</span>n, y<span style="color:#f92672">/</span>n

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center_np</span>(points: np<span style="color:#f92672">.</span>ndarray) <span style="color:#f92672">-&gt;</span> np<span style="color:#f92672">.</span>ndarray:
    <span style="color:#e6db74">&#39;&#39;&#39;Calculate the center of gravity from the list of points (ndarray version)&#39;&#39;&#39;</span>
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>average(points, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

points <span style="color:#f92672">=</span> [(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>)]

<span style="color:#66d9ef">print</span>(calc_center(points)) <span style="color:#75715e"># Success</span>

np_points <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(points, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>int)
np_points_float <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(points, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)

<span style="color:#66d9ef">print</span>(calc_center_np(np_points)) <span style="color:#75715e"># Success</span>
<span style="color:#66d9ef">print</span>(calc_center_np(np_points_float)) <span style="color:#75715e"># Success</span>
<span style="color:#66d9ef">print</span>(calc_center_np(points)) <span style="color:#75715e"># TypeHint Error</span>
</code></pre></div><pre><code class="language->set" data-lang=">set">&gt;mypy ex5.py
ex5.py:28: error: Argument 1 to &quot;calc_center_np&quot; has incompatible type &quot;List[Tuple[int, int]]&quot;; expected &quot;ndarray&quot;
Found 1 error in 1 file (checked 1 source file)
</code></pre><p>Now the type hint checking of the ndarray itself works. However, there is a slight bottleneck in that you cannot check it by specifying dtype and shape, and you have to set environment variables one by one.</p>
<h4 id="stubgen">stubgen</h4>
<p>mypy comes with a script called <a href="https://mypy.readthedocs.io/en/latest/stubgen.html">stubgen</a>thatwillautomaticallygenerateatypehintfile(.pyiextension). ..</p>
<pre><code>&gt;stubgen -p numpy
</code></pre><p><code>-p</code> is an option to recursively generate stubs for packages.
When executed, the <code>out</code> folder is created in the current directory, and the numpy stub file is packed in it.</p>
<p>However, because stubgen is not able to extract the numpy structure well, another error occurs when the mypy check is executed. There are cases where stubs are open to the public like numpy-stubs, so it is safer to use that if possible.</p>
<h3 id="method-3-use-nptyping">Method 3. Use nptyping</h3>
<p>If you want to form a type hint that includes dtype and shape of ndarray after taking either method 1 or 2, then <a href="numpy-type-hints-in-python-pep-484">nptyping</a> should be used.</p>
<p>It can be installed from PyPi with <code>pip install np typing</code>.</p>
<p>Although nptyping does not support static type hint checking by mypy, you can specify a type hint that specifies the dtype and shape of ndarray using the alias <code>Array</code>.</p>
<p>The following is an official sample. Arrays with mixed types such as pandas DataFrame are also OK.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> nptyping <span style="color:#f92672">import</span> Array
Array[str, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>] <span style="color:#75715e"># 3 rows and 2 columns</span>
Array[str, <span style="color:#ae81ff">3</span>] <span style="color:#75715e"># 3 rows and an undefined number of columns</span>
Array[str, <span style="color:#ae81ff">3</span>, <span style="color:#f92672">...</span>] <span style="color:#75715e"># 3 rows and an undefined number of columns</span>
Array[str, <span style="color:#f92672">...</span>, <span style="color:#ae81ff">2</span>] <span style="color:#75715e"># an undefined number of rows and 2 columns</span>
Array[int, float, str] <span style="color:#75715e"># int, float and str on columns 1, 2 and 3 resp.</span>
Array[int, float, str, <span style="color:#f92672">...</span>] <span style="color:#75715e"># int, float and str on columns 1, 2 and 3 resp.</span>
Array[int, float, str, <span style="color:#ae81ff">3</span>] <span style="color:#75715e"># int, float and str on columns 1, 2 and 3 resp. and with 3 rows</span>
</code></pre></div><p>Instance check using <code>isinstance</code> is also possible.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ex6.py (nptyping)</span>

<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Tuple
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">from</span> nptyping <span style="color:#f92672">import</span> Array

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center</span>(points: List[Tuple[int, int]]) <span style="color:#f92672">-&gt;</span> Tuple[float, float]:
    <span style="color:#e6db74">&#39;&#39;&#39;Find the center of gravity from the list of points&#39;&#39;&#39;</span>
    n <span style="color:#f92672">=</span> len(points)
    x, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> points:
        x <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">0</span>]
        y <span style="color:#f92672">+=</span> p[<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">/</span>n, y<span style="color:#f92672">/</span>n

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_center_np</span>(points: Array[int, <span style="color:#f92672">...</span>, <span style="color:#ae81ff">2</span>]) <span style="color:#f92672">-&gt;</span> Array[float, <span style="color:#ae81ff">2</span>]:
    <span style="color:#e6db74">&#39;&#39;&#39;Calculate the center of gravity from the list of points (ndarray version)&#39;&#39;&#39;</span>
    <span style="color:#66d9ef">print</span>(isinstance(points, Array[int, <span style="color:#f92672">...</span>, <span style="color:#ae81ff">2</span>]))
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>average(points, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

points <span style="color:#f92672">=</span> [(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>)]

np_points <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(points, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>int)
np_points_float <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(points, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)

<span style="color:#66d9ef">print</span>(isinstance(calc_center_np(np_points), Array[float, <span style="color:#ae81ff">2</span>])) <span style="color:#75715e"># Argument: True, Return value: True</span>
<span style="color:#66d9ef">print</span>(isinstance(calc_center_np(np_points_float), Array[float, <span style="color:#ae81ff">2</span>])) <span style="color:#75715e"># Argument: False, Return value: True</span>
<span style="color:#66d9ef">print</span>(isinstance(calc_center_np(points), Array[float, <span style="color:#ae81ff">2</span>])) <span style="color:#75715e"># Argument: False, Return value: True</span>
</code></pre></div><p>Don&rsquo;t forget to set nptyping to <code>ignore_missing_imports = True</code> in mypy.ini.
The execution result is as follows.</p>
<pre><code>&gt;mypy ex6.py
Success: no issues found in 1 source file
&gt;python ex6.py
True
True
False
True
False
True
</code></pre><h2 id="summary">Summary</h2>
<p>I have roughly summarized the type hints around numpy.
I think that information such as coordinates and tabular data is often handled as an ndarray and geometrical and statistical operations are implemented.
At that time, I often worry about the code I wrote such as &ldquo;How many dimensional ndarray are you turning around?&rdquo;
I thought that type hints like nptyping would be useful considering readability and maintainability.
I think that it will be more useful if it can support type checking by mypy in the future.</p>
<h2 id="reference-article">Reference article</h2>
<p><a href="https://stackoverflow.com/questions/52839427/">https://stackoverflow.com/questions/52839427/</a>
<a href="https://www.sambaiz.net/article/188/">https://www.sambaiz.net/article/188/</a>
<a href="https://masahito.hatenablog.com/entry/2017/01/08/113343">https://masahito.hatenablog.com/entry/2017/01/08/113343</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
