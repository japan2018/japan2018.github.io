<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] I did some research on the class | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] I did some research on the class</h1>
<p>
  <small class="text-secondary">
  
  
  Jun 24, 2014
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>

</p>
<pre><code>Since I'm almost new to python, I'll start with a simple code to look up classes (like quirks).
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>():
<span style="color:#66d9ef">pass</span>
</code></pre></div><p>Define an empty class.
When outputting the class members in this state,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>():
<span style="color:#66d9ef">pass</span>

pprint (inspect<span style="color:#f92672">.</span>getmembers(sampleCls))

</code></pre></div><p>When you run</p>
<pre><code>[('__doc__', None), ('__module__','__main__')]
</code></pre><p>Like this.</p>
<p>Add one line (instead of pass).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>():
abc <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>

pprint (inspect<span style="color:#f92672">.</span>getmembers(sampleCls))
</code></pre></div><p>When you run</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">[(<span style="color:#e6db74">&#39;__doc__&#39;</span>, None), (<span style="color:#e6db74">&#39;__module__&#39;</span>,<span style="color:#e6db74">&#39;__main__&#39;</span>), (<span style="color:#e6db74">&#39;abc&#39;</span>, <span style="color:#ae81ff">111</span>)]
</code></pre></div><p>Like this.</p>
<p>A class object is created after passing the class definition.
Class objects can be modified.
Try modifying the class object without instantiating it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>():
abc <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>

<span style="color:#75715e">#sampleCls.def = 222</span>
sampleCls<span style="color:#f92672">.</span>efg <span style="color:#f92672">=</span> <span style="color:#ae81ff">222</span>
pprint (inspect<span style="color:#f92672">.</span>getmembers(sampleCls))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">[(<span style="color:#e6db74">&#39;__doc__&#39;</span>, None), (<span style="color:#e6db74">&#39;__module__&#39;</span>,<span style="color:#e6db74">&#39;__main__&#39;</span>), (<span style="color:#e6db74">&#39;abc&#39;</span>, <span style="color:#ae81ff">111</span>), (<span style="color:#e6db74">&#39;efg&#39;</span>, <span style="color:#ae81ff">222</span>)]
</code></pre></div><p>You can change it like this.
(In sampleCls.def, def is a reserved word and an error occurs (；´∀｀))</p>
<p>If you create an instance of this class in this state,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>():
abc <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>

sampleCls<span style="color:#f92672">.</span>efg <span style="color:#f92672">=</span> <span style="color:#ae81ff">222</span>
i <span style="color:#f92672">=</span> sampleCls()
pprint (inspect<span style="color:#f92672">.</span>getmembers(sampleCls))
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;------------------------------&#34;</span>
pprint (inspect<span style="color:#f92672">.</span>getmembers(i))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">[(<span style="color:#e6db74">&#39;__doc__&#39;</span>, None), (<span style="color:#e6db74">&#39;__module__&#39;</span>,<span style="color:#e6db74">&#39;__main__&#39;</span>), (<span style="color:#e6db74">&#39;abc&#39;</span>, <span style="color:#ae81ff">111</span>), (<span style="color:#e6db74">&#39;efg&#39;</span>, <span style="color:#ae81ff">222</span>)]
<span style="color:#f92672">-</span> <span style="color:#f92672">-----------------------------</span>
[(<span style="color:#e6db74">&#39;__doc__&#39;</span>, None), (<span style="color:#e6db74">&#39;__module__&#39;</span>,<span style="color:#e6db74">&#39;__main__&#39;</span>), (<span style="color:#e6db74">&#39;abc&#39;</span>, <span style="color:#ae81ff">111</span>), (<span style="color:#e6db74">&#39;efg&#39;</span>, <span style="color:#ae81ff">222</span>)]
</code></pre></div><p>With that feeling, the efg added later is also included in the instance.
By the way, you can also delete the variable from the class object.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>():
abc <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>

sampleCls<span style="color:#f92672">.</span>efg <span style="color:#f92672">=</span> <span style="color:#ae81ff">222</span>
pprint (inspect<span style="color:#f92672">.</span>getmembers(sampleCls))
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;------------------------------&#34;</span>
<span style="color:#66d9ef">del</span> sampleCls<span style="color:#f92672">.</span>abc
pprint (inspect<span style="color:#f92672">.</span>getmembers(sampleCls))
</code></pre></div><p>When you run</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">[(<span style="color:#e6db74">&#39;__doc__&#39;</span>, None), (<span style="color:#e6db74">&#39;__module__&#39;</span>,<span style="color:#e6db74">&#39;__main__&#39;</span>), (<span style="color:#e6db74">&#39;abc&#39;</span>, <span style="color:#ae81ff">111</span>), (<span style="color:#e6db74">&#39;efg&#39;</span>, <span style="color:#ae81ff">222</span>)]
<span style="color:#f92672">-</span> <span style="color:#f92672">-----------------------------</span>
[(<span style="color:#e6db74">&#39;__doc__&#39;</span>, None), (<span style="color:#e6db74">&#39;__module__&#39;</span>,<span style="color:#e6db74">&#39;__main__&#39;</span>), (<span style="color:#e6db74">&#39;efg&#39;</span>, <span style="color:#ae81ff">222</span>)]
</code></pre></div><p>Disappeared. This area is similar to JavaScript.</p>
<p>#There is no constructor</p>
<p>There is no constructor in python at the following site.</p>
<ul>
<li><a href="http://www.sakito.com/2012/10/python-new-init.html">Introduction Mania Draft Edition: Python&rsquo;s <strong>new</strong> and <strong>init</strong> are not constructors</a></li>
</ul>
<p>Also, that kind of thing was written in the book. <sub><a href="#1">*1</a></sub>
As the definition of the constructor, it seems that memory allocation is also done by the constructor.</p>
<p>From the standpoint of programming, since memory allocation is built into the language, instances can be initialized, so I thought that <strong>init</strong> could be thought of as a general constructor.
Regarding _<em>new</em>_, it seems a little different, so I&rsquo;ll write a little more next.</p>
<p>What is # _<em>new</em>_</p>
<p>First, let&rsquo;s write a simple code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>(object):
abc <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;chkpnt10&#34;</span>
<span style="color:#66d9ef">def</span> __new__(cls):
cls<span style="color:#f92672">.</span>efg <span style="color:#f92672">=</span> <span style="color:#ae81ff">777</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;chkpnt20&#34;</span>
<span style="color:#66d9ef">return</span> super(sampleCls, cls)<span style="color:#f92672">.</span>__new__(cls)
<span style="color:#66d9ef">def</span> __init__(self):
self<span style="color:#f92672">.</span>hij <span style="color:#f92672">=</span> <span style="color:#ae81ff">999</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;chkpnt30&#34;</span>

pprint(dir(sampleCls))
</code></pre></div><p>When I run this,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">chkpnt10
[<span style="color:#e6db74">&#39;__class__&#39;</span>,
 <span style="color:#e6db74">&#39;__delattr__&#39;</span>,
 <span style="color:#e6db74">&#39;__dict__&#39;</span>,
 <span style="color:#e6db74">&#39;__doc__&#39;</span>,
 <span style="color:#e6db74">&#39;__format__&#39;</span>,
 <span style="color:#e6db74">&#39;__getattribute__&#39;</span>,
 <span style="color:#e6db74">&#39;__hash__&#39;</span>,
 <span style="color:#e6db74">&#39;__init__&#39;</span>,
 <span style="color:#e6db74">&#39;__module__&#39;</span>,
 <span style="color:#e6db74">&#39;__new__&#39;</span>,
 <span style="color:#e6db74">&#39;__reduce__&#39;</span>,
 <span style="color:#e6db74">&#39;__reduce_ex__&#39;</span>,
 <span style="color:#e6db74">&#39;__repr__&#39;</span>,
 <span style="color:#e6db74">&#39;__setattr__&#39;</span>,
 <span style="color:#e6db74">&#39;__sizeof__&#39;</span>,
 <span style="color:#e6db74">&#39;__str__&#39;</span>,
 <span style="color:#e6db74">&#39;__subclasshook__&#39;</span>,
 <span style="color:#e6db74">&#39;__weakref__&#39;</span>,
 <span style="color:#e6db74">&#39;abc&#39;</span>]
</code></pre></div><p>chkpnt10 is output, but chkpnt20 and chkpnt30 are not displayed.
Neither efg nor hij are included in the class object dump.
What happens when you create an instance?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">sampleCls</span>(object):
abc <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;chkpnt10&#34;</span>
<span style="color:#66d9ef">def</span> __new__(cls):
cls<span style="color:#f92672">.</span>efg <span style="color:#f92672">=</span> <span style="color:#ae81ff">777</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;chkpnt20&#34;</span>
<span style="color:#66d9ef">return</span> super(sampleCls, cls)<span style="color:#f92672">.</span>__new__(cls)
<span style="color:#66d9ef">def</span> __init__(self):
self<span style="color:#f92672">.</span>hij <span style="color:#f92672">=</span> <span style="color:#ae81ff">999</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;chkpnt30&#34;</span>
i <span style="color:#f92672">=</span> sampleCls()
pprint (inspect<span style="color:#f92672">.</span>getmembers(sampleCls))
pprint (inspect<span style="color:#f92672">.</span>getmembers(i))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">chkpnt10
chkpnt20
chkpnt30
[<span style="color:#e6db74">&#39;__class__&#39;</span>,
 <span style="color:#e6db74">&#39;__delattr__&#39;</span>,
 <span style="color:#e6db74">&#39;__dict__&#39;</span>,
 <span style="color:#e6db74">&#39;__doc__&#39;</span>,
 <span style="color:#e6db74">&#39;__format__&#39;</span>,
 <span style="color:#e6db74">&#39;__getattribute__&#39;</span>,
 <span style="color:#e6db74">&#39;__hash__&#39;</span>,
 <span style="color:#e6db74">&#39;__init__&#39;</span>,
 <span style="color:#e6db74">&#39;__module__&#39;</span>,
 <span style="color:#e6db74">&#39;__new__&#39;</span>,
 <span style="color:#e6db74">&#39;__reduce__&#39;</span>,
 <span style="color:#e6db74">&#39;__reduce_ex__&#39;</span>,
 <span style="color:#e6db74">&#39;__repr__&#39;</span>,
 <span style="color:#e6db74">&#39;__setattr__&#39;</span>,
 <span style="color:#e6db74">&#39;__sizeof__&#39;</span>,
 <span style="color:#e6db74">&#39;__str__&#39;</span>,
 <span style="color:#e6db74">&#39;__subclasshook__&#39;</span>,
 <span style="color:#e6db74">&#39;__weakref__&#39;</span>,
 <span style="color:#e6db74">&#39;abc&#39;</span>,
 <span style="color:#e6db74">&#39;efg&#39;</span>]
[<span style="color:#e6db74">&#39;__class__&#39;</span>,
 <span style="color:#e6db74">&#39;__delattr__&#39;</span>,
 <span style="color:#e6db74">&#39;__dict__&#39;</span>,
 <span style="color:#e6db74">&#39;__doc__&#39;</span>,
 <span style="color:#e6db74">&#39;__format__&#39;</span>,
 <span style="color:#e6db74">&#39;__getattribute__&#39;</span>,
 <span style="color:#e6db74">&#39;__hash__&#39;</span>,
 <span style="color:#e6db74">&#39;__init__&#39;</span>,
 <span style="color:#e6db74">&#39;__module__&#39;</span>,
 <span style="color:#e6db74">&#39;__new__&#39;</span>,
 <span style="color:#e6db74">&#39;__reduce__&#39;</span>,
 <span style="color:#e6db74">&#39;__reduce_ex__&#39;</span>,
 <span style="color:#e6db74">&#39;__repr__&#39;</span>,
 <span style="color:#e6db74">&#39;__setattr__&#39;</span>,
 <span style="color:#e6db74">&#39;__sizeof__&#39;</span>,
 <span style="color:#e6db74">&#39;__str__&#39;</span>,
 <span style="color:#e6db74">&#39;__subclasshook__&#39;</span>,
 <span style="color:#e6db74">&#39;__weakref__&#39;</span>,
 <span style="color:#e6db74">&#39;abc&#39;</span>,
 <span style="color:#e6db74">&#39;efg&#39;</span>,
 <span style="color:#e6db74">&#39;hij&#39;</span>]
</code></pre></div><p>It is output in the order of chkpnt10, chkpnt20, chkpnt30 (the code is running).
The class object contains abc and efg but does not contain hij. The instance object contains all abc, efg and hij.
The first argument of _<em>new</em>_ is a class object. In the above code, efg is set, so efg is added to the class object as a result.
With <code>super(sampleCls, cls).__new__(cls)</code>, an instance object is created from the class object and returned as the return value.
The return value of __new__ is an instance object of the class. If the return value is anything else, an instance object of the class object will not be created.
The instance object created by __new__ is called __init__ as the first argument.
So __new__ is for creating an instance object from a class object.
As in the above code, overriding __new__ allows you to change the class object from which the instance object is created, and this change will also be reflected in the created instance object.
From the above, I thought __new__ was not a constructor.</p>
<p>By the way, in the class,
・Type (new style class)
・Class object (old style class)
The above sample becomes a new style class. Apparently.</p>
<p>Since I use python which is installed by default when DataNitro is installed, the above is the one executed in 2.7.
With 2.7, in order to call (new?) <strong>new</strong>, it is necessary to inherit object or the like. <sub><a href="#2">*2</a></sub><sub><a href="#3">*3</a></sub>
(Since 3.0 inherits object by default, it is no longer necessary to specify class inheritance.)</p>
<p>I checked python over the past few days, and there is a mechanism that allows for fine control in a program, so even if I focus on the class, I still feel a bit muddy. You can search one after another&hellip;
However, I do not hate it. If you try it, you may be addicted in a good way.</p>
<p>As an aside, print has changed from 3.0 to an expression, or you have to add parentheses, so there are changes that affect the implementation level.
It seems that the interface of the library has also changed.</p>
<p>Will I continue to study python for a while?</p>
<hr>
<p><a name="1"><em>1.</a> Perhaps some books have <strong>init</strong> written as a constructor. Rather there are more?<a name="2"></em>2.</a> Inheriting the object and trying to investigate the causal relationship between the call to _<em>new</em>_ and whether the call to __new__ is controlled by the attribute value. I looked it up, but I couldn&rsquo;t finish it.
Even if the <a name="3">*3.</a> type is inherited, __new__ is called. However, in this case, the meaning may be slightly different due to the relationship with the metaclass. Future research issues regarding type.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
