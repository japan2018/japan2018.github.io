<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Is it still exhausted by MVC? ~ SPA development started with Django x React ~ | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Is it still exhausted by MVC? ~ SPA development started with Django x React ~</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 16, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/javascript">JavaScript</a></code></small>


<small><code><a href="https://memotut.com/tags/django">Django</a></code></small>


<small><code><a href="https://memotut.com/tags/api">api</a></code></small>


<small><code><a href="https://memotut.com/tags/react">React</a></code></small>

</p>
<pre><code>Recently, sites using JS framework are increasing.
</code></pre>
<p>In particular, JS frameworks such as React and Vue are often used for application development called SPA and bring many benefits not only to users of the site but also to developers.</p>
<h1 id="assumed-readers">Assumed readers</h1>
<ul>
<li>Web development experience</li>
<li>People who have developed web applications using API</li>
<li>Someone who knows JavaScript a lot and Python a little</li>
<li>I know a little about Django</li>
<li>People who have developed using MVC or MTV</li>
</ul>
<p>There is an article written in more detail in another article, so please see here if you feel that this article is difficult or if you want to learn more deeply.
<a href="https://note.com/_uichi/n/n79a038ce791d">Is MVC still exhausted? ~React x Django&rsquo;s Web development started today~</a></p>
<p>In this article, we will proceed with the tutorial using React as the front end and Django as the back end.
The tutorial will proceed with the ToDo app as the subject.</p>
<p>What is # SPA
SPA is called Single Page Application and it is an effective way to improve the user experience.
It also has three features: data binding, virtual DOM, and Component.</p>
<h2 id="data-binding">Data binding</h2>
<p>If you change the value using plain JavaScript, you have to rotate the process of changing the value by specifying the DOM.
However, using the JS framework, the value displayed on the screen will change each time the defined variable is updated.</p>
<h2 id="virtual-dom">Virtual DOM</h2>
<p>There are two types of JS frameworks, a DOM for drawing in the client browser and a virtual DOM that exists between the server and DOM.
The role of the virtual DOM is to take the difference between the newly emitted virtual DOM from the server and the currently existing virtual DOM, and reflect the difference in the DOM.
Therefore, the DOM is updated only in the part where there is a difference, and the page can be rendered at high speed.</p>
<h2 id="component">Component</h2>
<p>The JS framework allows you to divide page elements into parts called components. That way you can reuse the component and not have to write the same code.</p>
<p>This tutorial only creates one page, so you may not be able to feel the benefits that will lead to a user experience, but I think you can feel the benefits in terms of development.</p>
<h1 id="django-environment-construction">Django environment construction</h1>
<p>First, we will proceed from the back end.</p>
<p>Execute the following commands in order.</p>
<pre><code>mkdir todo-backend
cd todo-backend
python3 -m venv env
source env/bin/activate
pip install django djangorestframework django-cors-headers
django-admin startproject project.
django-admin startapp todo
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
</code></pre><p>Please access 127.0.0.1:8000 when the environment is built.
You should see the initial screen.</p>
<h1 id="django-environment-settings">Django environment settings</h1>
<p>I will add the plugin addition settings and cross origin settings to settings.py.
Cross-origin settings are added to prevent access denied when executing an API from a web browser.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py:settings.py" data-lang="py:settings.py">INSTALLED_APPS <span style="color:#f92672">=</span> [
   <span style="color:#e6db74">&#39;django.contrib.admin&#39;</span>,
   <span style="color:#e6db74">&#39;django.contrib.auth&#39;</span>,
   <span style="color:#e6db74">&#39;django.contrib.contenttypes&#39;</span>,
   <span style="color:#e6db74">&#39;django.contrib.sessions&#39;</span>,
   <span style="color:#e6db74">&#39;django.contrib.messages&#39;</span>,
   <span style="color:#e6db74">&#39;django.contrib.staticfiles&#39;</span>,
   <span style="color:#e6db74">&#39;rest_framework&#39;</span>,
   <span style="color:#e6db74">&#39;corsheaders&#39;</span>,
   <span style="color:#e6db74">&#39;todo&#39;</span>
]

MIDDLEWARE <span style="color:#f92672">=</span> [
   <span style="color:#e6db74">&#39;corsheaders.middleware.CorsMiddleware&#39;</span>,
]

<span style="color:#75715e"># Origins allowed</span>
CORS_ORIGIN_WHITELIST <span style="color:#f92672">=</span> [
   <span style="color:#e6db74">&#39;http://localhost:3000&#39;</span>,
]
</code></pre></div><p>Then, set the API routing in the url configuration file in the project directory.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py:urls.py" data-lang="py:urls.py"><span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path, include

urlpatterns <span style="color:#f92672">=</span> [
   path(<span style="color:#e6db74">&#39;admin/&#39;</span>, admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>urls),
   path(<span style="color:#e6db74">&#39;api/&#39;</span>, include(<span style="color:#e6db74">&#39;todo.urls&#39;</span>)),
]
</code></pre></div><p>#Backend implementation</p>
<p>I will implement the todo application.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py:models.py" data-lang="py:models.py"><span style="color:#f92672">from</span> django.db <span style="color:#f92672">import</span> models

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Todo</span>(models<span style="color:#f92672">.</span>Model):
   name <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>, blank<span style="color:#f92672">=</span>False, null<span style="color:#f92672">=</span>False)
   checked <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>BooleanField(default<span style="color:#f92672">=</span>False)

   <span style="color:#66d9ef">def</span> __str__(self):
       <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>name
</code></pre></div><p>Perform the migration.</p>
<pre><code>python manage.py makemigrations
python manage.py migrate
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py:admin.py" data-lang="py:admin.py"><span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="color:#f92672">from</span> .models <span style="color:#f92672">import</span> Todo

<span style="color:#a6e22e">@admin.register</span>(Todo)
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Todo</span>(admin<span style="color:#f92672">.</span>ModelAdmin):
   <span style="color:#66d9ef">pass</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py:serializer.py" data-lang="py:serializer.py"><span style="color:#f92672">from</span> rest_framework <span style="color:#f92672">import</span> serializers
<span style="color:#f92672">from</span> .models <span style="color:#f92672">import</span> Todo

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TodoSerializer</span>(serializers<span style="color:#f92672">.</span>ModelSerializer):
   <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Meta</span>:
       model <span style="color:#f92672">=</span> Todo
       fields <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;id&#39;</span>,<span style="color:#e6db74">&#39;name&#39;</span>,<span style="color:#e6db74">&#39;checked&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py:views.py" data-lang="py:views.py"><span style="color:#f92672">from</span> rest_framework <span style="color:#f92672">import</span> filters, generics, viewsets
<span style="color:#f92672">from</span> .models <span style="color:#f92672">import</span> Todo
<span style="color:#f92672">from</span> .serializer <span style="color:#f92672">import</span> TodoSerializer

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ToDoViewSet</span>(viewsets<span style="color:#f92672">.</span>ModelViewSet):
   queryset <span style="color:#f92672">=</span> Todo<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>all()
   serializer_class <span style="color:#f92672">=</span> TodoSerializer
   filter_fields <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;name&#39;</span>,)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py:urls.py" data-lang="py:urls.py"><span style="color:#f92672">from</span> rest_framework <span style="color:#f92672">import</span> routers
<span style="color:#f92672">from</span> .views <span style="color:#f92672">import</span> ToDoViewSet
<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path, include

router <span style="color:#f92672">=</span> routers<span style="color:#f92672">.</span>DefaultRouter()
router<span style="color:#f92672">.</span>register(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;todo&#39;</span>, ToDoViewSet)

urlpatterns <span style="color:#f92672">=</span> [
   path(<span style="color:#e6db74">&#39;&#39;</span>, include(router<span style="color:#f92672">.</span>urls)),
]
</code></pre></div><p>When you&rsquo;re done, go to http://localhost:8000/admin and add some tasks.</p>
<h1 id="react-environment-construction">React environment construction</h1>
<p>Use the Create React App to launch the React environment.</p>
<pre><code>yarn create react-app todo-frontend
cd todo-frontend
yarn start
</code></pre><p>When you access http://localhost:3000 and the screen is displayed normally, the environment construction is complete.</p>
<p>#Routing
React does not have a routing function, so install a plugin separately.</p>
<pre><code>yarn add react-router-dom
</code></pre><p>Create Router.jsx directly under the src directory.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx:Router.jsx" data-lang="jsx:Router.jsx"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span><span style="color:#e6db74">&#39;react&#39;</span>;
<span style="color:#66d9ef">import</span> {<span style="color:#a6e22e">BrowserRouter</span>, <span style="color:#a6e22e">Route</span>} <span style="color:#a6e22e">from</span><span style="color:#e6db74">&#39;react-router-dom&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Top</span> <span style="color:#a6e22e">from</span><span style="color:#e6db74">&#39;../components/Top&#39;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Router</span> <span style="color:#f92672">=</span> () =&gt; {
 <span style="color:#66d9ef">return</span> (
   &lt;<span style="color:#f92672">BrowserRouter</span>&gt;
   &lt;/<span style="color:#f92672">BrowserRouter</span>&gt;
 );
};
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">Router</span>;
</code></pre></div><p>Let App.js load the routes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-App.js" data-lang="App.js"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span><span style="color:#e6db74">&#39;react&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Router</span> <span style="color:#a6e22e">from</span><span style="color:#e6db74">&#39;./configs/Router&#39;</span>;

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App</span>() {
 <span style="color:#66d9ef">return</span> (
   <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">Router</span> <span style="color:#f92672">/&gt;</span>
 );
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">App</span>;
</code></pre></div><p>#Screen design</p>
<p>The design framework called Material UI is used for the screen design.
It is provided as a React plugin, so please install it with yarn add.</p>
<pre><code>yarn add @material-ui/core
</code></pre><p>The image below is the finished image.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/243199/16dfaf98-88ba-1da0-3d33-a5c4caca978e.png" alt="Screenshot from 2020-02-16 00-50-08.png"></p>
<h1 id="api-implementation">API implementation</h1>
<p>First, we will implement the API.
If you include it in one component, the readability will decrease, so implement the API processing in a separate file.
There are four API processes to implement: ToDo list acquisition, ToDo creation, ToDo check, and ToDo deletion.</p>
<p>Create src/common/api directory and create todo.js in it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js:todo.js" data-lang="js:todo.js">
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">originUrl</span> <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://127.0.0.1:8000&#39;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">getTodoList</span> <span style="color:#f92672">=</span> (() =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URL</span>(<span style="color:#e6db74">&#39;/api/todo/&#39;</span>, <span style="color:#a6e22e">originUrl</span>);
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise( (<span style="color:#a6e22e">resolve</span>, <span style="color:#a6e22e">reject</span>) =&gt; {
    <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">href</span>).<span style="color:#a6e22e">then</span>( <span style="color:#a6e22e">res</span> =&gt; <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>() )
    .<span style="color:#a6e22e">then</span>( <span style="color:#a6e22e">json</span> =&gt; <span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">json</span>) )
    .<span style="color:#66d9ef">catch</span>( () =&gt; <span style="color:#a6e22e">reject</span>([]) );
  });
});
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">getTodoList</span>;

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">postCreateTodo</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">name</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URL</span>(<span style="color:#e6db74">&#39;/api/todo/&#39;</span>, <span style="color:#a6e22e">originUrl</span>);
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise( <span style="color:#a6e22e">resolve</span> =&gt; {
    <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">href</span>, {
      <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#39;Accept&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
        <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>
      },
      <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({
        <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">name</span>
      })
    })
    .<span style="color:#a6e22e">then</span>( <span style="color:#a6e22e">res</span> =&gt; <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>() )
    .<span style="color:#a6e22e">then</span>( <span style="color:#a6e22e">data</span> =&gt; <span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">data</span>) );
  });
};

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">patchCheckTodo</span> <span style="color:#f92672">=</span> ((<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">check</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URL</span>(<span style="color:#e6db74">`/api/todo/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/`</span>, <span style="color:#a6e22e">originUrl</span>);
  <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">href</span>, {
    <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;PATCH&#39;</span>,
    <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>
    },
    <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({
      <span style="color:#a6e22e">checked</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">check</span>
    })
  });
});

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">deleteTodo</span> <span style="color:#f92672">=</span> ((<span style="color:#a6e22e">id</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URL</span>(<span style="color:#e6db74">`/api/todo/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/`</span>, <span style="color:#a6e22e">originUrl</span>);
  <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">href</span>, { <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;DELETE&#39;</span> });
});
</code></pre></div><h1 id="コンポーネント実装">コンポーネント実装</h1>
<p>次にコンポーネントを実装します。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx:index.jsx" data-lang="jsx:index.jsx"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useEffect</span>, <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Button</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/Button&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Box</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/Box&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">FormGroup</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/FormGroup&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">FormControlLabel</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/FormControlLabel&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Checkbox</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/Checkbox&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Container</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/Container&#39;</span>;
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">makeStyles</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/styles&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">TextField</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@material-ui/core/TextField&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">getToDoList</span>, { <span style="color:#a6e22e">postCreateTodo</span>, <span style="color:#a6e22e">patchCheckTodo</span>, <span style="color:#a6e22e">deleteTodo</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;../../common/api/todo&#39;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">useStyles</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">makeStyles</span>(<span style="color:#a6e22e">theme</span> =&gt; ({
  <span style="color:#a6e22e">todoTextField</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">marginRight</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">theme</span>.<span style="color:#a6e22e">spacing</span>(<span style="color:#ae81ff">1</span>)
  }
}));

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Top</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">classes</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">useStyles</span>();
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">todoList</span>, <span style="color:#a6e22e">setTodoList</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>([]);
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">todo</span>, <span style="color:#a6e22e">setTodo</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>);

  <span style="color:#a6e22e">useEffect</span>(() =&gt; {
    (<span style="color:#a6e22e">async</span> () =&gt; {
      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">list</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">getToDoList</span>();
      <span style="color:#a6e22e">setTodoList</span>(<span style="color:#a6e22e">list</span>);
    })();
  }, []);

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleCreate</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> () =&gt; {
    <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">todo</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">todoList</span>.<span style="color:#a6e22e">some</span>( <span style="color:#a6e22e">value</span> =&gt; <span style="color:#a6e22e">todo</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">name</span> ) ) <span style="color:#66d9ef">return</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">createTodoResponse</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">postCreateTodo</span>(<span style="color:#a6e22e">todo</span>);
    <span style="color:#a6e22e">setTodoList</span>(<span style="color:#a6e22e">todoList</span>.<span style="color:#a6e22e">concat</span>(<span style="color:#a6e22e">createTodoResponse</span>));
  };

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleSetTodo</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; {
    <span style="color:#a6e22e">setTodo</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>);
  };

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleCheck</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">todoId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">checked</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">checked</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">list</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">todoList</span>.<span style="color:#a6e22e">map</span>( (<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">index</span>) =&gt; {
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">toString</span>() <span style="color:#f92672">===</span> <span style="color:#a6e22e">todoId</span>) {
        <span style="color:#a6e22e">todoList</span>[<span style="color:#a6e22e">index</span>].<span style="color:#a6e22e">checked</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">checked</span>;
      }
      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">todoList</span>[<span style="color:#a6e22e">index</span>];
    });
    <span style="color:#a6e22e">setTodoList</span>(<span style="color:#a6e22e">list</span>)
    <span style="color:#a6e22e">patchCheckTodo</span>(<span style="color:#a6e22e">todoId</span>, <span style="color:#a6e22e">checked</span>);
  }

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleDelete</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">todoId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">currentTarget</span>.<span style="color:#a6e22e">dataset</span>.<span style="color:#a6e22e">id</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">list</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">todoList</span>.<span style="color:#a6e22e">filter</span>( <span style="color:#a6e22e">value</span> =&gt; <span style="color:#a6e22e">value</span>[<span style="color:#e6db74">&#39;id&#39;</span>].<span style="color:#a6e22e">toString</span>() <span style="color:#f92672">!==</span> <span style="color:#a6e22e">todoId</span>);
    <span style="color:#a6e22e">setTodoList</span>(<span style="color:#a6e22e">list</span>);
    <span style="color:#a6e22e">deleteTodo</span>(<span style="color:#a6e22e">todoId</span>);
  };

  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">Container</span> <span style="color:#a6e22e">maxWidth</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xs&#34;</span>&gt;
      &lt;<span style="color:#f92672">Box</span> <span style="color:#a6e22e">display</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;flex&#34;</span> <span style="color:#a6e22e">justifyContent</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;space-between&#34;</span> <span style="color:#a6e22e">mt</span><span style="color:#f92672">=</span>{<span style="color:#ae81ff">4</span>} <span style="color:#a6e22e">mb</span><span style="color:#f92672">=</span>{<span style="color:#ae81ff">4</span>}&gt;
        &lt;<span style="color:#f92672">TextField</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">classes</span>.<span style="color:#a6e22e">todoTextField</span>} <span style="color:#a6e22e">label</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;やること&#34;</span> <span style="color:#a6e22e">variant</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;outlined&#34;</span> <span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;small&#34;</span> <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleSetTodo</span>} /&gt;
        &lt;<span style="color:#f92672">Button</span> <span style="color:#a6e22e">variant</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;contained&#34;</span> <span style="color:#a6e22e">color</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;primary&#34;</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleCreate</span>}&gt;<span style="color:#a6e22e">作成</span>&lt;/<span style="color:#f92672">Button</span>&gt;
      &lt;/<span style="color:#f92672">Box</span>&gt;
      &lt;<span style="color:#f92672">FormGroup</span>&gt;
        {<span style="color:#a6e22e">todoList</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">todo</span>, <span style="color:#a6e22e">index</span>) =&gt; {
          <span style="color:#66d9ef">return</span> (
            &lt;<span style="color:#f92672">Box</span> <span style="color:#a6e22e">key</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">index</span>} <span style="color:#a6e22e">display</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;flex&#34;</span> <span style="color:#a6e22e">justifyContent</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;space-between&#34;</span> <span style="color:#a6e22e">mb</span><span style="color:#f92672">=</span>{<span style="color:#ae81ff">1</span>}&gt;
              &lt;<span style="color:#f92672">FormControlLabel</span>
                <span style="color:#a6e22e">control</span><span style="color:#f92672">=</span>{
                  &lt;<span style="color:#f92672">Checkbox</span>
                    <span style="color:#a6e22e">checked</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">todo</span>.<span style="color:#a6e22e">checked</span>}
                    <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleCheck</span>}
                    <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">todo</span>.<span style="color:#a6e22e">id</span>}
                    <span style="color:#a6e22e">color</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;primary&#34;</span>
                  /&gt;
                }
                <span style="color:#a6e22e">label</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">todo</span>.<span style="color:#a6e22e">name</span>}
              /&gt;
              &lt;<span style="color:#f92672">Button</span> <span style="color:#a6e22e">variant</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;contained&#34;</span> <span style="color:#a6e22e">color</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;secondary&#34;</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">id</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">todo</span>.<span style="color:#a6e22e">id</span>} <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleDelete</span>}&gt;<span style="color:#a6e22e">削除</span>&lt;/<span style="color:#f92672">Button</span>&gt;
            &lt;/<span style="color:#f92672">Box</span>&gt;
          )
        })}
      &lt;/<span style="color:#f92672">FormGroup</span>&gt;
    &lt;/<span style="color:#f92672">Container</span>&gt;
  )
};
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">Top</span>;
</code></pre></div><h1 id="最後に">最後に</h1>
<p>ToDoアプリを一つ作りましたが、この記事の内容だけだとまだ実用はできないので、いずれホスティングに載せるところまでを紹介しようと思います。</p>
<p>誤字脱字や、間違いがあればご連絡ください。
ソースコードをGitHubに上げているので、必要であれば使ってください。</p>
<p>フロントエンド
<a href="https://github.com/uichi/todo-frontend">https://github.com/uichi/todo-frontend</a></p>
<p>バックエンド
<a href="https://github.com/uichi/todo-backend">https://github.com/uichi/todo-backend</a></p>
<h1 id="参考">参考</h1>
<p><a href="https://ja.reactjs.org/">React公式</a>
<a href="https://material-ui.com/">Material UI公式</a>
<a href="https://docs.djangoproject.com/ja/3.0/">Django公式</a>
<a href="https://www.django-rest-framework.org/">Django REST framework公式</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
