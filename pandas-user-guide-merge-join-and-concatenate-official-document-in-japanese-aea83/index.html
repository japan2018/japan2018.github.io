<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Pandas User Guide merge, join and concatenate (official document in Japanese) | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Pandas User Guide merge, join and concatenate (official document in Japanese)</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 26, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/pandas">pandas</a></code></small>


<small><code><a href="https://memotut.com/tags/python3">Python3</a></code></small>

</p>
<pre><code>This article is a machine translation of [User Guide-Merge, join, and concatenate](https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html) of Pandas official document. It is a rework of an unnatural sentence in a section.
</code></pre>
<p>If you have any suggestions for mistranslation, alternative translations, questions, etc., please use the comments or edit request.</p>
<h1 id="merge-join-and-concatenate">merge, join and concatenate</h1>
<p>pandas provides various kinds of set operations and various functions of index and relational algebra function in join/merge type operations to easily join Series or DataFrame.</p>
<h2 id="object-concatenate">object concatenate</h2>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html#pandas.concat"><code>concat()</code></a>function(locatedinthemainpandasnamespace)Doesallthetediousworkofperformingconcatenationoperationsalonganaxis,performingarbitrarysetoperations(unionandintersection)ontheindicesofotheraxes(ifany). Note that a Series has only one concatenated axis, so it says &ldquo;if&rdquo;. Before we dive into the details of Concat and what it can do, let&rsquo;s look at a simple example.</p>
<p>Before we dive into the details of <code>concat</code> and what it can do, here is a simple example.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">1</span>]: df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>,<span style="color:#e6db74">&#39;A3&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>,<span style="color:#e6db74">&#39;B3&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>]},
   <span style="color:#f92672">...</span>: index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
   <span style="color:#f92672">...</span>:

In [<span style="color:#ae81ff">2</span>]: df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A4&#39;</span>,<span style="color:#e6db74">&#39;A5&#39;</span>,<span style="color:#e6db74">&#39;A6&#39;</span>,<span style="color:#e6db74">&#39;A7&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B4&#39;</span>,<span style="color:#e6db74">&#39;B5&#39;</span>,<span style="color:#e6db74">&#39;B6&#39;</span>,<span style="color:#e6db74">&#39;B7&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C4&#39;</span>,<span style="color:#e6db74">&#39;C5&#39;</span>,<span style="color:#e6db74">&#39;C6&#39;</span>,<span style="color:#e6db74">&#39;C7&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D4&#39;</span>,<span style="color:#e6db74">&#39;D5&#39;</span>,<span style="color:#e6db74">&#39;D6&#39;</span>,<span style="color:#e6db74">&#39;D7&#39;</span>]},
   <span style="color:#f92672">...</span>: index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>])
   <span style="color:#f92672">...</span>:

In [<span style="color:#ae81ff">3</span>]: df3 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A8&#39;</span>,<span style="color:#e6db74">&#39;A9&#39;</span>,<span style="color:#e6db74">&#39;A10&#39;</span>,<span style="color:#e6db74">&#39;A11&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B8&#39;</span>,<span style="color:#e6db74">&#39;B9&#39;</span>,<span style="color:#e6db74">&#39;B10&#39;</span>,<span style="color:#e6db74">&#39;B11&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C8&#39;</span>,<span style="color:#e6db74">&#39;C9&#39;</span>,<span style="color:#e6db74">&#39;C10&#39;</span>,<span style="color:#e6db74">&#39;C11&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D8&#39;</span>,<span style="color:#e6db74">&#39;D9&#39;</span>,<span style="color:#e6db74">&#39;D10&#39;</span>,<span style="color:#e6db74">&#39;D11&#39;</span>]},
   <span style="color:#f92672">...</span>: index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>])
   <span style="color:#f92672">...</span>:

In [<span style="color:#ae81ff">4</span>]: frames <span style="color:#f92672">=</span> [df1, df2, df3]

In [<span style="color:#ae81ff">5</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(frames)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_basic.png" alt="merging_concat_basic.png"></p>
<p>Similar to <code>numpy.concatenate</code>, which is a sibling of ndarrays, <code>pandas.concat</code> takes a list or dictionary of like objects, along with some configurable &ldquo;what to do with other axes&rdquo; operations. To connect.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">pd<span style="color:#f92672">.</span>concat(objs, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, join<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, ignore_index<span style="color:#f92672">=</span>False, keys<span style="color:#f92672">=</span>None,
          levels<span style="color:#f92672">=</span>None, names<span style="color:#f92672">=</span>None, verify_integrity<span style="color:#f92672">=</span>False, copy<span style="color:#f92672">=</span>True)
</code></pre></div><ul>
<li><code>objs</code>: A sequence or mapping of <code>Series</code> or <code>DataFrame</code> objects. If a dictionary is passed, the sorted keys will be used as the <em>keys</em> argument. Otherwise, the value will be selected (see below). None objects are implicitly excluded. If all are None, ValueError will occur.</li>
<li><code>axis</code>: {0, 1, …}, default 0. Specify the axis to connect.</li>
<li><code>join</code>: {&lsquo;inner&rsquo;,&lsquo;outer&rsquo;}, default is&rsquo;outer&rsquo;. How to handle indexes on other axes. outer is a union and inner is an intersection.</li>
<li><code>ignore_index</code>: boolean value, default is False. If True, do not use the index value on the concatenated axis. The resulting axes are labeled 0, …, n-1. This is useful for joining objects that do not have meaningful index information on the attach axis. Note that the index values for the other axes are still taken into account in the join.</li>
<li><code>keys</code>: Sequence, default None. Builds a hierarchical index using the passed in key as the outermost level. The tuple must be included if multiple levels are passed.</li>
<li><code>levels</code>: list of sequences, default None. The specific level (unique value) used to build the MultiIndex. If None, it is inferred from keys.</li>
<li><code>names</code>: list, default None. The name of the level of the resulting hierarchical index.</li>
<li><code>verify_integrity</code>: Boolean value, False by default. Check if the new consolidation axis contains duplicates. This can be very expensive compared to the actual data binding.</li>
<li><code>copy</code>: Boolean, default is True. If False, do not copy data unnecessarily.</li>
</ul>
<p>Without some explanation, most of these arguments may not make sense. Let&rsquo;s look again at the above example. Suppose you want to associate a particular key with each part of the DataFrame before the join. You can do this using the <code>keys</code> argument.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">6</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(frames, keys<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;x&#39;</span>,<span style="color:#e6db74">&#39;y&#39;</span>,<span style="color:#e6db74">&#39;z&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_keys.png" alt="merging_concat_keys.png"></p>
<p>As you can see from this (if you read the rest of the document), the index of the resulting object is <a href="https://qiita.com/nkay/items/63afdd4e96f21efbf62b#hierarchicalIndexmulti-index">hierarchical index</a>. This means that you can select each chunk by key.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">7</span>]: result<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;y&#39;</span>]
Out[<span style="color:#ae81ff">7</span>]:
    A B C D
<span style="color:#ae81ff">4</span> A4 B4 C4 D4
<span style="color:#ae81ff">5</span> A5 B5 C5 D5
<span style="color:#ae81ff">6</span> A6 B6 C6 D6
<span style="color:#ae81ff">7</span> A7 B7 C7 D7
</code></pre></div><p>It&rsquo;s not hard to see how useful this is. See below for more information on this feature.</p>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html#pandas.concat"><code>concat()</code></a>(andthusalso<code>append()</code>) is data Note that making a full copy of and constantly reusing this function will significantly reduce performance. If you need to use the operation on multiple datasets, use list comprehensions.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">frames <span style="color:#f92672">=</span> [process_your_file(f) <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> files]
result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(frames)
</code></pre></div><h3 id="set-operation-for-other-axes">Set operation for other axes</h3>
<p>If you combine multiple DataFrames, you can choose how to handle other axes (other than the axes that are bound). This can be done in two ways:</p>
<ul>
<li>To join all (sum, union), set <code>join='outer'</code>. This is the default option because it results in zero information loss.</li>
<li>To take a common part (intersection, intersection), set <code>join='inner'</code>.</li>
</ul>
<p>The following is an example of each of these methods. First, the operation when the default <code>join='outer'</code> is</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">8</span>]: df4 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B2&#39;</span>,<span style="color:#e6db74">&#39;B3&#39;</span>,<span style="color:#e6db74">&#39;B6&#39;</span>,<span style="color:#e6db74">&#39;B7&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>,<span style="color:#e6db74">&#39;D6&#39;</span>,<span style="color:#e6db74">&#39;D7&#39;</span>],
   <span style="color:#f92672">...</span>:<span style="color:#e6db74">&#39;F&#39;</span>: [<span style="color:#e6db74">&#39;F2&#39;</span>,<span style="color:#e6db74">&#39;F3&#39;</span>,<span style="color:#e6db74">&#39;F6&#39;</span>,<span style="color:#e6db74">&#39;F7&#39;</span>]},
   <span style="color:#f92672">...</span>: index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>])
   <span style="color:#f92672">...</span>:

In [<span style="color:#ae81ff">9</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, df4], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, sort<span style="color:#f92672">=</span>False)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_axis1.png" alt="merging_concat_axis1.png"></p>
<blockquote>
<p>:warning: <strong>warning</strong>
_ Changed in version 0.23.0 _</p>
<p><code>join='outer'</code> sorts other axes (columns in this case) by default. Future versions of pandas will not sort by default. Here we have specified <code>sort=False</code> and selected the new behavior.</p>
</blockquote>
<p>If you do the same thing with <code>join='inner'</code>,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">10</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, df4], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, join<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`!</span>[merging_concat_axis1_inner<span style="color:#f92672">.</span>png](https:<span style="color:#f92672">//</span>pandas<span style="color:#f92672">.</span>pydata<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>pandas<span style="color:#f92672">-</span>docs<span style="color:#f92672">/</span>stable<span style="color:#f92672">/</span>_images<span style="color:#f92672">/</span>merging_concat_axis1_inner<span style="color:#f92672">.</span>png)

Finally, I want to reuse the <span style="color:#f92672">*</span>exact index<span style="color:#f92672">*</span> of the original DataFrame<span style="color:#f92672">.</span>

<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span>py
In [<span style="color:#ae81ff">11</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, df4], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>reindex(df1<span style="color:#f92672">.</span>index)
</code></pre></div><p>Similarly, you can create an index before joining.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">12</span>]: pd<span style="color:#f92672">.</span>concat([df1, df4<span style="color:#f92672">.</span>reindex(df1<span style="color:#f92672">.</span>index)], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
Out[<span style="color:#ae81ff">12</span>]:
    A B C D B D F
<span style="color:#ae81ff">0</span> A0 B0 C0 D0 NaN NaN NaN
<span style="color:#ae81ff">1</span> A1 B1 C1 D1 NaN NaN NaN
<span style="color:#ae81ff">2</span> A2 B2 C2 D2 B2 D2 F2
<span style="color:#ae81ff">3</span> A3 B3 C3 D3 B3 D3 F3
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_axis1_join_axes.png" alt="merging_concat_axis1_join_axes.png"></p>
<h3 id="concatenation-using-append">Concatenation using <code>append</code></h3>
<p>[<code>append()</code>] of <code>Series</code> and <code>DataFrame</code>(<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html#pandas.DataFrame.append">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html#pandas.DataFrame.append</a>) Instance methods are a convenient shortcut to <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html#pandas.concat"><code>concat()</code></a>. In fact, these methods preceded <code>concat</code>. They are joined along <code>axis=0</code>, ie index.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">13</span>]: result <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>append(df2)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append1.png" alt="merging_append1.png"></p>
<p>For a <code>DataFrame</code>, the rows are always separate (even if they have the same value), but the columns are not.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">14</span>]: result <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>append(df4, sort<span style="color:#f92672">=</span>False)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append2.png" alt="merging_append2.png"></p>
<p>The <code>append</code> can also accept and combine multiple objects.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">15</span>]: result <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>append([df2, df3])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append3.png" alt="merging_append3.png"></p>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
The list type <code>append()</code> method adds an element to the original list and returns None, but this pandas&rsquo;s <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html#pandas.DataFrame.append"><code>append()</code></a> returns <code>df1</code> <em>without modification</em>*, concatenated with <code>df2</code>.</p>
</blockquote>
<h3 id="ignore-the-link-axis-index">Ignore the link axis index</h3>
<p>For <code>DataFrame</code> objects that don&rsquo;t have a meaningful index, you may want to ignore the duplicate indexes when joining them. To do this, use the <code>ignore_index</code> argument.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">16</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, df4], ignore_index<span style="color:#f92672">=</span>True, sort<span style="color:#f92672">=</span>False)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_ignore_index.png" alt="merging_concat_ignore_index.png"></p>
<p>This argument is also used in <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html#pandas.DataFrame.append"><code>DataFrame.append()</code></a> valid.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">17</span>]: result <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>append(df4, ignore_index<span style="color:#f92672">=</span>True, sort<span style="color:#f92672">=</span>False)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append_ignore_index.png" alt="merging_append_ignore_index.png"></p>
<h3 id="combine-data-with-different-dimensions">Combine data with different dimensions</h3>
<p>You can also combine <code>Series</code> and <code>DataFrame</code> objects. <code>Series</code> is converted into a <code>DataFrame</code> whose column name is its name (<code>name</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">18</span>]: s1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#e6db74">&#39;X0&#39;</span>,<span style="color:#e6db74">&#39;X1&#39;</span>,<span style="color:#e6db74">&#39;X2&#39;</span>,<span style="color:#e6db74">&#39;X3&#39;</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;X&#39;</span>)

In [<span style="color:#ae81ff">19</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, s1], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_mixed_ndim.png" alt="merging_concat_mixed_ndim.png"></p>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
Since I have combined <code>Series</code> to <code>DataFrame</code>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.assign.htmlIwasabletogetthesameresultas#pandas.DataFrame.assign"><code>DataFrame.assign()</code></a>.Use<code>concat</code>toconcatenateanynumberofpandasobjects(<code>DataFrame</code>or<code>Series</code>).</p>
</blockquote>
<p>If an unnamed <code>Series</code> is passed, a serial number will be added to the column name.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">20</span>]: s2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#e6db74">&#39;_0&#39;</span>,<span style="color:#e6db74">&#39;_1&#39;</span>,<span style="color:#e6db74">&#39;_2&#39;</span>,<span style="color:#e6db74">&#39;_3&#39;</span>])

In [<span style="color:#ae81ff">21</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, s2, s2, s2], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_unnamed_series.png" alt="merging_concat_unnamed_series.png"></p>
<p>Passing <code>ignore_index=True</code> will remove all name references.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">22</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, s1], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, ignore_index<span style="color:#f92672">=</span>True)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_series_ignore_index.png" alt="merging_concat_series_ignore_index.png"></p>
<h3 id="further-merging-with-group-keys">Further merging with group keys</h3>
<p>The <code>keys</code> argument is often used when creating a new <code>DataFrame</code> from an existing <code>Series</code> and overwriting a new column name. The default behavior is that the resulting <code>DataFrame</code> inherits the name from the original <code>Series</code> if it exists.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">23</span>]: s3 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;foo&#39;</span>)

In [<span style="color:#ae81ff">24</span>]: s4 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])

In [<span style="color:#ae81ff">25</span>]: s5 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])

In [<span style="color:#ae81ff">26</span>]: pd<span style="color:#f92672">.</span>concat([s3, s4, s5], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
Out[<span style="color:#ae81ff">26</span>]:
   foo <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span>
</code></pre></div><p>You can overwrite existing column names by using the <code>keys</code> argument.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">27</span>]: pd<span style="color:#f92672">.</span>concat([s3, s4, s5], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, keys<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;red&#39;</span>,<span style="color:#e6db74">&#39;blue&#39;</span>,<span style="color:#e6db74">&#39;yellow&#39;</span>])
Out[<span style="color:#ae81ff">27</span>]:
   red blue yellow
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span>
</code></pre></div><p>Let&rsquo;s consider a variation of the first example given.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">28</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(frames, keys<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;x&#39;</span>,<span style="color:#e6db74">&#39;y&#39;</span>,<span style="color:#e6db74">&#39;z&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_group_keys2.png" alt="merging_concat_group_keys2.png"></p>
<p>You can also pass the dictionary to <code>concat</code>. At this time, the dictionary keys are used for the <code>keys</code> argument (if no other keys are specified).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">29</span>]: pieces <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;x&#39;</span>: df1,<span style="color:#e6db74">&#39;y&#39;</span>: df2,<span style="color:#e6db74">&#39;z&#39;</span>: df3}

In [<span style="color:#ae81ff">30</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(pieces)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_dict.png" alt="merging_concat_dict.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">31</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(pieces, keys<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;z&#39;</span>,<span style="color:#e6db74">&#39;y&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`!</span>[merging_concat_dict_keys<span style="color:#f92672">.</span>png](https:<span style="color:#f92672">//</span>pandas<span style="color:#f92672">.</span>pydata<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>pandas<span style="color:#f92672">-</span>docs<span style="color:#f92672">/</span>stable<span style="color:#f92672">/</span>_images<span style="color:#f92672">/</span>merging_concat_dict_keys<span style="color:#f92672">.</span>png)

The created MultiIndex has a level consisting of the passed key <span style="color:#f92672">and</span> the index of the <span style="color:#e6db74">`DataFrame`</span> piece<span style="color:#f92672">.</span>

<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span>py
In [<span style="color:#ae81ff">32</span>]: result<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>levels
Out[<span style="color:#ae81ff">32</span>]: FrozenList([[<span style="color:#e6db74">&#39;z&#39;</span>,<span style="color:#e6db74">&#39;y&#39;</span>], [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>]])
</code></pre></div><p>If you want to specify other levels (and in some cases you may), you can do so using the <code>levels</code> argument.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">33</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(pieces, keys<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;x&#39;</span>,<span style="color:#e6db74">&#39;y&#39;</span>,<span style="color:#e6db74">&#39;z&#39;</span>],
   <span style="color:#f92672">....</span>: levels<span style="color:#f92672">=</span>[[<span style="color:#e6db74">&#39;z&#39;</span>,<span style="color:#e6db74">&#39;y&#39;</span>,<span style="color:#e6db74">&#39;x&#39;</span>,<span style="color:#e6db74">&#39;w&#39;</span>]],
   <span style="color:#f92672">....</span>: names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;group_key&#39;</span>])
   <span style="color:#f92672">....</span>:
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_dict_keys_names.png" alt="merging_concat_dict_keys_names.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">34</span>]: result<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>levels
Out[<span style="color:#ae81ff">34</span>]: FrozenList([[<span style="color:#e6db74">&#39;z&#39;</span>,<span style="color:#e6db74">&#39;y&#39;</span>,<span style="color:#e6db74">&#39;x&#39;</span>,<span style="color:#e6db74">&#39;w&#39;</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span> ]])
</code></pre></div><p>This is pretty esoteric, but it is actually needed for implementations such as GroupBy where the order of categorical variables makes sense.</p>
<h3 id="add-a-row-for-dataframe-append">Add a row for DataFrame (append)</h3>
<p>It&rsquo;s not very efficient (since a new object is always created), but you can add a line to the <code>DataFrame</code> by passing the <code>Series</code> or dictionary to the <code>append</code>. As mentioned above, this returns a new <code>DataFrame</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">35</span>]: s2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#e6db74">&#39;X0&#39;</span>,<span style="color:#e6db74">&#39;X1&#39;</span>,<span style="color:#e6db74">&#39;X2&#39;</span>,<span style="color:#e6db74">&#39;X3&#39;</span>], index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>,<span style="color:#e6db74">&#39;C&#39;</span>,<span style="color:#e6db74">&#39;D&#39;</span>])

In [<span style="color:#ae81ff">36</span>]: result <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>append(s2, ignore_index<span style="color:#f92672">=</span>True)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append_series_as_row.png" alt="merging_append_series_as_row.png"></p>
<p>If you want to discard the original index of <code>DataFrame</code> with this method, use <code>ignore_index</code>. If you want to keep the index, you need to construct a properly indexed <code>DataFrame</code> and append or concatenate those objects.</p>
<p>You can also pass a list of dictionaries or series.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">37</span>]: dicts <span style="color:#f92672">=</span> [{<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;B&#39;</span>: <span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">3</span>,<span style="color:#e6db74">&#39;X&#39;</span>: <span style="color:#ae81ff">4</span>},
   <span style="color:#f92672">....</span>: {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">5</span>,<span style="color:#e6db74">&#39;B&#39;</span>: <span style="color:#ae81ff">6</span>,<span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">7</span>,<span style="color:#e6db74">&#39;Y&#39;</span>: <span style="color:#ae81ff">8</span>}]
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">38</span>]: result <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>append(dicts, ignore_index<span style="color:#f92672">=</span>True, sort<span style="color:#f92672">=</span>False)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append_dits.png" alt="merging_append_dits.png"></p>
<h2 id="database-style-dataframe-or-named-series-joinmerge">Database style DataFrame or named Series join/merge</h2>
<p>pandas has a full-featured, high-performance, in-memory join operation that is very similar to relational databases such as SQL. These methods are vastly superior (and in some cases even an order of magnitude better) than other open source implementations (such as R&rsquo;s <code>base::merge.data.frame</code>). The reason for this is the careful algorithm design and the internal layout of the data in the <code>DataFrame</code>.</p>
<p>For more advanced operations, see also <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#cookbook-selection">cook book</a>.</p>
<p>If you&rsquo;re new to SQL, but new to pandas, the <a href="https://dev.pandas.io/docs/getting_started/comparison/comparison_with_sql.html#compare-with-sql-join">Compare with SQL</a> May be helpful.</p>
<p>pandas provides a single function, <code>merge()</code>, as the entry point for all standard database merge operations between <code>DataFrame</code> or named <code>Series</code> objects.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>, on<span style="color:#f92672">=</span>None, left_on<span style="color:#f92672">=</span>None, right_on<span style="color:#f92672">=</span>None,
         left_index<span style="color:#f92672">=</span>False, right_index<span style="color:#f92672">=</span>False, sort<span style="color:#f92672">=</span>True,
         suffixes<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;_x&#39;</span>,<span style="color:#e6db74">&#39;_y&#39;</span>), copy<span style="color:#f92672">=</span>True, indicator<span style="color:#f92672">=</span>False,
         validate<span style="color:#f92672">=</span>None)
</code></pre></div><ul>
<li>
<p><code>left</code>: DataFrame or named Series object.</p>
</li>
<li>
<p><code>right</code>: Another DataFrame or named Series object.</p>
</li>
<li>
<p><code>on</code>: Column or row level name to join. Must exist on both the left and right DataFrame or Series objects. If this is not specified and <code>left_index</code> and <code>right_index</code> are <code>False</code>, the intersection of the DataFrame or Series columns is assumed to be the join key.</p>
</li>
<li>
<p><code>left_on</code>: Column or row level of the left DataFrame or Series to use as the key. You can receive either a column or row level name, or an array of length equal to the length (len) of the DataFrame or Series.</p>
</li>
<li>
<p><code>right_on</code>: The left DataFrame or Series column or row level to use as a key. You can receive either a column or row level name, or an array of length equal to the length (len) of the DataFrame or Series.</p>
</li>
<li>
<p><code>left_index</code>: If it is <code>True</code>, the left DataFrame or Series index (row label) is used as the binding key. For a DataFrame or Series with a MultiIndex (hierarchy), the number of levels must match the number of join keys from the DataFrame or Series on the right.</p>
</li>
<li>
<p><code>right_index</code>: The same specification as <code>left_index</code> for the right DataFrame or Series.</p>
</li>
<li>
<p><code>how</code>: One of <code>'left'</code>, <code>'right'</code>, <code>'outer'</code>, and <code>'inner'</code>. The default is&rsquo;inner&rsquo;. Details of each method are given below.</p>
</li>
<li>
<p><code>sort</code>: Sort the resulting DataFrames lexicographically by the join key. The default is <code>True</code>, and setting it to <code>False</code> often results in a significant performance boost.</p>
</li>
<li>
<p><code>suffixes</code>: A tuple of prefixes to apply to duplicate columns. The default is <code>('_x','_y')</code>.</p>
</li>
<li>
<p><code>copy</code>: (For the default <code>True</code>) Always copy the data from the passed DataFrame or named Series object, even if it does not need to be reindexed. Copying is often unavoidable, but it can improve performance memory usage. There are rare cases where you can avoid copying, but this option is still provided.</p>
</li>
<li>
<p><code>indicator</code>: Add a column to the output DataFrame with information about the source of each row, named <code>_merge</code>. <code>_merge</code> is a Categorical type, <code>left_only</code> if the merge key exists only in a DataFrame or Series with&rsquo;left&rsquo;, <code>right_only</code> if it exists only in a DataFrame or Series with <code>right</code>, or both Takes the value of <code>both</code>.</p>
</li>
<li>
<p><code>validate</code>: String, default None. If specified, checks to see if the merge is of the specified type.
-“One_to_one” or “1:1”: Check if the merge key is unique in both left and right datasets.
-“One_to_many” or “1:m”: Check if the merge key is unique in the left dataset.
-“Many_to_one” or “m:1”: Check if the merge key is unique in the right dataset.
-“Many_to_many” or “m:m”: Takes an argument but does not check it.</p>
<p>_ From version 0.21.0 _</p>
</li>
</ul>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
Support for specifying line levels using the <code>on</code>, <code>left_on</code>, and <code>right_on</code> arguments was added in version 0.23.0. Support for merging named <code>Series</code> objects was added in version 0.24.0.</p>
</blockquote>
<p>The return type is the same as <code>left</code>. If <code>left</code> is a <code>DataFrame</code> or a named <code>Series</code> and <code>right</code> is a subclass of <code>DataFrame</code>, the return type will still be <code>DataFrame</code>.</p>
<p><code>merge</code> is a function in the pandas namespace, but you can also use the <code>DataFrame</code> instance method <code>merge()</code>. The caller&rsquo;s <code>DataFrame</code> is implicitly considered to be the object to the left of the join.</p>
<p>The related <code>join()</code> method uses <code>merge</code> internally for index-on-index (default) and column-on-index joins. If you want to join by index only, you can use <code>DataFrame.join</code> to simplify the input.</p>
<h3 id="outline-of-merge-method-relational-algebra">Outline of merge method (relational algebra)</h3>
<p>Experienced users of relational databases like SQL are familiar with terminology to describe join operations between two SQL table-like structures (<code>DataFrame</code> objects). There are some cases to consider that are very important to understand.</p>
<ul>
<li><strong>one-to-one</strong> Join: For example, when joining two <code>DataFrame</code> objects according to an index (including unique values).-<strong>many-to-one</strong> join: For example, when joining an index (unique) to one or more columns of different DataFrames.</li>
<li><strong>many-to-many</strong> join: when joining columns to columns.</li>
</ul>
<blockquote>
<p>When joining columns to columns (like a <strong>many-to-many</strong> join), all indexes of the <code>DataFrame</code> objects passed will be <strong>discarded</strong>.</p>
</blockquote>
<p>Understanding the consequences of a <strong>many-to-many</strong> join is worth the time. In SQL or standard relational algebra, if a key combination occurs multiple times in both tables, the resulting table will contain a <strong>Cartesian product</strong> of related data. The following is a very basic example with one unique key combination.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">39</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;K3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>,<span style="color:#e6db74">&#39;A3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>,<span style="color:#e6db74">&#39;B3&#39;</span>]})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">40</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;K3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>]})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">41</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key.png" alt="merging_merge_on_key.png"></p>
<p>Below is a more complex example using multiple join keys. By default, <code>how='inner'</code>, so only keys that are common to the left and right will appear in the result (intersection intersection).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">42</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key1&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;key2&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>,<span style="color:#e6db74">&#39;A3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>,<span style="color:#e6db74">&#39;B3&#39;</span>]})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">43</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key1&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;key2&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>]})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">44</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_multiple.png" alt="merging_merge_on_key_multiple.png"></p>
<p>The <code>how</code> argument specifies how to determine the keys contained in the table resulting from <code>merge</code>. If the key combination <strong>doesn&rsquo;t exist</strong> in either the left or right table, the value of the joined table will be <code>NA</code>. Here&rsquo;s a summary of the <code>how</code> options and their SQL equivalents:</p>
<p>| merge method | SQL JOIN name | Behavior |
| :&mdash;&mdash;&mdash;&mdash;- | :&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; | :&mdash;&mdash;&mdash;&mdash;&ndash; &mdash;&mdash;&mdash;&ndash; |
| <code>left</code> | <code>LEFT OUTER JOIN</code> | Use only the left key |
| <code>right</code> | <code>RIGHT OUTER JOIN</code> | Use only the right key |
| <code>outer</code> | <code>FULL OUTER JOIN</code> | Uses the sum of both keys |
| <code>inner</code> | <code>INNER JOIN</code> | Uses the intersection of both keys |</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">45</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_left.png" alt="merging_merge_on_key_left.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">46</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;right&#39;</span>, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_right.png" alt="merging_merge_on_key_right.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">47</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_outer.png" alt="merging_merge_on_key_outer.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">48</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_inner.png" alt="merging_merge_on_key_inner.png"></p>
<p>The following example is for a DataFrame with duplicate join keys.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">49</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>],<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>]})

In [<span style="color:#ae81ff">50</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>]})

In [<span style="color:#ae81ff">51</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;B&#39;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_dup.png" alt="merging_merge_on_key_dup.png"></p>
<blockquote>
<p>:warning: <strong>warning</strong>
Join/merge with duplicate keys may return frames of row dimension multiplication, which can lead to memory overflow. Users must manage duplicate keys before joining large DataFrames.</p>
</blockquote>
<h3 id="check-for-duplicate-keys">Check for duplicate keys</h3>
<p>_ From version 0.21.0 _</p>
<p>The user can use the <code>validate</code> argument to automatically check for unexpected duplicates in the merge key. The uniqueness of the keys will be checked before the join operation, which will prevent memory overflow. Checking key uniqueness is also a good way to ensure that the user data structure is what you expect.</p>
<p>In the following example, the value of <code>B</code> in the right <code>DataFrame</code> is duplicated. This is not a one-to-one merge specified by the <code>validate</code> argument, so an exception is thrown.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">52</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>],<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]})

In [<span style="color:#ae81ff">53</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>],<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>]})
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">53</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;B&#39;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, validate<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;one_to_one&#34;</span>)
<span style="color:#f92672">...</span>
MergeError: Merge keys are <span style="color:#f92672">not</span> unique <span style="color:#f92672">in</span> right dataset; <span style="color:#f92672">not</span> a one<span style="color:#f92672">-</span>to<span style="color:#f92672">-</span>one merge
</code></pre></div><p>If you already know that the right <code>DataFrame</code> has duplicates and you want to make sure the left <code>DataFrame</code> is unique, you can use the <code>validate='one_to_many'</code> argument instead. This does not raise an exception.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">54</span>]: pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;B&#39;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, validate<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;one_to_many&#34;</span>)
Out[<span style="color:#ae81ff">54</span>]:
   A_x B A_y
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> NaN
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4.0</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5.0</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6.0</span>
</code></pre></div><h3 id="merge-indicator">merge indicator</h3>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge.html#pandas.merge"><code>merge()</code></a> takes an <code>indicator</code> argument. If <code>True</code>, a Categorical type column called <code>_merge</code> with one of the following values is added to the output object.</p>
<table>
<thead>
<tr>
<th align="left">Observation origin</th>
<th align="left">The value of <code>_merge</code></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">The binding key exists only in the <code>left</code> frame</td>
<td align="left"><code>left_only</code></td>
</tr>
<tr>
<td align="left">The binding key exists only in the <code>right</code> frame</td>
<td align="left"><code>right_only</code></td>
</tr>
<tr>
<td align="left">Join key exists in both frames</td>
<td align="left"><code>both</code></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">55</span>]: df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;col1&#39;</span>: [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>],<span style="color:#e6db74">&#39;col_left&#39;</span>: [<span style="color:#e6db74">&#39;a&#39;</span>,<span style="color:#e6db74">&#39;b&#39;</span>]})In [<span style="color:#ae81ff">56</span>]: df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;col1&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>],<span style="color:#e6db74">&#39;col_right&#39;</span>: [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>]})

In [<span style="color:#ae81ff">57</span>]: pd<span style="color:#f92672">.</span>merge(df1, df2, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;col1&#39;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, indicator<span style="color:#f92672">=</span>True)
Out[<span style="color:#ae81ff">57</span>]:
   col1 col_left col_right _merge
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> a NaN left_only
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> b <span style="color:#ae81ff">2.0</span> both
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> NaN <span style="color:#ae81ff">2.0</span> right_only
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> NaN <span style="color:#ae81ff">2.0</span> right_only
</code></pre></div><p>The <code>indicator</code> argument can also accept a string. In this case, the indicator function uses the passed string value as the name of the indicator column.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">58</span>]: pd<span style="color:#f92672">.</span>merge(df1, df2, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;col1&#39;</span>, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, indicator<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;indicator_column&#39;</span>)
Out[<span style="color:#ae81ff">58</span>]:
   col1 col_left col_right indicator_column
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> a NaN left_only
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> b <span style="color:#ae81ff">2.0</span> both
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> NaN <span style="color:#ae81ff">2.0</span> right_only
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> NaN <span style="color:#ae81ff">2.0</span> right_only
</code></pre></div><h3 id="merge-data-type">merge data type</h3>
<p>merge retains the data type of the merge key.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">59</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#ae81ff">1</span>],<span style="color:#e6db74">&#39;v1&#39;</span>: [<span style="color:#ae81ff">10</span>]})

In [<span style="color:#ae81ff">60</span>]: left
Out[<span style="color:#ae81ff">60</span>]:
   key v1
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">10</span>

In [<span style="color:#ae81ff">61</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>],<span style="color:#e6db74">&#39;v1&#39;</span>: [<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>]})

In [<span style="color:#ae81ff">62</span>]: right
Out[<span style="color:#ae81ff">62</span>]:
   key v1
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">30</span>
</code></pre></div><p>Can hold a join key.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">63</span>]: pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)
Out[<span style="color:#ae81ff">63</span>]:
   key v1
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">10</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">30</span>

In [<span style="color:#ae81ff">64</span>]: pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)<span style="color:#f92672">.</span>dtypes
Out[<span style="color:#ae81ff">64</span>]:
key int64
v1 int64
dtype: object
</code></pre></div><p>Of course, if there are missing values, the resulting data type will be upcast.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">65</span>]: pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>)
Out[<span style="color:#ae81ff">65</span>]:
   key v1_x v1_y
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">10.0</span> <span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> NaN <span style="color:#ae81ff">30</span>

In [<span style="color:#ae81ff">66</span>]: pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>)<span style="color:#f92672">.</span>dtypes
Out[<span style="color:#ae81ff">66</span>]:
key int64
v1_x float64
v1_y int64
dtype: object
</code></pre></div><p>merge retains the original <code>category</code> data type. See also the section on <a href="https://dev.pandas.io/docs/user_guide/categorical.html#categorical-merge">Category</a>.</p>
<p>Left frame.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">67</span>]: <span style="color:#f92672">from</span> pandas.api.types <span style="color:#f92672">import</span> CategoricalDtype

In [<span style="color:#ae81ff">68</span>]: X <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>choice([<span style="color:#e6db74">&#39;foo&#39;</span>,<span style="color:#e6db74">&#39;bar&#39;</span>], size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,)))

In [<span style="color:#ae81ff">69</span>]: X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(CategoricalDtype(categories<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;foo&#39;</span>,<span style="color:#e6db74">&#39;bar&#39;</span>]))

In [<span style="color:#ae81ff">70</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;X&#39;</span>: X,
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;Y&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>choice([<span style="color:#e6db74">&#39;one&#39;</span>,<span style="color:#e6db74">&#39;two&#39;</span>,<span style="color:#e6db74">&#39;three&#39;</span>],
   <span style="color:#f92672">....</span>: size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,))})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">71</span>]: left
Out[<span style="color:#ae81ff">71</span>]:
     X Y
<span style="color:#ae81ff">0</span> bar one
<span style="color:#ae81ff">1</span> foo one
<span style="color:#ae81ff">2</span> foo three
<span style="color:#ae81ff">3</span> bar three
<span style="color:#ae81ff">4</span> foo one
<span style="color:#ae81ff">5</span> bar one
<span style="color:#ae81ff">6</span> bar three
<span style="color:#ae81ff">7</span> bar three
<span style="color:#ae81ff">8</span> bar three
<span style="color:#ae81ff">9</span> foo three

In [<span style="color:#ae81ff">72</span>]: left<span style="color:#f92672">.</span>dtypes
Out[<span style="color:#ae81ff">72</span>]:
X category
Y object
dtype: object
</code></pre></div><p>Right frame.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">73</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;X&#39;</span>: pd<span style="color:#f92672">.</span>Series([<span style="color:#e6db74">&#39;foo&#39;</span>,<span style="color:#e6db74">&#39;bar&#39;</span>],
   <span style="color:#f92672">....</span>: dtype<span style="color:#f92672">=</span>CategoricalDtype([<span style="color:#e6db74">&#39;foo&#39;</span>,<span style="color:#e6db74">&#39;bar&#39;</span>])),
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;Z&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">74</span>]: right
Out[<span style="color:#ae81ff">74</span>]:
     X Z
<span style="color:#ae81ff">0</span> foo <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> bar <span style="color:#ae81ff">2</span>

In [<span style="color:#ae81ff">75</span>]: right<span style="color:#f92672">.</span>dtypes
Out[<span style="color:#ae81ff">75</span>]:
X category
Z int64
dtype: object
</code></pre></div><p>Result of combining.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">76</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)

In [<span style="color:#ae81ff">77</span>]: result
Out[<span style="color:#ae81ff">77</span>]:
     X Y Z
<span style="color:#ae81ff">0</span> bar one <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">1</span> bar three <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2</span> bar one <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">3</span> bar three <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">4</span> bar three <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">5</span> bar three <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">6</span> foo one <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">7</span> foo three <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">8</span> foo one <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">9</span> foo three <span style="color:#ae81ff">1</span>

In [<span style="color:#ae81ff">78</span>]: result<span style="color:#f92672">.</span>dtypes
Out[<span style="color:#ae81ff">78</span>]:
X category
Y object
Z int64
dtype: object
</code></pre></div><blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
Category types must have the same category and order attributes and be <em>exactly</em> identical. Otherwise, the result will overwrite the data type of the category element.</p>
</blockquote>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
Joining the same <code>category</code> datatype can be very performant compared to merging the <code>object</code> datatype.</p>
</blockquote>
<h3 id="join-according-to-index">join according to index</h3>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>DataFrame.join()</code></a> may have different indexes Convenience method for combining two different <code>DataFrame</code> columns into one <code>DataFrame</code>. The following example is a very basic example.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">79</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>]},
   <span style="color:#f92672">....</span>: index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>])
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">80</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>]},
   <span style="color:#f92672">....</span>: index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;K3&#39;</span>])
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">81</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join.png" alt="merging_join.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">82</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_outer.png" alt="merging_join_outer.png"></p>
<p>Similar to the above, using <code>how='inner'</code>,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">83</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_inner.png" alt="merging_join_inner.png"></p>
<p>The alignment of the data here is based on the index (row label). To do the same thing with <code>merge</code>, pass an extra argument that tells it to use the index.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">84</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, left_index<span style="color:#f92672">=</span>True, right_index<span style="color:#f92672">=</span>True, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;outer&#39;</span>)
</code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_index_outer.png" alt="merging_merge_index_outer.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">85</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, left_index<span style="color:#f92672">=</span>True, right_index<span style="color:#f92672">=</span>True, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)
</code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_index_inner.png" alt="merging_merge_index_inner.png"></p>
<h3 id="join-key-column-to-indexjoinhttpspandaspydataorgpandas-docsstablereferenceapipandasdataframejoinhtmlpandasdataframejoin-is-an-optional-on-argument--column-or-multiple-column-names-the-passed-dataframe-will-be-merged-along-its-columns-in-the-dataframe-the-following-two-function-calls-are-exactly-equivalent">Join key column to index<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>join()</code></a> is an optional <code>on</code> argument , Column or multiple column names. The passed <code>DataFrame</code> will be merged along its columns in the <code>DataFrame</code>. The following two function calls are exactly equivalent.</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">left<span style="color:#f92672">.</span>join(right, on<span style="color:#f92672">=</span>key_or_keys)
pd<span style="color:#f92672">.</span>merge(left, right, left_on<span style="color:#f92672">=</span>key_or_keys, right_index<span style="color:#f92672">=</span>True,
         how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>, sort<span style="color:#f92672">=</span>False)
</code></pre></div><p>Obviously you can choose a more convenient format. For many-to-one joins (where one of the <code>DataFrame</code> is already indexed by the join key), it may be more convenient to use <code>join</code>. Below is a simple example.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">86</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>,<span style="color:#e6db74">&#39;A3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>,<span style="color:#e6db74">&#39;B3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;key&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>]})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">87</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>]},
   <span style="color:#f92672">....</span>: index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>])
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">88</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_key_columns.png" alt="merging_join_key_columns.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">89</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, left_on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>, right_index<span style="color:#f92672">=</span>True,
   <span style="color:#f92672">....</span>: how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>, sort<span style="color:#f92672">=</span>False);
   <span style="color:#f92672">....</span>:
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_key_columns.png" alt="merging_merge_key_columns.png"></p>
<p>To combine with multiple keys, the passed DataFrame needs a <code>MultiIndex</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">90</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>,<span style="color:#e6db74">&#39;A3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>,<span style="color:#e6db74">&#39;B3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;key1&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;key2&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>]})
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">91</span>]: index <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples([(<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>), (<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>),
   <span style="color:#f92672">....</span>: (<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>), (<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>)])
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">92</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>]},
   <span style="color:#f92672">....</span>: index<span style="color:#f92672">=</span>index)
   <span style="color:#f92672">....</span>:
</code></pre></div><p>This can be combined by passing the two key column names.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">93</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_multikeys.png" alt="merging_join_multikeys.png"></p>
<p>The default for <code>DataFrame.join</code> is to perform a left join (essentially a &ldquo;VLOOKUP&rdquo; operation for Excel users) using only the keys found in the calling DataFrame. Other join types, such as inner joins, are just as easy to perform.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">94</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>], how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_multikeys_inner.png" alt="merging_join_multikeys_inner.png"></p>
<p>As above, this will remove the unmatched rows.</p>
<h3 id="combining-a-single-index-into-a-multi-index">Combining a single index into a multi-index</h3>
<p>You can combine a single index <code>DataFrame</code> into a <code>DataFrame</code> level with a MultiIndex. In the level name of the frame with MultiIndex, the level matches the index name of the single index frame.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">95</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>]},
   <span style="color:#f92672">....</span>: index<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Index([<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key&#39;</span>))
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">96</span>]: index <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples([(<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;Y0&#39;</span>), (<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;Y1&#39;</span>),
   <span style="color:#f92672">....</span>: (<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;Y2&#39;</span>), (<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;Y3&#39;</span>)],
   <span style="color:#f92672">....</span>: names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>])
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">97</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>]},
   <span style="color:#f92672">....</span>: index<span style="color:#f92672">=</span>index)
   <span style="color:#f92672">....</span>:

In [<span style="color:#ae81ff">98</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_multiindex_inner.png" alt="merging_join_multiindex_inner.png"></p>
<p>The following examples are equivalent, but less redundant, more memory efficient and faster.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">99</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left<span style="color:#f92672">.</span>reset_index(), right<span style="color:#f92672">.</span>reset_index(),
   <span style="color:#f92672">....</span>: on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key&#39;</span>], how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)<span style="color:#f92672">.</span>set_index([<span style="color:#e6db74">&#39;key&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>])
   <span style="color:#f92672">....</span>:
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_multiindex_alternative.png" alt="merging_merge_multiindex_alternative.png"></p>
<h3 id="combining-two-multi-indexes">Combining two multi-indexes</h3>
<p>This method works only if the index of the right argument is fully used in the join and is a subset of the index of the left argument, as in the following example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">100</span>]: leftindex <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_product([list(<span style="color:#e6db74">&#39;abc&#39;</span>), list(<span style="color:#e6db74">&#39;xy&#39;</span>), [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]],
   <span style="color:#f92672">.....</span>: names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;abc&#39;</span>,<span style="color:#e6db74">&#39;xy&#39;</span>,<span style="color:#e6db74">&#39;num&#39;</span>])
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">101</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;v1&#39;</span>: range(<span style="color:#ae81ff">12</span>)}, index<span style="color:#f92672">=</span>leftindex)

In [<span style="color:#ae81ff">102</span>]: left
Out[<span style="color:#ae81ff">102</span>]:
            v1
abc xy num
a x <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>
       twenty one
    y <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
       twenty three
b x <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
       twenty five
    y <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">6</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">7</span>
c x <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">8</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">9</span>
    y <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">10</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">11</span>

In [<span style="color:#ae81ff">103</span>]: rightindex <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_product([list(<span style="color:#e6db74">&#39;abc&#39;</span>), list(<span style="color:#e6db74">&#39;xy&#39;</span>)],
   <span style="color:#f92672">.....</span>: names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;abc&#39;</span>,<span style="color:#e6db74">&#39;xy&#39;</span>])
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">104</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;v2&#39;</span>: [<span style="color:#ae81ff">100</span> <span style="color:#f92672">*</span> i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>)]}, index<span style="color:#f92672">=</span>rightindex)

In [<span style="color:#ae81ff">105</span>]: right
Out[<span style="color:#ae81ff">105</span>]:
         v2
abc xy
a x <span style="color:#ae81ff">100</span>
    y <span style="color:#ae81ff">200</span>
b x <span style="color:#ae81ff">300</span>
    y <span style="color:#ae81ff">400</span>
c x <span style="color:#ae81ff">500</span>
    y <span style="color:#ae81ff">600</span>

In [<span style="color:#ae81ff">106</span>]: left<span style="color:#f92672">.</span>join(right, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;abc&#39;</span>,<span style="color:#e6db74">&#39;xy&#39;</span>], how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)
Out[<span style="color:#ae81ff">106</span>]:
            v1 v2
abc xy num
a x <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">100</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">100</span>
    y <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">200</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">200</span>
b x <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">300</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">300</span>
    y <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">4002</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">400</span>
c x <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">500</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">500</span>
    y <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">600</span>
       <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">11</span> <span style="color:#ae81ff">600</span>
</code></pre></div><p>If that condition is not met, you can use the following code to perform a join of two multi-indexes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">107</span>]: leftindex <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples([(<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;X0&#39;</span>), (<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;X1&#39;</span>),
   <span style="color:#f92672">.....</span>: (<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;X2&#39;</span>)],
   <span style="color:#f92672">.....</span>: names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key&#39;</span>,<span style="color:#e6db74">&#39;X&#39;</span>])
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">108</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>]},
   <span style="color:#f92672">.....</span>: index<span style="color:#f92672">=</span>leftindex)
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">109</span>]: rightindex <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples([(<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;Y0&#39;</span>), (<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;Y1&#39;</span>),
   <span style="color:#f92672">.....</span>: (<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;Y2&#39;</span>), (<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;Y3&#39;</span>)],
   <span style="color:#f92672">.....</span>: names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>])
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">110</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>]},
   <span style="color:#f92672">.....</span>: index<span style="color:#f92672">=</span>rightindex)
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">111</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left<span style="color:#f92672">.</span>reset_index(), right<span style="color:#f92672">.</span>reset_index(),
   <span style="color:#f92672">.....</span>: on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key&#39;</span>], how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;inner&#39;</span>)<span style="color:#f92672">.</span>set_index([<span style="color:#e6db74">&#39;key&#39;</span>,<span style="color:#e6db74">&#39;X&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>])
   <span style="color:#f92672">.....</span>:
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_two_multiindex.png" alt="merging_merge_two_multiindex.png"></p>
<h3 id="merge-with-combination-of-column-and-index-level">Merge with combination of column and index level</h3>
<p>_ From version 0.23 _</p>
<p>The strings passed as the <code>on</code>, <code>left_on</code>, and <code>right_on</code> parameters can reference either the column name or the index level name. This allows you to merge <code>DataFrame</code> instances by index level and column combination without having to reset the index.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">112</span>]: left_index <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Index([<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key1&#39;</span>)

In [<span style="color:#ae81ff">113</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#e6db74">&#39;A0&#39;</span>,<span style="color:#e6db74">&#39;A1&#39;</span>,<span style="color:#e6db74">&#39;A2&#39;</span>,<span style="color:#e6db74">&#39;A3&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#e6db74">&#39;B0&#39;</span>,<span style="color:#e6db74">&#39;B1&#39;</span>,<span style="color:#e6db74">&#39;B2&#39;</span>,<span style="color:#e6db74">&#39;B3&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;key2&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>]},
   <span style="color:#f92672">.....</span>: index<span style="color:#f92672">=</span>left_index)
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">114</span>]: right_index <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Index([<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;key1&#39;</span>)

In [<span style="color:#ae81ff">115</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;C&#39;</span>: [<span style="color:#e6db74">&#39;C0&#39;</span>,<span style="color:#e6db74">&#39;C1&#39;</span>,<span style="color:#e6db74">&#39;C2&#39;</span>,<span style="color:#e6db74">&#39;C3&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;D&#39;</span>: [<span style="color:#e6db74">&#39;D0&#39;</span>,<span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;key2&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>]},
   <span style="color:#f92672">.....</span>: index<span style="color:#f92672">=</span>right_index)
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">116</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>merge(right, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;key1&#39;</span>,<span style="color:#e6db74">&#39;key2&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merge_on_index_and_column.png" alt="merge_on_index_and_column.png"></p>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
When you merge a DataFrame with a string that matches the index level in both frames, the index level is retained as the index level in the resulting DataFrame.</p>
</blockquote>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
Merging a DataFrame using only some levels of <em>MultiIndex</em> will remove the extra levels from the merged result. To keep these levels, move them to a column using <code>reset_index</code> with their level name before performing the merge.</p>
</blockquote>
<blockquote>
<p>:ballot_box_with_check: <strong>NOTE</strong>
If the string matches both the column name and the index level name, a warning is raised and the column takes precedence. This may cause ambiguous errors in future versions.</p>
</blockquote>
<h3 id="columns-with-duplicate-values">Columns with duplicate values</h3>
<p>The <code>suffixes</code> argument of merge takes a tuple of strings to add to the duplicate column names in the input <code>DataFrame</code> to clarify the resulting columns.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">117</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;k&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>],<span style="color:#e6db74">&#39;v&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]})

In [<span style="color:#ae81ff">118</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;k&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K3&#39;</span>],<span style="color:#e6db74">&#39;v&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>]})

In [<span style="color:#ae81ff">119</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;k&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_overlapped.png" alt="merging_merge_overlapped.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">120</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(left, right, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;k&#39;</span>, suffixes<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;_l&#39;</span>,<span style="color:#e6db74">&#39;_r&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_overlapped_suffix.png" alt="merging_merge_overlapped_suffix.png"></p>
<p>Same behavior for <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>DataFrame.join()</code></a> There are <code>lsuffix</code> and <code>rsuffix</code> arguments to do.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">121</span>]: left <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;k&#39;</span>)

In [<span style="color:#ae81ff">122</span>]: right <span style="color:#f92672">=</span> right<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;k&#39;</span>)

In [<span style="color:#ae81ff">123</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join(right, lsuffix<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;_l&#39;</span>, rsuffix<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;_r&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_overlapped_multi_suffix.png" alt="merging_merge_overlapped_multi_suffix.png"></p>
<h3 id="combining-multiple-dataframes">Combining multiple DataFrames</h3>
<p>A list or tuple of <code>DataFrame</code> is <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>join()</code></a> You can also pass them to and combine them by index.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">124</span>]: right2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;v&#39;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>]}, index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>])

In [<span style="color:#ae81ff">125</span>]: result <span style="color:#f92672">=</span> left<span style="color:#f92672">.</span>join([right, right2])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_multi_df.png" alt="merging_join_multi_df.png"></p>
<h3 id="combine-values-in-columns-of-series-or-dataframe">Combine values in columns of Series or DataFrame</h3>
<p>Another fairly common situation is to have two similarly indexed (or similarly indexed) <code>Series</code> or <code>DataFrame</code> objects and match the value of one object with the index of the other. If you want to &ldquo;patch&rdquo; from the value. An example is shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">126</span>]: df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[np<span style="color:#f92672">.</span>nan, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">5.</span>], [<span style="color:#f92672">-</span><span style="color:#ae81ff">4.6</span>, np<span style="color:#f92672">.</span>nan, np<span style="color:#f92672">.</span>nan],
   <span style="color:#f92672">.....</span>: [np<span style="color:#f92672">.</span>nan, <span style="color:#ae81ff">7.</span>, np<span style="color:#f92672">.</span>nan]])
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">127</span>]: df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#f92672">-</span><span style="color:#ae81ff">42.6</span>, np<span style="color:#f92672">.</span>nan, <span style="color:#f92672">-</span><span style="color:#ae81ff">8.2</span>], [<span style="color:#f92672">-</span><span style="color:#ae81ff">5.</span>, <span style="color:#ae81ff">1.6</span>, <span style="color:#ae81ff">4</span>]],
   <span style="color:#f92672">.....</span>: index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>])
   <span style="color:#f92672">.....</span>:
</code></pre></div><p>To do this, use the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.combine_first.html#pandas.DataFrame.combine_first"><code>combine_first()</code></a> method I will.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">128</span>]: result <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>combine_first(df2)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`!</span>[merging_combine_first<span style="color:#f92672">.</span>png](https:<span style="color:#f92672">//</span>pandas<span style="color:#f92672">.</span>pydata<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>pandas<span style="color:#f92672">-</span>docs<span style="color:#f92672">/</span>stable<span style="color:#f92672">/</span>_images<span style="color:#f92672">/</span>merging_combine_first<span style="color:#f92672">.</span>png)

Note that this method gets the value <span style="color:#f92672">from</span> the right <span style="color:#e6db74">`DataFrame`</span> only <span style="color:#66d9ef">if</span> the left <span style="color:#e6db74">`DataFrame`</span> has no value<span style="color:#f92672">.</span> The related method [<span style="color:#e6db74">`update()`</span>](https:<span style="color:#f92672">//</span>pandas<span style="color:#f92672">.</span>pydata<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>pandas<span style="color:#f92672">-</span>docs<span style="color:#f92672">/</span>stable<span style="color:#f92672">/</span>reference<span style="color:#f92672">/</span>api<span style="color:#f92672">/</span>pandas<span style="color:#f92672">.</span>DataFrame<span style="color:#f92672">.</span>update<span style="color:#f92672">.</span>html<span style="color:#75715e">#pandas.DataFrame.update) is Change the value.</span>

<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span>py
In [<span style="color:#ae81ff">129</span>]: df1<span style="color:#f92672">.</span>update(df2)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"></code></pre></div><p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_update.png" alt="merging_update.png"></p>
<h2 id="join-for-time-series-data">Join for time series data</h2>
<h3 id="joining-ordered-data">Joining ordered data</h3>
<p>With the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge_ordered.html#pandas.merge_ordered"><code>merge_ordered()</code></a> function, time series and other ordered You can combine different data. It features an optional <code>fill_method</code> argument to fill/interpolate missing data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">130</span>]: left <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;k&#39;</span>: [<span style="color:#e6db74">&#39;K0&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;lv&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;s&#39;</span>: [<span style="color:#e6db74">&#39;a&#39;</span>,<span style="color:#e6db74">&#39;b&#39;</span>,<span style="color:#e6db74">&#39;c&#39;</span>,<span style="color:#e6db74">&#39;d&#39;</span>]})
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">131</span>]: right <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;k&#39;</span>: [<span style="color:#e6db74">&#39;K1&#39;</span>,<span style="color:#e6db74">&#39;K2&#39;</span>,<span style="color:#e6db74">&#39;K4&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;rv&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]})
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">132</span>]: pd<span style="color:#f92672">.</span>merge_ordered(left, right, fill_method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ffill&#39;</span>, left_by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;s&#39;</span>)
Out[<span style="color:#ae81ff">132</span>]:
     k lv s rv
<span style="color:#ae81ff">0</span> K0 <span style="color:#ae81ff">1.0</span> a NaN
<span style="color:#ae81ff">1</span> K1 <span style="color:#ae81ff">1.0</span> a <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">2</span> K2 <span style="color:#ae81ff">1.0</span> a <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">3</span> K4 <span style="color:#ae81ff">1.0</span> a <span style="color:#ae81ff">3.0</span>
<span style="color:#ae81ff">4</span> K1 <span style="color:#ae81ff">2.0</span> b <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">5</span> K2 <span style="color:#ae81ff">2.0</span> b <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">6</span> K4 <span style="color:#ae81ff">2.0</span> b <span style="color:#ae81ff">3.0</span>
<span style="color:#ae81ff">7</span> K1 <span style="color:#ae81ff">3.0</span> c <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">8</span> K2 <span style="color:#ae81ff">3.0</span> c <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">9</span> K4 <span style="color:#ae81ff">3.0</span> c <span style="color:#ae81ff">3.0</span>
<span style="color:#ae81ff">10</span> K1 NaN d <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">11</span> K2 <span style="color:#ae81ff">4.0</span> d <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">12</span> K4 <span style="color:#ae81ff">4.0</span> d <span style="color:#ae81ff">3.0</span>
</code></pre></div><h3 id="asof-merge">asof merge</h3>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge_asof.html#pandas.merge_asof"><code>merge_asof()</code></a> is similar to ordered left join , Match with the nearest key, not the equals key. For each line in the <code>left DataFrame</code>, select the last line in the <code>right DataFrame</code> where the <code>on</code> key is less than the left key. Both DataFrames must be sorted by key.</p>
<p>Optionally, the asof merge can perform a group-wise merge. This matches the <code>on</code> key approximately, plus the <code>by</code> key for an exact match.</p>
<p>For example, if you have <code>trades</code> and <code>quotes</code>, merge them.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">133</span>]: trades <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;time&#39;</span>: pd<span style="color:#f92672">.</span>to_datetime([<span style="color:#e6db74">&#39;20160525 13:30:00.023&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.038&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.048&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.048&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.048&#39;</span>]),
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;ticker&#39;</span>: [<span style="color:#e6db74">&#39;MSFT&#39;</span>,<span style="color:#e6db74">&#39;MSFT&#39;</span>,
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;GOOG&#39;</span>,<span style="color:#e6db74">&#39;GOOG&#39;</span>,<span style="color:#e6db74">&#39;AAPL&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;price&#39;</span>: [<span style="color:#ae81ff">51.95</span>, <span style="color:#ae81ff">51.95</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#ae81ff">720.77</span>, <span style="color:#ae81ff">720.92</span>, <span style="color:#ae81ff">98.00</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;quantity&#39;</span>: [<span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">155</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>]},
   <span style="color:#f92672">.....</span>: columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;time&#39;</span>,<span style="color:#e6db74">&#39;ticker&#39;</span>,<span style="color:#e6db74">&#39;price&#39;</span>,<span style="color:#e6db74">&#39;quantity&#39;</span>])
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">134</span>]: quotes <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;time&#39;</span>: pd<span style="color:#f92672">.</span>to_datetime([<span style="color:#e6db74">&#39;20160525 13:30:00.023&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.023&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.030&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.041&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.048&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.049&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.072&#39;</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#e6db74">&#39;20160525 13:30:00.075&#39;</span>]),
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;ticker&#39;</span>: [<span style="color:#e6db74">&#39;GOOG&#39;</span>,<span style="color:#e6db74">&#39;MSFT&#39;</span>,<span style="color:#e6db74">&#39;MSFT&#39;</span>,
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;MSFT&#39;</span>,<span style="color:#e6db74">&#39;GOOG&#39;</span>,<span style="color:#e6db74">&#39;AAPL&#39;</span>,<span style="color:#e6db74">&#39;GOOG&#39;</span>,
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;MSFT&#39;</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;bid&#39;</span>: [<span style="color:#ae81ff">720.50</span>, <span style="color:#ae81ff">51.95</span>, <span style="color:#ae81ff">51.97</span>, <span style="color:#ae81ff">51.99</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#ae81ff">720.50</span>, <span style="color:#ae81ff">97.99</span>, <span style="color:#ae81ff">720.50</span>, <span style="color:#ae81ff">52.01</span>],
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;ask&#39;</span>: [<span style="color:#ae81ff">720.93</span>, <span style="color:#ae81ff">51.96</span>, <span style="color:#ae81ff">51.98</span>, <span style="color:#ae81ff">52.00</span>,
   <span style="color:#f92672">.....</span>: <span style="color:#ae81ff">720.93</span>, <span style="color:#ae81ff">98.01</span>, <span style="color:#ae81ff">720.88</span>, <span style="color:#ae81ff">52.03</span>]},
   <span style="color:#f92672">.....</span>: columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;time&#39;</span>,<span style="color:#e6db74">&#39;ticker&#39;</span>,<span style="color:#e6db74">&#39;bid&#39;</span>,<span style="color:#e6db74">&#39;ask&#39;</span>])
   <span style="color:#f92672">.....</span>:
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">135</span>]: trades
Out[<span style="color:#ae81ff">135</span>]:
                     time ticker price quantity
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.023</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">75</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.038</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">155</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.77</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.92</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> AAPL <span style="color:#ae81ff">98.00</span> <span style="color:#ae81ff">100</span>

In [<span style="color:#ae81ff">136</span>]: quotes
Out[<span style="color:#ae81ff">136</span>]:
                     time ticker bid ask
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.023</span> GOOG <span style="color:#ae81ff">720.50</span> <span style="color:#ae81ff">720.93</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.023</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">51.96</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.030</span> MSFT <span style="color:#ae81ff">51.97</span> <span style="color:#ae81ff">51.98</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.041</span> MSFT <span style="color:#ae81ff">51.99</span> <span style="color:#ae81ff">52.00</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.50</span> <span style="color:#ae81ff">720.93</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.049</span> AAPL <span style="color:#ae81ff">97.99</span> <span style="color:#ae81ff">98.01</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.072</span> GOOG <span style="color:#ae81ff">720.50</span> <span style="color:#ae81ff">720.88</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.075</span> MSFT <span style="color:#ae81ff">52.01</span> <span style="color:#ae81ff">52.03</span>
</code></pre></div><p>Apply quotes asof as default.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">137</span>]: pd<span style="color:#f92672">.</span>merge_asof(trades, quotes,
   <span style="color:#f92672">.....</span>: on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;time&#39;</span>,
   <span style="color:#f92672">.....</span>: by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ticker&#39;</span>)
   <span style="color:#f92672">.....</span>:
Out[<span style="color:#ae81ff">137</span>]:
                     time ticker price quantity bid ask
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.023</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">75</span> <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">51.96</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.038</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">155</span> <span style="color:#ae81ff">51.97</span> <span style="color:#ae81ff">51.98</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.77</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">720.50</span> <span style="color:#ae81ff">720.93</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.92</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">720.50</span> <span style="color:#ae81ff">720.93</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> AAPL <span style="color:#ae81ff">98.00</span> <span style="color:#ae81ff">100</span> NaN NaN
</code></pre></div><p>Set the time between quote time and trade time within <code>2ms</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">138</span>]: pd<span style="color:#f92672">.</span>merge_asof(trades, quotes,
   <span style="color:#f92672">.....</span>: on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;time&#39;</span>,
   <span style="color:#f92672">.....</span>: by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ticker&#39;</span>,<span style="color:#f92672">.....</span>: tolerance<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Timedelta(<span style="color:#e6db74">&#39;2ms&#39;</span>))
   <span style="color:#f92672">.....</span>:
Out[<span style="color:#ae81ff">138</span>]:
                     time ticker price quantity bid ask
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.023</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">75</span> <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">51.96</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.038</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">155</span> NaN NaN
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.77</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">720.50</span> <span style="color:#ae81ff">720.93</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.92</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">720.50</span> <span style="color:#ae81ff">720.93</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> AAPL <span style="color:#ae81ff">98.00</span> <span style="color:#ae81ff">100</span> NaN NaN
</code></pre></div><p>Keep the time between quote time and trade time within <code>10ms</code> and exclude the exact match on time. Exclude exact matches (of quotes), but note that previous quotes <em>propagate</em> up to that point.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">In [<span style="color:#ae81ff">139</span>]: pd<span style="color:#f92672">.</span>merge_asof(trades, quotes,
   <span style="color:#f92672">.....</span>: on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;time&#39;</span>,
   <span style="color:#f92672">.....</span>: by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ticker&#39;</span>,
   <span style="color:#f92672">.....</span>: tolerance<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Timedelta(<span style="color:#e6db74">&#39;10ms&#39;</span>),
   <span style="color:#f92672">.....</span>: allow_exact_matches<span style="color:#f92672">=</span>False)
   <span style="color:#f92672">.....</span>:
Out[<span style="color:#ae81ff">139</span>]:
                     time ticker price quantity bid ask
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.023</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">75</span> NaN NaN
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.038</span> MSFT <span style="color:#ae81ff">51.95</span> <span style="color:#ae81ff">155</span> <span style="color:#ae81ff">51.97</span> <span style="color:#ae81ff">51.98</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.77</span> <span style="color:#ae81ff">100</span> NaN NaN
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> GOOG <span style="color:#ae81ff">720.92</span> <span style="color:#ae81ff">100</span> NaN NaN
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00.048</span> AAPL <span style="color:#ae81ff">98.00</span> <span style="color:#ae81ff">100</span> NaN NaN
</code></pre></div>
    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
