<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>People who want to clear the D problem at ABC of AtCoder scratched the foot | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>People who want to clear the D problem at ABC of AtCoder scratched the foot</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 29, 2019
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/atcoder"> AtCoder</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/competitive-programming"> competitive programming</a></code></small>

</p>
<pre><code>## Introduction
</code></pre>
<ul>
<li>An amateur writer tried <a href="https://atcoder.jp/contests/">AtCoder</a> Beginner Contest several times.</li>
<li>Language is python</li>
<li>However, after the D problem, I have no teeth.</li>
<li>For these problems, it is required to estimate the amount of calculation + how to use algorithms or libraries to improve processing speed or mathematical knowledge.</li>
<li>It&rsquo;s difficult and seems to vomit, but it&rsquo;s funny. If you don&rsquo;t solve it</li>
</ul>
<h2 id="purpose">Purpose</h2>
<ul>
<li>Learn how to solve AtCoder&rsquo;s D-rank problem (400 points).</li>
<li>Learn the estimation of computational complexity for D problems and algorithms to reduce computational complexity.</li>
</ul>
<h2 id="from-now-on">from now on</h2>
<ul>
<li>With the current ability, the image that can be solved in production does not boil &hellip;.</li>
<li>We plan to add articles when the results of studying are accumulated.</li>
</ul>
<h2 id="link-to-the-problem">Link to the problem</h2>
<ul>
<li>ABC D problem
<ul>
<li><a href="https://atcoder.jp/contests/abc142/tasks/abc142_d">ABC 142 D</a></li>
<li><a href="https://atcoder.jp/contests/abc141/tasks/abc141_d">ABC 141 D</a></li>
<li><a href="https://atcoder.jp/contests/abc140/tasks/abc140_d">ABC 140 D</a></li>
<li><a href="https://atcoder.jp/contests/abc139/tasks/abc139_d">ABC 139 D</a></li>
<li><a href="https://atcoder.jp/contests/abc138/tasks/abc138_d">ABC 138 D</a></li>
</ul>
</li>
</ul>
<p>*Problem to practice D problem</p>
<ul>
<li><a href="https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_b">Disco2020 B</a></li>
<li><a href="https://atcoder.jp/contests/abc146/tasks/abc146_c">ABC 146 C</a></li>
</ul>
<h2 id="answer">Answer</h2>
<h3 id="abc-142-dhttpsatcoderjpcontestsabc142tasksabc142_d"><a href="https://atcoder.jp/contests/abc142/tasks/abc142_d">ABC 142 D</a></h3>
<ul>
<li>
<p>Policy</p>
<ul>
<li>Prime number search is $O{(\sqrt{N})}$</li>
<li>$O{(\sqrt{N})}$ when calculating a factor (factoring)</li>
</ul>
</li>
<li>
<p>Implementation</p>
<ul>
<li>Prime number search <code>for i in range(int(math.sqrt(N))+1)</code></li>
<li>The greatest common divisor is the Euclidean algorithm <code>A, B = B, A %B </code></li>
<li>Remember that factoring adds the value divisible by when added to the divisor</li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math

A, B <span style="color:#f92672">=</span> [int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gdc</span>(A, B):
    <span style="color:#66d9ef">if</span> B <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">return</span> A
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> gdc(B, A <span style="color:#f92672">%</span>B)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">chk_pn</span>(num):
    flag <span style="color:#f92672">=</span> True
    <span style="color:#66d9ef">if</span> num <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">3</span>:
        <span style="color:#66d9ef">pass</span>
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>, int(math<span style="color:#f92672">.</span>sqrt(num)) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
            <span style="color:#66d9ef">if</span> num <span style="color:#f92672">%</span>i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
                flag <span style="color:#f92672">=</span> False
                <span style="color:#66d9ef">break</span>
    <span style="color:#66d9ef">return</span> flag

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">mk_factor</span>(num):
    max_divisor <span style="color:#f92672">=</span> int(math<span style="color:#f92672">.</span>sqrt(num))<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    divisor <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
    factor_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>]

    <span style="color:#66d9ef">while</span> divisor <span style="color:#f92672">&lt;=</span> max_divisor:
        <span style="color:#66d9ef">if</span> num <span style="color:#f92672">%</span>divisor <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            factor_list<span style="color:#f92672">.</span>append(divisor)
            num <span style="color:#f92672">/=</span> divisor
        <span style="color:#66d9ef">else</span>:
            divisor <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    
    factor_list<span style="color:#f92672">.</span>append(num) <span style="color:#75715e"># Remember to include the divisible number in the divisor</span>
    <span style="color:#66d9ef">return</span> factor_list

GDC <span style="color:#f92672">=</span> gdc(A, B)
pn_factor <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> mk_factor(GDC) <span style="color:#66d9ef">if</span> chk_pn(i) <span style="color:#f92672">is</span> True]
<span style="color:#75715e"># print(pn_factor)</span>
<span style="color:#66d9ef">print</span>(len(set(pn_factor)))
</code></pre></div><ul>
<li>bonus
<ul>
<li>Least common multiple is ${A B / gdc}$</li>
</ul>
</li>
</ul>
<h3 id="abc-141-dhttpsatcoderjpcontestsabc141tasksabc141_d"><a href="https://atcoder.jp/contests/abc141/tasks/abc141_d">ABC 141 D</a></h3>
<ul>
<li>Policy
<ul>
<li>When using M gift certificates for N products, always use one for each product with the maximum value.</li>
<li>Use priority queue algorithm (heapsort) for sorting when prices change</li>
</ul>
</li>
<li>Implementation
<ul>
<li>Create heap <code>heapq.heapify(list)</code></li>
<li>To extract the maximum value, use <code>heapq.heappop(heap)</code> which extracts the minimum value with the element being negative.</li>
<li>Add the discounted price with <code>heapq.heappush(heap, item)</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">import</span> heapq <span style="color:#f92672">as</span> hp
N, M <span style="color:#f92672">=</span> [int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()]
price_list <span style="color:#f92672">=</span> sorted([<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()])

total_m <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">discount</span>(price_list, ticket_num):
    total_ticket <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    hp<span style="color:#f92672">.</span>heapify(price_list)

    <span style="color:#66d9ef">while</span> total_ticket <span style="color:#f92672">&lt;</span>ticket_num:
        temp <span style="color:#f92672">=</span> hp<span style="color:#f92672">.</span>heappop(price_list)
        hp<span style="color:#f92672">.</span>heappush(price_list, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">*</span> (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">*</span>temp<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>))
        total_ticket <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">return</span> price_list

res <span style="color:#f92672">=</span> discount(price_list, M)
<span style="color:#66d9ef">print</span>(res)
<span style="color:#66d9ef">print</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> sum(res))
</code></pre></div><ul>
<li>bonus
<ul>
<li><a href="http://sevendays-study.com/algorithm/day3.html">Sort algorithm</a></li>
<li><a href="https://docs.python.org/ja/3/library/heapq.html">Example of using heap queue in python standard library</a></li>
</ul>
</li>
</ul>
<h3 id="abc-140-dhttpsatcoderjpcontestsabc140tasksabc140_d"><a href="https://atcoder.jp/contests/abc140/tasks/abc140_d">ABC 140 D</a></h3>
<ul>
<li>
<p>Policy</p>
<ul>
<li>Group groups facing the same direction</li>
<li>People who are in the same group are happy</li>
<li>Turn the leftmost person to the left. (If you turn to the right, you will flip all)</li>
<li>The leftmost person is unhappy</li>
<li>When compressed, LRLR is an alternate list, so the number of times R can be reversed *2 is the happiness increase number
<ul>
<li>However, be aware that the number of consecutive lines when all the R&rsquo;s are inverted and set to L when the right end is L and R will shift by 1</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Implementation</p>
<ul>
<li>Counting the happy numbers after compressing the list can be stopped by numerical calculation by dividing the number of elements by the number of even and odd numbers of elements without the need to create an inverted list. This is faster because you don&rsquo;t have to reverse the list.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">     <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">compress</span>(arr):
    <span style="color:#e6db74">&#34;&#34;&#34;A person who disappears after compression is happy&#34;&#34;&#34;</span>
    cnt_h <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    new_arr <span style="color:#f92672">=</span> []
    comp_arr <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;L&#39;</span>]

    <span style="color:#75715e"># Start with L at the beginning</span>
    <span style="color:#66d9ef">if</span> arr[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;R&#39;</span>:
        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> arr:
            <span style="color:#66d9ef">if</span> item <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;L&#39;</span>:
                new_arr<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;R&#39;</span>)
            <span style="color:#66d9ef">else</span>:
                new_arr<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;L&#39;</span>)

            prev_item <span style="color:#f92672">=</span> item
    <span style="color:#66d9ef">else</span>:
        new_arr <span style="color:#f92672">=</span> arr
    <span style="color:#75715e"># Count compression operations and compressed debris</span>

    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, N):
        <span style="color:#66d9ef">if</span> new_arr[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> new_arr[i]:
            cnt_h <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">else</span>:
            comp_arr<span style="color:#f92672">.</span>append(new_arr[i])

    <span style="color:#66d9ef">return</span> [comp_arr, cnt_h]


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">execute</span>(arr, cnt_h, K):
    <span style="color:#75715e"># Number of operations required to invert all boundaries</span>
    max_rotation <span style="color:#f92672">=</span> len(arr)<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>
    <span style="color:#75715e"># Ends when all become L or the number of inversion reaches K</span>
    <span style="color:#66d9ef">if</span> max_rotation <span style="color:#f92672">&lt;=</span> K:
        cnt_h <span style="color:#f92672">+=</span> len(arr)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">else</span>:
        cnt_h <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>K

    <span style="color:#66d9ef">return</span> cnt_h
</code></pre></div><h3 id="abc-139-dhttpsatcoderjpcontestsabc139tasksabc139_d"><a href="https://atcoder.jp/contests/abc139/tasks/abc139_d">ABC 139 D</a></h3>
<ul>
<li>Policy
<ul>
<li>To maximize the remainder, divide a number by a number + 1.</li>
<li>Then it&rsquo;s a good idea to divide the sequence by the number +1. Since you cannot create a value that exceeds the maximum value, apply 1 to it. .. ..</li>
<li>If you add for statement, TLE will be added, so&hellip; Formula of sum of arithmetic progression</li>
</ul>
</li>
<li>Implementation
<ul>
<li>2 lines&hellip;</li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">N <span style="color:#f92672">=</span> int(input())
<span style="color:#66d9ef">print</span>((N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>N <span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>)
</code></pre></div><ul>
<li>Awareness
<ul>
<li>N=10^10 is not good for turning</li>
</ul>
</li>
</ul>
<h3 id="abc-138-dhttpsatcoderjpcontestsabc138tasksabc138_d"><a href="https://atcoder.jp/contests/abc138/tasks/abc138_d">ABC 138 D</a></h3>
<ul>
<li>Policy
<ul>
<li>Create a tree data structure</li>
<li>Each time a value is added, it will be ${O(NQ)}$ if it is added downstream. By adding the value to the place where the addition is made and then taking the cumulative sum, the addition operation can be completed once. ${O(N + Q)}$</li>
</ul>
</li>
<li>Implementation
<ul>
<li>When expressing the graph as a list
<ul>
<li>Lists links to children and parents.</li>
<li>Has a list of visited nodes</li>
<li>Since depth-first search is performed by LIFO, it has a search stack and performs <code>.pop()</code> and <code>.append()</code>.</li>
</ul>
</li>
<li>When creating a tree data structure
<ul>
<li>Node has the node number, the added value of this problem, and the linked node list. It was okay to have the visited node list as an attribute of the node (this time I kept the visited node list separately).* The same thing as when a graph is represented by a list is realized with a tree data structure.</li>
<li>If it is python3, it will not be in time for calculation, so submit it with pypy3.</li>
</ul>
</li>
<li>Awareness
<ul>
<li>If you use a recursive function, it will hit the memory limit, so execute it sequentially while</li>
<li>Use LIFO on the stack. Being a LIFO, you can do depth-first search while watching the youngest person.</li>
<li>Use <code>form collections import deque</code> to improve stack processing speed. This is faster for loading and unloading the front end and rear end.</li>
<li>Remember that the parent node is the first node to play, as it does not go back to the parent node.</li>
<li>I thought that if I defined it in a directed graph, I didn&rsquo;t need the process of playing the parent, but if there is a condition added after the contest, I can not AC without the parent playing process of the invalid graph.</li>
<li>Using a recursive function consumes a large amount of memory, so RE is the memory limit.</li>
<li>Representing the data structure as an instance object slows down and cannot keep up.</li>
<li>I found that pypy3 can be used to push through when I can&rsquo;t make it in time.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="python-list-version">python list version</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">N, Q <span style="color:#f92672">=</span> [int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()]

tree_list <span style="color:#f92672">=</span> [input()<span style="color:#f92672">.</span>split() <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, N)]

query_list <span style="color:#f92672">=</span> [input()<span style="color:#f92672">.</span>split() <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(Q)]
query_list_int <span style="color:#f92672">=</span> [[int(k) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> query_list]

val_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]

linked_node_list <span style="color:#f92672">=</span> [[] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]

<span style="color:#75715e">#Create undirected graph link relationships (including upstream connections)</span>
<span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> tree_list:
    a, b <span style="color:#f92672">=</span> int(a)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, int(b) <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    linked_node_list[a]<span style="color:#f92672">.</span>append(b) <span style="color:#75715e"># add child</span>
    linked_node_list[b]<span style="color:#f92672">.</span>append(a) <span style="color:#75715e"># add parent</span>


<span style="color:#66d9ef">for</span> index, val <span style="color:#f92672">in</span> query_list_int:
    val_list[index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> val

stack <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#75715e"># Create a stack containing the value of the root node and store the target to go around</span>
parent <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> (N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e"># store a stack that remembers visited nodes</span>

If you use <span style="color:#75715e">#recursive function, it will hit memory limit, so execute it while</span>
<span style="color:#75715e"># Use LIFO on the stack. Being a LIFO, you can do depth-first search while watching the youngest person.</span>
<span style="color:#75715e"># Remember the parent node and play it</span>
<span style="color:#75715e">#If you define it in a directed graph, you don&#39;t need to play the parent.</span>

<span style="color:#66d9ef">while</span> True:
    <span style="color:#75715e"># Tour from the route in order</span>
    v<span style="color:#f92672">=</span>stack<span style="color:#f92672">.</span>pop()
    <span style="color:#66d9ef">for</span> child <span style="color:#f92672">in</span> linked_node_list[v]:
        <span style="color:#66d9ef">if</span> child <span style="color:#f92672">!=</span> parent[v]:
            parent[child] <span style="color:#f92672">=</span> v <span style="color:#75715e"># Store visited nodes</span>
            stack<span style="color:#f92672">.</span>append(child) <span style="color:#75715e"># Store the destination node of this node v in the stack</span>
            val_list[child] <span style="color:#f92672">+=</span> val_list[v] <span style="color:#75715e"># cumulative sum</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> stack:
        <span style="color:#75715e">#Patrol ends when stack is exhausted</span>
        <span style="color:#66d9ef">break</span>

<span style="color:#66d9ef">print</span>(<span style="color:#f92672">*</span>val_list)
</code></pre></div><h4 id="pypy3-node-object-version">pypy3 node object version</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
N, Q <span style="color:#f92672">=</span> [int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()]

tree_list <span style="color:#f92672">=</span> [input()<span style="color:#f92672">.</span>split() <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, N)]
query_list <span style="color:#f92672">=</span> [input()<span style="color:#f92672">.</span>split() <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(Q)]


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Node</span>:
    <span style="color:#66d9ef">def</span> __init__(self, val):
        self<span style="color:#f92672">.</span>val <span style="color:#f92672">=</span> val
        self<span style="color:#f92672">.</span>child_list <span style="color:#f92672">=</span> []
        self<span style="color:#f92672">.</span>cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">my_tree</span>:
    <span style="color:#66d9ef">def</span> __init__(self, tree_list):
        self<span style="color:#f92672">.</span>node_list <span style="color:#f92672">=</span> []

        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
            self<span style="color:#f92672">.</span>node_list<span style="color:#f92672">.</span>append(Node(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))

        <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> tree_list:
            a, b <span style="color:#f92672">=</span> int(a), int(b)

            child_node <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>node_list[b<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
            parent_node <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>node_list[a<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
            self<span style="color:#f92672">.</span>node_list[a<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>child_list<span style="color:#f92672">.</span>append(child_node)
            self<span style="color:#f92672">.</span>node_list[b<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>child_list<span style="color:#f92672">.</span>append(parent_node)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">adding</span>(self, query_list):
        <span style="color:#66d9ef">for</span> a, data <span style="color:#f92672">in</span> query_list:
            a, data <span style="color:#f92672">=</span> int(a), int(data)
            self<span style="color:#f92672">.</span>node_list[a<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>cnt <span style="color:#f92672">+=</span> data

        stack <span style="color:#f92672">=</span> deque([self<span style="color:#f92672">.</span>node_list[<span style="color:#ae81ff">0</span>]])
        parent_node_list <span style="color:#f92672">=</span> [self<span style="color:#f92672">.</span>node_list[<span style="color:#ae81ff">0</span>]]<span style="color:#f92672">*</span>(N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)

        <span style="color:#66d9ef">while</span> True:
            v <span style="color:#f92672">=</span> stack<span style="color:#f92672">.</span>pop()
            <span style="color:#66d9ef">for</span> child <span style="color:#f92672">in</span> v<span style="color:#f92672">.</span>child_list:
                <span style="color:#66d9ef">if</span> child <span style="color:#f92672">!=</span> parent_node_list[v<span style="color:#f92672">.</span>val <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
                    child<span style="color:#f92672">.</span>cnt <span style="color:#f92672">+=</span> v<span style="color:#f92672">.</span>cnt
                    parent_node_list[child<span style="color:#f92672">.</span>val <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> v
                    stack<span style="color:#f92672">.</span>append(child)

            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> stack:
                <span style="color:#66d9ef">break</span>


ins <span style="color:#f92672">=</span> my_tree(tree_list)
ins<span style="color:#f92672">.</span>adding(query_list)
<span style="color:#66d9ef">print</span>(<span style="color:#f92672">*</span>[node<span style="color:#f92672">.</span>cnt <span style="color:#66d9ef">for</span> node <span style="color:#f92672">in</span> ins<span style="color:#f92672">.</span>node_list])

</code></pre></div><h2 id="d-exercises-for-practice">D Exercises for practice</h2>
<h3 id="disco2020-bhttpsatcoderjpcontestsddcc2020-qualtasksddcc2020_qual_b"><a href="https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_b">Disco2020 B</a></h3>
<ul>
<li>The problem of calculating the total N times will be enormous if it is calculated straightforwardly each time.</li>
<li>If you let <code>sum</code> be calculated in the for statement, you would have to turn the double loop without knowing it. Polnareff.</li>
<li>So let&rsquo;s use cumulative sums well Problem.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
N <span style="color:#f92672">=</span> int(input())
A_list <span style="color:#f92672">=</span> [int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()]

all_sum <span style="color:#f92672">=</span> sum(A_list)

F_sum_list <span style="color:#f92672">=</span> [A_list[<span style="color:#ae81ff">0</span>]]

<span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,N):
    F_sum_list<span style="color:#f92672">.</span>append(F_sum_list[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> A_list[j])

delta_list <span style="color:#f92672">=</span> [abs(all_sum<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span> i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> F_sum_list]

<span style="color:#66d9ef">print</span>(min(delta_list))
</code></pre></div><h3 id="abc-146-chttpsatcoderjpcontestsabc146tasksabc146_c"><a href="https://atcoder.jp/contests/abc146/tasks/abc146_c">ABC 146 C</a></h3>
<ul>
<li>the dichotomy! !</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
A, B, X <span style="color:#f92672">=</span> [int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()]
res_list <span style="color:#f92672">=</span> []
left <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
right <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">9</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>

is_search <span style="color:#f92672">=</span> True

<span style="color:#66d9ef">while</span> is_search:
    N <span style="color:#f92672">=</span> (left <span style="color:#f92672">+</span> right)<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>
    res <span style="color:#f92672">=</span> A <span style="color:#f92672">*</span> N <span style="color:#f92672">+</span> B <span style="color:#f92672">*</span> len(str(N))

    <span style="color:#66d9ef">if</span> res <span style="color:#f92672">&gt;</span>X:
        right <span style="color:#f92672">=</span> N
    <span style="color:#66d9ef">elif</span> res <span style="color:#f92672">&lt;=</span> X:
        res_list<span style="color:#f92672">.</span>append(N)
        left <span style="color:#f92672">=</span> N

    <span style="color:#66d9ef">if</span> right<span style="color:#f92672">-</span>left <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>:
        is_search <span style="color:#f92672">=</span> False

<span style="color:#66d9ef">if</span> res_list <span style="color:#f92672">==</span> []:
    <span style="color:#66d9ef">print</span>(<span style="color:#ae81ff">0</span>)
<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">print</span>(max(res_list))
</code></pre></div><ul>
<li>The code below is a binary search that I originally wrote.</li>
<li>With this code, the way to narrow down might not converge to the solution.</li>
<li>So, after the dichotomizing search, we did an absurd thing to do a linear search with a narrowed search range near the solution.</li>
<li>Insanely embarrassing.</li>
<li>I will publish it for the sake of reminding me that I will never do this again.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> math
 
A, B, X <span style="color:#f92672">=</span> [int(item) <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> input()<span style="color:#f92672">.</span>split()]
 
res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
res_list <span style="color:#f92672">=</span> []
delta <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">9</span> <span style="color:#f92672">//</span> <span style="color:#ae81ff">4</span>
N<span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">9</span> <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>
 
 
is_search <span style="color:#f92672">=</span> True
 
<span style="color:#66d9ef">while</span> is_search:
    res <span style="color:#f92672">=</span> A <span style="color:#f92672">*</span> N <span style="color:#f92672">+</span> B <span style="color:#f92672">*</span> len(str(N))
    <span style="color:#66d9ef">if</span> res <span style="color:#f92672">&gt;</span>X:
        N <span style="color:#f92672">=</span> N <span style="color:#f92672">-</span>delta
    <span style="color:#66d9ef">elif</span> res <span style="color:#f92672">&lt;=</span> X:
        res_list<span style="color:#f92672">.</span>append(N)
        N <span style="color:#f92672">=</span> N <span style="color:#f92672">+</span> delta
 
    <span style="color:#66d9ef">if</span> delta <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">break</span>
 
    delta <span style="color:#f92672">=</span> delta <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>
 
new_res_list <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N<span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span>, N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1000</span>):
    res <span style="color:#f92672">=</span> A <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> B <span style="color:#f92672">*</span> len(str(i))
    <span style="color:#66d9ef">if</span> res <span style="color:#f92672">&lt;=</span> X:
        new_res_list<span style="color:#f92672">.</span>append(i)
 
 
<span style="color:#66d9ef">if</span> new_res_list <span style="color:#f92672">==</span> [] <span style="color:#f92672">or</span> max(new_res_list) <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">1</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#ae81ff">0</span>)
<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;=</span> max(new_res_list) <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">9</span>:
        <span style="color:#66d9ef">print</span>(max(new_res_list))
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">9</span>)
</code></pre></div>
    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
