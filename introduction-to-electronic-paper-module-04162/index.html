<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Introduction to electronic paper module | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Introduction to electronic paper module</h1>
<p>
  <small class="text-secondary">
  
  
  Mar 28, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/raspberrypi"> RaspberryPi</a></code></small>


<small><code><a href="https://memotut.com/tags/pillow"> pillow</a></code></small>


<small><code><a href="https://memotut.com/tags/electronic-paper"> electronic paper</a></code></small>


<small><code><a href="https://memotut.com/tags/e-paper"> e-Paper</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>Combining ready-made products in the shortest possible time,
The purpose is to create a prototype that allows you to customize the content displayed on the electronic paper.
It&rsquo;s just a prototype, so I don&rsquo;t think about costs or operation costs.</p>
<h1 id="things-to-prepare">Things to prepare</h1>
<h3 id="raspberry-pi-wh-zero-wh">Raspberry Pi WH Zero WH</h3>
<p><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>
<img src="https://d2air1d4eqhwg2.cloudfront.net/images/3646/500x500/8d037ed2-9a5b-4619-baa6-9fb208fb9cb8.jpg" width=300></p>
<p>A similar product is the <strong>Raspberry Pi Zero W</strong>.
<strong>Raspberry Pi Zero WH</strong> is a model with pin header mounted on <strong>Raspberry Pi Zero W</strong>.
If you do not have a soldering iron, we recommend the <strong>Raspberry Pi Zero WH</strong>.
You can purchase from Switch Science.
<a href="https://www.switch-science.com/catalog/3646/">Raspberry Pi Zero WH -Switch Science</a></p>
<h3 id="27-inch-264-x-176-e-ink-redblackwhite-3-color-electronic-paper-module-for-raspberrypi">2.7 inch 264 x 176 E-Ink Red/Black/White 3 Color Electronic Paper Module for RaspberryPi</h3>
<p>[^2]
<img src="https://www.sengoku.co.jp/item/images/th800/7b578e208343225488e769f8a6f165c0b2c61f6652dd844fa64a86d25bb7efd4.jpg" width=300></p>
<p>You can also purchase it at Sengoku Densho in Akihabara.
There are variations in display size and number of colors.
This time, I chose the model of <strong>2.7inch/red/black/white</strong>.
You can purchase it from Sengoku Densho.
<a href="https://www.sengoku.co.jp/mod/sgk_cart/detail.php?code=EEHD-58WK">WaveShare 13357 2.7 inch 264 x 176 E-Ink Red/Black/White 3 Color Electronic Paper Module for RaspberryPi</a></p>
<h3 id="power-supply-compatible-with-microsd-cardmicrousb-terminal">Power supply compatible with microSD card/microUSB terminal</h3>
<p>An essential item if you use Rapsberry Pi.
Use a microSD card with a capacity of 8GB or more.
The power supply must have a power supply capacity of 1.2A or higher <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>.</p>
<h3 id="optional-keyboardmini-hdmi-cable">(Optional) Keyboard/mini HDMI cable</h3>
<p>Required if you don&rsquo;t use ssh.</p>
<h1 id="set-up-the-raspberry-pi-zero-wh">Set up the Raspberry Pi Zero WH</h1>
<p>The OS can be downloaded from <a href="https://www.raspberrypi.org/downloads/raspbian/">here</a>.
The OS adopted the latest Raspibian Buster Lite at the time of writing (March 28, 2020).</p>
<p>For instructions on writing the OS to the microSD, search for a keyword such as &ldquo;Raspberry Pi setup&rdquo; and you will find Japanese articles.
The installation guide is also publicly available, so I will post it here.
<a href="https://www.raspberrypi.org/documentation/installation/installing-images/README.md">Installing operating system images-Raspberry Pi Documentation</a></p>
<p>For those who have trouble connecting to the display, this setting eliminates the need to connect to the display for the initial settings.
<a href="https://qiita.com/mascii/items/0d1a280ac58ed8f6f999">Set up wireless LAN of Raspberry Pi with microSD-Qiita</a></p>
<h1 id="connect-the-electronic-paper-module-and-raspberry-pi-zero-wh">Connect the electronic paper module and Raspberry Pi Zero WH</h1>
<p>Connect like this.
<img src=https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/334984/77ffc5a9-3caf-01d3-950e-cdd57c9de86c.jpeg width=400></p>
<p>From another angle.
<img src=https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/334984/d74daa77-c6d1-77d7-de83-01f187fcff23.jpeg width=400></p>
<p>#Run the sample code</p>
<p>Follow the <a href="https://www.waveshare.com/wiki/2.7inch_e-Paper_HAT_(B)">Official Wiki</a> published by WaveShare.</p>
<p>Open a terminal and execute the following command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo raspi-config
</code></pre></div><p>Then the setting screen is displayed.
Select &ldquo;Interfacing Options&rdquo;,
→ Select &ldquo;SPI&rdquo;,
→ Select &ldquo;Yes&rdquo;.
<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>
<img src="https://www.waveshare.com/w/upload/1/1e/RPI_open_spi.png" width=600/></p>
<p>Run the following command and reboot</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo reboot
</code></pre></div><p>Install the required libraries.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># install bcm2835 libraries</span>
wget http://www.airspayce.com/mikem/bcm2835/bcm2835-1.60.tar.gz
tar zxvf bcm2835-1.60.tar.gz
cd bcm2835-1.60/
sudo ./configure
sudo make
sudo make check
sudo make install

<span style="color:#75715e"># install wiringPi libraries</span>
sudo apt-get install wiringpi

<span style="color:#75715e"># install Python3 libraries</span>
sudo apt-get update
sudo apt-get install python3-pip
sudo apt-get install python3-pil
sudo apt-get install python3-numpy
sudo pip3 install RPi.GPIO
sudo pip3 install spidev
</code></pre></div><p>Waveshare clones <a href="https://github.com/waveshare/e-Paper">Repository published on GitHub</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo git clone https://github.com/waveshare/e-Paper
</code></pre></div><p>Let&rsquo;s move to the directory with the sample code and run it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cd e-Paper/RaspberryPi<span style="color:#ae81ff">\&amp;</span>JetsonNano/python/examples
sudo python3 epd_2in7b_test.py
</code></pre></div><p>Please see here for a video of the state at the time of execution. It takes about 2 minutes.
<a href="https://vimeo.com/399654308"><img src="https://i.vimeocdn.com/video/867770427_640.jpg" alt="epd_2in7b_test.py"></a></p>
<p>Let&rsquo;s take a look at the sample code <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:epd_2in7b_test.py" data-lang="python:epd_2in7b_test.py"><span style="color:#75715e">#!/usr/bin/python</span>
<span style="color:#75715e"># -*- coding:utf-8 -*-</span>
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> os
picdir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>realpath(__file__))),<span style="color:#e6db74">&#39;pic&#39;</span>)
libdir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>realpath(__file__))),<span style="color:#e6db74">&#39;lib&#39;</span>)
<span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>exists(libdir):
    sys<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>append(libdir)

<span style="color:#f92672">import</span> logging
<span style="color:#f92672">from</span> waveshare_epd <span style="color:#f92672">import</span> epd2in7b
<span style="color:#f92672">import</span> time
<span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image,ImageDraw,ImageFont
<span style="color:#f92672">import</span> traceback

logging<span style="color:#f92672">.</span>basicConfig(level<span style="color:#f92672">=</span>logging<span style="color:#f92672">.</span>DEBUG)

<span style="color:#66d9ef">try</span>:
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;epd2in7b Demo&#34;</span>)
    
    epd <span style="color:#f92672">=</span> epd2in7b<span style="color:#f92672">.</span>EPD()
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;init and Clear&#34;</span>)
    epd<span style="color:#f92672">.</span>init()
    epd<span style="color:#f92672">.</span>Clear()
    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
    
    <span style="color:#75715e"># Drawing on the image</span>
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;Drawing&#34;</span>)
    blackimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>width, epd<span style="color:#f92672">.</span>height), <span style="color:#ae81ff">255</span>) <span style="color:#75715e"># 255: clear the frame</span>
    redimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>width, epd<span style="color:#f92672">.</span>height), <span style="color:#ae81ff">255</span>) <span style="color:#75715e"># 255: clear the frame</span>
    
    font24 <span style="color:#f92672">=</span> ImageFont<span style="color:#f92672">.</span>truetype(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(picdir,<span style="color:#e6db74">&#39;Font.ttc&#39;</span>), <span style="color:#ae81ff">24</span>)
    font18 <span style="color:#f92672">=</span> ImageFont<span style="color:#f92672">.</span>truetype(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(picdir,<span style="color:#e6db74">&#39;Font.ttc&#39;</span>), <span style="color:#ae81ff">18</span>)
    

    <span style="color:#75715e"># Drawing on the Horizontal image</span>
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;1.Drawing on the Horizontal image...&#34;</span>)
    HBlackimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>height, epd<span style="color:#f92672">.</span>width), <span style="color:#ae81ff">255</span>) <span style="color:#75715e"># 298*126</span>
    HRedimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>height, epd<span style="color:#f92672">.</span>width), <span style="color:#ae81ff">255</span>) <span style="color:#75715e"># 298*126</span>
    
    drawblack <span style="color:#f92672">=</span> ImageDraw<span style="color:#f92672">.</span>Draw(HBlackimage)
    drawred <span style="color:#f92672">=</span> ImageDraw<span style="color:#f92672">.</span>Draw(HRedimage)
    drawblack<span style="color:#f92672">.</span>text((<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>),<span style="color:#e6db74">&#39;hello world&#39;</span>, font <span style="color:#f92672">=</span> font24, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>text((<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>), <span style="color:#e6db74">&#39;2.9inch e-Paper&#39;</span>, font <span style="color:#f92672">=</span> font24, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>text((<span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">0</span>), <span style="color:#e6db74">u</span><span style="color:#e6db74">&#39;snow electronic&#39;</span>, font <span style="color:#f92672">=</span> font24, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">100</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)drawblack<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">100</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>rectangle((<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">100</span>), outline <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)    
    drawred<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">165</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">165</span>, <span style="color:#ae81ff">100</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">190</span>, <span style="color:#ae81ff">75</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>arc((<span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">190</span>, <span style="color:#ae81ff">100</span>), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">360</span>, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>rectangle((<span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">130</span>, <span style="color:#ae81ff">100</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>chord((<span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">100</span>), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">360</span>, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    epd<span style="color:#f92672">.</span>display(epd<span style="color:#f92672">.</span>getbuffer(HBlackimage), epd<span style="color:#f92672">.</span>getbuffer(HRedimage))
    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">2</span>)
    
    <span style="color:#75715e"># Drawing on the Vertical image</span>
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;2.Drawing on the Vertical image...&#34;</span>)
    LBlackimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>width, epd<span style="color:#f92672">.</span>height), <span style="color:#ae81ff">255</span>)  <span style="color:#75715e"># 126*298</span>
    LRedimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>width, epd<span style="color:#f92672">.</span>height), <span style="color:#ae81ff">255</span>)  <span style="color:#75715e"># 126*298</span>
    drawblack <span style="color:#f92672">=</span> ImageDraw<span style="color:#f92672">.</span>Draw(LBlackimage)
    drawred <span style="color:#f92672">=</span> ImageDraw<span style="color:#f92672">.</span>Draw(LRedimage)
    
    drawblack<span style="color:#f92672">.</span>text((<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>), <span style="color:#e6db74">&#39;hello world&#39;</span>, font <span style="color:#f92672">=</span> font18, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>text((<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">20</span>), <span style="color:#e6db74">&#39;2.9inch epd&#39;</span>, font <span style="color:#f92672">=</span> font18, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>text((<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">50</span>), <span style="color:#e6db74">u</span><span style="color:#e6db74">&#39;微雪电子&#39;</span>, font <span style="color:#f92672">=</span> font18, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">140</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">140</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawblack<span style="color:#f92672">.</span>rectangle((<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">140</span>), outline <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">140</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>line((<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">115</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>arc((<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">140</span>), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">360</span>, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>rectangle((<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">200</span>), fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    drawred<span style="color:#f92672">.</span>chord((<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">200</span>), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">360</span>, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    epd<span style="color:#f92672">.</span>display(epd<span style="color:#f92672">.</span>getbuffer(LBlackimage), epd<span style="color:#f92672">.</span>getbuffer(LRedimage))
    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">2</span>)
    
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;3.read bmp file&#34;</span>)
    HBlackimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(picdir, <span style="color:#e6db74">&#39;2in7b-b.bmp&#39;</span>))
    HRedimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(picdir, <span style="color:#e6db74">&#39;2in7b-r.bmp&#39;</span>))
    epd<span style="color:#f92672">.</span>display(epd<span style="color:#f92672">.</span>getbuffer(HBlackimage), epd<span style="color:#f92672">.</span>getbuffer(HRedimage))
    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">2</span>)
    
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;4.read bmp file on window&#34;</span>)
    blackimage1 <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>height, epd<span style="color:#f92672">.</span>width), <span style="color:#ae81ff">255</span>)  <span style="color:#75715e"># 298*126</span>
    redimage1 <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;1&#39;</span>, (epd<span style="color:#f92672">.</span>height, epd<span style="color:#f92672">.</span>width), <span style="color:#ae81ff">255</span>)  <span style="color:#75715e"># 298*126    </span>
    newimage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(picdir, <span style="color:#e6db74">&#39;100x100.bmp&#39;</span>))
    blackimage1<span style="color:#f92672">.</span>paste(newimage, (<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">10</span>))    
    epd<span style="color:#f92672">.</span>display(epd<span style="color:#f92672">.</span>getbuffer(blackimage1), epd<span style="color:#f92672">.</span>getbuffer(redimage1))
    
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;Clear...&#34;</span>)
    epd<span style="color:#f92672">.</span>init()
    epd<span style="color:#f92672">.</span>Clear()
    
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;Goto Sleep...&#34;</span>)
    epd<span style="color:#f92672">.</span>sleep()
        
<span style="color:#66d9ef">except</span> <span style="color:#a6e22e">IOError</span> <span style="color:#66d9ef">as</span> e:
    logging<span style="color:#f92672">.</span>info(e)
    
<span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyboardInterrupt</span>:    
    logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;ctrl + c:&#34;</span>)
    epd2in7b<span style="color:#f92672">.</span>epdconfig<span style="color:#f92672">.</span>module_exit()
    exit()
</code></pre></div><p>電子ペーパーに表示したい内容はPillowのImageオブジェクトで渡してあげればいいことがわかります。
<code>epd.getbuffer()</code>の第一引数には黒で描画したいイメージを、第二引数には赤で描画したいイメージを指定します。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">epd<span style="color:#f92672">.</span>display(epd<span style="color:#f92672">.</span>getbuffer(LBlackimage), epd<span style="color:#f92672">.</span>getbuffer(LRedimage))
</code></pre></div><h1 id="カスタマイズしてみた">カスタマイズしてみた</h1>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/334984/760ddb36-5c30-4105-8a74-65903fdcc083.jpeg" alt="e-tag.jpg"></p>
<p>日本語フォントを使うには<code>ImageFont</code>でフォントファイルを読み込みます。</p>
<p><a href="https://pillow.readthedocs.io/en/stable/reference/ImageFont.html">ImageFont Module — Pillow (PIL Fork) 7.0.0 documentation</a></p>
<h1 id="附録">附録</h1>
<h2 id="費用">費用</h2>
<table>
<thead>
<tr>
<th align="right">項目</th>
<th align="right">金額</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">電子ペーパーモジュール</td>
<td align="right">¥2,590</td>
</tr>
<tr>
<td align="right">Raspberry Pi Zero WH</td>
<td align="right">¥1,848</td>
</tr>
<tr>
<td align="right">microSDカード 16GB</td>
<td align="right">¥800</td>
</tr>
</tbody>
</table>
<p>microSDカードは価格幅が広いので参考程度に。
合計すると¥5,300ぐらいです。
ここには含めませんでしたが、電源も必要です。</p>
<h2 id="消費電力">消費電力</h2>
<p>公式サイトのFAQをみるとRaspberry Pi Zero WHの平常時の消費電流は0.15Aです。
電源が近くにないような場面ではモバイルバッテリーによる電力供給も考えられますが、
何時間稼働させられるんでしょうか？</p>
<p><a href="https://denor.jp/pi-zero-w%E3%81%AF%E3%83%A2%E3%83%90%E3%82%A4%E3%83%AB%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E3%81%A7%E3%81%A9%E3%81%AE%E3%81%8F%E3%82%89%E3%81%84%E3%81%AE%E6%99%82%E9%96%93%E5%8B%95%E4%BD%9C">Pi Zero Wはモバイルバッテリーでどのくらいの時間動作するか</a>
↑こちらの記事によると、</p>
<blockquote>
<p>5200mAhのバッテリーで、Pi Zero W本体のみ動作した時間は28時間42分</p>
</blockquote>
<p>と書かれています。たかだか1日しか稼働させられないので用途は限られますね。</p>
<p>別の選択肢として、公式から<a href="https://www.raspberrypi.org/products/poe-hat/">PoE HAT</a>が発売されています。
ただし、対応するモデルは<strong>Raspberry Pi 4 Model BとRaspberry Pi 3 Model B+のみ</strong>です。
これを接続すればイーサネットケーブルで給電できます。</p>
<h2 id="電子ペーパーモジュール使用上の注意">電子ペーパーモジュール使用上の注意</h2>
<p>目を通すのを忘れがちなユーザマニュアルに大事なことが書いてあったので一部抜粋して掲載します。
<a href="https://www.waveshare.com/w/upload/3/32/2.7inch-e-paper-hat-b-user-manual-en.pdf">公式ユーザマニュアル</a></p>
<blockquote>
<p>The e-Paper cannot be powered on for long time, you must set e-Paper to sleep mode or power off when it needn’t refresh, otherwise, e-Paper keeps in high voltage status for long time, which will damage e-Paper and cannot be fixed.</p>
</blockquote>
<p>電子ペーパーに電圧をかけた状態をキープすると、電子ペーパーがダメージを受けるのでスリープを設定してください。</p>
<blockquote>
<p>We suggest you update e-Paper once every 24 hours or at least 10 days to update again. Otherwise, ghost of the last content may cannot be cleared.</p>
</blockquote>
<p>毎日１回、最低でも10日に１回は電子ペーパーを更新することを推奨します。
そうしないと、ゴーストが生じる恐れがあります。</p>
<blockquote>
<p>The e-Paper cannot refresh directly under sunlight. The refresh steps should be
done indoor</p>
</blockquote>
<p>電子ペーパーは日光のあたるところでリフレッシュできません。リフレッシュは屋内でするようにしてください。</p>
<h2 id="nfc対応電子ペーパー">NFC対応電子ペーパー</h2>
<p>Waveshareさんから電源不要でNFCで表示切替できる製品が発売されています。
<a href="https://www.waveshare.com/4.2inch-nfc-powered-e-paper.htm">4.2inch Passive NFC-Powered e-Paper, No Battery, Wireless Powering &amp; Data Transfer</a>
<img src="https://www.waveshare.com/img/devkit/LCD/4.2inch-NFC-Powered-e-Paper/4.2inch-NFC-Powered-e-Paper-Details-02.jpg" width=300></p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://www.switch-science.com/catalog/3646/">Raspberry Pi Zero WH - スイッチサイエンス</a>より引用[^2]:<a href="https://www.sengoku.co.jp/mod/sgk_cart/detail.php?Quotedfromcode=EEHD-58WK">WaveShare133572.7inch264x176E-InkRed/Black/White3ColorElectronicPaperModuleforRaspberryPi</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>See Power &gt;What are the power requirements? in <a href="https://www.raspberrypi.org/documentation/faqs/#power">FAQs-Raspberry Pi Documentation</a> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p><a href="https://www.waveshare.com/wiki/2.7inch_e-Paper_HAT_(B)">2.7inch e-Paper HAT (B)-Waveshare Wiki</a> Raspberry Pi&gt; Hardware connection <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p><a href="https://github.com/waveshare/e-Paper/blob/master/RaspberryPi&amp;JetsonNano/python/examples/epd_2in7b_test.py">e-Paper/epd_2in7b_test.py at master · waveshare/e-Paper</a> <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
