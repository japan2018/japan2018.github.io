<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Analyzing pollen dispersal amount, vegetation of Sugi and influence of wind from open data (pretreatment) | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Analyzing pollen dispersal amount, vegetation of Sugi and influence of wind from open data (pretreatment)</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 11, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/open-data"> open data</a></code></small>


<small><code><a href="https://memotut.com/tags/visualization"> visualization</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>TechTrain&rsquo;s Advent Calendar (<a href="https://qiita.com/advent-calendar/2019/techtrain">https://qiita.com/advent-calendar/2019/techtrain</a>) I&rsquo;m in charge of the 11th day, and I&rsquo;m a first-year college student learning Python for two and a half months. I will summarize what I analyzed lightly.</p>
<h1 id="content">Content</h1>
<p>Looking at the hay fever prevalence data in each prefecture, it was found that the hay fever prevalence was high in a wide area in the Kanto region, including Tokyo, where there is no image of sugi growing so much. I wonder if there is any factor between the sugi vegetation and the amount of pollen dispersal&hellip;I wonder if it is the wind, and by visualizing them, I can see if the forecast is correct and how much it affects it. The purpose is to have a look.
Since there are many things to do, we will only summarize the data preprocessing part this time.</p>
<h1 id="list-of-data-used">List of data used</h1>
<ul>
<li>Ministry of the Environment pollen observation system (Mr. Hanako)
(<a href="http://kafun.taiki.go.jp/DownLoad1.aspx">http://kafun.taiki.go.jp/DownLoad1.aspx</a>) <br>
Pollen dispersal counts and AMeDAS data observed at observatories nationwide except Hokkaido and Okinawa by specifying the period as 2019/2/15 to 2019/4/30</li>
<li>Omaru-kun&rsquo;s technical note, city code table (with latitude and longitude)
(<a href="http://note.omarukun.com/notes/4/">http://note.omarukun.com/notes/4/</a>) <br>
I want to finally plot on a Japan map, so I want the coordinates of the observation point</li>
<li>Wind direction code 16 azimuth correspondence table (made by meteorological agency data) <br>
In order to make it easy to understand, the wind direction of Amedas data was written with numbers instead of directions.</li>
<li>Regional differences in the prevalence of Japanese cedar pollinosis
(<a href="https://www.jstage.jst.go.jp/article/arerugi/59/1/59_KJ00006063684/_pdf">https://www.jstage.jst.go.jp/article/arerugi/59/1/59_KJ00006063684/_pdf</a>) <br>
Prevalence data for hay fever by prefecture</li>
<li>Forestry Agency Forest rate/plantation rate by prefecture
(<a href="http://www.rinya.maff.go.jp/j/keikaku/genkyou/h29/1.html">http://www.rinya.maff.go.jp/j/keikaku/genkyou/h29/1.html</a>) <br>
Data of sugi vegetation area by prefecture</li>
</ul>
<p>#Data loading and data cleansing</p>
<h3 id="pollen-dispersal-area-amount-and-weather-data">Pollen dispersal area, amount and weather data</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e">#Set the number of display data frames</span>
<span style="color:#75715e">#Display 8 lines</span>
pd<span style="color:#f92672">.</span>set_option(<span style="color:#e6db74">&#39;display.max_rows&#39;</span>, <span style="color:#ae81ff">10</span>)
</code></pre></div><p>We will read the CSV file output for each region</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#75715e">#Tohoku</span>
touhoku <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./pollen_touhoku.csv&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;shift_jis&#39;</span>, header<span style="color:#f92672">=</span>None)
touhoku
</code></pre></div><p>0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |11 |12 |
|&mdash;&mdash;-:|&mdash;-:|&mdash;&mdash;-:|&ndash;:|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-|&ndash;:|&ndash;:|&mdash;&mdash;|&mdash;:|&mdash;- &mdash;&mdash;&mdash;-|&mdash;:|&ndash;:|&ndash;:|&mdash;&ndash;:|&mdash;:|&ndash;:|
|50210100|31312|20190215| 1| Aomori Central Wholesale Market | 1| 2| Aomori Prefecture| 2201| Aomori City| 0| 10| 3| -3.2| 0| 0|
|50210100|31312|20190215| 2| Aomori Central Wholesale Market | 1| 2| Aomori Prefecture| 2201| Aomori City| 323| 9| 5| -3.4| 0| 0|
|50210100|31312|20190215| 3| Aomori Central Wholesale Market | 1| 2| Aomori Prefecture| 2201| Aomori City| 69| 9| 4| -3.1| 0| 0|
|50210100| NaN|20190215| 4| Aomori Central Wholesale Market | 1| 2| Aomori Prefecture| 2201| Aomori City| 86|NaN|NaN| NaN| NaN| 0|
|・・・|・・・|・・・|・・・|・・・ |・・・|・・・|・・・|・・・|・・・ |・・・|・・・|・・・｜・・・|・・・|・・・|
|50620100|35141|20190308| 1| Shonai General Branch Branch Office | 2| 6| Yamagata Prefecture | 6426| Mikawa Town, Higashidagawa-gun | 0| 15| 3| 3.3| 0| 1|
|50620100|35141|20190308| 2| Shonai General Branch Branch Office | 2| 6| Yamagata | 6426 | Mikawa-cho, Higashidagawa-gun | 45| 16| 3| 1.1| 1| 0|
|50620100|35141|20190308| 3| Shonai General Branch Office | 2| 6| Yamagata | 6426 | Mikawa-cho, Higashidagawa-gun | 8| 14| 3| 2.9| 0|
|50620100|35141|20190308| 4| Shonai General Branch Office | 2| 6| Yamagata | 6426 | Mikawa-cho, Higashidagawa-gun | 4| 13| 3| 3.1| 0|
23400 rows × 16 columns
We will read this as the rest of Kanto (kanto), Chubu (chubu), Kansai (kansai), Chugoku/Shikoku (chugoku_shikoku), and Kyushu (kyusyu).
The code and results are omitted because they are the same and long.</p>
<h3 id="remove-extra-columns">remove extra columns</h3>
<p>As you can see from the data frame in the Tohoku region, the column labels are unknown, so check each one and delete the unnecessary columns.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
touhoku<span style="color:#f92672">.</span>drop([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)
kanto<span style="color:#f92672">.</span>drop([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)
chubu<span style="color:#f92672">.</span>drop([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)
kansai<span style="color:#f92672">.</span>drop([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)
chugoku_shikoku<span style="color:#f92672">.</span>drop([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)
kyushu<span style="color:#f92672">.</span>drop([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)
</code></pre></div><h3 id="missing-value-handling">missing value handling</h3>
<p>First check for missing values</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#66d9ef">print</span>(touhoku<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum())
<span style="color:#66d9ef">print</span>(kanto<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum())
<span style="color:#66d9ef">print</span>(chubu<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum())
<span style="color:#66d9ef">print</span>(kansai<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum())
<span style="color:#66d9ef">print</span>(chugoku_shikoku<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum())
<span style="color:#66d9ef">print</span>(kyushu<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum())
</code></pre></div><p>Delete rows with missing values</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
touhoku<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>, inplace<span style="color:#f92672">=</span>True)
kanto<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>, inplace<span style="color:#f92672">=</span>True)
chubu<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>, inplace<span style="color:#f92672">=</span>True)
kansai<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>, inplace<span style="color:#f92672">=</span>True)
chugoku_shikoku<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>, inplace<span style="color:#f92672">=</span>True)
kyushu<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>, inplace<span style="color:#f92672">=</span>True)
</code></pre></div><h3 id="display-the-data-after-deletion">Display the data after deletion</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
touhoku
</code></pre></div><p>| 2 | 3 | 4 | 7 | 8 | 9 | 10 | 11 |
|&mdash;&mdash;-:|&ndash;:|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; &mdash;&mdash;&mdash;-|&mdash;&mdash;|&mdash;:|&mdash;&mdash;&mdash;&mdash;&ndash;|&mdash;:|&ndash;:|&ndash;: |
|20190215| 1| Aomori Central Wholesale Market | Aomori Prefecture| 2201| Aomori City| 0| 10| 3|
|20190215| 2| Aomori Central Wholesale Market | Aomori Prefecture| 2201| Aomori City| 323| 9| 5|
|20190215| 3| Aomori Central Wholesale Market | Aomori Prefecture | 2201 | Aomori City | 69| 9| 4|
|20190215| 5| Aomori Central Wholesale Market | Aomori Prefecture| 2201| Aomori City| 16| 9| 5|
|・・・|・・・|・・・ |・・・|・・・|・・・ | ・・・| ・・・| ・・・|
|20190430| 21| Koto Microbial Research Institute, Tohoku Central Research Institute | Fukushima Prefecture| 7204| Iwaki City| 0| 8| 2|
|20190430| 22| Koto Microbial Research Institute, Tohoku Central Research Institute | Fukushima Prefecture| 7204| Iwaki City| 0| 9| 3|
|20190430| 23| Koto Microbial Research Institute, Tohoku Central Research Institute | Fukushima Prefecture| 7204| Iwaki City| 0| 8| 3|
|20190430| 24| Koto Microbial Research Institute, Tohoku Central Research Institute | Fukushima Prefecture| 7204| Iwaki City| 0| 9| 2|
23310 rows × 9 columns
By deleting the lines with missing values, we reduced 90 lines in the Tohoku region.
We will look at this in each region as before.</p>
<h3 id="check-which-municipality-is-included-in-each-data">Check which municipality is included in each data</h3>
<p>There are many observation points in each data, but let&rsquo;s count how many observation points there are by the number of municipalities with observation points.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#75715e"># Check the number of municipalities at the observation points in each region except Hokkaido and Okinawa</span>
<span style="color:#66d9ef">print</span>(len(touhoku<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)<span style="color:#f92672">.</span>count()))
<span style="color:#66d9ef">print</span>(len(kanto<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)<span style="color:#f92672">.</span>count()))
<span style="color:#66d9ef">print</span>(len(chubu<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)<span style="color:#f92672">.</span>count()))
<span style="color:#66d9ef">print</span>(len(kansai<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)<span style="color:#f92672">.</span>count()))
<span style="color:#66d9ef">print</span>(len(chugoku_shikoku<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)<span style="color:#f92672">.</span>count()))<span style="color:#66d9ef">print</span>(len(kyushu<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)<span style="color:#f92672">.</span>count()))
<span style="color:#75715e"># Check the total number of municipalities at observation points nationwide except Hokkaido and Okinawa</span>
<span style="color:#66d9ef">print</span>(len(touhoku<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)) <span style="color:#f92672">+</span> len(kanto<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)) <span style="color:#f92672">+</span> len(chubu<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)) <span style="color:#f92672">+</span> len(kansai<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)) <span style="color:#f92672">+</span> len(chugoku_shikoku<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>) ) <span style="color:#f92672">+</span> len(kyushu<span style="color:#f92672">.</span>groupby(<span style="color:#ae81ff">9</span>)))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
Tohoku: <span style="color:#ae81ff">13</span>
Kanto: <span style="color:#ae81ff">20</span>
Chubu: <span style="color:#ae81ff">23</span>
Kansai: <span style="color:#ae81ff">19</span>
Chugoku<span style="color:#f92672">/</span>Shikoku: <span style="color:#ae81ff">21</span>
Kyushu: <span style="color:#ae81ff">20</span>
Total: <span style="color:#ae81ff">116</span>
</code></pre></div><h3 id="combine-the-data-frames-for-each-region-into-one">Combine the data frames for each region into one</h3>
<p>When combined, it became a data frame of about 210,000 rows</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
alljapan <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([touhoku, kanto, chubu, kansai, chugoku_shikoku, kyushu])
alljapan
</code></pre></div><p>| 2 | 3 | 4 | 7 | 8 | 9 | 10 | 11 |
|&mdash;&mdash;-:|&ndash;:|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; &mdash;&mdash;&mdash;-|&mdash;&mdash;|&mdash;:|&mdash;&mdash;&mdash;&mdash;&ndash;|&mdash;:|&ndash;:|&ndash;: |
|20190215| 1| Aomori Central Wholesale Market | Aomori Prefecture| 2201| Aomori City| 0| 10| 3|
|20190215| 2| Aomori Central Wholesale Market | Aomori Prefecture| 2201| Aomori City| 323| 9| 5|
|20190215| 3| Aomori Central Wholesale Market | Aomori Prefecture | 2201 | Aomori City | 69| 9| 4|
|20190215| 5| Aomori Central Wholesale Market | Aomori Prefecture| 2201| Aomori City| 16| 9| 5|
|・・・|・・・|・・・ |・・・|・・・|・・・ | ・・・| ・・・| ・・・|
|20190430| 21| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Building | Kagoshima Prefecture | 46203| Kanoya City | 8| 11| 1|
|20190430| 22| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Building | Kagoshima Prefecture | 46203| Kanoya City | 4| 10| 1|
|20190430| 23| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Building | Kagoshima Prefecture | 46203| Kanoya City | 0| 11| 1|
|20190430| 24| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Building | Kagoshima Prefecture | 46203| Kanoya City | 0| 10| 1|
208273 rows × 9 columns</p>
<p>The column label is hard to understand, so edit the column name</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
alljapan<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;year/month/day&#39;</span>,<span style="color:#e6db74">&#39;time&#39;</span>,<span style="color:#e6db74">&#39;observation point&#39;</span>,<span style="color:#e6db74">&#39;prefecture&#39;</span>,<span style="color:#e6db74">&#39;municipal code&#39;</span>,<span style="color:#e6db74">&#39;municipal&#39;</span>,<span style="color:#e6db74">&#39;pollen scattering count (pieces/m^3)&#39;</span> , <span style="color:#e6db74">&#34;Wind direction code&#34;</span>, <span style="color:#e6db74">&#34;Wind speed (m/s)&#34;</span>]
</code></pre></div><h3 id="i-want-to-make-the-wind-direction-data-easier-to-understand">I want to make the wind direction data easier to understand</h3>
<p>Prepare a wind direction code and 16-direction wind direction correspondence table</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
wind_direction <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./wind_direction_code.csv&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;UTF-8&#39;</span>, header<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
wind_direction
</code></pre></div><p>| Wind direction | Wind direction code |
|&mdash;&mdash;|&mdash;&mdash;&mdash;::
North-northeast | 1|
| Northeast | 2|
| East North East | 3|
| East | 4|
Southeast | 5|
Southeast | 6|
South-South East | 7|
| South | 8|
South-southwest | 9|
| Southwest | 10|
| WSW | 11|
| West | 12|
| West Northwest | 13|
| Northwest | 14|
| Northwest | 15|
| North | 16|
Combine the observation table with this wind direction code correspondence table
Converted alljapan wind direction column data type from float to int in order to make the data types the same when combining</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
alljapan[<span style="color:#e6db74">&#39;wind direction code&#39;</span>] <span style="color:#f92672">=</span> alljapan[<span style="color:#e6db74">&#39;wind direction code&#39;</span>]<span style="color:#f92672">.</span>astype(np<span style="color:#f92672">.</span>int64)
</code></pre></div><p>Combine two data frames around the wind direction code</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
alljapan2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
    alljapan, wind_direction,
    on <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Wind direction code&#39;</span>,
    how <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>
)
alljapan2
</code></pre></div><p>Date | Time | Observation point | Prefecture | Prefecture code | Municipal code | Municipalities | Pollen scattering number (pieces/m^3) | Wind direction code | Wind speed (m/s) |
|&mdash;&mdash;-:|&mdash;:|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;|&mdash;&mdash;&ndash;|&mdash;&mdash;- &mdash;&mdash;:|&mdash;&mdash;&ndash;|&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;:|&mdash;&mdash;&mdash;:|&mdash; &mdash;&ndash;:|&mdash;&mdash;|
|20190215| 1| Aomori City Central Wholesale Market | Aomori Prefecture | 2201| Aomori City | 0| 10| 3| Southwest |
|20190215| 2| Aomori City Central Wholesale Market | Aomori Prefecture | 2201 | Aomori City | 323| 9| 5| Southwest |
|20190215| 3| Aomori Central Wholesale Market | Aomori Prefecture | 2201 | Aomori City | 69| 9| 4| Southwest |
|20190215| 5| Aomori Central Wholesale Market | Aomori Prefecture | 2201| Aomori City | 16| 9| 5| South-South |
|・・・|・・・|・・・|・・・ | ・・・|・・・ | ・・・| ・・・| ・・・|・・・ |
|20190430| 21| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Building | Kagoshima Prefecture | 46203| Kanoya City | 8| 11| 1| West Southwest |
|20190430| 22| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Building | Kagoshima Prefecture | 46203| Kanoya City | 4| 10| 1| Southwest |
|20190430| 23| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Office | Kagoshima Prefecture | 46203| Kanoya City | 0| 11| 1| West Southwest |
|20190430| 24| Kagoshima Prefecture Osumi Regional Development Bureau Main Government Building | Kagoshima Prefecture | 46203| Kanoya City | 0| 10| 1| Southwest |</p>
<p>The wind direction code 0th was included, so delete it.
Wind direction code 0 indicates &ldquo;quiet&rdquo;, but this time it is unnecessary.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
alljapan3 <span style="color:#f92672">=</span> alljapan2[alljapan2[<span style="color:#e6db74">&#39;wind direction code&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>]
</code></pre></div><h3 id="i-want-to-combine-data-about-coordinates">I want to combine data about coordinates</h3>
<p>Read the correspondence table of city code and coordinates
Since the data frame was output for markdown, only 2 digits after the decimal point of latitude and longitude are displayed, but in reality more detailed values are displayed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
city_lon_lat <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./citycode_coordinate_correspondence_table.csv&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;UTF-8&#39;</span>, header<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
city_lon_lat
</code></pre></div><p>| City Code | Prefecture | City | Unnamed: 3 | Latitude | Longitude |
|&mdash;&mdash;&mdash;&mdash;-:|&mdash;&mdash;&ndash;|&mdash;&mdash;&mdash;&mdash;&ndash;|&mdash;&mdash;&mdash;- &ndash;|&mdash;-:|&mdash;-:|
| 11011 | Hokkaido | Sapporo City | Chuo-ku | 43.06|141.3|
| 11029 | Hokkaido | Sapporo City | Kita Ward | 43.09|141.3|
| 11037 | Hokkaido | Sapporo City | Higashi Ward | 43.08|141.4|
| ・・・|・・・ |・・・ |・・・ |・・・|・・・|
473758| Okinawa | Miyako-gun | Tarama-mura | 24.67|124.7|
Okinawa Prefecture | Yaeyama District | Taketomi Town | 24.29|123.9|
Okinawa Prefecture | Yaeyama District | Yonaguni Town | 24.47|123.0|
1896 rows × 6 columns</p>
<p>Remove extra columns</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
city_lon_lat<span style="color:#f92672">.</span>drop([<span style="color:#e6db74">&#39;prefecture&#39;</span>,<span style="color:#e6db74">&#39;city&#39;</span>,<span style="color:#e6db74">&#39;Unnamed: 3&#39;</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)
</code></pre></div><p>The last digit of the city code is a check digit, so the left five digits are the commonly used city code, so remove the last digit.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
Converts the data type of the city code column of <span style="color:#75715e"># city_lon_lat from int to str</span>
city_lon_lat[<span style="color:#e6db74">&#39;city code&#39;</span>] <span style="color:#f92672">=</span> city_lon_lat[<span style="color:#e6db74">&#39;city code&#39;</span>]<span style="color:#f92672">.</span>astype(str)

Delete the last digit of the city code column of <span style="color:#75715e"># city_lon_lat and resubstitute</span>
city_lon_lat[<span style="color:#e6db74">&#39;city code&#39;</span>] <span style="color:#f92672">=</span> city_lon_lat[<span style="color:#e6db74">&#39;city code&#39;</span>]<span style="color:#f92672">.</span>str[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]

Convert data type of city code column of <span style="color:#75715e"># city_lon_lat from str to int</span>
city_lon_lat[<span style="color:#e6db74">&#39;city code&#39;</span>] <span style="color:#f92672">=</span> city_lon_lat[<span style="color:#e6db74">&#39;city code&#39;</span>]<span style="color:#f92672">.</span>astype(int)
</code></pre></div><p>Merge alljapan3 and city_lon_lat with &ldquo;City code&rdquo; column as axis</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
join_alljapan <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
    alljapan3, city_lon_lat,
    on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;City code&#39;</span>,
    how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>
)
join_alljapan
</code></pre></div><p>Date | Time | Observing point | Prefecture | City code | City code | Number of pollen scattered (pieces/m^3) | Wind direction code | Wind speed (m/s) ||&mdash;&mdash;-:|&mdash;:|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;|&mdash;&mdash;&ndash;|&mdash;&mdash;- &mdash;&mdash;:|&mdash;&mdash;&ndash;|&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;:|&mdash;&mdash;&mdash;:|&mdash; &mdash;&ndash;:|&mdash;&mdash;|&mdash;-:|&mdash;-:|
|20190215| 1| Aomori Central Wholesale Market | Aomori Prefecture | 2201| Aomori City | 0| 10| 3| Southwest | 40.82| 140.7|
|20190215| 2| Aomori Central Wholesale Market | Aomori Prefecture | 2201| Aomori City | 323| 9| 5| South-South | 40.82|140.7|
|20190215| 3| Aomori City Central Wholesale Market | Aomori Prefecture | 2201 | Aomori City | 69| 9| 4| South-southwest | 40.82|140.7|
|・・・| ・・・|・・・|・・・ | ・・・|・・・ | ・・・| ・・・| ・・・|・・・|・・・|・・・|
|20190430| 22| Aomori City Central Wholesale Market | Aomori Prefecture | 2201| Aomori City | 0| 13| 1| WNW | 40.82|140.7|
|20190430| 23| Aomori City Central Wholesale Market | Aomori Prefecture | 2201| Aomori City | 4| 11| 1| WSW | 40.82|140.7|
|20190430| 24| Aomori Central Wholesale Market | Aomori Prefecture | 2201 | Aomori City | 0| 14| 1| Northwest | 40.82| 140.7|</p>
<p>Check data type and number of data in each column</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
join_alljapan<span style="color:#f92672">.</span>info()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
Date <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
Time <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
Observation point <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null object
Prefecture <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null object
City code <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
City <span style="color:#ae81ff">2014</span> <span style="color:#ae81ff">22</span> non<span style="color:#f92672">-</span>null object
Pollen scattering number (pieces<span style="color:#f92672">/</span>m<span style="color:#f92672">^</span><span style="color:#ae81ff">3</span>) <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null float64
Wind direction code <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
Wind speed (m<span style="color:#f92672">/</span>s) <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null float64
Wind direction <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null object
Latitude <span style="color:#ae81ff">196486</span> non<span style="color:#f92672">-</span>null float64
Longitude <span style="color:#ae81ff">196486</span> non<span style="color:#f92672">-</span>null float64
</code></pre></div><p>It seems that there are missing values in latitude and longitude, so when I check it concretely, it seems that there was an error in the municipality code of the municipality at the three observation points.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
join_alljapan[join_alljapan[<span style="color:#e6db74">&#39;latitude&#39;</span>]<span style="color:#f92672">.</span>isnull()]
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#75715e"># Shizuoka prefectural government office location, Aoi-ku, Shizuoka city, the city code seems to be 22101 instead of 22201, so correct it</span>
alljapan3<span style="color:#f92672">.</span> municipal code [alljapan3<span style="color:#f92672">.</span> municipal code <span style="color:#f92672">==</span> <span style="color:#ae81ff">22201</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">22101</span>
<span style="color:#75715e"># Correct the location code of Kumamoto City Medical Association Healthcare Center, Chuo-ku, Kumamoto City, as 43101 is correct instead of 43201</span>
alljapan3<span style="color:#f92672">.</span> City code [alljapan3<span style="color:#f92672">.</span> City code <span style="color:#f92672">==</span> <span style="color:#ae81ff">43201</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43101</span>
<span style="color:#75715e"># Aira/Isa Regional Development Bureau, Kagoshima Prefecture The location of Isa Government Office, the city code of Isa City, Kagoshima Prefecture is correct instead of 46209, so correct it.</span>
alljapan3<span style="color:#f92672">.</span> Municipal code [alljapan3<span style="color:#f92672">.</span> Municipal code <span style="color:#f92672">==</span> <span style="color:#ae81ff">46209</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">46224</span>
</code></pre></div><p>Merge alljapan3 and city_lon_lat again with the city code column as the axis</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
join_alljapan <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>merge(
    alljapan3, city_lon_lat,
    on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;City code&#39;</span>,
    how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>
)
</code></pre></div><p>Check data type and number of data in each column
This time, the numbers of data all match and it seems that we could merge without missing values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
join_alljapan<span style="color:#f92672">.</span>info()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
Date <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
Time <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
Observation point <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null object
Prefecture <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null object
City code <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
City <span style="color:#ae81ff">2014</span> <span style="color:#ae81ff">22</span> non<span style="color:#f92672">-</span>null object
Pollen scattering number (pieces<span style="color:#f92672">/</span>m<span style="color:#f92672">^</span><span style="color:#ae81ff">3</span>) <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null float64
Wind direction code <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null int64
Wind speed (m<span style="color:#f92672">/</span>s) <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null float64
Wind direction <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null object
Latitude <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null float64
Longitude <span style="color:#ae81ff">201422</span> non<span style="color:#f92672">-</span>null float64
</code></pre></div><p>Verification of the number of observation points</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#66d9ef">print</span>(len(join_alljapan<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;city code&#39;</span>))))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#ae81ff">116</span>
</code></pre></div><h3 id="cedar-vegetation-data">Cedar vegetation data</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
sugi_area <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./sugi_h29.csv&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;UTF-8&#39;</span>, header<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
sugi_area
</code></pre></div><img width="1348" alt="Screenshots 2019-12-11 7.52.17.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/515144/b0575bf9-754e-f7f0-7189-cba53eabe8fc.png">
52 rows × 24 columns
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
sugi_area<span style="color:#f92672">.</span>drop([<span style="color:#e6db74">&#39;Unnamed: 0&#39;</span>,<span style="color:#e6db74">&#39;Unnamed: 1&#39;</span>, <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;3&#39;</span>, <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;5&#39;</span>, <span style="color:#e6db74">&#39;6&#39;</span>, <span style="color:#e6db74">&#39;7&#39;</span>, <span style="color:#e6db74">&#39;8&#39;</span>, <span style="color:#e6db74">&#39; 9&#39;</span>, <span style="color:#e6db74">&#39;10&#39;</span>, <span style="color:#e6db74">&#39;11&#39;</span>, <span style="color:#e6db74">&#39;12&#39;</span>, <span style="color:#e6db74">&#39;13&#39;</span>, <span style="color:#e6db74">&#39;14&#39;</span>, <span style="color:#e6db74">&#39;15&#39;</span>, <span style="color:#e6db74">&#39;16&#39;</span>, <span style="color:#e6db74">&#39;17&#39;</span>, <span style="color:#e6db74">&#39;18&#39;</span>, <span style="color:#e6db74">&#39;19&#39;</span>, <span style="color:#e6db74">&#39;20+&#39;</span>], axis<span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)

sugi_area<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;prefecture&#39;</span>,<span style="color:#e6db74">&#39;sugi vegetation area (m^2)&#39;</span>]

<span style="color:#75715e">#Delete rows with missing values</span>
sugi_area<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>, inplace<span style="color:#f92672">=</span>True)
sugi_area <span style="color:#f92672">=</span> sugi_area<span style="color:#f92672">.</span>drop(<span style="color:#ae81ff">47</span>)
sugi_area
</code></pre></div><table>
<thead>
<tr>
<th>Prefectures</th>
<th>Cedar vegetation area (m^2)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hokkaido</td>
<td>32,128</td>
</tr>
<tr>
<td>Aomori Prefecture</td>
<td>198,690</td>
</tr>
<tr>
<td>Iwate Prefecture</td>
<td>200,525</td>
</tr>
<tr>
<td>・・・</td>
<td>・・・</td>
</tr>
<tr>
<td>Miyazaki Prefecture</td>
<td>224,828</td>
</tr>
<tr>
<td>Kagoshima</td>
<td>153,298</td>
</tr>
<tr>
<td>Okinawa Prefecture</td>
<td>237</td>
</tr>
</tbody>
</table>
<h3 id="prevalence-data-for-hay-fever-by-prefecture">Prevalence data for hay fever by prefecture</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
pollen_prevalence <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./pollen_prevalence.csv&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;UTF-8&#39;</span>, header<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
pollen_prevalence <span style="color:#f92672">=</span> pollen_prevalence<span style="color:#f92672">.</span>drop(<span style="color:#ae81ff">47</span>)
pollen_prevalence
</code></pre></div><table>
<thead>
<tr>
<th>Prefectures</th>
<th align="right">Prevalence</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hokkaido</td>
<td align="right">2.2</td>
</tr>
<tr>
<td>Aomori</td>
<td align="right">12.5</td>
</tr>
<tr>
<td>Iwate</td>
<td align="right">12.1</td>
</tr>
<tr>
<td>・・・</td>
<td align="right">・・・</td>
</tr>
<tr>
<td>Miyazaki</td>
<td align="right">8.2</td>
</tr>
<tr>
<td>Kagoshima</td>
<td align="right">12.1</td>
</tr>
<tr>
<td>Okinawa</td>
<td align="right">6.0</td>
</tr>
</tbody>
</table>
<p>That&rsquo;s all for data cleansing of the data captured in the CSV file.</p>
<h1 id="aggregate">Aggregate</h1>
<p>Next, we will collect the cleansed data and obtain the necessary data.</p>
<h3 id="average-number-of-pollen-scattered-in-each-municipality">Average number of pollen scattered in each municipality</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
pollen_amount <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(join_alljapan<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;prefecture&#39;</span>])<span style="color:#f92672">.</span>mean()[<span style="color:#e6db74">&#39;pollen scattering number (pieces/m^3)&#39;</span>])
<span style="color:#75715e"># pollen_amount.insert(0,&#39;city&#39;, join_alljapan[&#39;city&#39;]]</span>
pollen_amount
</code></pre></div><img width="171" alt="Screenshots 2019-12-11 12.35.13.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/515144/db141ccb-4fad-d63b-8740-efe432ce008b.png">
<h3 id="aggregation-of-wind-direction-at-each-observation-point">Aggregation of wind direction at each observation point</h3>
<p>By collecting the wind direction observed every hour at each observation point during the observation period, we would like to obtain the rough wind direction at that observation point.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">
<span style="color:#75715e"># Create a new data frame by grouping by prefecture / city / town / wind direction and collecting the number of observations for each direction</span>
count_wind <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(join_alljapan<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;prefecture&#39;</span>,<span style="color:#e6db74">&#39;city&#39;</span>,<span style="color:#e6db74">&#39;wind direction&#39;</span>])<span style="color:#f92672">.</span>size())
count_wind<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Number of observations in each direction of wind&#39;</span>]

<span style="color:#75715e"># Add &#34;Total number of observations in all directions of wind direction&#34; as a new column</span>
count_wind[<span style="color:#e6db74">&#39;total number of wind observations in all directions&#39;</span>] <span style="color:#f92672">=</span> join_alljapan<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;prefecture&#39;</span>,<span style="color:#e6db74">&#39;city&#39;</span>])<span style="color:#f92672">.</span>size()

<span style="color:#75715e"># Add &#34;Percentage of observed wind direction in all directions (%)&#34; as a new column</span>
count_wind[<span style="color:#e6db74">&#39;Percentage of observed wind direction in all directions(%)&#39;</span>] <span style="color:#f92672">=</span> count_wind[<span style="color:#e6db74">&#39;Number of observations in each direction of wind direction&#39;</span>] <span style="color:#f92672">/</span> count_wind[<span style="color:#e6db74">&#39;Total number of observations in all directions of wind direction&#39;</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>

count_wind
</code></pre></div><p>Like this<img width="788" alt="Screenshots 2019-12-11 5.52.15.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/515144/13fe8ad9-fe64-73f1-c6b4-1320a5e3ceee.png">
I have created a table that summarizes the number of pollen scattered and the wind direction, but it is in a state where there is no column as a data frame to the left of the column.
Once you have added the columns for prefectures, you are ready to visualize.
However, since it takes a lot of time, I&rsquo;ll do so this time. .. ..</p>
<h1 id="finally">Finally</h1>
<p>This time, I have summarized only the data preprocessing in the series of analysis that I wanted to do.
My homework is to improve it a little more so that the data can be visualized and then visualize it. .. ..
I will update Qiita when it is put together.</p>
<h1 id="relation">Relation</h1>
<p>Analyzing the amount of pollen dispersal, the vegetation of Sugi and the effect of wind from open data (Visualization)
<a href="https://qiita.com/TakuTaku36/items/e9fa09b38f86be188070">https://qiita.com/TakuTaku36/items/e9fa09b38f86be188070</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
