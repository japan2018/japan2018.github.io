<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>(WIP) Verify Bresenham&#39;s algorithm for drawing line segments | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>(WIP) Verify Bresenham&rsquo;s algorithm for drawing line segments</h1>
<p>
  <small class="text-secondary">
  
  
  Apr 26, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/algorithm"> Algorithm</a></code></small>

</p>
<pre><code># Status
</code></pre>
<p>For now, up to drawing and proof by human power. Next, I would like to prove it with a theorem proof system such as TLA+ or Coq.
By the way, the vertical position of MathJax is too misaligned, isn&rsquo;t it?</p>
<h1 id="overview">Overview</h1>
<p>The Bresenham algorithm is an algorithm for drawing a line segment on a screen expressed in pixels.
Pixel coordinates can only have integer values, so an approximation algorithm is needed.
At this time, it is an advantage of this algorithm that the calculation can be performed without performing the floating-point calculation having an error.</p>
<h1 id="references">References</h1>
<ul>
<li>Wikipedia, Bresenham&rsquo;s algorithm: https://w.wiki/P2G</li>
</ul>
<h1 id="problem-setting">Problem setting</h1>
<p>Draw a line segment connecting the end points $(x_0,y_0)$ and $(x_1,y_1)$. However,</p>
<ul>
<li>End points are grid points, that is, coordinate values are integers.</li>
<li>Both endpoints are in the first quadrant, that is, $0&lt;x_0, 0&lt;y_0,0&lt;x_1,0&lt;y_1$.</li>
<li>A line segment that goes to the upper right. That is, $x_0 &lt;x_1, y_0 \le y_1$. Note that horizontal lines may be included, but vertical lines are not included.</li>
<li>Furthermore, the slope of the line segment is less than $1$, that is, $$\frac{y_1-y_0}{x_1-x_0} \le 1$$.</li>
</ul>
<p>There are various assumptions, but since all other cases can be reduced to this case, this assumption does not lose generality. <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<h1 id="algorithm">Algorithm</h1>
<p>In the following, $x_1-x_0 = \Delta x$, $y_1-y_0=\Delta y$. The slope can be expressed as $\Delta y/\Delta x$.</p>
<p>Since the slope is less than $1$, the $y$ coordinate $\hat Y(X)$ is calculated to be an integer for the integer value $x$ coordinate $X$ between the end points. It seems that if you draw (X,\hat Y(X))$, it looks like a straight line.
However, since it must be an approximation of the original straight line, the absolute value of the error between the original $y$ coordinates $Y(X)$ and $\hat Y(X)$ $|\hat Y(X)-Y( X)|$ should be less than $1/2$. The image is drawn while rounding off the $y$ coordinate values.</p>
<h2 id="concrete-example">Concrete example</h2>
<p>For example, drawing a line segment from $(1,1)$ to $(12,5)$ (slope $4/11$) looks like this (drawn with matplotlib).</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/58848/e2ce416b-3a26-24ef-cf8d-5ceb4779d896.png" alt="bre1.png"></p>
<h2 id="program">Program</h2>
<p>The first algorithm on Wikipedia uses fractions ($\Delta x$ in the denominator of <code>deltaerr</code> and $2$ in the denominator of <code>0.5</code> in if statements), so floating-point arithmetic is required. So, multiplying everything in the error calculation by $2\Delta x$ results in the following Python program.
If you set <code>grid</code> as an array of NumPy, you can draw with <code>imshow()</code> or <code>matshow()</code> of matplotlib.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Bresenham</span>(grid, p0, p1):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot</span>(grid, x, y):
        grid[y,x] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    x0, y0 <span style="color:#f92672">=</span> p0
    x1, y1 <span style="color:#f92672">=</span> p1
    deltax <span style="color:#f92672">=</span> x1<span style="color:#f92672">-</span>x0
    deltay <span style="color:#f92672">=</span> y1<span style="color:#f92672">-</span>y0
    error <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    y <span style="color:#f92672">=</span> y0
    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(x0, x1<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
        plot(grid, x, y)
        error <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>deltay
        <span style="color:#66d9ef">if</span> error <span style="color:#f92672">&gt;</span>deltax:
            y <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
            error <span style="color:#f92672">-=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>deltax
    <span style="color:#66d9ef">return</span> grid
</code></pre></div><p>The previous figure is a drawing of the array created as <code>grid = Bresenham(np.zeros((7, 14)), (1,1), (12,5))</code>.</p>
<h2 id="proof">Proof</h2>
<p>This proves that the line segment can be drawn approximately.
Hereafter, the value of $Y,\hat Y$ for $X$ is written as $Y(X), \hat Y(X)$. And the error $\hat Y(X)-Y(X) = \varepsilon (X)$.
Prove that $-1/2 &lt;\varepsilon(X) \le 1/2$ for every $X$ between $x_0$ and $x_1$. Only the inequality sign on the right has an equal sign.
Prove by induction:</p>
<ol>
<li>When $X=x_0$, $\hat Y(X) = y_0$, so $\varepsilon(X)=0$ satisfies the subject.</li>
<li>Suppose $-1/2 &lt;\varepsilon(X) \le 1/2$ for some $X$. Since the slope of the line segment is $\Delta y/\Delta x$, if we leave it as $\hat Y(X+1)=\hat Y(X)$, then $\varepsilon(X+1) = \varepsilon(X) + \Delta y/\Delta x$ and the slope is $0$ or more and $1$ or less, so $-1/2 &lt;\varepsilon(X+1) \le 3/2 It becomes $.</li>
<li>If it is within the range of $-1/2 &lt;\varepsilon(X+1) \le 1/2$, the condition is satisfied as it is.</li>
<li>If $1/2 &lt;\varepsilon(X+1) \le 3/2$, by setting $\hat Y(X+1)=\hat Y(X)+1$, $-1 /2 &lt;\varepsilon(X+1) \le 1/2$ can be satisfied, which satisfies the subject.</li>
</ol>
<p>From the above, the theme was shown. (End of proof)</p>
<p>Furthermore, it shows that they appear to be continuous on the screen, that is, $\hat Y(X+1)-\hat Y(X) \in \{ 0, 1 \}$ May be good. However, this is almost self-evident from the program.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>In English, &ldquo;without loss of generality&rdquo; may be abbreviated as &ldquo;w.l.o.g.&rdquo; or &ldquo;wlog&rdquo; in English. <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
