<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>I want to upload the Django app to heroku | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>I want to upload the Django app to heroku</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 7, 2019
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/django">Django</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/heroku">Heroku</a></code></small>

</p>
<pre><code>Thank you for your help.
</code></pre>
<p>【environment】
Surface Laptop2
Windows 1809
Python 3.7.4 (the one running on the command line)
Django 2.2.6</p>
<p>[What you want to achieve]
I want to publish an app made with Django using heroku</p>
<p>【Situation】
The Django app on Heroku doesn&rsquo;t deploy well and the build doesn&rsquo;t succeed.</p>
<p><a href="URLusedasreference">Procedure</a>
(1) <a href="https://qiita.com/frosty/items/66f5dff8fc723387108c">https://qiita.com/frosty/items/66f5dff8fc723387108c</a>
Https://qiita.com/RyuSA/items/0cbc7d5b0145585861a8
I rewrote settings.py with reference to the two sites
Was rewritten as
from socket import gethostname # It is possible to get the hostname by doing this ***A
import django_heroku
import os
import dj_database_url</p>
<p>hostname = gethostname() # substitute the host name obtained in A for hostname</p>
<p>BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(<strong>file</strong>)))</p>
<p>INSTALLED_APPS = [
&lsquo;polls.apps.PollsConfig&rsquo;,
&lsquo;django.contrib.admin&rsquo;,
&lsquo;django.contrib.auth&rsquo;,
&lsquo;django.contrib.contenttypes&rsquo;,
&lsquo;django.contrib.sessions&rsquo;,
&lsquo;django.contrib.messages&rsquo;,
&lsquo;django.contrib.staticfiles&rsquo;,
]</p>
<p>MIDDLEWARE = [
&lsquo;django.middleware.security.SecurityMiddleware&rsquo;,
&lsquo;django.contrib.sessions.middleware.SessionMiddleware&rsquo;,
&lsquo;django.middleware.common.CommonMiddleware&rsquo;,
&lsquo;django.middleware.csrf.CsrfViewMiddleware&rsquo;,
&lsquo;django.contrib.auth.middleware.AuthenticationMiddleware&rsquo;,
&lsquo;django.contrib.messages.middleware.MessageMiddleware&rsquo;,
&lsquo;django.middleware.clickjacking.XFrameOptionsMiddleware&rsquo;,
Added&rsquo;whitenoise.middleware.WhiteNoiseMiddleware&rsquo;, # ←
]</p>
<p>ROOT_URLCONF ='mysite.urls&rsquo;</p>
<p>TEMPLATES = [
{
&lsquo;BACKEND&rsquo;:&lsquo;django.template.backends.django.DjangoTemplates&rsquo;,
&lsquo;DIRS&rsquo;: [os.path.join(BASE_DIR,&lsquo;templates&rsquo;)],
&lsquo;APP_DIRS&rsquo;: True,
&lsquo;OPTIONS&rsquo;: {
&lsquo;context_processors&rsquo;: [
&lsquo;django.template.context_processors.debug&rsquo;,
&lsquo;django.template.context_processors.request&rsquo;,
&lsquo;django.contrib.auth.context_processors.auth&rsquo;,
&lsquo;django.contrib.messages.context_processors.messages&rsquo;,
],
},
},
]</p>
<p>WSGI_APPLICATION ='mysite.wsgi.application&rsquo;</p>
<p>AUTH_PASSWORD_VALIDATORS = [
{
&lsquo;NAME&rsquo;:&lsquo;django.contrib.auth.password_validation.UserAttributeSimilarityValidator&rsquo;,
},
{
&lsquo;NAME&rsquo;:&lsquo;django.contrib.auth.password_validation.MinimumLengthValidator&rsquo;,
},
{
&lsquo;NAME&rsquo;:&lsquo;django.contrib.auth.password_validation.CommonPasswordValidator&rsquo;,
},
{
&lsquo;NAME&rsquo;:&lsquo;django.contrib.auth.password_validation.NumericPasswordValidator&rsquo;,
},
]</p>
<p>LANGUAGE_CODE ='en-us&rsquo;
TIME_ZONE ='UTC&rsquo;
USE_I18N = True
USE_L10N = True
USE_TZ = True</p>
<p>DEBUG = False
if not DEBUG:
SECRET_KEY = os.environ[&lsquo;SECRET_KEY&rsquo;]</p>
<p>DEBUG = False</p>
<p>try:
from .local_settings import * # imports all loca_settings modules
except ImportError:
pass</p>
<p>STATIC_URL =&rsquo;/static/&rsquo;
STATIC_ROOT ='staticfiles&rsquo;
STATIC_ROOT = os.path.join(BASE_DIR,&lsquo;staticfiles&rsquo;)</p>
<p>if &ldquo;DESKTOP-877IM6E&rdquo; in hostname:
# Debug environment
# DEBUG = True
DATABASES = {
# django is an alias for default when no other database is selected
#Use database
&lsquo;default&rsquo;: {
&lsquo;ENGINE&rsquo;:&lsquo;django.db.backends.sqlite3&rsquo;,
&lsquo;NAME&rsquo;: os.path.join(BASE_DIR,&lsquo;db.sqlite3&rsquo;),
}
}
ALLOWED_HOSTS = ['*'] # Since this is a local development environment, there is no need for a domain
else:
DEBUG = False
db_from_env = dj_database_url.config()
DATABASES = {
&lsquo;default&rsquo;: {
&lsquo;ENGINE&rsquo;:&lsquo;django.db.backends.postgresql_psycopg2&rsquo;,
&lsquo;NAME&rsquo;:&lsquo;name&rsquo;,
&lsquo;USER&rsquo;:&lsquo;user&rsquo;,
&lsquo;PASSWORD&rsquo;:'&rsquo;,
&lsquo;HOST&rsquo;:&lsquo;host&rsquo;,
&lsquo;PORT&rsquo;:'&rsquo;,
}
}
ALLOWED_HOSTS = [&lsquo;https://salty-beyond-49092.herokuapp.com/']</p>
<p>#Advanced Setting
(2) The file is set as shown in the image below, and requirements.txt and Procfile are set.
Also, the one covered with black letters in the image is my PC name.
<img width="966" alt="a.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/500814/1d633efb-fd92-bc72-3921-2eae50518ef4.png"></p>
<p>#result
Then, deploying with heroku and displaying the specified URL in the browser will be as follows
<img width="966" alt="b.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/500814/c7574664-f87f-0bac-af4c-62f1720d2127.png"></p>
<h1 id="do-not-know-etc">[Do not know, etc.]</h1>
<p>I&rsquo;m new to Django and have no idea why a bad request comes in.
There are no errors, so I don&rsquo;t know where to fix it.
The developer tools error message is
``Failed to load resource: the server responded with a status of 400 (Bad Request)&rsquo;&rsquo;
An error message like is displayed.
Even if you look at heroku status like the image below
There seems to be no problem with the database,
<img width="484" alt="c.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/500814/45b2ea8e-4ded-6163-af17-02f7d7681b9a.png"></p>
<p>Thank you.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
