<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>[Pandas 1.0.1 Memorial] Fierce battle with Cookbook | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Pandas 1.0.1 Memorial] Fierce battle with Cookbook</h1>
<p>
  <small class="text-secondary">
  
  
  Mar 9, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/numpy">numpy</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/pandas">pandas</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/python3">Python3</a></code></small>

</p>
<pre><code>#Background
</code></pre>
<ul>
<li>Every time there is a Google search, it is bloody and not flesh due to temporary understanding.</li>
<li>Fragmental knowledge alone is not enough to apply when it is difficult to apply.</li>
<li>In order to overcome the weakened memory, it is necessary to move it, understand it, and explain it to the brain.</li>
<li>I would like to carry out a dictum from the predecessors, &ldquo;Please read the official manual&rdquo;.</li>
</ul>
<h1 id="what-and-how">What and how</h1>
<ul>
<li><a href="https://pandas.pydata.org/docs/index.html">Pandas</a> Target the <code>CookBook</code> at the end of the <code>User Guide</code> on the official page.</li>
<li>On the official page, concrete examples and posts posted on <a href="https://stackoverflow.com">stackoverlow.com</a> etc., <br>
Links to questions and discussions that have been actively discussed are posted.</li>
<li>Why does that happen? While answering questions, I actually write my hands to reach the goal</li>
</ul>
<h1 id="about-the-structure-of-this-post">About the structure of this post</h1>
<ul>
<li>Organize headings according to the structure of your cookbook and cite the codes provided. <br>
(Some numbers and codes have been modified)</li>
<li>In addition, the post of <code>stackoverflow.com</code> is also posted depending on the content. (Publication criteria are individual judgments)</li>
<li>:Clipboard: at the end of the headline is an example from <a href="https://www.stackoverflow.com/">stackoverflow.com</a>.</li>
<li>Regarding the title of the post, at first, if you feel something is wrong with machine translation, I am correcting it with poor reading comprehension.
*:Thumbsup: at the end of the headline is this **useful! <strong>,</strong> Cool! <strong>,</strong> Good! It is a personal opinion called **.</li>
</ul>
<hr>
<p><img src="https://pandas.pydata.org/docs/_static/pandas.svg" alt="pandas logo"></p>
<pre><code class="language-math" data-lang="math">\small{\mathsf{ Date:Feb \ 05, 2020 \ Version: 1.0.1 }}
</code></pre><h1 id="pandas-official-website-cookbookhttpspandaspydataorgdocsuser_guidecookbookhtml"><a href="https://pandas.pydata.org/docs/user_guide/cookbook.html">Pandas Official Website Cookbook</a></h1>
<h1 id="idioms">Idioms</h1>
<h2 id="if-then">If-then&hellip;</h2>
<h3 id="use-if-then--if-then-else-in-one-column-and-assign-it-to-another-column-or-columns">Use if-then / if-then-else in one column and assign it to another column or columns.</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">1</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>],
                           <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
                           <span style="color:#e6db74">&#39;CCC&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>]})

In [<span style="color:#ae81ff">2</span>]: df
Out[<span style="color:#ae81ff">2</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>
</code></pre></div><h3 id="one-column-if-then">one column if-then</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>loc[df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5</span>,<span style="color:#e6db74">&#39;BBB&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</code></pre></div><h3 id="example-of-if-then-assigned-to-two-columns">Example of if-then assigned to two columns</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>loc[df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5</span>, [<span style="color:#e6db74">&#39;BBB&#39;</span>,<span style="color:#e6db74">&#39;CCC&#39;</span>]] <span style="color:#f92672">=</span> <span style="color:#ae81ff">555</span>
</code></pre></div><h3 id="update-condition-and-change-another-row">update condition and change another row</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>loc[df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span>, [<span style="color:#e6db74">&#39;BBB&#39;</span>,<span style="color:#e6db74">&#39;CCC&#39;</span>]] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2000</span>
</code></pre></div><h3 id="condition-is-mask-value">Condition is mask value</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">9</span>]: df_mask <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [True] <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>,
                                <span style="color:#e6db74">&#39;BBB&#39;</span>: [False] <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>,
                                <span style="color:#e6db74">&#39;CCC&#39;</span>: [True, False] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>})

In [<span style="color:#ae81ff">10</span>]: df<span style="color:#f92672">.</span>where(df_mask, <span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span>)
Out[<span style="color:#ae81ff">10</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span> <span style="color:#ae81ff">2000</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span> <span style="color:#ae81ff">555</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<blockquote>
<ul>
<li>In the data frame creation, [True] * 4 becomes [True,True,True,True].</li>
</ul>
</blockquote>
<ul>
<li>The contents of mask_df are as follows.</li>
</ul>
<blockquote>
</blockquote>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">AAA</th>
<th align="right">BBB</th>
<th align="right">CCC</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">True</td>
<td align="right">False</td>
<td align="right">True</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">True</td>
<td align="right">False</td>
<td align="right">False</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">True</td>
<td align="right">False</td>
<td align="right">True</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">True</td>
<td align="right">False</td>
<td align="right">False</td>
</tr>
</tbody>
</table>
<ul>
<li>Where method, if the first argument is True, the element is used, otherwise the second argument is used.</li>
</ul>
<h3 id="use-npwhere-and-substitute-if-then-else-thumbsup">Use np.where and substitute if-then-else :thumbsup:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># np.where(condition, true, false)</span>
df[<span style="color:#e6db74">&#39;logic&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(df[<span style="color:#e6db74">&#39;AAA&#39;</span>]<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">5</span>,<span style="color:#e6db74">&#39;high&#39;</span>,<span style="color:#e6db74">&#39;low&#39;</span>)
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="right">AAA</th>
<th align="right">BBB</th>
<th align="right">CCC</th>
<th align="left">logic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2000</td>
<td align="right">2000</td>
<td align="left">low</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">555</td>
<td align="right">555</td>
<td align="left">low</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">555</td>
<td align="right">555</td>
<td align="left">high</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">7</td>
<td align="right">555</td>
<td align="right">555</td>
<td align="left">high</td>
</tr>
</tbody>
</table>
<h1 id="splitting-division">Splitting (division)</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">16</span>]: df
Out[<span style="color:#ae81ff">16</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>

In [<span style="color:#ae81ff">17</span>]: df[df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">5</span>]
Out[<span style="color:#ae81ff">17</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>

In [<span style="color:#ae81ff">18</span>]: df[df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span>]
Out[<span style="color:#ae81ff">18</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>
</code></pre></div><h3 id="split-the-data-frame-by-boolean-clipboardthumbsup">Split the data frame by Boolean: clipboard::thumbsup:</h3>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="right">sex</th>
<th align="right">age</th>
<th align="right">visits</th>
<th align="right">points</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">128</td>
<td align="right">1</td>
<td align="right">36</td>
<td align="right">6</td>
<td align="right">1980</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">324</td>
<td align="right">0</td>
<td align="right">29</td>
<td align="right">9</td>
<td align="right">-50</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">287</td>
<td align="right">0</td>
<td align="right">41</td>
<td align="right">12</td>
<td align="right">-239</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">423</td>
<td align="right">1</td>
<td align="right">33</td>
<td align="right">33</td>
<td align="right">1570</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">589</td>
<td align="right">0</td>
<td align="right">19</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>Let&rsquo;s split this by a Boolean value.</p>
<blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Check the boolean value of <span style="color:#75715e">#m</span>
m <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;sex&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>
m
<span style="color:#ae81ff">0</span> True
<span style="color:#ae81ff">1</span> False
<span style="color:#ae81ff">2</span> False
<span style="color:#ae81ff">3</span> True
<span style="color:#ae81ff">4</span> False
Name: sex, dtype: bool
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Extract with condition m, extract with negation of m</span>
female, male <span style="color:#f92672">=</span> df[m], df[<span style="color:#f92672">~</span>m]
</code></pre></div><blockquote>
</blockquote>
<p>female</p>
<blockquote>
</blockquote>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="right">sex</th>
<th align="right">age</th>
<th align="right">visits</th>
<th align="right">points</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">128</td>
<td align="right">1</td>
<td align="right">36</td>
<td align="right">6</td>
<td align="right">1980</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">423</td>
<td align="right">1</td>
<td align="right">33</td>
<td align="right">33</td>
<td align="right">1570</td>
</tr>
</tbody>
</table>
<blockquote>
<p>male</p>
</blockquote>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="right">sex</th>
<th align="right">age</th>
<th align="right">visits</th>
<th align="right">points</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">324</td>
<td align="right">0</td>
<td align="right">29</td>
<td align="right">9</td>
<td align="right">-50</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">287</td>
<td align="right">0</td>
<td align="right">41</td>
<td align="right">12</td>
<td align="right">-239</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">589</td>
<td align="right">0</td>
<td align="right">19</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<h1 id="building-criteria">Building criteria</h1>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="right">sex</th>
<th align="right">age</th>
<th align="right">visits</th>
<th align="right">points</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">128</td>
<td align="right">1</td>
<td align="right">36</td>
<td align="right">6</td>
<td align="right">1980</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">324</td>
<td align="right">0</td>
<td align="right">29</td>
<td align="right">9</td>
<td align="right">-50</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">287</td>
<td align="right">0</td>
<td align="right">41</td>
<td align="right">12</td>
<td align="right">-239</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">423</td>
<td align="right">1</td>
<td align="right">33</td>
<td align="right">33</td>
<td align="right">1570</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">589</td>
<td align="right">0</td>
<td align="right">19</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># (A condition) &amp; (B condition) and will result in an error</span>
df<span style="color:#f92672">.</span>loc[(df[<span style="color:#e6db74">&#39;BBB&#39;</span>] <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">25</span>) <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#39;CCC&#39;</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">40</span>),<span style="color:#e6db74">&#39;AAA&#39;</span>]
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span>
Name: AAA, dtype: int64
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># (A condition) | (B condition) or error</span>
 df<span style="color:#f92672">.</span>loc[(df[<span style="color:#e6db74">&#39;BBB&#39;</span>] <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">25</span>) <span style="color:#f92672">|</span> (df[<span style="color:#e6db74">&#39;CCC&#39;</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">40</span>),<span style="color:#e6db74">&#39;AAA&#39;</span>]
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span>
Name: AAA, dtype: int64
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">You can update the data using <span style="color:#75715e"># &amp;,|</span>
df<span style="color:#f92672">.</span>loc[(df[<span style="color:#e6db74">&#39;BBB&#39;</span>] <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">25</span>) <span style="color:#f92672">|</span> (df[<span style="color:#e6db74">&#39;CCC&#39;</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">75</span>),<span style="color:#e6db74">&#39;AAA&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="right">AAA</th>
<th align="right">BBB</th>
<th align="right">CCC</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">10</td>
<td align="right">100</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">20</td>
<td align="right">50</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">0.1</td>
<td align="right">40</td>
<td align="right">-50</td>
</tr>
</tbody>
</table>
<h3 id="use-the-argsort-function-to-select-the-row-with-the-data-closest-to-a-particular-value">use the argsort function to select the row with the data closest to a particular value</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>],
                   <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
                   <span style="color:#e6db74">&#39;CCC&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>]})

In [<span style="color:#ae81ff">26</span>]: df
Out[<span style="color:#ae81ff">26</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>

In [<span style="color:#ae81ff">27</span>]: aValue <span style="color:#f92672">=</span> <span style="color:#ae81ff">43.0</span>

In [<span style="color:#ae81ff">28</span>]: df<span style="color:#f92672">.</span>loc[(df<span style="color:#f92672">.</span>CCC<span style="color:#f92672">-</span>aValue)<span style="color:#f92672">.</span>abs()<span style="color:#f92672">.</span>argsort()]
Out[<span style="color:#ae81ff">28</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Simple calculation</span>
(df<span style="color:#f92672">.</span>CCC<span style="color:#f92672">-</span>aValue)
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">57.0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">7.0</span>
<span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">73.0</span>
<span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">93.0</span>
Name: CCC, dtype: float64
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Make simple calculation result absolute value</span>
(df<span style="color:#f92672">.</span>CCC<span style="color:#f92672">-</span>aValue)<span style="color:#f92672">.</span>abs()
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">57.0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">7.0</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">73.0</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">93.0</span>
Name: CCC, dtype: float64
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#The result of simple calculation is made into an absolute value, and the index of the result of sorting the numbers is returned.</span>
(df<span style="color:#f92672">.</span>CCC<span style="color:#f92672">-</span>aValue)<span style="color:#f92672">.</span>abs()<span style="color:#f92672">.</span>argsort()
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>
Ten
twenty two
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>
Name: CCC, dtype: int64
</code></pre></div><p>Use ### binary operator to dynamically narrow the list of criteria</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
In [<span style="color:#ae81ff">29</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>],
                            <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
                            <span style="color:#e6db74">&#39;CCC&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>]})

In [<span style="color:#ae81ff">30</span>]: df
Out[<span style="color:#ae81ff">30</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>

In [<span style="color:#ae81ff">31</span>]: Crit1 <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">5.5</span>
In [<span style="color:#ae81ff">32</span>]: Crit2 <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>BBB <span style="color:#f92672">==</span> <span style="color:#ae81ff">10.0</span>
In [<span style="color:#ae81ff">33</span>]: Crit3 <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>CCC <span style="color:#f92672">&gt;-</span><span style="color:#ae81ff">40.0</span>
<span style="color:#75715e"># Join with hard coding</span>
In [<span style="color:#ae81ff">34</span>]: AllCrit <span style="color:#f92672">=</span> Crit1 <span style="color:#f92672">&amp;</span> Crit2 <span style="color:#f92672">&amp;</span> Crit3

In [<span style="color:#ae81ff">35</span>]: <span style="color:#f92672">import</span> functools
In [<span style="color:#ae81ff">36</span>]: CritList <span style="color:#f92672">=</span> [Crit1, Crit2, Crit3]
Create all conditions (integrate) <span style="color:#66d9ef">with</span> <span style="color:#75715e">#reduce function</span>
In [<span style="color:#ae81ff">37</span>]: AllCrit <span style="color:#f92672">=</span> functools<span style="color:#f92672">.</span>reduce(<span style="color:#66d9ef">lambda</span> x, y: x <span style="color:#f92672">&amp;</span> y, CritList)

In [<span style="color:#ae81ff">38</span>]: df[AllCrit]
Out[<span style="color:#ae81ff">38</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Confirm each condition as a data frame.</span>
tmp <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;CritList_0&#39;</span>:CritList[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>tolist(),
                    <span style="color:#e6db74">&#39;CritList_1&#39;</span>:CritList[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>tolist(),
                    <span style="color:#e6db74">&#39;CritList_2&#39;</span>:CritList[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>tolist(),
                    <span style="color:#e6db74">&#39;AllCrit&#39;</span>:AllCrit<span style="color:#f92672">.</span>tolist()
                   }, index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>])
</code></pre></div><ul>
<li>With <code>AllCrit</code>, which is a combination of all conditions, <code>True</code> is the row with index <code>0</code>.</li>
</ul>
<blockquote>
</blockquote>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">CritList_0</th>
<th align="right">CritList_1</th>
<th align="right">CritList_2</th>
<th align="right">AllCrit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">True</td>
<td align="right">True</td>
<td align="right">True</td>
<td align="right">True</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">True</td>
<td align="right">False</td>
<td align="right">True</td>
<td align="right">False</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">False</td>
<td align="right">False</td>
<td align="right">True</td>
<td align="right">False</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">False</td>
<td align="right">False</td>
<td align="right">False</td>
<td align="right">False</td>
</tr>
</tbody>
</table>
<hr>
<h1 id="selection">Selection</h1>
<h2 id="dataframes">Dataframes</h2>
<h3 id="use-both-row-label-and-value-condition-thumbsup">Use both row label and value condition :thumbsup:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">39</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>],
                            <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
                            <span style="color:#e6db74">&#39;CCC&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>]})

In [<span style="color:#ae81ff">40</span>]: df
Out[<span style="color:#ae81ff">40</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>

In [<span style="color:#ae81ff">41</span>]: df[(df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>isin([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>]))]]
Out[<span style="color:#ae81ff">41</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
</code></pre></div><p>Use loc for slices with ### labels and iloc for position slices
| | AAA | BBB | CCC |
|:&mdash;-|&mdash;&mdash;:|&mdash;&mdash;:|&mdash;&mdash;:|
| foo | 4 | 10 | 100 |
| bar | 5 | 20 | 50 |
| boo | 6 | 30 | -30 |
| kar | 7 | 40 | -50 |</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">43</span>]: df<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;bar&#39;</span>:<span style="color:#e6db74">&#39;kar&#39;</span>] <span style="color:#75715e"># Label</span>
Out[<span style="color:#ae81ff">43</span>]:
     AAA BBB CCC
bar <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
boo <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
kar <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>

<span style="color:#75715e"># Generic</span>
In [<span style="color:#ae81ff">44</span>]: df<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">3</span>]
Out[<span style="color:#ae81ff">44</span>]:
     AAA BBB CCC
foo <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
bar <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
boo <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
</code></pre></div><p><strong>Important points learned</strong></p>
<ul>
<li>Position-oriented (Python slicing style: excluding end)</li>
<li>Label oriented (non-Python slice style: including termination)</li>
</ul>
<h3 id="i-have-a-problem-if-the-index-consists-of-a-non-zero-start-or-an-integer-that-is-not-a-unit-increment">I have a problem if the index consists of a non-zero start or an integer that is not a unit increment</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">46</span>]: data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>],
                 <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
                 <span style="color:#e6db74">&#39;CCC&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>]}

<span style="color:#75715e">#Note: Index starts from 1</span>
In [<span style="color:#ae81ff">47</span>]: df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>data, index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>])
In [<span style="color:#ae81ff">48</span>]: df2<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>] <span style="color:#75715e"># Position-oriented</span>
Out[<span style="color:#ae81ff">48</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>

In [<span style="color:#ae81ff">49</span>]: df2<span style="color:#f92672">.</span>loc[<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>] <span style="color:#75715e"># Label oriented</span>
Out[<span style="color:#ae81ff">49</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
</code></pre></div><h3 id="use-the-comparison-operator--not-to-get-at-the-negation-of-the-condition">Use the comparison operator (~) [Not] to get at the negation of the condition</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">50</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>],
                            <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
                            <span style="color:#e6db74">&#39;CCC&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>]})

In [<span style="color:#ae81ff">51</span>]: df
Out[<span style="color:#ae81ff">51</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">100</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>

In [<span style="color:#ae81ff">52</span>]: df[<span style="color:#f92672">~</span>((df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>isin([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>])))]]
Out[<span style="color:#ae81ff">52</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">50</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">40</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">If you get it without using <span style="color:#75715e"># `~`</span>
df[((df<span style="color:#f92672">.</span>AAA <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>isin([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>])))]]
</code></pre></div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAA</th>
      <th>BBB</th>
      <th>CCC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>30</td>
      <td>-30</td>
    </tr>
  </tbody>
</table>
Since this content is negated `~`, indexes 1 and 3 are selected.
<h2 id="new-columns-create-new-columns-efficiently-and-dynamically-using-the-applymap-function-thumbsup">New columns### Create new columns efficiently and dynamically using the applymap function: thumbsup:</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">53</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>],
                            <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>],
                            <span style="color:#e6db74">&#39;CCC&#39;</span>: [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>]})


In [<span style="color:#ae81ff">54</span>]: df
Out[<span style="color:#ae81ff">54</span>]:
   AAA BBB CCC
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>

In [<span style="color:#ae81ff">55</span>]: source_cols <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>columns <span style="color:#75715e"># Get existing column names</span>

In [<span style="color:#ae81ff">56</span>]: new_cols <span style="color:#f92672">=</span> [str(x) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_cat&#34;</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> source_cols]

In [<span style="color:#ae81ff">57</span>]: categories <span style="color:#f92672">=</span> {<span style="color:#ae81ff">1</span>:<span style="color:#e6db74">&#39;Alpha&#39;</span>, <span style="color:#ae81ff">2</span>:<span style="color:#e6db74">&#39;Beta&#39;</span>, <span style="color:#ae81ff">3</span>:<span style="color:#e6db74">&#39;Charlie&#39;</span>}

In [<span style="color:#ae81ff">58</span>]: df[new_cols] <span style="color:#f92672">=</span> df[source_cols]<span style="color:#f92672">.</span>applymap(categories<span style="color:#f92672">.</span>get)

In [<span style="color:#ae81ff">59</span>]: df
Out[<span style="color:#ae81ff">59</span>]:
   AAA BBB CCC AAA_cat BBB_cat CCC_cat
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> Alpha Alpha Beta
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> Beta Alpha Alpha
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> Alpha Beta Charlie
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> Charlie Beta Alpha

</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Get existing column name</span>
source_cols <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>columns
source_cols
Index([<span style="color:#e6db74">&#39;AAA&#39;</span>,<span style="color:#e6db74">&#39;BBB&#39;</span>,<span style="color:#e6db74">&#39;CCC&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;object&#39;</span>)
<span style="color:#75715e"># Create a list with `_cat` appended to the existing column names</span>
new_cols <span style="color:#f92672">=</span> [str(x) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_cat&#34;</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> source_cols]
new_cols
[<span style="color:#e6db74">&#39;AAA_cat&#39;</span>,<span style="color:#e6db74">&#39;BBB_cat&#39;</span>,<span style="color:#e6db74">&#39;CCC_cat&#39;</span>]
</code></pre></div><h5 id="update-new-columns-aaa_catbbb_catccc_cat-with-values-from-the-categories-dictionary-for-existing-columns">Update new columns [&lsquo;AAA_cat&rsquo;,&lsquo;BBB_cat&rsquo;,&lsquo;CCC_cat&rsquo;] with values from the <code>categories</code> dictionary for existing columns</h5>
<h3 id="keep-other-columns-when-using-min-with-groupby">keep other columns when using min() with groupby</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">60</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;AAA&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>],
                            <span style="color:#e6db74">&#39;BBB&#39;</span>: [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]})

In [<span style="color:#ae81ff">61</span>]: df
Out[<span style="color:#ae81ff">61</span>]:
   AAA BBB
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>
</code></pre></div><h4 id="method-1-idxmin--to-get-the-smallest-index">Method 1: idxmin () to get the smallest index</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">62</span>]: df<span style="color:#f92672">.</span>loc[df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;AAA&#34;</span>)[<span style="color:#e6db74">&#34;BBB&#34;</span>]<span style="color:#f92672">.</span>idxmin()]
Out[<span style="color:#ae81ff">62</span>]:
   AAA BBB
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span>
</code></pre></div><h4 id="method-2-sort-and-then-get-each-first">Method 2: Sort and then get each first</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">63</span>]: df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;BBB&#34;</span>)<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;AAA&#34;</span>, as_index<span style="color:#f92672">=</span>False)<span style="color:#f92672">.</span>first()
Out[<span style="color:#ae81ff">63</span>]:
   AAA BBB
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<ul>
<li>Method 1</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Group by&#39;AAA&#39; column</span>
gb <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;AAA&#34;</span>)[<span style="color:#e6db74">&#34;BBB&#34;</span>]
<span style="color:#75715e">#If you get &#39;2&#39; in&#39;AAA&#39; column, the contents are as follows, so the minimum value of &#39;2&#39; in&#39;AAA&#39; column is &#39;1&#39;</span>
gb<span style="color:#f92672">.</span>get_group(<span style="color:#ae81ff">2</span>)
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">1</span>
Name: BBB, dtype: int64
</code></pre></div><blockquote>
<ul>
<li>Method 2</li>
</ul>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Sort by&#39;BBB&#39; column</span>
sv <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;BBB&#34;</span>)
sv
AAA BBB
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Group by&#39;AAA&#39; column</span>
gb <span style="color:#f92672">=</span> sv<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;AAA&#34;</span>, as_index<span style="color:#f92672">=</span>False)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#If you get &#39;2&#39; in&#39;AAA&#39; column, the minimum value is &#39;1&#39;</span>
gb<span style="color:#f92672">.</span>get_group(<span style="color:#ae81ff">2</span>)
AAA BBB
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Get first of group object</span>
gb<span style="color:#f92672">.</span>first()
AAA BBB
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span>
</code></pre></div><hr>
<h1 id="multi-indexing">Multi Indexing</h1>
<h3 id="create-a-multiindex-from-a-labeled-frame">Create a MultiIndex from a labeled frame</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">64</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;row&#39;</span>: [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>],
                           <span style="color:#e6db74">&#39;One_X&#39;</span>: [<span style="color:#ae81ff">1.1</span>, <span style="color:#ae81ff">1.1</span>, <span style="color:#ae81ff">1.1</span>],
                           <span style="color:#e6db74">&#39;One_Y&#39;</span>: [<span style="color:#ae81ff">1.2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#ae81ff">1.2</span>],
                           <span style="color:#e6db74">&#39;Two_X&#39;</span>: [<span style="color:#ae81ff">1.11</span>, <span style="color:#ae81ff">1.11</span>, <span style="color:#ae81ff">1.11</span>],
                           <span style="color:#e6db74">&#39;Two_Y&#39;</span>: [<span style="color:#ae81ff">1.22</span>, <span style="color:#ae81ff">1.22</span>, <span style="color:#ae81ff">1.22</span>]})

In [<span style="color:#ae81ff">65</span>]: df
Out[<span style="color:#ae81ff">65</span>]:
   row One_X One_Y Two_X Two_Y
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>

<span style="color:#75715e"># Labeled index</span>
In [<span style="color:#ae81ff">66</span>]: df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;row&#39;</span>)

In [<span style="color:#ae81ff">67</span>]: df
Out[<span style="color:#ae81ff">67</span>]:
     One_X One_Y Two_X Two_Y
row
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>

<span style="color:#75715e"># Divide existing column name by&#39;_&#39; and change to tuple format hierarchical index.</span>
In [<span style="color:#ae81ff">68</span>]: df<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples([tuple(c<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;_&#39;</span>)) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns])

In [<span style="color:#ae81ff">69</span>]: df
Out[<span style="color:#ae81ff">69</span>]:
     One Two
       X Y X Y
row
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1.2</span> <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>

<span style="color:#75715e"># Make hierarchical index column data and reset index</span>
In [<span style="color:#ae81ff">70</span>]: df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>stack(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>reset_index(<span style="color:#ae81ff">1</span>)

In [<span style="color:#ae81ff">71</span>]: df
Out[<span style="color:#ae81ff">71</span>]:
    level_1 X Y
row
<span style="color:#ae81ff">0</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
<span style="color:#ae81ff">0</span> Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">1</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
<span style="color:#ae81ff">1</span> Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">2</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
<span style="color:#ae81ff">2</span> Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>

Modify the <span style="color:#75715e"># label (note that the label &#34;level_1&#34; was added automatically)</span>
In [<span style="color:#ae81ff">72</span>]: df<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Sample&#39;</span>,<span style="color:#e6db74">&#39;All_X&#39;</span>,<span style="color:#e6db74">&#39;All_Y&#39;</span>]

In [<span style="color:#ae81ff">73</span>]: df
Out[<span style="color:#ae81ff">73</span>]:
    Sample All_X All_Y
row
<span style="color:#ae81ff">0</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
<span style="color:#ae81ff">0</span> Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">1</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
<span style="color:#ae81ff">1</span> Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">2</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
<span style="color:#ae81ff">2</span> Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Split existing column <span style="color:#66d9ef">with</span><span style="color:#e6db74">&#39;_&#39;</span> <span style="color:#f92672">in</span> <span style="color:#75715e"># comprehension</span>
[tuple(c<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;_&#39;</span>)) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns]
[(<span style="color:#e6db74">&#39;One&#39;</span>,<span style="color:#e6db74">&#39;X&#39;</span>), (<span style="color:#e6db74">&#39;One&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>), (<span style="color:#e6db74">&#39;Two&#39;</span>,<span style="color:#e6db74">&#39;X&#39;</span>), (<span style="color:#e6db74">&#39;Two&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>)]
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Hierarchical index is expressed in tuple format</span>
df<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples([tuple(c<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;_&#39;</span>)) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns])
df<span style="color:#f92672">.</span>columns
MultiIndex([(<span style="color:#e6db74">&#39;One&#39;</span>,<span style="color:#e6db74">&#39;X&#39;</span>),
            (<span style="color:#e6db74">&#39;One&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>),
            (<span style="color:#e6db74">&#39;Two&#39;</span>,<span style="color:#e6db74">&#39;X&#39;</span>),
            (<span style="color:#e6db74">&#39;Two&#39;</span>,<span style="color:#e6db74">&#39;Y&#39;</span>)],
           )
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Pivot from column to row</span>
df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>stack(<span style="color:#ae81ff">0</span>)
X Y
row
<span style="color:#ae81ff">0</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">1</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
<span style="color:#ae81ff">2</span> One <span style="color:#ae81ff">1.10</span> <span style="color:#ae81ff">1.20</span>
Two <span style="color:#ae81ff">1.11</span> <span style="color:#ae81ff">1.22</span>
</code></pre></div><blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"></code></pre></div></blockquote>
<p>Reset Level=1(&lsquo;One,Two&rsquo;) of #index
df.reset_index(1)
level_1 X Y
row
0 One 1.10 1.20
0 Two 1.11 1.22
1 One 1.10 1.20
1 Two 1.11 1.22
2 One 1.10 1.20
2 Two 1.11 1.22</p>
<pre><code>
## Arithmetic
* The following code is partially changed from the official website.

```python
In [74]: cols = pd.MultiIndex.from_tuples([(x, y) for x in ['A','B','C'] for y in ['O','I']])In [75]: df = pd.DataFrame(np.arange(12).reshape((2,6)), index=['n', 'm'], columns=cols)

In [76]: df
Out[76]: 
 A  B  C
 O I O I O I
n 0 1 2 3 4 5
m 6 7 8 9 10 11

In [77]: df = df.div(df['C'], level=1)

In [78]: df
Out[78]: 

 A    B    C
 O I   O I   O I
n 0.0 0.200000 0.5 0.600000 1.0 1.0
m 0.6 0.636364 0.8 0.818182 1.0 1.0
</code></pre><blockquote>
<p><font color="crimson">**[コード リーディング]**</font></p>
</blockquote>
<p>$ n行をB列に説明すると $
$ [B][O](2 \div 4 = 0.5) $
$ [B][I](3 \div 5 = 0.600000) $</p>
<blockquote>
</blockquote>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">A</th>
      <th colspan="2" halign="left">B</th>
      <th colspan="2" halign="left">C</th>
    </tr>
    <tr>
      <th></th>
      <th>O</th>
      <th>I</th>
      <th>O</th>
      <th>I</th>
      <th>O</th>
      <th>I</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>n</th>
      <td>0.0</td>
      <td>0.200000</td>
      <td>0.5</td>
      <td>0.600000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>m</th>
      <td>0.6</td>
      <td>0.636364</td>
      <td>0.8</td>
      <td>0.818182</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<h2 id="sliceスライス">Slice(スライス)</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">coords <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;AA&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>), (<span style="color:#e6db74">&#39;AA&#39;</span>, <span style="color:#e6db74">&#39;six&#39;</span>), (<span style="color:#e6db74">&#39;BB&#39;</span>, <span style="color:#e6db74">&#39;one&#39;</span>), (<span style="color:#e6db74">&#39;BB&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>), (<span style="color:#e6db74">&#39;BB&#39;</span>, <span style="color:#e6db74">&#39;six&#39;</span>)]
index <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples(coords)
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">55</span>], index, [<span style="color:#e6db74">&#39;MyData&#39;</span>])
</code></pre></div><table>
<thead>
<tr>
<th align="center"></th>
<th align="center"></th>
<th align="right">MyData</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">AA</td>
<td align="center">one</td>
<td align="right">11</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">six</td>
<td align="right">22</td>
</tr>
<tr>
<td align="center">BB</td>
<td align="center">one</td>
<td align="right">33</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">two</td>
<td align="right">44</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">six</td>
<td align="right">55</td>
</tr>
</tbody>
</table>
<h3 id="1番目のレベルと一番目の軸から選択するには">1番目のレベルと一番目の軸から選択するには</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 一番目の軸</span>
df<span style="color:#f92672">.</span>xs(<span style="color:#e6db74">&#39;BB&#39;</span>, level<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</code></pre></div><table>
<thead>
<tr>
<th align="left"></th>
<th align="right">MyData</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">one</td>
<td align="right">33</td>
</tr>
<tr>
<td align="left">two</td>
<td align="right">44</td>
</tr>
<tr>
<td align="left">six</td>
<td align="right">55</td>
</tr>
</tbody>
</table>
<h3 id="sixのレベルと一番目の軸から選択するには">&lsquo;six&rsquo;のレベルと一番目の軸から選択するには</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 2番目の軸</span>
df<span style="color:#f92672">.</span>xs(<span style="color:#e6db74">&#39;six&#39;</span>, level<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</code></pre></div><table>
<thead>
<tr>
<th align="left"></th>
<th align="right">MyData</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">AA</td>
<td align="right">22</td>
</tr>
<tr>
<td align="left">BB</td>
<td align="right">55</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">85</span>]: <span style="color:#f92672">import</span> itertools
In [<span style="color:#ae81ff">86</span>]: index <span style="color:#f92672">=</span> list(itertools<span style="color:#f92672">.</span>product([<span style="color:#e6db74">&#39;Ada&#39;</span>, <span style="color:#e6db74">&#39;Quinn&#39;</span>, <span style="color:#e6db74">&#39;Violet&#39;</span>],
                                        [<span style="color:#e6db74">&#39;Comp&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span>, <span style="color:#e6db74">&#39;Sci&#39;</span>]))
In [<span style="color:#ae81ff">87</span>]: headr <span style="color:#f92672">=</span> list(itertools<span style="color:#f92672">.</span>product([<span style="color:#e6db74">&#39;Exams&#39;</span>, <span style="color:#e6db74">&#39;Labs&#39;</span>], [<span style="color:#e6db74">&#39;I&#39;</span>, <span style="color:#e6db74">&#39;II&#39;</span>]))
In [<span style="color:#ae81ff">88</span>]: indx <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples(index, names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Student&#39;</span>, <span style="color:#e6db74">&#39;Course&#39;</span>])
In [<span style="color:#ae81ff">89</span>]: cols <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples(headr)   <span style="color:#75715e"># Notice these are un-named</span>
In [<span style="color:#ae81ff">90</span>]: data <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">70</span> <span style="color:#f92672">+</span> x <span style="color:#f92672">+</span> y <span style="color:#f92672">+</span> (x <span style="color:#f92672">*</span> y) <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)] <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">9</span>)]
In [<span style="color:#ae81ff">91</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data, indx, cols)

In [<span style="color:#ae81ff">92</span>]: df
Out[<span style="color:#ae81ff">92</span>]: 
               Exams     Labs    
                   I  II    I  II
Student Course                   
Ada     Comp      <span style="color:#ae81ff">70</span>  <span style="color:#ae81ff">71</span>   <span style="color:#ae81ff">72</span>  <span style="color:#ae81ff">73</span>
        Math      <span style="color:#ae81ff">71</span>  <span style="color:#ae81ff">73</span>   <span style="color:#ae81ff">75</span>  <span style="color:#ae81ff">74</span>
        Sci       <span style="color:#ae81ff">72</span>  <span style="color:#ae81ff">75</span>   <span style="color:#ae81ff">75</span>  <span style="color:#ae81ff">75</span>
Quinn   Comp      <span style="color:#ae81ff">73</span>  <span style="color:#ae81ff">74</span>   <span style="color:#ae81ff">75</span>  <span style="color:#ae81ff">76</span>
        Math      <span style="color:#ae81ff">74</span>  <span style="color:#ae81ff">76</span>   <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">77</span>
        Sci       <span style="color:#ae81ff">75</span>  <span style="color:#ae81ff">78</span>   <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">78</span>
Violet  Comp      <span style="color:#ae81ff">76</span>  <span style="color:#ae81ff">77</span>   <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">79</span>
        Math      <span style="color:#ae81ff">77</span>  <span style="color:#ae81ff">79</span>   <span style="color:#ae81ff">81</span>  <span style="color:#ae81ff">80</span>
        Sci       <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">81</span>   <span style="color:#ae81ff">81</span>  <span style="color:#ae81ff">81</span>

In [<span style="color:#ae81ff">93</span>]: All <span style="color:#f92672">=</span> slice(None)

In [<span style="color:#ae81ff">94</span>]: df<span style="color:#f92672">.</span>loc[<span style="color:#e6db74">&#39;Violet&#39;</span>]
Out[<span style="color:#ae81ff">94</span>]: 
       Exams     Labs    
           I  II    I  II
Course                   
Comp      <span style="color:#ae81ff">76</span>  <span style="color:#ae81ff">77</span>   <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">79</span>
Math      <span style="color:#ae81ff">77</span>  <span style="color:#ae81ff">79</span>   <span style="color:#ae81ff">81</span>  <span style="color:#ae81ff">80</span>
Sci       <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">81</span>   <span style="color:#ae81ff">81</span>  <span style="color:#ae81ff">81</span>

In [<span style="color:#ae81ff">95</span>]: df<span style="color:#f92672">.</span>loc[(All, <span style="color:#e6db74">&#39;Math&#39;</span>), All]
Out[<span style="color:#ae81ff">95</span>]: 
               Exams     Labs    
                   I  II    I  II
Student Course                   
Ada     Math      <span style="color:#ae81ff">71</span>  <span style="color:#ae81ff">73</span>   <span style="color:#ae81ff">75</span>  <span style="color:#ae81ff">74</span>
Quinn   Math      <span style="color:#ae81ff">74</span>  <span style="color:#ae81ff">76</span>   <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">77</span>
Violet  Math      <span style="color:#ae81ff">77</span>  <span style="color:#ae81ff">79</span>   <span style="color:#ae81ff">81</span>  <span style="color:#ae81ff">80</span>

In [<span style="color:#ae81ff">96</span>]: df<span style="color:#f92672">.</span>loc[(slice(<span style="color:#e6db74">&#39;Ada&#39;</span>, <span style="color:#e6db74">&#39;Quinn&#39;</span>), <span style="color:#e6db74">&#39;Math&#39;</span>), All]
Out[<span style="color:#ae81ff">96</span>]: 
               Exams     Labs    
                   I  II    I  II
Student Course                   
Ada     Math      <span style="color:#ae81ff">71</span>  <span style="color:#ae81ff">73</span>   <span style="color:#ae81ff">75</span>  <span style="color:#ae81ff">74</span>
Quinn   Math      <span style="color:#ae81ff">74</span>  <span style="color:#ae81ff">76</span>   <span style="color:#ae81ff">78</span>  <span style="color:#ae81ff">77</span>

In [<span style="color:#ae81ff">97</span>]: df<span style="color:#f92672">.</span>loc[(All, <span style="color:#e6db74">&#39;Math&#39;</span>), (<span style="color:#e6db74">&#39;Exams&#39;</span>)]
Out[<span style="color:#ae81ff">97</span>]: 
                 I  II
Student Course        
Ada     Math    <span style="color:#ae81ff">71</span>  <span style="color:#ae81ff">73</span>
Quinn   Math    <span style="color:#ae81ff">74</span>  <span style="color:#ae81ff">76</span>
Violet  Math    <span style="color:#ae81ff">77</span>  <span style="color:#ae81ff">79</span>

In [<span style="color:#ae81ff">98</span>]: df<span style="color:#f92672">.</span>loc[(All, <span style="color:#e6db74">&#39;Math&#39;</span>), (All, <span style="color:#e6db74">&#39;II&#39;</span>)]
Out[<span style="color:#ae81ff">98</span>]: 
               Exams Labs
                  II   II
Student Course           
Ada     Math      <span style="color:#ae81ff">73</span>   <span style="color:#ae81ff">74</span>
Quinn   Math      <span style="color:#ae81ff">76</span>   <span style="color:#ae81ff">77</span>
Violet  Math      <span style="color:#ae81ff">79</span>   <span style="color:#ae81ff">80</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[コード リーディング]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">All <span style="color:#f92672">=</span> slice(None) <span style="color:#75715e">#これはどういう事？</span>
<span style="color:#75715e"># silice(start, stop, step)だから、Noneが３つあるのか。</span>
All
slice(None, None, None)
<span style="color:#66d9ef">print</span>(type(All))
<span style="color:#75715e"># &lt;class &#39;slice&#39;&gt; # スライスオブジェクト</span>
</code></pre></div><ul>
<li><code>ALL = None</code>で試してみたがエラーになるので、抽出条件となるのはスライスオブジェクトでなければならないという事？</li>
<li>ここでは、<code>ALL</code>は条件指定なしという意味</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indx
MultiIndex([(   <span style="color:#e6db74">&#39;Ada&#39;</span>, <span style="color:#e6db74">&#39;Comp&#39;</span>),
            (   <span style="color:#e6db74">&#39;Ada&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span>),
            (   <span style="color:#e6db74">&#39;Ada&#39;</span>,  <span style="color:#e6db74">&#39;Sci&#39;</span>),
            ( <span style="color:#e6db74">&#39;Quinn&#39;</span>, <span style="color:#e6db74">&#39;Comp&#39;</span>),
            ( <span style="color:#e6db74">&#39;Quinn&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span>),
            ( <span style="color:#e6db74">&#39;Quinn&#39;</span>,  <span style="color:#e6db74">&#39;Sci&#39;</span>),
            (<span style="color:#e6db74">&#39;Violet&#39;</span>, <span style="color:#e6db74">&#39;Comp&#39;</span>),
            (<span style="color:#e6db74">&#39;Violet&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span>),
            (<span style="color:#e6db74">&#39;Violet&#39;</span>,  <span style="color:#e6db74">&#39;Sci&#39;</span>)],
           names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Student&#39;</span>, <span style="color:#e6db74">&#39;Course&#39;</span>])
cols
MultiIndex([(<span style="color:#e6db74">&#39;Exams&#39;</span>,  <span style="color:#e6db74">&#39;I&#39;</span>),
            (<span style="color:#e6db74">&#39;Exams&#39;</span>, <span style="color:#e6db74">&#39;II&#39;</span>),
            ( <span style="color:#e6db74">&#39;Labs&#39;</span>,  <span style="color:#e6db74">&#39;I&#39;</span>),
            ( <span style="color:#e6db74">&#39;Labs&#39;</span>, <span style="color:#e6db74">&#39;II&#39;</span>)],
           )
</code></pre></div><h2 id="sorting並び替え">Sorting(並び替え)</h2>
<h3 id="multiindexを使用して特定の列または列の順序付きリストで並べ替える">MultiIndexを使用して、特定の列または列の順序付きリストで並べ替える</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;Labs&#39;</span>, <span style="color:#e6db74">&#39;II&#39;</span>), ascending<span style="color:#f92672">=</span>False)
</code></pre></div><table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Exams</th><th colspan = "2" halign = "left"> Labs </th>
    </tr>
    <tr>
      <th> </th>
      <th> </th>
      <th> I </th>
      <th> II </th>
      <th> I </th>
      <th> II </th>
    </tr>
    <tr>
      <th> Student </th>
      <th> Course </th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan = "3" valign = "top"> Violet </th>
      <th> Sci </th>
      <td> 78 </td>
      <td> 81 </td>
      <td> 81 </td>
      <td> 81 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 77 </td>
      <td> 79 </td>
      <td> 81 </td>
      <td> 80 </td>
    </tr>
    <tr>
      <th> Comp </th>
      <td> 76 </td>
      <td> 77 </td>
      <td> 78 </td>
      <td> 79 </td>
    </tr>
    <tr>
      <th rowspan = "3" valign = "top"> Quinn </th>
      <th> Sci </th>
      <td> 75 </td>
      <td> 78 </td>
      <td> 78 </td>
      <td> 78 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 74 </td>
      <td> 76 </td>
      <td> 78 </td>
      <td> 77 </td>
    </tr>
    <tr>
      <th> Comp </th>
      <td> 73 </td>
      <td> 74 </td>
      <td> 75 </td>
      <td> 76 </td>
    </tr>
    <tr>
      <th rowspan = "3" valign = "top"> Ada </th>
      <th> Sci </th>
      <td> 72 </td>
      <td> 75 </td>
      <td> 75 </td>
      <td> 75 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 71 </td>
      <td> 73 </td>
      <td> 75 </td>
      <td> 74 </td>
    </tr>
    <tr>
      <th> Comp </th>
      <td> 70 </td>
      <td> 71 </td>
      <td> 72 </td>
      <td> 73 </td>
    </tr>
  </tbody>
</table>
<h2 id="levels-レ-ベ-ル">Levels (レ ベ ル）</h2>
<h3 id="マ-ル-チ-イ-ン-デ-ッ-ク-ス-の-前-に-レ-ベ-ル-を-追加-す-る-clipboard--thumbsup">マ ル チ イ ン デ ッ ク ス の 前 に レ ベ ル を 追加 す る: clipboard :: thumbsup:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># こ の DF に &#39;Firstlevel: Foo&#39; を 追加 す る に は？</span>
pd<span style="color:#f92672">.</span>concat ([df], keys <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Foo&#39;</span>], names <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Firstlevel&#39;</span>])
</code></pre></div><table border = "1" class = "dataframe">
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th colspan = "2" halign = "left"> Exams </th>
      <th colspan = "2" halign = "left"> Labs </th>
    </tr>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> I </th>
      <th> II </th>
      <th> I </th>
      <th> II </th>
    </tr>
    <tr>
      <th> Firstlevel </th>
      <th> Student </th>
      <th> Course </th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan = "9" valign = "top"> Foo </th>
      <th rowspan = "3" valign = "top"> Ada </th>
      <th> Comp </th>
      <td> 70 </td>
      <td> 71 </td>
      <td> 72 </td>
      <td> 73 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 71 </td>
      <td> 73 </td>
      <td> 75 </td>
      <td> 74 </td>
    </tr>
    <tr>
      <th> Sci </th>
      <td> 72 </td>
      <td> 75 </td>
      <td> 75 </td>
      <td> 75 </td>
    </tr>
    <tr>
      <th rowspan = "3" valign = "top"> Quinn </th>
      <th> Comp </th>
      <td> 73 </td>
      <td> 74 </td>
      <td> 75 </td>
      <td> 76 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 74 </td>
      <td> 76 </td>
      <td> 78 </td>
      <td> 77 </td>
    </tr>
    <tr>
      <th> Sci </th>
      <td> 75 </td>
      <td> 78 </td>
      <td> 78 </td>
      <td> 78 </td>
    </tr>
    <tr>
      <th rowspan = "3" valign = "top"> Violet </th>
      <th> Comp </th>
      <td> 76 </td>
      <td> 77 </td>
      <td> 78 </td>
      <td> 79 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 77 </td>
      <td> 79 </td>
      <td> 81 </td>
      <td> 80 </td>
    </tr>
    <tr>
      <th> Sci </th>
      <td> 78 </td>
      <td> 81 </td>
      <td> 81 </td>
      <td> 81 </td>
    </tr>
  </tbody>
</table>
<h3 id="階層-イ-ン-デ-ッ-ク-を-フ-ラ-ッ-ト-に-す-る-に-は-clipboard">階層 イ ン デ ッ ク を フ ラ ッ ト に す る に は: clipboard:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>get_level_values (<span style="color:#ae81ff">0</span>)
</code></pre></div><table border = "1" class = "dataframe">
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th colspan = "2" halign = "left"> Exams </th>
      <th colspan = "2" halign = "left"> Labs </th>
    </tr>
    <tr>
      <th> </th>
      <th> </th>
      <th> I </th>
      <th> II </th>
      <th> I </th>
      <th> II </th>
    </tr>
    <tr>
      <th> Student </th>
      <th> Course </th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan = "3" valign = "top"> Ada </th>
      <th> Comp </th>
      <td> 70 </td>
      <td> 71 </td>
      <td> 72 </td>
      <td> 73 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 71 </td>
      <td> 73 </td>
      <td> 75 </td>
      <td> 74 </td>
    </tr>
    <tr>
      <th> Sci </th>
      <td> 72 </td>
      <td> 75 </td>
      <td> 75 </td>
      <td> 75 </td>
    </tr>
    <tr>
      <th rowspan = "3" valign = "top"> Quinn </th>
      <th> Comp </th>
      <td> 73 </td>
      <td> 74 </td>
      <td> 75 </td>
      <td> 76 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 74 </td>
      <td> 76 </td>
      <td> 78 </td>
      <td> 77 </td>
    </tr>
    <tr>
      <th> Sci </th>
      <td> 75 </td>
      <td> 78 </td>
      <td> 78 </td>
      <td> 78 </td>
    </tr>
    <tr>
      <th rowspan = "3" valign = "top"> Violet </th>
      <th> Comp </th>
      <td> 76 </td>
      <td> 77 </td>
      <td> 78 </td>
      <td> 79 </td>
    </tr>
    <tr>
      <th> Type </th>
      <td> 77 </td>
      <td> 79 </td>
      <td> 81 </td>
      <td> 80 </td>
    </tr>
    <tr>
      <th> Sci </th>
      <td> 78 </td>
      <td> 81 </td><td>81</td>
      <td>81</td>
    </tr>
  </tbody>
</table>
<hr>
<h1 id="missing-data">Missing data</h1>
<h3 id="fill-reverse-order-of-time-series-with-forward-data">Fill reverse order of time series with forward data</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">100</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>),
                            index<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2013-08-01&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;B&#39;</span>),
                            columns<span style="color:#f92672">=</span>list(<span style="color:#e6db74">&#39;A&#39;</span>))

In [<span style="color:#ae81ff">101</span>]: df<span style="color:#f92672">.</span>loc[df<span style="color:#f92672">.</span>index[<span style="color:#ae81ff">3</span>],<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan

In [<span style="color:#ae81ff">102</span>]: df
Out[<span style="color:#ae81ff">102</span>]:
                   A
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0.721555</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.706771</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.039575</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span> NaN
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.424972</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">0.567020</span>

In [<span style="color:#ae81ff">103</span>]: df<span style="color:#f92672">.</span>reindex(df<span style="color:#f92672">.</span>index[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>ffill()
Out[<span style="color:#ae81ff">103</span>]:
                   A
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">0.567020</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.424972</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.424972</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.039575</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.706771</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0.721555</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>reindex(df<span style="color:#f92672">.</span>index[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>ffill()
df<span style="color:#f92672">.</span>reindex(df<span style="color:#f92672">.</span>index[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>fillna(method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ffill&#39;</span>) <span style="color:#75715e"># synonymous with above</span>
</code></pre></div><p>The above is an example of resetting the index in the reverse order of index and filling with <code>fiillna(method='ffill')</code>. The <code>fillna</code> function is more general than <code>ffill()</code> because it can be filled using <code>mode='ffill' (forward) and'bfill (backward)'</code>.</p>
<h3 id="reset-accumulation-with-nan-clipboardthumbsup">Reset accumulation with NaN: clipboard::thumbsup:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">v <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, np<span style="color:#f92672">.</span>nan, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, np<span style="color:#f92672">.</span>nan, <span style="color:#ae81ff">1</span>], dtype<span style="color:#f92672">=</span>float)
n <span style="color:#f92672">=</span> v<span style="color:#f92672">.</span>isnull()
a <span style="color:#f92672">=</span> <span style="color:#f92672">~</span>n
c <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>astype(float)<span style="color:#f92672">.</span>cumsum()
d <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(np<span style="color:#f92672">.</span>diff(np<span style="color:#f92672">.</span>hstack(([<span style="color:#ae81ff">0.</span>], c[n]))), index<span style="color:#f92672">=</span>index)
v[n] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>d
result <span style="color:#f92672">=</span> v<span style="color:#f92672">.</span>cumsum()
result
    <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1.0</span>
    <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2.0</span>
    <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3.0</span>
    <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0.0</span>
    <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1.0</span>
    <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2.0</span>
    <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">3.0</span>
    <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">4.0</span>
    <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">0.0</span>
    <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">1.0</span>
    dtype: float64
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font>
$(1) Create data with Nan value $
$ v = pd.Series([1, 1, 1, np.nan, 1, 1, 1, 1, np.nan, 1], dtype=float) \tag{1} $
$(2)n gets the NaN value as a boolean $
$ n = v.isnull() \tag{2} $
$(3)a inverts the boolean value of n$
$ a = \tilde~n \tag{3} $
$(4)a Boolean based $
$ c = a.astype(float).cumsum() \tag{4} $
$(5) Get the False index of n from the accumulated data $
$ index = c[n].index \tag{5} $
$(6) Get the difference of c[n] from 0 $
$ d = pd.Series(np.diff(np.hstack(([0.], c[n]))), index=index) \tag{6} $
Substitute the value obtained in $(7)(6) for False of v with a negative value $
$ v[n] = -d \tag{7} $
When the data of $(8)(7) is added up, it becomes 0 as a negative value $
$ result = v.cumsum() \tag{8} $</p>
</blockquote>
<pre><code class="language-math" data-lang="math">\begin
{array}{|c|c|c|c|c|c|c|r|c|} \hline
  &amp; (1) &amp; (2) &amp; (3) &amp; (4) &amp;(5)&amp;(6)&amp; (7) &amp; (8) \\ \hline
0 &amp; 1.0 &amp; False &amp; True &amp; 1.0 &amp; &amp; &amp; 1.0 &amp; 1.0 \\ \hline
1 &amp; 1.0 &amp; False &amp; True &amp; 2.0 &amp; &amp; &amp; 1.0 &amp; 2.0 \\ \hline
2 &amp; 1.0 &amp; False &amp; True &amp; 3.0 &amp; &amp; &amp; 1.0 &amp; 3.0 \\ \hline
3 &amp; NaN &amp; True &amp; False &amp; 3.0 &amp; 3 &amp; 3 &amp; -3.0 &amp; 0.0 \\ \hline
4 &amp; 1.0 &amp; False &amp; True &amp; 4.0 &amp; &amp; &amp; 1.0 &amp; 1.0 \\ \hline
5 &amp; 1.0 &amp; False &amp; True &amp; 5.0 &amp; &amp; &amp; 1.0 &amp; 2.0 \\ \hline
6 &amp; 1.0 &amp; False &amp; True &amp; 6.0 &amp; &amp; &amp; 1.0 &amp; 3.0 \\ \hline
7 &amp; 1.0 &amp; False &amp; True &amp; 7.0 &amp; &amp; &amp; 1.0 &amp; 4.0 \\ \hline
8 &amp; NaN &amp; True &amp; False &amp; 7.0 &amp; 8 &amp; 4 &amp; -4.0 &amp; 0.0 \\ \hline
9 &amp; 1.0 &amp; False &amp; True &amp; 8.0 &amp; &amp; &amp; 1.0 &amp; 1.0 \\ \hline
\end{array}
</code></pre><hr>
<h1 id="grouping">Grouping</h1>
<p>Unlike the ### agg function, the apply function returns a dataframe with access to all columns</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;animal&#39;</span>:<span style="color:#e6db74">&#39;cat dog cat fish dog cat cat&#39;</span><span style="color:#f92672">.</span>split(),
                    <span style="color:#e6db74">&#39;size&#39;</span>: list(<span style="color:#e6db74">&#39;SSMMMLL&#39;</span>),
                    <span style="color:#e6db74">&#39;weight&#39;</span>: [<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>],
                    <span style="color:#e6db74">&#39;adult&#39;</span>: [False] <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">+</span> [True] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>})
In [<span style="color:#ae81ff">105</span>]: df
Out[<span style="color:#ae81ff">105</span>]:
  animal size weight adult
<span style="color:#ae81ff">0</span> cat S <span style="color:#ae81ff">8</span> False
<span style="color:#ae81ff">1</span> dog S <span style="color:#ae81ff">10</span> False
<span style="color:#ae81ff">2</span> cat M <span style="color:#ae81ff">11</span> False
<span style="color:#ae81ff">3</span> fish M <span style="color:#ae81ff">1</span> False
<span style="color:#ae81ff">4</span> dog M <span style="color:#ae81ff">20</span> False
<span style="color:#ae81ff">5</span> cat L <span style="color:#ae81ff">12</span> True
<span style="color:#ae81ff">6</span> cat L <span style="color:#ae81ff">12</span> True

<span style="color:#75715e"># List the size of the heaviest animals.</span>
In [<span style="color:#ae81ff">106</span>]: df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;animal&#39;</span>)<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> subf: subf[<span style="color:#e6db74">&#39;size&#39;</span>][subf[<span style="color:#e6db74">&#39;weight&#39;</span>]<span style="color:#f92672">.</span>idxmax()])
Out[<span style="color:#ae81ff">106</span>]:
animal
cat L
dog M
fish M
dtype: object
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># When I decompose this</span>
df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;animal&#39;</span>)<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> subf: subf[<span style="color:#e6db74">&#39;size&#39;</span>][subf[<span style="color:#e6db74">&#39;weight&#39;</span>]<span style="color:#f92672">.</span>idxmax()])
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Get the element of&#39;size&#39; from the index of the element with the maximum value of&#39;weight&#39;</span>
df[<span style="color:#e6db74">&#39;size&#39;</span>][df[<span style="color:#e6db74">&#39;weight&#39;</span>]<span style="color:#f92672">.</span>idxmax()]
   <span style="color:#e6db74">&#39;M&#39;</span>
Because it <span style="color:#f92672">is</span> <span style="color:#75715e">#, you can get the maximum value of the grouped contents</span>
</code></pre></div><h3 id="use-get_group-function">use get_group function</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">107</span>]: gb <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;animal&#39;</span>])
<span style="color:#75715e"># Check the contents of the GroupBy object using&#39;get_group&#39;</span>
In [<span style="color:#ae81ff">108</span>]: gb<span style="color:#f92672">.</span>get_group(<span style="color:#e6db74">&#39;cat&#39;</span>)
Out[<span style="color:#ae81ff">108</span>]:
  animal size weight adult
<span style="color:#ae81ff">0</span> cat S <span style="color:#ae81ff">8</span> False
<span style="color:#ae81ff">2</span> cat M <span style="color:#ae81ff">11</span> False
<span style="color:#ae81ff">5</span> cat L <span style="color:#ae81ff">12</span> True
<span style="color:#ae81ff">6</span> cat L <span style="color:#ae81ff">12</span> True
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Access to the object acquired by <span style="color:#75715e"># group by</span>
gb[[<span style="color:#e6db74">&#39;animal&#39;</span>,<span style="color:#e6db74">&#39;size&#39;</span>,<span style="color:#e6db74">&#39;weight&#39;</span>]]<span style="color:#f92672">.</span>get_group(<span style="color:#e6db74">&#39;cat&#39;</span>)
</code></pre></div><table class="dataframe" style="border:1px solid #000">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>animal</th>
      <th>size</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cat</td>
      <td style="text-align:center">S</td>
      <td style="text-align:right">8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>cat</td>
      <td style="text-align:center">M</td>
      <td style="text-align:right">11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>cat</td>
      <td style="text-align:center">L</td>
      <td style="text-align:right">12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>cat</td><td style="text-align:center">L</td>
      <td style="text-align:right">12</td>
    </tr>
  </tbody>
</table>
<h3 id="グループ内の異なるアイテムに適用する">グループ内の異なるアイテムに適用する</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">109</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GrowUp</span>(x):
              avg_weight <span style="color:#f92672">=</span> sum(x[x[<span style="color:#e6db74">&#39;size&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;S&#39;</span>]<span style="color:#f92672">.</span>weight <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.5</span>)
              avg_weight <span style="color:#f92672">+=</span> sum(x[x[<span style="color:#e6db74">&#39;size&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;M&#39;</span>]<span style="color:#f92672">.</span>weight <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.25</span>)
              avg_weight <span style="color:#f92672">+=</span> sum(x[x[<span style="color:#e6db74">&#39;size&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;L&#39;</span>]<span style="color:#f92672">.</span>weight)
              avg_weight <span style="color:#f92672">/=</span> len(x)
              <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#e6db74">&#39;L&#39;</span>, avg_weight, True], index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;size&#39;</span>, <span style="color:#e6db74">&#39;weight&#39;</span>, <span style="color:#e6db74">&#39;adult&#39;</span>])

In [<span style="color:#ae81ff">110</span>]: expected_df <span style="color:#f92672">=</span> gb<span style="color:#f92672">.</span>apply(GrowUp)

In [<span style="color:#ae81ff">111</span>]: expected_df
Out[<span style="color:#ae81ff">111</span>]: 
       size   weight  adult
animal                     
cat       L  <span style="color:#ae81ff">12.4375</span>   True
dog       L  <span style="color:#ae81ff">20.0000</span>   True
fish      L   <span style="color:#ae81ff">1.2500</span>   True
</code></pre></div><blockquote>
<p><font color="crimson">**[コード リーディング]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># S sizeの計算</span>
cat_s <span style="color:#f92672">=</span> sum(df[(df[<span style="color:#e6db74">&#39;animal&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;cat&#39;</span>) <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#39;size&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;S&#39;</span>)]<span style="color:#f92672">.</span>weight <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.5</span>)
cat_s
<span style="color:#ae81ff">12.0</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># M sizeの計算</span>
cat_m <span style="color:#f92672">=</span> sum(df[(df[<span style="color:#e6db74">&#39;animal&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;cat&#39;</span>) <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#39;size&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;M&#39;</span>)]<span style="color:#f92672">.</span>weight <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.25</span>)
cat_m
<span style="color:#ae81ff">13.75</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># L sizeの計算</span>
cat_l <span style="color:#f92672">=</span> sum(df[(df[<span style="color:#e6db74">&#39;animal&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;cat&#39;</span>) <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#39;size&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;L&#39;</span>)]<span style="color:#f92672">.</span>weight)
cat_l
<span style="color:#ae81ff">24</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># &#39;SMLの平均</span>
cat_avg <span style="color:#f92672">=</span> (cat_s <span style="color:#f92672">+</span> cat_m <span style="color:#f92672">+</span> cat_l) <span style="color:#f92672">/</span> len(df[df[<span style="color:#e6db74">&#39;animal&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;cat&#39;</span>])
cat_avg
<span style="color:#ae81ff">12.4375</span>
<span style="color:#75715e"># 得られた結果をpd.Sriesの形式で返す</span>
</code></pre></div><h3 id="全件に関数を適用する">全件に関数を適用する</h3>
<p>以下のコードは、公式サイトから一部数値を変更しています。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># S = pd.Series([i / 100.0 for i in range(1, 11)])</span>
S <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>)])

S
    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">1</span>
    <span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">2</span>
    <span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">3</span>
    <span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">4</span>
    <span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">5</span>
    <span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">6</span>
    <span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">7</span>
    <span style="color:#ae81ff">7</span>     <span style="color:#ae81ff">8</span>
    <span style="color:#ae81ff">8</span>     <span style="color:#ae81ff">9</span>
    <span style="color:#ae81ff">9</span>    <span style="color:#ae81ff">10</span>
    dtype: int64
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cum_ret</span>(x, y):
    <span style="color:#66d9ef">return</span> x <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> y)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">red</span>(x):
    p <span style="color:#f92672">=</span> functools<span style="color:#f92672">.</span>reduce(cum_ret, x, <span style="color:#ae81ff">1.0</span>)
    <span style="color:#66d9ef">return</span> p
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># すべてのデータに対して実行するexpanding().[mean(),std()...]</span>
S<span style="color:#f92672">.</span>expanding()<span style="color:#f92672">.</span>apply(red, raw<span style="color:#f92672">=</span>True)

<span style="color:#ae81ff">0</span>           <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">1</span>           <span style="color:#ae81ff">6.0</span>
<span style="color:#ae81ff">2</span>          <span style="color:#ae81ff">24.0</span>
<span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">120.0</span>
<span style="color:#ae81ff">4</span>         <span style="color:#ae81ff">720.0</span>
<span style="color:#ae81ff">5</span>        <span style="color:#ae81ff">5040.0</span>
<span style="color:#ae81ff">6</span>       <span style="color:#ae81ff">40320.0</span>
<span style="color:#ae81ff">7</span>      <span style="color:#ae81ff">362880.0</span>
<span style="color:#ae81ff">8</span>     <span style="color:#ae81ff">3628800.0</span>
<span style="color:#ae81ff">9</span>    <span style="color:#ae81ff">39916800.0</span>
dtype: float64
</code></pre></div><blockquote>
<p><font color="crimson">**[コード リーディング]**</font></p>
</blockquote>
<p>$ x=1 $</p>
<blockquote>
</blockquote>
<p>$ 1：red関数(x)が呼び出され、x=1.0となる。次に $</p>
<blockquote>
</blockquote>
<p>$ 2：cum\_ret関数(x,y)が呼び出され、x=1,y=1から x*(1+y)=1.0*(1.0+1.0)=2.0が返却される $</p>
<blockquote>
</blockquote>
<p>$ 3:p=2.0 $</p>
<blockquote>
</blockquote>
<p>$ x=2 $</p>
<blockquote>
</blockquote>
<p>$ p=6.0((1<em>2)</em>(1+2)) $</p>
<blockquote>
</blockquote>
<p>$ x=3 $</p>
<blockquote>
</blockquote>
<p>$ p=24.0((1<em>2</em>3)*(1+3)) $</p>
<blockquote>
</blockquote>
<p>$ x=4 $</p>
<blockquote>
</blockquote>
<p>$ p=120.0((1<em>2</em>3<em>4)</em>(1+4)) $</p>
<blockquote>
</blockquote>
<h3 id="０より小さい値を除いてグループの平均値に置き換える">０より小さい値を除いてグループの平均値に置き換える</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">116</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>], <span style="color:#e6db74">&#39;B&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]})
 A B
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span>

In [<span style="color:#ae81ff">117</span>]: gb <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)
In [<span style="color:#ae81ff">118</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">replace</span>(g):
              mask <span style="color:#f92672">=</span> g <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>
              <span style="color:#66d9ef">return</span> g<span style="color:#f92672">.</span>where(mask, g[<span style="color:#f92672">~</span>mask]<span style="color:#f92672">.</span>mean())

In [<span style="color:#ae81ff">119</span>]: gb<span style="color:#f92672">.</span>transform(replace)
Out[<span style="color:#ae81ff">119</span>]: 
     B
<span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">1.5</span>
<span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">1.5</span>
</code></pre></div><h3 id="０より小さい値をグループの平均値に置き換えるclipboardthumbsup">０より小さい値をグループの平均値に置き換える:clipboard::thumbsup:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span> : [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>], <span style="color:#e6db74">&#39;B&#39;</span> : [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>]})
gb <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">replace</span>(g):
    mask <span style="color:#f92672">=</span> g <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>
    g<span style="color:#f92672">.</span>loc[mask] <span style="color:#f92672">=</span> g[<span style="color:#f92672">~</span>mask]<span style="color:#f92672">.</span>mean()
    <span style="color:#66d9ef">return</span> g
gb<span style="color:#f92672">.</span>transform(replace)

 B
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3.0</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2.5</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6.0</span>
</code></pre></div><h3 id="集計データでグループを並べ替える">集計データでグループを並べ替える</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">120</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;code&#39;</span>: [<span style="color:#e6db74">&#39;foo&#39;</span>, <span style="color:#e6db74">&#39;bar&#39;</span>, <span style="color:#e6db74">&#39;baz&#39;</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>,
                             <span style="color:#e6db74">&#39;data&#39;</span>: [<span style="color:#ae81ff">0.16</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">0.21</span>, <span style="color:#ae81ff">0.33</span>, <span style="color:#ae81ff">0.45</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">0.59</span>, <span style="color:#ae81ff">0.62</span>],
                             <span style="color:#e6db74">&#39;flag&#39;</span>: [False, True] <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>})

In [<span style="color:#ae81ff">121</span>]: code_groups <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;code&#39;</span>)

In [<span style="color:#ae81ff">122</span>]: agg_n_sort_order <span style="color:#f92672">=</span> code_groups[[<span style="color:#e6db74">&#39;data&#39;</span>]]<span style="color:#f92672">.</span>transform(sum)<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;data&#39;</span>)

In [<span style="color:#ae81ff">123</span>]: sorted_df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>loc[agg_n_sort_order<span style="color:#f92672">.</span>index]

In [<span style="color:#ae81ff">124</span>]: sorted_df
Out[<span style="color:#ae81ff">124</span>]: 
  code  data   flag
<span style="color:#ae81ff">1</span>  bar <span style="color:#f92672">-</span><span style="color:#ae81ff">0.21</span>   True
<span style="color:#ae81ff">4</span>  bar <span style="color:#f92672">-</span><span style="color:#ae81ff">0.59</span>  False
<span style="color:#ae81ff">0</span>  foo  <span style="color:#ae81ff">0.16</span>  False
<span style="color:#ae81ff">3</span>  foo  <span style="color:#ae81ff">0.45</span>   True
<span style="color:#ae81ff">2</span>  baz  <span style="color:#ae81ff">0.33</span>  False
<span style="color:#ae81ff">5</span>  baz  <span style="color:#ae81ff">0.62</span>   True
</code></pre></div><blockquote>
<p><font color="crimson">**[コード リーディング]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># &#39;data&#39;でグループ化して合計を求め並び替える。</span>
agg_n_sort_order <span style="color:#f92672">=</span> code_groups[[<span style="color:#e6db74">&#39;data&#39;</span>]]<span style="color:#f92672">.</span>transform(sum)<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;data&#39;</span>)
 data
<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.80</span>
<span style="color:#ae81ff">4</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.80</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.61</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0.61</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0.95</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0.95</span>
<span style="color:#75715e"># 次にインデックスを求めて抽出する</span>
agg_n_sort_order<span style="color:#f92672">.</span>index
Int64Index([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
</code></pre></div><h3 id="複数の集計列を作成する">複数の集計列を作成する</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">125</span>]: rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(start<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2014-10-07&#34;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2min&#39;</span>)

In [<span style="color:#ae81ff">126</span>]: ts <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(data<span style="color:#f92672">=</span>list(range(<span style="color:#ae81ff">10</span>)), index<span style="color:#f92672">=</span>rng)

In [<span style="color:#ae81ff">127</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">MyCust</span>(x):
              <span style="color:#66d9ef">if</span> len(x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>:
                  <span style="color:#66d9ef">return</span> x[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.234</span>
              <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>NaT 

In [<span style="color:#ae81ff">128</span>]: mhc <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Mean&#39;</span>: np<span style="color:#f92672">.</span>mean, <span style="color:#e6db74">&#39;Max&#39;</span>: np<span style="color:#f92672">.</span>max, <span style="color:#e6db74">&#39;Custom&#39;</span>: MyCust}

In [<span style="color:#ae81ff">129</span>]: ts<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#34;5min&#34;</span>)<span style="color:#f92672">.</span>apply(mhc)
Out[<span style="color:#ae81ff">129</span>]: 
Mean    <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>        <span style="color:#ae81ff">1</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>      <span style="color:#ae81ff">3.5</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">00</span>        <span style="color:#ae81ff">6</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span>      <span style="color:#ae81ff">8.5</span>
Max     <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>        <span style="color:#ae81ff">2</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>        <span style="color:#ae81ff">4</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">00</span>        <span style="color:#ae81ff">7</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span>        <span style="color:#ae81ff">9</span>
Custom  <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">1.234</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>      NaT
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">7.404</span>
        <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span>      NaT
dtype: object

In [<span style="color:#ae81ff">130</span>]: ts
Out[<span style="color:#ae81ff">130</span>]: 
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">04</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">06</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">08</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">6</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">16</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">8</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">18</span>:<span style="color:#ae81ff">00</span>    <span style="color:#ae81ff">9</span>
Freq: <span style="color:#ae81ff">2</span>T, dtype: int64

</code></pre></div><blockquote>
<p><font color="crimson">**[コードリーディング]**</font></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"></code></pre></div></blockquote>
<p>Recount #TimeSeries object to &lsquo;5min&rsquo;
ts_re = ts.resample(&lsquo;5min&rsquo;)
#View the contents of an object
for t in ts_re:
print(t)
(Timestamp(&lsquo;2014-10-07 00:00:00&rsquo;, freq='5T&rsquo;), 2014-10-07 00:00:00 0
2014-10-07 00:02:00 1
2014-10-07 00:04:00 2
Freq: 2T, dtype: int64)
(Timestamp(&lsquo;2014-10-07 00:05:00&rsquo;, freq='5T&rsquo;), 2014-10-07 00:06:00 3
2014-10-07 00:08:00 4
Freq: 2T, dtype: int64)
(Timestamp(&lsquo;2014-10-07 00:10:00&rsquo;, freq='5T&rsquo;), 2014-10-07 00:10:00 5
2014-10-07 00:12:00 6
2014-10-07 00:14:00 7
Freq: 2T, dtype: int64)
(Timestamp(&lsquo;2014-10-07 00:15:00&rsquo;, freq='5T&rsquo;), 2014-10-07 00:16:00 8
2014-10-07 00:18:00 9
Freq: 2T, dtype: int64)</p>
<pre><code>||ts|data|mean|max|MyCust|x[1]|
|:-:|:-:|:-:|--:|--:|--:|---:|
|0|2014-10-07 00:00:00|0,1,2|1|2|1.234|1|
|1|2014-10-07 00:05:00|3,4|3.5|4|NaT|False|
|2|2014-10-07 00:10:00|5,6,7|6|7|7.404|6|
|3|2014-10-07 00:15:00|8,9|8.5|9|NaT|False|

### Create value count column and reassign to DataFrame
```python
In [131]: df = pd.DataFrame({'Color':'Red Red Red Blue'.split(),
                             'Value': [100, 150, 50, 50]})

In [132]: df
Out[132]:
  Color Value
0 Red 100
1 Red 150
2 Red 50
3 Blue 50

In [133]: df['Counts'] = df.groupby(['Color']).transform(len)

In [134]: df
Out[134]:
  Color Value Counts
0 Red 100 3
1 Red 150 3
2 Red 50 3
3 Blue 50 1
</code></pre><h3 id="shift-group-of-column-values-based-on-index">Shift group of column values based on index</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">135</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;line_race&#39;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>],
                             <span style="color:#e6db74">&#39;beyer&#39;</span>: [<span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">100</span>]},
                             index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Last Gunfighter&#39;</span>,<span style="color:#e6db74">&#39;Last Gunfighter&#39;</span>,<span style="color:#e6db74">&#39;Last Gunfighter&#39;</span>,
                                    <span style="color:#e6db74">&#39;Paynter&#39;</span>,<span style="color:#e6db74">&#39;Paynter&#39;</span>,<span style="color:#e6db74">&#39;Paynter&#39;</span>])

In [<span style="color:#ae81ff">136</span>]: df
Out[<span style="color:#ae81ff">136</span>]:
                 line_race beyer
Last Gunfighter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">99</span>
Last Gunfighter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">102</span>
Last Gunfighter <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">103</span>
Paynter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">103</span>
Paynter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">88</span>
Paynter <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">100</span>

In [<span style="color:#ae81ff">137</span>]: df[<span style="color:#e6db74">&#39;beyer_shifted&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(level<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)[<span style="color:#e6db74">&#39;beyer&#39;</span>]<span style="color:#f92672">.</span>shift(<span style="color:#ae81ff">1</span>)

In [<span style="color:#ae81ff">138</span>]: df
Out[<span style="color:#ae81ff">138</span>]:
                 line_race beyer beyer_shifted
Last Gunfighter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">99</span> NaN
Last Gunfighter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">102</span> <span style="color:#ae81ff">99.0</span>
Last Gunfighter <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">103</span> <span style="color:#ae81ff">102.0</span>
Paynter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">103</span> NaN
Paynter <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">88</span> <span style="color:#ae81ff">103.0</span>
Paynter <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">88.0</span>

</code></pre></div><h3 id="select-the-row-with-the-maximum-value-from-each-group">Select the row with the maximum value from each group</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;host&#39;</span>: [<span style="color:#e6db74">&#39;other&#39;</span>,<span style="color:#e6db74">&#39;other&#39;</span>,<span style="color:#e6db74">&#39;that&#39;</span>,<span style="color:#e6db74">&#39;this&#39;</span>,<span style="color:#e6db74">&#39;this&#39;</span>],
                   <span style="color:#e6db74">&#39;service&#39;</span>: [<span style="color:#e6db74">&#39;mail&#39;</span>,<span style="color:#e6db74">&#39;web&#39;</span>,<span style="color:#e6db74">&#39;mail&#39;</span>,<span style="color:#e6db74">&#39;mail&#39;</span>,<span style="color:#e6db74">&#39;web&#39;</span>],
                   <span style="color:#e6db74">&#39;no&#39;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>]})<span style="color:#f92672">.</span>set_index([<span style="color:#e6db74">&#39;host&#39;</span>,<span style="color:#e6db74">&#39;service&#39;</span>]

In [<span style="color:#ae81ff">140</span>]: mask <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(level<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>agg(<span style="color:#e6db74">&#39;idxmax&#39;</span>)

In [<span style="color:#ae81ff">141</span>]: df_count <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>loc[mask[<span style="color:#e6db74">&#39;no&#39;</span>]]<span style="color:#f92672">.</span>reset_index()

In [<span style="color:#ae81ff">142</span>]: df_count
Out[<span style="color:#ae81ff">142</span>]:
    host service no
<span style="color:#ae81ff">0</span> other web <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">1</span> that mail <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> this mail <span style="color:#ae81ff">2</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center"></th>
<th align="center">no</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">host</td>
<td align="center">service</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">other</td>
<td align="center">mail</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">web</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">that</td>
<td align="center">mail</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">this</td>
<td align="center">mail</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">web</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">See the contents of the mask value grouped by <span style="color:#75715e">#level=0</span>
mask <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(level<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>agg(<span style="color:#e6db74">&#39;idxmax&#39;</span>)
no
host
other (other, web)
that (that, mail)
this (this, mail)
</code></pre></div><p>The maximum value index is created for data grouped in tuple format.
The index is reset in the data frame resulting from extraction with this mask value.</p>
<h3 id="grouping-like-itertoolsgroupby">grouping like itertools.groupby</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">143</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>], columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>])

In [<span style="color:#ae81ff">144</span>]: df[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">.</span>groupby((df[<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">!=</span> df[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">.</span>shift())<span style="color:#f92672">.</span>cumsum())<span style="color:#f92672">.</span>groups
Out[<span style="color:#ae81ff">144</span>]:
{<span style="color:#ae81ff">1</span>: Int64Index([<span style="color:#ae81ff">0</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>),
 <span style="color:#ae81ff">2</span>: Int64Index([<span style="color:#ae81ff">1</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>),
 <span style="color:#ae81ff">3</span>: Int64Index([<span style="color:#ae81ff">2</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>),
 <span style="color:#ae81ff">4</span>: Int64Index([<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>),
 <span style="color:#ae81ff">5</span>: Int64Index([<span style="color:#ae81ff">6</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>),
 <span style="color:#ae81ff">6</span>: Int64Index([<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)}

In [<span style="color:#ae81ff">145</span>]: df[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">.</span>groupby((df[<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">!=</span> df[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">.</span>shift())<span style="color:#f92672">.</span>cumsum())<span style="color:#f92672">.</span>cumsum()
Out[<span style="color:#ae81ff">145</span>]:
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2</span>
Name: A, dtype: int64
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Above data frame</span>
df
A
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">1</span>
</code></pre></div><blockquote>
</blockquote>
<ul>
<li>If you run the same data with itertools.groupby, you will see the following contents.</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>]
gb <span style="color:#f92672">=</span> itertools<span style="color:#f92672">.</span>groupby(data)
<span style="color:#66d9ef">for</span> key, group <span style="color:#f92672">in</span> gb:
    <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;{key}: {list(group)}&#39;</span>)
<span style="color:#ae81ff">0</span>: [<span style="color:#ae81ff">0</span>]
<span style="color:#ae81ff">1</span>: [<span style="color:#ae81ff">1</span>]
<span style="color:#ae81ff">0</span>: [<span style="color:#ae81ff">0</span>]
<span style="color:#ae81ff">1</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>]
<span style="color:#ae81ff">0</span>: [<span style="color:#ae81ff">0</span>]
<span style="color:#ae81ff">1</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>]
</code></pre></div><ul>
<li>GroupBy.groups returns group names and labels in dictionary format.</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tmp <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;A&#39;</span>)
gb <span style="color:#f92672">=</span> tmp<span style="color:#f92672">.</span>groups
gb<span style="color:#f92672">.</span>get(<span style="color:#ae81ff">1</span>)
Int64Index([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
gb<span style="color:#f92672">.</span>get(<span style="color:#ae81ff">0</span>)
Int64Index([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
</code></pre></div><blockquote>
</blockquote>
<p>$ (1)\ sample data $
$ df[&lsquo;A&rsquo;] \tag{1} $
$(2)\ shift data $$ df[&lsquo;A&rsquo;].shift() \tag{2} $
True $ if $(3)(2) and (3) are not equivalent
$ df[&lsquo;A&rsquo;] != df[&lsquo;A&rsquo;].shift() \tag{3} $
$ (4) \ (3) is cumulative $
$ (df[&lsquo;A&rsquo;] != df[&lsquo;A&rsquo;].shift()).cumsum() \tag{4} $
$ (5)\ Contents of objects grouped by cumulative data $
$ gb = df[&lsquo;A&rsquo;].groupby((df[&lsquo;A&rsquo;] != df[&lsquo;A&rsquo;].shift()).cumsum()) \tag{5} $
$ (6)\ Cumulative grouped data $
$ df[&lsquo;A&rsquo;].groupby((df[&lsquo;A&rsquo;] != df[&lsquo;A&rsquo;].shift()).cumsum()).cumsum() \tag{6} $</p>
<blockquote>
</blockquote>
<pre><code class="language-math" data-lang="math">\begin
{array}{|c|c|c|c|c|c|c|} \hline
 &amp; (1) &amp; (2) &amp; (3) &amp; (4) &amp; (5) &amp; (6) \\ \hline
0 &amp; 0 &amp; NaN &amp; True &amp; 1 &amp; 0 &amp; 0 \\ \hline
1 &amp; 1 &amp; 0.0 &amp; True &amp; 2 &amp; 1 &amp; 1 \\ \hline
2 &amp; 0 &amp; 1.0 &amp; True &amp; 3 &amp; 0 &amp; 0 \\ \hline
3 &amp; 1 &amp; 0.0 &amp; True &amp; 4 &amp; 1,1,1 &amp; 1 \\ \hline
4 &amp; 1 &amp; 1.0 &amp; False &amp; 4 &amp; &amp; 2 \\ \hline
5 &amp; 1 &amp; 1.0 &amp; False &amp; 4 &amp; &amp; 3 \\ \hline
6 &amp; 0 &amp; 1.0 &amp; True &amp; 5 &amp; 0 &amp; 0 \\ \hline
7 &amp; 1 &amp; 0.0 &amp; True &amp; 6 &amp; 1,1 &amp; 1 \\ \hline
8 &amp; 1 &amp; 1.0 &amp; False &amp; 6 &amp; &amp; 2 \\ \hline
\end{array}
</code></pre><h2 id="expanding-data">Expanding data</h2>
<h3 id="rolling-calculation-based-on-value-rather-than-count-clipboard">Rolling calculation based on value rather than count: clipboard:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;RollBasis&#39;</span>:[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">13</span>],
                   <span style="color:#e6db74">&#39;ToRoll&#39;</span>:[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">2</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">13</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>]})

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(x):
    ser <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>ToRoll[(df<span style="color:#f92672">.</span>RollBasis <span style="color:#f92672">&gt;=</span> x) <span style="color:#f92672">&amp;</span> (df<span style="color:#f92672">.</span>RollBasis <span style="color:#f92672">&lt;</span>x<span style="color:#f92672">+</span><span style="color:#ae81ff">5</span>)]
    <span style="color:#66d9ef">return</span> ser<span style="color:#f92672">.</span>sum()

df[<span style="color:#e6db74">&#39;Rolled&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>RollBasis<span style="color:#f92672">.</span>apply(f)
df
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">15</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">13</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">12</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">13</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<p>| |RollBasis | ToRoll |
|:&ndash;|&ndash;::&mdash;-|
| 0 | 1 | 1 |
| 1 | 1 | 4 |
| 2 | 1 | -5 |
| 3 | 2 | 2 |
| 4 | 3 | -4 |
| 5 | 5 | -2 |
| 6 | 8 | 0 |
| 7 | 10 | -13 |
| 8 | 12 | -2 |
| 9 | 13 | -5 |</p>
<ul>
<li>The content of the function f sums up the values of&rsquo;ToRoll&rsquo; in the range where the value of&rsquo;RollBasis&rsquo; is x or more and x+5 or less.</li>
</ul>
<p>$ x=1 $
$(RollBasis&gt;=1) \&amp; (RollBsis&lt;1+5) \rightarrow sum([1,4,-5,2,-4,-2]) \rightarrow -4 $
$ \vdots $
$x =4 $
$(RollBasis&gt;=4) \&amp; (RollBsis&lt;4+5) \rightarrow sum([-2,0]) \rightarrow -2 $</p>
<h3 id="rolling-average-by-time-interval">rolling average by time interval</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;B&#39;</span>: range(<span style="color:#ae81ff">5</span>)})

df<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> (pd<span style="color:#f92672">.</span>Timestamp(<span style="color:#e6db74">&#39;20130101 09:00:00&#39;</span>),
            pd<span style="color:#f92672">.</span>Timestamp(<span style="color:#e6db74">&#39;20130101 09:00:02&#39;</span>),
            pd<span style="color:#f92672">.</span>Timestamp(<span style="color:#e6db74">&#39;20130101 09:00:03&#39;</span>),
            pd<span style="color:#f92672">.</span>Timestamp(<span style="color:#e6db74">&#39;20130101 09:00:05&#39;</span>),
            pd<span style="color:#f92672">.</span>Timestamp(<span style="color:#e6db74">&#39;20130101 09:00:06&#39;</span>)]

df
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">06</span> <span style="color:#ae81ff">4</span>

df<span style="color:#f92672">.</span>rolling(<span style="color:#ae81ff">2</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>sum()
B
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02</span> <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03</span> <span style="color:#ae81ff">3.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">5.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">06</span> <span style="color:#ae81ff">7.0</span>

df<span style="color:#f92672">.</span>rolling(<span style="color:#e6db74">&#39;2s&#39;</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>sum()
B
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02</span> <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03</span> <span style="color:#ae81ff">3.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">3.0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">06</span> <span style="color:#ae81ff">7.0</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># rolling (window width, minimum number of data)</span>
df<span style="color:#f92672">.</span>rolling(<span style="color:#ae81ff">2</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>sum()
<span style="color:#75715e"># 0+1=1, 1+2=3, 2+3=5, 3+4=7 in 2 line units</span>
df<span style="color:#f92672">.</span>rolling(<span style="color:#e6db74">&#39;2s&#39;</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>sum()
<span style="color:#75715e"># 0+1=1, 1+2=3, 3+0=3, 3+4=7</span>
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#If you take the total of the time series data at 2 minute intervals,</span>
df<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;2s&#39;</span>)<span style="color:#f92672">.</span>sum()
B
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">04</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">06</span> <span style="color:#ae81ff">4</span>
</code></pre></div><h3 id="calculate-rolling-average-from-total-by-time-series-by-rolling-function">Calculate rolling average from total by time series by rolling function</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame((<span style="color:#e6db74">&#39;enddate&#39;</span>:pd<span style="color:#f92672">.</span>to_datetime([<span style="color:#e6db74">&#39;2019-03-01&#39;</span>,<span style="color:#e6db74">&#39;2019-03-01&#39;</span>,<span style="color:#e6db74">&#39;2019-03-01&#39;</span>,<span style="color:#e6db74">&#39;2019-03-02&#39;</span>,<span style="color:#e6db74">&#39;2019 -03-02&#39;</span>,<span style="color:#e6db74">&#39;2019-03-02&#39;</span>,<span style="color:#e6db74">&#39;2019-03-03&#39;</span>,<span style="color:#e6db74">&#39;2019-03-03&#39;</span>,<span style="color:#e6db74">&#39;2019-03-04&#39;</span>]),
                   <span style="color:#e6db74">&#39;bloom&#39;</span>:[<span style="color:#ae81ff">0.342</span>, <span style="color:#ae81ff">0.235</span>, <span style="color:#ae81ff">0.456</span>, <span style="color:#ae81ff">0.389</span>, <span style="color:#ae81ff">0.453</span>, <span style="color:#ae81ff">0.367</span>, <span style="color:#ae81ff">0.369</span>, <span style="color:#ae81ff">0.428</span>, <span style="color:#ae81ff">0.55</span>],
                   <span style="color:#e6db74">&#39;unbloom&#39;</span>:[<span style="color:#ae81ff">0.658</span>, <span style="color:#ae81ff">0.765</span>, <span style="color:#ae81ff">0.544</span>, <span style="color:#ae81ff">0.611</span>, <span style="color:#ae81ff">0.547</span>, <span style="color:#ae81ff">0.633</span>, <span style="color:#ae81ff">0.631</span>, <span style="color:#ae81ff">0.572</span>, <span style="color:#ae81ff">0.45</span>]})
</code></pre></div><h2 id="splitting">Splitting</h2>
<h3 id="create-a-list-of-data-frames-and-divide-by-the-values-contained-in-the-rows">Create a list of data frames and divide by the values contained in the rows.</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">146</span>]: d df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;Case&#39;</span>: [<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>,<span style="color:#e6db74">&#39;A &#39;</span>,<span style="color:#e6db74">&#39;A&#39;</span>],
                         <span style="color:#e6db74">&#39;Data&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">50</span>,(<span style="color:#ae81ff">9</span>,))})

In [<span style="color:#ae81ff">147</span>]: dfs <span style="color:#f92672">=</span> list(zip(<span style="color:#f92672">*</span>df<span style="color:#f92672">.</span>groupby((<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (df[<span style="color:#e6db74">&#39;Case&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;B&#39;</span>))<span style="color:#f92672">.</span>cumsum()
                         <span style="color:#f92672">.</span>rolling(window<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>median())))[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]

In [<span style="color:#ae81ff">148</span>]: dfs[<span style="color:#ae81ff">0</span>]
Out[<span style="color:#ae81ff">148</span>]:
  Case Data
<span style="color:#ae81ff">0</span> A <span style="color:#ae81ff">24</span>
<span style="color:#ae81ff">1</span> A <span style="color:#ae81ff">34</span>
<span style="color:#ae81ff">2</span> A <span style="color:#ae81ff">33</span>
<span style="color:#ae81ff">3</span> B <span style="color:#ae81ff">11</span>
In [<span style="color:#ae81ff">149</span>]: dfs[<span style="color:#ae81ff">1</span>]
Out[<span style="color:#ae81ff">149</span>]:
  Case Data
<span style="color:#ae81ff">4</span> A <span style="color:#ae81ff">31</span>
<span style="color:#ae81ff">5</span> A <span style="color:#ae81ff">35</span>
<span style="color:#ae81ff">6</span> B <span style="color:#ae81ff">13</span>

In [<span style="color:#ae81ff">150</span>]: dfs[<span style="color:#ae81ff">2</span>]
Out[<span style="color:#ae81ff">150</span>]:
Case Data
<span style="color:#ae81ff">7</span> A <span style="color:#ae81ff">17</span>
<span style="color:#ae81ff">8</span> A <span style="color:#ae81ff">33</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="center">Case</th>
<th align="right">Data</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="center">A</td>
<td align="right">24</td>
</tr>
<tr>
<td align="right">1</td>
<td align="center">A</td>
<td align="right">34</td>
</tr>
<tr>
<td align="right">2</td>
<td align="center">A</td>
<td align="right">33</td>
</tr>
<tr>
<td align="right">3</td>
<td align="center">B</td>
<td align="right">11</td>
</tr>
<tr>
<td align="right">4</td>
<td align="center">A</td>
<td align="right">31</td>
</tr>
<tr>
<td align="right">5</td>
<td align="center">A</td>
<td align="right">35</td>
</tr>
<tr>
<td align="right">6</td>
<td align="center">B</td>
<td align="right">13</td>
</tr>
<tr>
<td align="right">7</td>
<td align="center">A</td>
<td align="right">17</td>
</tr>
<tr>
<td align="right">8</td>
<td align="center">A</td>
<td align="right">33</td>
</tr>
</tbody>
</table>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dfs <span style="color:#f92672">=</span> list(zip(<span style="color:#f92672">*</span>df<span style="color:#f92672">.</span>groupby((<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (df[<span style="color:#e6db74">&#39;Case&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;B&#39;</span>))<span style="color:#f92672">.</span>cumsum()<span style="color:#f92672">.</span>rolling(window<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>median()))) [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</code></pre></div><blockquote>
</blockquote>
<ul>
<li>I will disassemble this one liner.</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#&#39;Case&#39; column sets&#39;B&#39; to 1</span>
<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (df[<span style="color:#e6db74">&#39;Case&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;B&#39;</span>)
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
Ten
<span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">40</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">0</span>
Name: Case, dtype: int64
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Take cumulative</span>
<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (df[<span style="color:#e6db74">&#39;Case&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;B&#39;</span>)<span style="color:#f92672">.</span>cumsum()
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
Ten
<span style="color:#ae81ff">20</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2</span>
Name: Case, dtype: int64
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Take the median of the cumulative values in units of 3 lines</span>
(<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (df[<span style="color:#e6db74">&#39;Case&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;B&#39;</span>))<span style="color:#f92672">.</span>cumsum()<span style="color:#f92672">.</span>rolling(window<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>median()
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">1.0</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2.0</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2.0</span>
Name: Case, dtype: float64
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Because the reference value to group by the previous process was made, it is extracted with it. Expand the resulting group objects to list them.tmp2 = list(zip(*df.groupby((1 * (df[&#39;Case&#39;] ==&#39;B&#39;)).cumsum().rolling(window=3, min_periods=1).median())))</span>
<span style="color:#f92672">&gt;</span>
[(<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.0</span>, <span style="color:#ae81ff">2.0</span>), (Case Data
  <span style="color:#ae81ff">0</span> A <span style="color:#ae81ff">24</span>
  <span style="color:#ae81ff">1</span> A <span style="color:#ae81ff">34</span>
  <span style="color:#ae81ff">2</span> A <span style="color:#ae81ff">33</span>
  <span style="color:#ae81ff">3</span> B <span style="color:#ae81ff">11</span>, Case Data
  <span style="color:#ae81ff">4</span> A <span style="color:#ae81ff">31</span>
  <span style="color:#ae81ff">5</span> A <span style="color:#ae81ff">35</span>
  <span style="color:#ae81ff">6</span> B <span style="color:#ae81ff">13</span>, Case Data
  <span style="color:#ae81ff">7</span> A <span style="color:#ae81ff">17</span>
  <span style="color:#ae81ff">8</span> A <span style="color:#ae81ff">33</span>)]
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># The contents when the obtained group object is not expanded are as follows, so you can see the difference with unpack (*) well.</span>
tmp <span style="color:#f92672">=</span> list(zip(df<span style="color:#f92672">.</span>groupby((<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (df[<span style="color:#e6db74">&#39;Case&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;B&#39;</span>))<span style="color:#f92672">.</span>cumsum()<span style="color:#f92672">.</span>rolling(window<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>median())))
<span style="color:#f92672">&gt;</span>
[((<span style="color:#ae81ff">0.0</span>, Case Data
   <span style="color:#ae81ff">0</span> A <span style="color:#ae81ff">24</span>
   <span style="color:#ae81ff">1</span> A <span style="color:#ae81ff">34</span>
   <span style="color:#ae81ff">2</span> A <span style="color:#ae81ff">33</span>
   <span style="color:#ae81ff">3</span> B <span style="color:#ae81ff">11</span>),), ((<span style="color:#ae81ff">1.0</span>, Case Data
   <span style="color:#ae81ff">4</span> A <span style="color:#ae81ff">31</span>
   <span style="color:#ae81ff">5</span> A <span style="color:#ae81ff">35</span>
   <span style="color:#ae81ff">6</span> B <span style="color:#ae81ff">13</span>),), ((<span style="color:#ae81ff">2.0</span>, Case Data
   <span style="color:#ae81ff">7</span> A <span style="color:#ae81ff">17</span>
   <span style="color:#ae81ff">8</span> A <span style="color:#ae81ff">33</span>),)]
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># dfs is a list [(0.0, 1.0, 2.0), (the following data)], so get the first element from the end as [-1].</span>
dfs <span style="color:#f92672">=</span> list(zip(<span style="color:#f92672">*</span>df<span style="color:#f92672">.</span>groupby((<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (df[<span style="color:#e6db74">&#39;Case&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;B&#39;</span>))<span style="color:#f92672">.</span>cumsum()<span style="color:#f92672">.</span>rolling(window<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>median()))) [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#f92672">&gt;</span>
(Case Data
 <span style="color:#ae81ff">0</span> A <span style="color:#ae81ff">24</span>
 <span style="color:#ae81ff">1</span> A <span style="color:#ae81ff">34</span>
 <span style="color:#ae81ff">2</span> A <span style="color:#ae81ff">33</span>
 <span style="color:#ae81ff">3</span> B <span style="color:#ae81ff">11</span>, Case Data
 <span style="color:#ae81ff">4</span> A <span style="color:#ae81ff">31</span>
 <span style="color:#ae81ff">5</span> A <span style="color:#ae81ff">35</span>
 <span style="color:#ae81ff">6</span> B <span style="color:#ae81ff">13</span>, Case Data
 <span style="color:#ae81ff">7</span> A <span style="color:#ae81ff">17</span>
 <span style="color:#ae81ff">8</span> A <span style="color:#ae81ff">33</span>)
</code></pre></div><h2 id="pivot">Pivot</h2>
<h3 id="partial-totals-and-subtotals">Partial totals and subtotals</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">151</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;Province&#39;</span>: [<span style="color:#e6db74">&#39;ON&#39;</span>,<span style="color:#e6db74">&#39;QC&#39;</span>,<span style="color:#e6db74">&#39;BC&#39;</span>,<span style="color:#e6db74">&#39;AL&#39;</span>,<span style="color:#e6db74">&#39;AL&#39;</span>,<span style="color:#e6db74">&#39;MN&#39;</span>,<span style="color:#e6db74">&#39;ON&#39;</span>],
                                  <span style="color:#e6db74">&#39;City&#39;</span>: [<span style="color:#e6db74">&#39;Toronto&#39;</span>,<span style="color:#e6db74">&#39;Montreal&#39;</span>,<span style="color:#e6db74">&#39;Vancouver&#39;</span>,
                                  <span style="color:#e6db74">&#39;Calgary&#39;</span>,<span style="color:#e6db74">&#39;Edmonton&#39;</span>,<span style="color:#e6db74">&#39;Winnipeg&#39;</span>,<span style="color:#e6db74">&#39;Windsor&#39;</span>],
                                  <span style="color:#e6db74">&#39;Sales&#39;</span>: [<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>]})


In [<span style="color:#ae81ff">152</span>]: table <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>pivot_table(df, values<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Sales&#39;</span>], index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Province&#39;</span>],
                                 columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;City&#39;</span>], aggfunc<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>sum, margins<span style="color:#f92672">=</span>True)

In [<span style="color:#ae81ff">153</span>]: table<span style="color:#f92672">.</span>stack(<span style="color:#e6db74">&#39;City&#39;</span>)
Out[<span style="color:#ae81ff">153</span>]:
                    Sales
Province City
AL All <span style="color:#ae81ff">12.0</span>
         Calgary <span style="color:#ae81ff">8.0</span>
         Edmonton <span style="color:#ae81ff">4.0</span>
BC All <span style="color:#ae81ff">16.0</span>
         Vancouver <span style="color:#ae81ff">16.0</span>
<span style="color:#f92672">...</span> <span style="color:#f92672">...</span>
All Montreal <span style="color:#ae81ff">6.0</span>
         Toronto <span style="color:#ae81ff">13.0</span>
         Vancouver <span style="color:#ae81ff">16.0</span>
         Windsor <span style="color:#ae81ff">1.0</span>
         Winnipeg <span style="color:#ae81ff">3.0</span>

[<span style="color:#ae81ff">20</span> rows x <span style="color:#ae81ff">1</span> columns]
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font>
The given data frame is as follows.</p>
</blockquote>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Province</th>
<th align="left">City</th>
<th align="right">Sales</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">ON</td>
<td align="left">Toronto</td>
<td align="right">13</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">QC</td>
<td align="left">Montreal</td>
<td align="right">6</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">Vancouver</td>
<td align="right">16</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">AL</td>
<td align="left">Calgary</td>
<td align="right">8</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">AL</td>
<td align="left">Edmonton</td>
<td align="right">4</td>
</tr>
<tr>
<td align="right">5</td>
<td align="left">MN</td>
<td align="left">Winnipeg</td>
<td align="right">3</td>
</tr>
<tr>
<td align="right">6</td>
<td align="left">ON</td>
<td align="left">Windsor</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Convert to table format <span style="color:#66d9ef">with</span> <span style="color:#75715e"># pivot_table function.</span>
table <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>pivot_table(df, values<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Sales&#39;</span>], index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Province&#39;</span>], columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;City&#39;</span>], aggfunc<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>sum, margins<span style="color:#f92672">=</span>True)
</code></pre></div><blockquote>
</blockquote>
<p>|||||||Sales|
|:&mdash;&mdash;&mdash;&ndash;|&mdash;&mdash;&mdash;&mdash;:|&mdash;&mdash;&mdash;&mdash;-:|&mdash;&mdash;- &mdash;&ndash;:|&mdash;&mdash;&mdash;&mdash;:|:&mdash;&mdash;&mdash;&ndash;:|:&mdash;&mdash;&mdash;-:|:- &mdash;&mdash;&ndash;:|:&mdash;&mdash;-:|
| <strong>Province</strong> | <strong>Calgary</strong> | <strong>Edmonton</strong> | <strong>Montreal</strong>| <strong>Toronto</strong> |<strong>Vancouver</strong>|<strong>Windsor</strong> |<strong>Winnipeg</strong>|* *All** |
| **AL** | 8 | 4 | nan | nan | nan | nan | nan |
| **BC** | nan | nan | nan | nan | 16 | nan | nan | 16 |
| **MN** | nan | nan | nan | nan | nan | nan | 3 |
| **ON** | nan | nan | nan | 13 | nan | 1 | nan |
| **QC** | nan | nan | 6 | nan | nan | nan | nan | 6 |
| **All** | 8 | 4 | 6 | 13 | 16 | 1 | 3 |</p>
<blockquote>
</blockquote>
<p>The data in the column direction is transformed into the row direction with the stack function.</p>
<h3 id="r-plyr-like-frequency-table">R plyr-like frequency table</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">154</span>]: grades <span style="color:#f92672">=</span> [<span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">78</span>]

In [<span style="color:#ae81ff">155</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;ID&#39;</span>: [<span style="color:#e6db74">&#34;x</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span>r <span style="color:#66d9ef">for</span> r <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>)],
                             <span style="color:#e6db74">&#39;Gender&#39;</span>: [<span style="color:#e6db74">&#39;F&#39;</span>,<span style="color:#e6db74">&#39;M&#39;</span>,<span style="color:#e6db74">&#39;F&#39;</span>,<span style="color:#e6db74">&#39;M&#39;</span>,<span style="color:#e6db74">&#39;F&#39;</span>,
                                        <span style="color:#e6db74">&#39;M&#39;</span>,<span style="color:#e6db74">&#39;F&#39;</span>,<span style="color:#e6db74">&#39;M&#39;</span>,<span style="color:#e6db74">&#39;M&#39;</span>,<span style="color:#e6db74">&#39;M&#39;</span>],
                            <span style="color:#e6db74">&#39;ExamYear&#39;</span>: [<span style="color:#e6db74">&#39;2007&#39;</span>, <span style="color:#e6db74">&#39;2007&#39;</span>, <span style="color:#e6db74">&#39;2007&#39;</span>, <span style="color:#e6db74">&#39;2008&#39;</span>, <span style="color:#e6db74">&#39;2008&#39;</span>,
                                         <span style="color:#e6db74">&#39;2008&#39;</span>, <span style="color:#e6db74">&#39;2008&#39;</span>, <span style="color:#e6db74">&#39;2009&#39;</span>, <span style="color:#e6db74">&#39;2009&#39;</span>, <span style="color:#e6db74">&#39;2009&#39;</span>],
                            <span style="color:#e6db74">&#39;Class&#39;</span>: [<span style="color:#e6db74">&#39;algebra&#39;</span>,<span style="color:#e6db74">&#39;stats&#39;</span>,<span style="color:#e6db74">&#39;bio&#39;</span>,<span style="color:#e6db74">&#39;algebra&#39;</span>,
                                      <span style="color:#e6db74">&#39;algebra&#39;</span>,<span style="color:#e6db74">&#39;stats&#39;</span>,<span style="color:#e6db74">&#39;stats&#39;</span>,<span style="color:#e6db74">&#39;algebra&#39;</span>,
                                      <span style="color:#e6db74">&#39;bio&#39;</span>,<span style="color:#e6db74">&#39;bio&#39;</span>],
                            <span style="color:#e6db74">&#39;Participated&#39;</span>: [<span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;no&#39;</span>,
                                             <span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;yes&#39;</span>,<span style="color:#e6db74">&#39;yes&#39;</span>],
                            <span style="color:#e6db74">&#39;Passed&#39;</span>: [<span style="color:#e6db74">&#39;yes&#39;</span> <span style="color:#66d9ef">if</span> x <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">50</span> <span style="color:#66d9ef">else</span><span style="color:#e6db74">&#39;no&#39;</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> grades],
                            <span style="color:#e6db74">&#39;Employed&#39;</span>: [True, True, True, False,
                                         False, False, False, True, True, False],
                            <span style="color:#e6db74">&#39;Grade&#39;</span>: grades})

In [<span style="color:#ae81ff">156</span>]: df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;ExamYear&#39;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#39;Participated&#39;</span>: <span style="color:#66d9ef">lambda</span> x: x<span style="color:#f92672">.</span>value_counts()[<span style="color:#e6db74">&#39;yes&#39;</span>],
                                      <span style="color:#e6db74">&#39;Passed&#39;</span>: <span style="color:#66d9ef">lambda</span> x: sum(x <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;yes&#39;</span>),
                                      <span style="color:#e6db74">&#39;Employed&#39;</span>: <span style="color:#66d9ef">lambda</span> x: sum(x),<span style="color:#e6db74">&#39;Grade&#39;</span>: <span style="color:#66d9ef">lambda</span> x: sum(x) <span style="color:#f92672">/</span> len(x)})
Out[<span style="color:#ae81ff">156</span>]: 
          Participated  Passed  Employed      Grade
ExamYear                                           
<span style="color:#ae81ff">2007</span>                 <span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">74.000000</span>
<span style="color:#ae81ff">2008</span>                 <span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">68.500000</span>
<span style="color:#ae81ff">2009</span>                 <span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">60.666667</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[コードリーディング]**</font></p>
</blockquote>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">ID</th>
<th align="left">Gender</th>
<th align="right">ExamYear</th>
<th align="left">Class</th>
<th align="left">Participated</th>
<th align="left">Passed</th>
<th align="left">Employed</th>
<th align="right">Grade</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">x0</td>
<td align="left">F</td>
<td align="right">2007</td>
<td align="left">algebra</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">True</td>
<td align="right">48</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">x1</td>
<td align="left">M</td>
<td align="right">2007</td>
<td align="left">stats</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">True</td>
<td align="right">99</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">x2</td>
<td align="left">F</td>
<td align="right">2007</td>
<td align="left">bio</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">True</td>
<td align="right">75</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">x3</td>
<td align="left">M</td>
<td align="right">2008</td>
<td align="left">algebra</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">False</td>
<td align="right">80</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">x4</td>
<td align="left">F</td>
<td align="right">2008</td>
<td align="left">algebra</td>
<td align="left">no</td>
<td align="left">no</td>
<td align="left">False</td>
<td align="right">42</td>
</tr>
<tr>
<td align="right">5</td>
<td align="left">x5</td>
<td align="left">M</td>
<td align="right">2008</td>
<td align="left">stats</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">False</td>
<td align="right">80</td>
</tr>
<tr>
<td align="right">6</td>
<td align="left">x6</td>
<td align="left">F</td>
<td align="right">2008</td>
<td align="left">stats</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">False</td>
<td align="right">72</td>
</tr>
<tr>
<td align="right">7</td>
<td align="left">x7</td>
<td align="left">M</td>
<td align="right">2009</td>
<td align="left">algebra</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">True</td>
<td align="right">68</td>
</tr>
<tr>
<td align="right">8</td>
<td align="left">x8</td>
<td align="left">M</td>
<td align="right">2009</td>
<td align="left">bio</td>
<td align="left">yes</td>
<td align="left">no</td>
<td align="left">True</td>
<td align="right">36</td>
</tr>
<tr>
<td align="right">9</td>
<td align="left">x9</td>
<td align="left">M</td>
<td align="right">2009</td>
<td align="left">bio</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">False</td>
<td align="right">78</td>
</tr>
</tbody>
</table>
<ul>
<li>日常的にSQLは使っていませんが、Sqlite3に入れてSQL文で確認しました。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SQL" data-lang="SQL"><span style="color:#66d9ef">select</span> ExamYear,
<span style="color:#66d9ef">count</span>(Participated <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;yes&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">as</span> participated,
<span style="color:#66d9ef">count</span>(Passed <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;yes&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">as</span> passed,
<span style="color:#66d9ef">count</span>(Employed <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;True&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">as</span> employed,
<span style="color:#66d9ef">sum</span>(<span style="color:#66d9ef">cast</span>(Grade <span style="color:#66d9ef">as</span> real))<span style="color:#f92672">/</span><span style="color:#66d9ef">count</span>(<span style="color:#66d9ef">cast</span>(Grade <span style="color:#66d9ef">as</span> real)) <span style="color:#66d9ef">as</span> grades
<span style="color:#66d9ef">from</span> df
<span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> ExamYear 
;

<span style="color:#e6db74">&#34;2007&#34;</span> <span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#e6db74">&#34;74.0&#34;</span>
<span style="color:#e6db74">&#34;2008&#34;</span> <span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#e6db74">&#34;68.5&#34;</span>
<span style="color:#e6db74">&#34;2009&#34;</span> <span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#e6db74">&#34;60.6666666666667&#34;</span>
</code></pre></div><h3 id="年と月のクロス集計を作成するには">年と月のクロス集計を作成するには：</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">157</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;value&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">36</span>)},
                             index<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2011-01-01&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;M&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">36</span>))

In [<span style="color:#ae81ff">158</span>]: pd<span style="color:#f92672">.</span>pivot_table(df, index<span style="color:#f92672">=</span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, columns<span style="color:#f92672">=</span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year,
                         values<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;value&#39;</span>, aggfunc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sum&#39;</span>)

Out[<span style="color:#ae81ff">158</span>]: 
        <span style="color:#ae81ff">2011</span>      <span style="color:#ae81ff">2012</span>      <span style="color:#ae81ff">2013</span>
<span style="color:#ae81ff">1</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">1.039268</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.968914</span>  <span style="color:#ae81ff">2.565646</span>
<span style="color:#ae81ff">2</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">0.370647</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.294524</span>  <span style="color:#ae81ff">1.431256</span>
<span style="color:#ae81ff">3</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">1.157892</span>  <span style="color:#ae81ff">0.413738</span>  <span style="color:#ae81ff">1.340309</span>
<span style="color:#ae81ff">4</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">1.344312</span>  <span style="color:#ae81ff">0.276662</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.170299</span>
<span style="color:#ae81ff">5</span>   <span style="color:#ae81ff">0.844885</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.472035</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.226169</span>
<span style="color:#ae81ff">6</span>   <span style="color:#ae81ff">1.075770</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.013960</span>  <span style="color:#ae81ff">0.410835</span>
<span style="color:#ae81ff">7</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">0.109050</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.362543</span>  <span style="color:#ae81ff">0.813850</span>
<span style="color:#ae81ff">8</span>   <span style="color:#ae81ff">1.643563</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.006154</span>  <span style="color:#ae81ff">0.132003</span>
<span style="color:#ae81ff">9</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">1.469388</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.923061</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.827317</span>
<span style="color:#ae81ff">10</span>  <span style="color:#ae81ff">0.357021</span>  <span style="color:#ae81ff">0.895717</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.076467</span>
<span style="color:#ae81ff">11</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.674600</span>  <span style="color:#ae81ff">0.805244</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.187678</span>
<span style="color:#ae81ff">12</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.776904</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.206412</span>  <span style="color:#ae81ff">1.130127</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[コードリーディング]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 1-12のみと思っていたインデックスはレコード分ありました。Yearも同じ。それぞれをunique()にして集約している。</span>
df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month
<span style="color:#f92672">&gt;</span>
Int64Index([ <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">7</span>,  <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">5</span>,
             <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">7</span>,  <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">7</span>,  <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>,
            <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
<span style="color:#f92672">&gt;</span>
df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year
<span style="color:#f92672">&gt;</span>
Int64Index([<span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2011</span>,
            <span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>,
            <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2012</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>,
            <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>, <span style="color:#ae81ff">2013</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
</code></pre></div><blockquote>
</blockquote>
<p>pivot_tableはエクセルと同様メモリを食うんだと思っていたら小さくなりました。考えてみたら変換前データを持ってないので当たり前でした。</p>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;value&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">36</span>)},
                  index<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2011-01-01&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;M&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">36</span>))
df<span style="color:#f92672">.</span>__sizeof__()
<span style="color:#ae81ff">576</span>
df_pivot <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>pivot_table(df, index<span style="color:#f92672">=</span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, columns<span style="color:#f92672">=</span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year, values<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;value&#39;</span>, aggfunc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sum&#39;</span>)
df_pivot<span style="color:#f92672">.</span>__sizeof__()
<span style="color:#ae81ff">384</span>
</code></pre></div><h2 id="apply更新">Apply(更新)</h2>
<h4 id="整理にローリング適用-埋め込みリストをmultiindexフレームに変換">整理にローリング適用-埋め込みリストをMultiIndexフレームに変換</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">159</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;A&#39;</span>: [[<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">16</span>], [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">200</span>], [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>]],
                           <span style="color:#e6db74">&#39;B&#39;</span>: [[<span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>], [<span style="color:#e6db74">&#39;jj&#39;</span>, <span style="color:#e6db74">&#39;kk&#39;</span>], [<span style="color:#e6db74">&#39;ccc&#39;</span>]]},
                           index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;I&#39;</span>, <span style="color:#e6db74">&#39;II&#39;</span>, <span style="color:#e6db74">&#39;III&#39;</span>])

In [<span style="color:#ae81ff">160</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">SeriesFromSubList</span>(aList):
              <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>Series(aList)

In [<span style="color:#ae81ff">161</span>]: df_orgz <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat({ind: row<span style="color:#f92672">.</span>apply(SeriesFromSubList)
                               <span style="color:#66d9ef">for</span> ind, row <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>iterrows()})

In [<span style="color:#ae81ff">162</span>]: df_orgz
Out[<span style="color:#ae81ff">162</span>]: 
         <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">3</span>
I   A    <span style="color:#ae81ff">2</span>    <span style="color:#ae81ff">4</span>    <span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">16.0</span>
    B    a    b    c   NaN
II  A  <span style="color:#ae81ff">100</span>  <span style="color:#ae81ff">200</span>  NaN   NaN
    B   jj   kk  NaN   NaN
III A   <span style="color:#ae81ff">10</span>   <span style="color:#ae81ff">20</span>   <span style="color:#ae81ff">30</span>   NaN
    B  ccc  NaN  NaN   NaN
</code></pre></div><blockquote>
<p><font color="crimson">**[コードリーディング]**</font></p>
</blockquote>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">A</th>
<th align="center">B</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">I</td>
<td align="center">[2, 4, 8, 16]</td>
<td align="center">[a, b, c]</td>
</tr>
<tr>
<td align="center">II</td>
<td align="center">[100, 200]</td>
<td align="center">[jj, kk]</td>
</tr>
<tr>
<td align="center">III</td>
<td align="center">[10, 20, 30]</td>
<td align="center">[ccc]</td>
</tr>
</tbody>
</table>
<blockquote>
</blockquote>
<p>作成されたデータフレームのセルにあるリストを取得して、それをpd.Seriesに変換し結合する。最大列に足らないデータはNaNが追加される。</p>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> ind, row <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>iterrows():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;ind:&#39;</span><span style="color:#f92672">+</span>str(ind))
    <span style="color:#66d9ef">print</span>(row)
    r <span style="color:#f92672">=</span> row<span style="color:#f92672">.</span>apply(SeriesFromSubList)
    <span style="color:#66d9ef">print</span>(r)
<span style="color:#f92672">&gt;</span>
ind:I
A    [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">16</span>]
B        [a, b, c]
Name: I, dtype: object
   <span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">3</span>
A  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">16.0</span>
B  a  b  c   NaN
ind:II
A    [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">200</span>]
B      [jj, kk]Name: II, dtype: object
     <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>
A <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">200</span>
B jj kk
ind:III
A [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>]
B [ccc]
Name: III, dtype: object
     <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
A <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">20.0</span> <span style="color:#ae81ff">30.0</span>
B ccc NaN NaN
</code></pre></div><h3 id="convert-the-result-converted-from-pdseries-to-a-scalar-value-again-to-pdseries-format-and-apply-the-rolling-function-to-multiple-columns">Convert the result converted from pd.Series to a scalar value again to pd.Series format and apply the rolling function to multiple columns</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">163</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">2000</span>, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">10000</span>,
                            index<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2001-01-01&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">2000</span>),
                            columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>])
In [<span style="color:#ae81ff">164</span>]: df
Out[<span style="color:#ae81ff">164</span>]:
                   A B
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000144</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000141</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">0.000161</span> <span style="color:#ae81ff">0.000102</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">0.000057</span> <span style="color:#ae81ff">0.000088</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000221</span> <span style="color:#ae81ff">0.000097</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000201</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000041</span>
<span style="color:#f92672">...</span> <span style="color:#f92672">...</span> <span style="color:#f92672">...</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">0.000040</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000235</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">20</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000123</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000021</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.000113</span> <span style="color:#ae81ff">0.000114</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">22</span> <span style="color:#ae81ff">0.000136</span> <span style="color:#ae81ff">0.000109</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span> <span style="color:#ae81ff">0.000027</span> <span style="color:#ae81ff">0.000030</span>
[<span style="color:#ae81ff">2000</span> rows x <span style="color:#ae81ff">2</span> columns]

In [<span style="color:#ae81ff">165</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gm</span>(df, const):
              v <span style="color:#f92672">=</span> ((((df[<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">+</span> df[<span style="color:#e6db74">&#39;B&#39;</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>cumprod())<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> const
              <span style="color:#66d9ef">return</span> v<span style="color:#f92672">.</span>iloc[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]


In [<span style="color:#ae81ff">166</span>]: s <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series({df<span style="color:#f92672">.</span>index[i]: gm(df<span style="color:#f92672">.</span>iloc[i:min(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">51</span>, len(df)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)], <span style="color:#ae81ff">5</span>)
                         <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(df)<span style="color:#f92672">-</span><span style="color:#ae81ff">50</span>)})

In [<span style="color:#ae81ff">167</span>]: s
Out[<span style="color:#ae81ff">167</span>]:
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0.000930</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">0.002615</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">0.001281</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span> <span style="color:#ae81ff">0.001117</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">0.002772</span>
                <span style="color:#f92672">...</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">0.003296</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0.002629</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">0.002081</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">0.004247</span>
<span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span> <span style="color:#ae81ff">0.003928</span>
Length: <span style="color:#ae81ff">1950</span>, dtype: float64
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#In this example, data is extracted every 50 days.</span>
<span style="color:#75715e"># Get the return value obtained by applying this gm function to the extraction result.</span>
<span style="color:#75715e"># Save the date and time and the return value from the beginning date and time of the target period (&#39;2001-01-1&#39; in this example) to the end date and time (2006-05-04)</span>
<span style="color:#f92672">&gt;</span>
Function of <span style="color:#75715e"># gm function: Calculate the cumulative product of (df[&#39;A&#39;]+df[&#39;B&#39;]+1) and subtract 1. Multiply the result by 5:</span>
gm(df<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:min(<span style="color:#ae81ff">0</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">51</span>, len(df)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)], <span style="color:#ae81ff">5</span>)
<span style="color:#ae81ff">0.000930</span>
</code></pre></div><h4 id="roll-on-multiple-columns-when-function-is-scalar">Roll on multiple columns when function is scalar</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">168</span>]: rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(start<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2014-01-01&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)

In [<span style="color:#ae81ff">169</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame((<span style="color:#e6db74">&#39;Open&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(len(rng)),
                             <span style="color:#e6db74">&#39;Close&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(len(rng)),
                             <span style="color:#e6db74">&#39;Volume&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2000</span>, len(rng))},
                            index<span style="color:#f92672">=</span>rng)
In [<span style="color:#ae81ff">170</span>]: df
Out[<span style="color:#ae81ff">170</span>]:
                Open Close Volume
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.611353</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.492885</span> <span style="color:#ae81ff">1219</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">3.000951</span> <span style="color:#ae81ff">0.445794</span> <span style="color:#ae81ff">1054</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.138359</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.076081</span> <span style="color:#ae81ff">1381</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span> <span style="color:#ae81ff">0.301568</span> <span style="color:#ae81ff">1.198259</span> <span style="color:#ae81ff">1253</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">0.276381</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.669831</span> <span style="color:#ae81ff">1728</span>
<span style="color:#f92672">...</span> <span style="color:#f92672">...</span> <span style="color:#f92672">...</span> <span style="color:#f92672">...</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.040338</span> <span style="color:#ae81ff">0.937843</span> <span style="color:#ae81ff">1188</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">0.359661</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.285908</span> <span style="color:#ae81ff">1864</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">0.060978</span> <span style="color:#ae81ff">1.714814</span> <span style="color:#ae81ff">941</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">1.759055</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.455942</span> <span style="color:#ae81ff">1065</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0.138185</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.147008</span> <span style="color:#ae81ff">1453</span>
[<span style="color:#ae81ff">100</span> rows x <span style="color:#ae81ff">3</span> columns]

In [<span style="color:#ae81ff">171</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">vwap</span>(bars):
              <span style="color:#66d9ef">return</span> ((bars<span style="color:#f92672">.</span>Close <span style="color:#f92672">*</span> bars<span style="color:#f92672">.</span>Volume)<span style="color:#f92672">.</span>sum() <span style="color:#f92672">/</span> bars<span style="color:#f92672">.</span>Volume<span style="color:#f92672">.</span>sum())
 

In [<span style="color:#ae81ff">172</span>]: window <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>

In [<span style="color:#ae81ff">173</span>]: s <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([(pd<span style="color:#f92672">.</span>Series(vwap(df<span style="color:#f92672">.</span>iloc[i:i <span style="color:#f92672">+</span> window]),
                          index<span style="color:#f92672">=</span>[df<span style="color:#f92672">.</span>index[i <span style="color:#f92672">+</span> window]]))
                         <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(df)<span style="color:#f92672">-</span>window)])

In [<span style="color:#ae81ff">174</span>]: s<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">2</span>)
Out[<span style="color:#ae81ff">174</span>]:
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span> <span style="color:#ae81ff">0.02</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">0.11</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">0.10</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">0.07</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.29</span>
              <span style="color:#f92672">...</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.63</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.02</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.03</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">0.34</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0.29</span>
Length: <span style="color:#ae81ff">95</span>, dtype: float64
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<ul>
<li>Apply the vmap function to the data aggregated with the window value of 5 (5 day unit) and obtain the result.</li>
<li>Add window value 5 to the start date as the aggregation period date and create the aggregation period date and the resulting data frame.</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[(pd<span style="color:#f92672">.</span>Series(vwap(df<span style="color:#f92672">.</span>iloc[i:i <span style="color:#f92672">+</span> window]),index<span style="color:#f92672">=</span>[df<span style="color:#f92672">.</span>index[i <span style="color:#f92672">+</span> window]])) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(df)<span style="color:#f92672">-</span>window)]
<span style="color:#75715e"># When the content of the function is decomposed and viewed with the first interval i=0, it is as follows.</span>
tmp <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">0</span> <span style="color:#f92672">+</span> window]
(tmp<span style="color:#f92672">.</span>Close<span style="color:#f92672">*</span>tmp<span style="color:#f92672">.</span>Volume)<span style="color:#f92672">.</span>sum()
tmp<span style="color:#f92672">.</span>Volume<span style="color:#f92672">.</span>sum()
(tmp<span style="color:#f92672">.</span>Close<span style="color:#f92672">*</span>tmp<span style="color:#f92672">.</span>Volume)<span style="color:#f92672">.</span>sum() <span style="color:#f92672">/</span> tmp<span style="color:#f92672">.</span>Volume<span style="color:#f92672">.</span>sum()
<span style="color:#ae81ff">0.02</span>
</code></pre></div><hr>
<h1 id="timeseries-clipboard">Timeseries: clipboard:</h1>
<h3 id="time-period">time period</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># indexer_between_time(start, end)</span>
rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;1/1/2000&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;H&#39;</span>)
ts <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(len(rng)), index<span style="color:#f92672">=</span>rng)
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1.298558</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.333122</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.034170</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2.396508</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">04</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.608591</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1.710535</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">06</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.657193</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">07</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.166563</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">08</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1.768663</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1.395805</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.111062</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.840320</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.129081</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.604446</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.257967</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.384715</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">16</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.185482</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">17</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">2.222229</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">18</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.917695</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">19</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2.158507</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.487902</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.667997</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.202186</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.710070</span>
Freq: H, dtype: float64
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># When extracting from 10:00 to 14:00</span>
ts<span style="color:#f92672">.</span>iloc[ts<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>indexer_between_time(datetime<span style="color:#f92672">.</span>time(<span style="color:#ae81ff">10</span>), datetime<span style="color:#f92672">.</span>time(<span style="color:#ae81ff">14</span>))]
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.111062</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.840320</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.129081</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.604446</span>
<span style="color:#ae81ff">2000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.257967</span>
Freq: H, dtype: float64
</code></pre></div><p>About time series masks based on ### index: clipboard:</p>
<pre><code class="language-pythonindex" data-lang="pythonindex">data = pd.DataFrame(data=[1,2,3,4,5,6,7,8,9,0], columns=['value'], index=index)
data
value
2013-01-01 00:00:00 1
2013-01-01 00:15:00 2
2013-01-01 00:30:00 3
2013-01-01 00:45:00 4
2013-01-01 01:00:00 5
2013-01-01 01:15:00 6
2013-01-01 01:30:00 7
2013-01-01 01:45:00 8
2013-01-01 02:00:00 9
2013-01-01 02:15:00 0

data.index.indexer_between_time('01:15', '02:00')
array([5, 6, 7, 8])

data.iloc[data.index.indexer_between_time('1:15', '02:00')]
013-01-01 01:15:00 6
2013-01-01 01:30:00 7
2013-01-01 01:45:00 8
2013-01-01 02:00:00 9
</code></pre><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Reverse the time specification to extract the excluded period.</span>
data<span style="color:#f92672">.</span>iloc[data<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>indexer_between_time(<span style="color:#e6db74">&#39;02:00&#39;</span>, <span style="color:#e6db74">&#39;1:15&#39;</span>)]
value
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">45</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">6</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">9</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0</span>
</code></pre></div><h3 id="create-a-date-and-time-range-that-excludes-weekends-and-includes-only-certain-times-clipboard">Create a date and time range that excludes weekends and includes only certain times: clipboard:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;20130101 09:00&#39;</span>,<span style="color:#e6db74">&#39;20130110 16:00&#39;</span>,freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;30T&#39;</span>)

DatetimeIndex([<span style="color:#e6db74">&#39;2013-01-01 09:00:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 09:30:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 10:00:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 10:30:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 11:00:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 11:30:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 12:00:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 12:30:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 13:00:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 13:30:00&#39;</span>,
               <span style="color:#f92672">...</span>
               <span style="color:#e6db74">&#39;2013-01-10 11:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 12:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 12:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 13:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 13:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 14:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 14:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 15:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 15:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 16:00:00&#39;</span>],
              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">447</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;30T&#39;</span>)

<span style="color:#75715e"># Excludes unnecessary time</span>
rng <span style="color:#f92672">=</span> rng<span style="color:#f92672">.</span>take(rng<span style="color:#f92672">.</span>indexer_between_time(<span style="color:#e6db74">&#39;09:30&#39;</span>,<span style="color:#e6db74">&#39;16:00&#39;</span>))

DatetimeIndex([<span style="color:#e6db74">&#39;2013-01-01 09:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 10:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 10:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 11:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 11:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 12:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 12:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 13:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 13:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 14:00:00&#39;</span>,
               <span style="color:#f92672">...</span>
               <span style="color:#e6db74">&#39;2013-01-10 11:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 12:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 12:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 13:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 13:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 14:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 14:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 15:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 15:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 16:00:00&#39;</span>],
              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">140</span>, freq<span style="color:#f92672">=</span>None)

<span style="color:#75715e">#Weekdays only</span>
rng <span style="color:#f92672">=</span> rng[rng<span style="color:#f92672">.</span>weekday<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span>]
DatetimeIndex([<span style="color:#e6db74">&#39;2013-01-01 09:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 10:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 10:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 11:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 11:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 12:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 12:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 13:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-01 13:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01 14:00:00&#39;</span>,
               <span style="color:#f92672">...</span>
               <span style="color:#e6db74">&#39;2013-01-10 11:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 12:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 12:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 13:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 13:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 14:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 14:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 15:00:00&#39;</span>,
               <span style="color:#e6db74">&#39;2013-01-10 15:30:00&#39;</span>, <span style="color:#e6db74">&#39;2013-01-10 16:00:00&#39;</span>],
              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">112</span>, freq<span style="color:#f92672">=</span>None)
</code></pre></div><h3 id="look-up-matrix-in-data-frame">Look up matrix in data frame</h3>
<p>The following code changes some numerical values from stackoverflow.com.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">date_item <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_datetime((<span style="color:#e6db74">&#39;2019/1/4&#39;</span>,<span style="color:#e6db74">&#39;2019/1/7&#39;</span>,<span style="color:#e6db74">&#39;2019/1/7&#39;</span>,<span style="color:#e6db74">&#39;2019/1/8&#39;</span>,<span style="color:#e6db74">&#39;2019/1/9&#39;</span>,<span style="color:#e6db74">&#39;2019/ 1/10&#39;</span>,<span style="color:#e6db74">&#39;2019/1/10&#39;</span>,<span style="color:#e6db74">&#39;2019/1/11&#39;</span>,<span style="color:#e6db74">&#39;2019/1/15&#39;</span>,<span style="color:#e6db74">&#39;2019/1/16&#39;</span>,<span style="color:#e6db74">&#39;2019/1/16&#39;</span>,<span style="color:#e6db74">&#39;2019/1/ 17&#39;</span>,<span style="color:#e6db74">&#39;2019/1/18&#39;</span>])

DatetimeIndex([<span style="color:#e6db74">&#39;2019-01-04&#39;</span>, <span style="color:#e6db74">&#39;2019-01-07&#39;</span>, <span style="color:#e6db74">&#39;2019-01-07&#39;</span>, <span style="color:#e6db74">&#39;2019-01-08&#39;</span>,
               <span style="color:#e6db74">&#39;2019-01-09&#39;</span>, <span style="color:#e6db74">&#39;2019-01-10&#39;</span>, <span style="color:#e6db74">&#39;2019-01-10&#39;</span>, <span style="color:#e6db74">&#39;2019-01-11&#39;</span>,
               <span style="color:#e6db74">&#39;2019-01-15&#39;</span>, <span style="color:#e6db74">&#39;2019-01-16&#39;</span>, <span style="color:#e6db74">&#39;2019-01-16&#39;</span>, <span style="color:#e6db74">&#39;2019-01-17&#39;</span>,
               <span style="color:#e6db74">&#39;2019-01-18&#39;</span>],
              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, freq<span style="color:#f92672">=</span>None)

orders <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Date&#39;</span>:date_item,
                      <span style="color:#e6db74">&#39;by&#39;</span>:[<span style="color:#e6db74">&#39;buy&#39;</span>,<span style="color:#e6db74">&#39;buy&#39;</span>,<span style="color:#e6db74">&#39;sell&#39;</span>,<span style="color:#e6db74">&#39;buy&#39;</span>,<span style="color:#e6db74">&#39;sell&#39;</span>,<span style="color:#e6db74">&#39;buy&#39;</span>,<span style="color:#e6db74">&#39;buy&#39;</span>,<span style="color:#e6db74">&#39;sell&#39;</span>,<span style="color:#e6db74">&#39;buy&#39;</span>,<span style="color:#e6db74">&#39;sell&#39;</span>,<span style="color:#e6db74">&#39;buy&#39;</span>,<span style="color:#e6db74">&#39; sell&#39;</span>,<span style="color:#e6db74">&#39;buy&#39;</span>],
                      <span style="color:#e6db74">&#39;cnt&#39;</span>:[<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">100</span>],
                      <span style="color:#e6db74">&#39;code&#39;</span>:[<span style="color:#e6db74">&#39;1720&#39;</span>,<span style="color:#e6db74">&#39;8086&#39;</span>,<span style="color:#e6db74">&#39;4967&#39;</span>,<span style="color:#e6db74">&#39;8086&#39;</span>,<span style="color:#e6db74">&#39;8086&#39;</span>,<span style="color:#e6db74">&#39;4967&#39;</span>,<span style="color:#e6db74">&#39;1720&#39;</span>,<span style="color:#e6db74">&#39;4967&#39;</span>,<span style="color:#e6db74">&#39;1720&#39;</span>,<span style="color:#e6db74">&#39;1720&#39;</span>,<span style="color:#e6db74">&#39;8086&#39;</span>,<span style="color:#e6db74">&#39; 4967&#39;</span>,<span style="color:#e6db74">&#39;8086&#39;</span>],
                      <span style="color:#e6db74">&#39;prices&#39;</span>:[<span style="color:#ae81ff">1008</span>, <span style="color:#ae81ff">1344</span>, <span style="color:#ae81ff">7530</span>, <span style="color:#ae81ff">1347</span>, <span style="color:#ae81ff">1373</span>, <span style="color:#ae81ff">7120</span>, <span style="color:#ae81ff">1008</span>, <span style="color:#ae81ff">7120</span>, <span style="color:#ae81ff">995</span>, <span style="color:#ae81ff">986</span>, <span style="color:#ae81ff">1417</span>, <span style="color:#ae81ff">6990</span>, <span style="color:#ae81ff">1445</span>]})
</code></pre></div><p>Prices</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">1720</th>
<th align="center">8086</th>
<th align="center">4967</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>2019-01-04</strong></td>
<td align="center">1008</td>
<td align="center">1311</td>
<td align="center">7370</td>
</tr>
<tr>
<td align="center"><strong>2019-01-07</strong></td>
<td align="center">1033</td>
<td align="center">1344</td>
<td align="center">7530</td>
</tr>
<tr>
<td align="center"><strong>2019-01-08</strong></td>
<td align="center">1025</td>
<td align="center">1347</td>
<td align="center">7130</td>
</tr>
<tr>
<td align="center"><strong>2019-01-09</strong></td>
<td align="center">1034</td>
<td align="center">1373</td>
<td align="center">7460</td>
</tr>
<tr>
<td align="center"><strong>2019-01-10</strong></td>
<td align="center">1008</td>
<td align="center">1364</td>
<td align="center">7120</td>
</tr>
<tr>
<td align="center"><strong>2019-01-11</strong></td>
<td align="center">1000</td>
<td align="center">1391</td>
<td align="center">7030</td>
</tr>
<tr>
<td align="center"><strong>2019-01-15</strong></td>
<td align="center">995</td>
<td align="center">1400</td>
<td align="center">6950</td>
</tr>
<tr>
<td align="center"><strong>2019-01-16</strong></td>
<td align="center">986</td>
<td align="center">1417</td>
<td align="center">6920</td>
</tr>
<tr>
<td align="center"><strong>2019-01-17</strong></td>
<td align="center">1002</td>
<td align="center">1419</td>
<td align="center">6990</td>
</tr>
<tr>
<td align="center"><strong>2019-01-18</strong></td>
<td align="center">1010</td>
<td align="center">1445</td>
<td align="center">7050</td>
</tr>
</tbody>
</table>
<p>Orders</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="center">Date</th>
<th align="center">by</th>
<th align="right">cnt</th>
<th align="center">code</th>
<th align="right">prices</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0</td>
<td align="center">2019-01-04</td>
<td align="center">buy</td>
<td align="right">100</td>
<td align="center">1720</td>
<td align="right">1008</td>
</tr>
<tr>
<td align="left">1</td>
<td align="center">2019-01-07</td>
<td align="center">buy</td>
<td align="right">200</td>
<td align="center">8086</td>
<td align="right">1344</td>
</tr>
<tr>
<td align="left">2</td>
<td align="center">2019-01-07</td>
<td align="center">sell</td>
<td align="right">100</td>
<td align="center">4967</td>
<td align="right">7530</td>
</tr>
<tr>
<td align="left">3</td>
<td align="center">2019-01-08</td>
<td align="center">buy</td>
<td align="right">50</td>
<td align="center">8086</td>
<td align="right">1347</td>
</tr>
<tr>
<td align="left">4</td>
<td align="center">2019-01-09</td>
<td align="center">sell</td>
<td align="right">100</td>
<td align="center">8086</td>
<td align="right">1373</td>
</tr>
<tr>
<td align="left">6</td>
<td align="center">2019-01-10</td>
<td align="center">buy</td>
<td align="right">200</td>
<td align="center">1720</td>
<td align="right">1008</td>
</tr>
<tr>
<td align="left">7</td>
<td align="center">2019-01-11</td>
<td align="center">sell</td>
<td align="right">50</td>
<td align="center">4967</td>
<td align="right">7120</td>
</tr>
<tr>
<td align="left">8</td>
<td align="center">2019-01-15</td>
<td align="center">buy</td>
<td align="right">100</td>
<td align="center">1720</td>
<td align="right">995</td>
</tr>
<tr>
<td align="left">9</td>
<td align="center">2019-01-16</td>
<td align="center">sell</td>
<td align="right">50</td>
<td align="center">1720</td>
<td align="right">986</td>
</tr>
<tr>
<td align="left">10</td>
<td align="center">2019-01-16</td>
<td align="center">buy</td>
<td align="right">50</td>
<td align="center">8086</td>
<td align="right">1417</td>
</tr>
<tr>
<td align="left">11</td>
<td align="center">2019-01-17</td>
<td align="center">sell</td>
<td align="right">50</td>
<td align="center">4967</td>
<td align="right">6990</td>
</tr>
<tr>
<td align="left">12</td>
<td align="center">2019-01-18</td>
<td align="center">buy</td>
<td align="right">100</td>
<td align="center">8086</td>
<td align="right">1445</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">lookup(row_labels, col_labels)
prices<span style="color:#f92672">.</span>lookup(orders<span style="color:#f92672">.</span>Date, orders<span style="color:#f92672">.</span>code)
array([<span style="color:#ae81ff">1008</span>, <span style="color:#ae81ff">1344</span>, <span style="color:#ae81ff">7530</span>, <span style="color:#ae81ff">1347</span>, <span style="color:#ae81ff">1373</span>, <span style="color:#ae81ff">7120</span>, <span style="color:#ae81ff">1008</span>, <span style="color:#ae81ff">7030</span>, <span style="color:#ae81ff">995</span>, <span style="color:#ae81ff">986</span>, <span style="color:#ae81ff">1417</span>,
       <span style="color:#ae81ff">6990</span>, <span style="color:#ae81ff">1445</span>])
</code></pre></div><h3 id="converts-a-data-frame-with-columns-in-hours-and-rows-in-days-into-a-continuous-sequence-of-rows-in-chronological-format-clipboard">Converts a data frame with columns in hours and rows in days into a continuous sequence of rows in chronological format. :clipboard:</h3>
<p>The following code changes some numerical values from the content posted on stackoverflow.com.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Date&#39;</span>:[<span style="color:#e6db74">&#39;2020-01-01&#39;</span>, <span style="color:#e6db74">&#39;2020-01-02&#39;</span>],<span style="color:#e6db74">&#39;h1&#39;</span>:[<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">45</span>],<span style="color:#e6db74">&#39;h2&#39;</span>:[<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">17</span>],<span style="color:#e6db74">&#39; h3&#39;</span>:[<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">16</span>],<span style="color:#e6db74">&#39;h4&#39;</span>:[<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">31</span>],<span style="color:#e6db74">&#39;h24&#39;</span>:[<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">55</span>]})

Date h1 h2 h3 h4 h24
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">18</span> <span style="color:#ae81ff">11</span> <span style="color:#ae81ff">29</span> <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">45</span> <span style="color:#ae81ff">17</span> <span style="color:#ae81ff">16</span> <span style="color:#ae81ff">31</span> <span style="color:#ae81ff">55</span>

<span style="color:#75715e"># Convert to the following format</span>
Date value
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">23</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">18</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">29</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">17</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">16</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">31</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">55</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Convert from horizontal to vertical</span>
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>melt(df, id_vars<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Date&#39;</span>])
<span style="color:#f92672">&gt;</span>
Date variable value
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h1 <span style="color:#ae81ff">23</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h1 <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h2 <span style="color:#ae81ff">18</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h2 <span style="color:#ae81ff">17</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h3 <span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h3 <span style="color:#ae81ff">16</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h4 <span style="color:#ae81ff">29</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h4 <span style="color:#ae81ff">31</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h24 <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h24 <span style="color:#ae81ff">55</span>
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Change column name</span>
df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;variable&#39;</span>:<span style="color:#e6db74">&#39;hour&#39;</span>})
<span style="color:#f92672">&gt;</span>
Date hour value
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h1 <span style="color:#ae81ff">23</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h1 <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h2 <span style="color:#ae81ff">18</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h2 <span style="color:#ae81ff">17</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h3 <span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h3 <span style="color:#ae81ff">16</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h4 <span style="color:#ae81ff">29</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h4 <span style="color:#ae81ff">31</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> h24 <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> h24 <span style="color:#ae81ff">55</span>
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Remove<span style="color:#e6db74">&#39;h&#39;</span> <span style="color:#f92672">in</span> <span style="color:#75715e">#hour column</span>
df[<span style="color:#e6db74">&#39;hour&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;hour&#39;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: int(x<span style="color:#f92672">.</span>lstrip(<span style="color:#e6db74">&#39;h&#39;</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
<span style="color:#f92672">&gt;</span>
Date hour value
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">23</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">18</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">17</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">16</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">29</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">31</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">55</span>
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Create column data combining day and time</span>
combined <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: pd<span style="color:#f92672">.</span>to_datetime(x[<span style="color:#e6db74">&#39;Date&#39;</span>], dayfirst<span style="color:#f92672">=</span>True) <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(hours<span style="color:#f92672">=</span>int(x[<span style="color:#e6db74">&#39;hour&#39;</span>])), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>
dtype: datetime64[ns]
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Replace&#39;Date&#39; column data</span>
df[<span style="color:#e6db74">&#39;Date&#39;</span>] <span style="color:#f92672">=</span> combined
Date hour value
 <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">23</span>
 <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">45</span>
 <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">18</span>
 <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">17</span>
 <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">11</span>
 <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">16</span>
 <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">29</span>
 <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">31</span>
 <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">45</span>
 <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">55</span>
</code></pre></div><blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#&#39;hour&#39; column deleted</span>
<span style="color:#66d9ef">del</span> df[<span style="color:#e6db74">&#39;hour&#39;</span>]
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e">#Sort by date</span>
df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;Date&#34;</span>)
<span style="color:#f92672">&gt;</span>
Date value
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">23</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">18</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">29</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">45</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">17</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">16</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">31</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">55</span>
</code></pre></div><h3 id="handling-duplicates-when-reindexing-a-time-series-to-a-certain-frequency-clipboard">Handling duplicates when reindexing a time series to a certain frequency: clipboard:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#A Time series data creation (date + millisecond [dummy data]) -&gt; 100 records</span>
intervals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1000</span>,size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)<span style="color:#f92672">.</span>cumsum()
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame((<span style="color:#e6db74">&#39;time&#39;</span>:[pd<span style="color:#f92672">.</span>Timestamp(<span style="color:#e6db74">&#39;20140101&#39;</span>) <span style="color:#f92672">+</span> pd<span style="color:#f92672">.</span>offsets<span style="color:#f92672">.</span>Milli(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> intervals ],
                <span style="color:#e6db74">&#39;value&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(len(intervals))})

<span style="color:#75715e"># df</span>
time value
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.499</span> <span style="color:#ae81ff">0.567731</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.232</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.751466</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.238</span> <span style="color:#ae81ff">1.250118</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.533</span> <span style="color:#ae81ff">0.588161</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02.210</span> <span style="color:#ae81ff">0.996543</span>
<span style="color:#f92672">...</span> <span style="color:#f92672">...</span> <span style="color:#f92672">...</span>
<span style="color:#ae81ff">95</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">49.216</span> <span style="color:#ae81ff">0.753233</span>
<span style="color:#ae81ff">96</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">49.719</span> <span style="color:#ae81ff">0.849922</span>
<span style="color:#ae81ff">97</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">49.732</span> <span style="color:#ae81ff">1.171001</span>
<span style="color:#ae81ff">98</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">50.723</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.443835</span>
<span style="color:#ae81ff">99</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">51.389</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.830960</span>
<span style="color:#ae81ff">100</span> rows <span style="color:#960050;background-color:#1e0010">×</span> <span style="color:#ae81ff">2</span> columns

<span style="color:#75715e">#B Time-series data index (date and time + 1 minute unit) -&gt; 3601</span>
pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;20140101 00:00:00&#39;</span>,<span style="color:#e6db74">&#39;20140101 01:00:00&#39;</span>,freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;s&#39;</span>)

DatetimeIndex([<span style="color:#e6db74">&#39;2014-01-01 00:00:00&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:00:01&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:00:02&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:00:03&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:00:04&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:00:05&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:00:06&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:00:07&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:00:08&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:00:09&#39;</span>,
               <span style="color:#f92672">...</span>
               <span style="color:#e6db74">&#39;2014-01-01 00:59:51&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:59:52&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:59:53&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:59:54&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:59:55&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:59:56&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:59:57&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 00:59:58&#39;</span>,
               <span style="color:#e6db74">&#39;2014-01-01 00:59:59&#39;</span>, <span style="color:#e6db74">&#39;2014-01-01 01:00:00&#39;</span>],
              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>, length<span style="color:#f92672">=</span><span style="color:#ae81ff">3601</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;S&#39;</span>)

<span style="color:#75715e">#Result</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.000</span> NaN
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.499</span> <span style="color:#ae81ff">0.567731</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.000</span> <span style="color:#ae81ff">0.567731</span> <span style="color:#f92672">&lt;-</span> Originally NaN
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.232</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.751466</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.238</span> <span style="color:#ae81ff">1.250118</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.533</span> <span style="color:#ae81ff">0.588161</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02.000</span> <span style="color:#ae81ff">0.588161</span> <span style="color:#f92672">&lt;-</span> Originally NaN
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02.210</span> <span style="color:#ae81ff">0.996543</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02.652</span> <span style="color:#ae81ff">0.322535</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03.000</span> <span style="color:#ae81ff">0.322535</span> <span style="color:#f92672">&lt;-</span> Originally NaN
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font>* Although it is a very confusing heading, the point is to add another B time series (both of which are in the same time axis) to A time series data, and use ffill( It is a technique to fill in the numbers with ).</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">intervals
<span style="color:#f92672">&gt;</span>
array([ <span style="color:#ae81ff">499</span>, <span style="color:#ae81ff">1232</span>, <span style="color:#ae81ff">1238</span>, <span style="color:#ae81ff">1533</span>, <span style="color:#ae81ff">2210</span>, <span style="color:#ae81ff">2652</span>, <span style="color:#ae81ff">3512</span>, <span style="color:#ae81ff">3598</span>, <span style="color:#ae81ff">3663</span>,
        <span style="color:#ae81ff">3688</span>, <span style="color:#ae81ff">3758</span>, <span style="color:#ae81ff">3969</span>, <span style="color:#ae81ff">4960</span>, <span style="color:#ae81ff">5933</span>, <span style="color:#ae81ff">6211</span>, <span style="color:#ae81ff">7040</span>, <span style="color:#ae81ff">7763</span>, <span style="color:#ae81ff">8331</span>,
        <span style="color:#ae81ff">9329</span>, <span style="color:#ae81ff">10229</span>, <span style="color:#ae81ff">10436</span>, <span style="color:#ae81ff">10671</span>, <span style="color:#ae81ff">10727</span>, <span style="color:#ae81ff">11695</span>, <span style="color:#ae81ff">12249</span>, <span style="color:#ae81ff">13033</span>, <span style="color:#ae81ff">13867</span>,
       <span style="color:#ae81ff">13895</span>, <span style="color:#ae81ff">14809</span>, <span style="color:#ae81ff">15069</span>, <span style="color:#ae81ff">16022</span>, <span style="color:#ae81ff">16484</span>, <span style="color:#ae81ff">16597</span>, <span style="color:#ae81ff">17044</span>, <span style="color:#ae81ff">17060</span>, <span style="color:#ae81ff">17344</span>,
       <span style="color:#ae81ff">18124</span>, <span style="color:#ae81ff">18629</span>, <span style="color:#ae81ff">19256</span>, <span style="color:#ae81ff">20022</span>, <span style="color:#ae81ff">20620</span>, <span style="color:#ae81ff">21080</span>, <span style="color:#ae81ff">21148</span>, <span style="color:#ae81ff">21603</span>, <span style="color:#ae81ff">22164</span>,
       <span style="color:#ae81ff">22872</span>, <span style="color:#ae81ff">23075</span>, <span style="color:#ae81ff">23566</span>, <span style="color:#ae81ff">24133</span>, <span style="color:#ae81ff">24887</span>, <span style="color:#ae81ff">24996</span>, <span style="color:#ae81ff">25132</span>, <span style="color:#ae81ff">25435</span>, <span style="color:#ae81ff">26047</span>,
       <span style="color:#ae81ff">26287</span>, <span style="color:#ae81ff">27168</span>, <span style="color:#ae81ff">27228</span>, <span style="color:#ae81ff">28129</span>, <span style="color:#ae81ff">29118</span>, <span style="color:#ae81ff">29539</span>, <span style="color:#ae81ff">30339</span>, <span style="color:#ae81ff">30465</span>, <span style="color:#ae81ff">31396</span>,
       <span style="color:#ae81ff">31805</span>, <span style="color:#ae81ff">32583</span>, <span style="color:#ae81ff">33021</span>, <span style="color:#ae81ff">33854</span>, <span style="color:#ae81ff">34439</span>, <span style="color:#ae81ff">34865</span>, <span style="color:#ae81ff">35207</span>, <span style="color:#ae81ff">35212</span>, <span style="color:#ae81ff">35345</span>,
       <span style="color:#ae81ff">35865</span>, <span style="color:#ae81ff">36586</span>, <span style="color:#ae81ff">37325</span>, <span style="color:#ae81ff">37422</span>, <span style="color:#ae81ff">38411</span>, <span style="color:#ae81ff">38986</span>, <span style="color:#ae81ff">39227</span>, <span style="color:#ae81ff">39768</span>, <span style="color:#ae81ff">40316</span>,
       <span style="color:#ae81ff">41254</span>, <span style="color:#ae81ff">42162</span>, <span style="color:#ae81ff">42476</span>, <span style="color:#ae81ff">43155</span>, <span style="color:#ae81ff">43971</span>, <span style="color:#ae81ff">44791</span>, <span style="color:#ae81ff">44899</span>, <span style="color:#ae81ff">45770</span>, <span style="color:#ae81ff">46701</span>,
       <span style="color:#ae81ff">47568</span>, <span style="color:#ae81ff">47901</span>, <span style="color:#ae81ff">48242</span>, <span style="color:#ae81ff">48720</span>, <span style="color:#ae81ff">48940</span>, <span style="color:#ae81ff">49216</span>, <span style="color:#ae81ff">49719</span>, <span style="color:#ae81ff">49732</span>, <span style="color:#ae81ff">50723</span>,
       <span style="color:#ae81ff">51389</span>])
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># Create B time series and combine with A time series index</span>
rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;20140101 00:00:00&#39;</span>,<span style="color:#e6db74">&#39;20140101 01:00:00&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;s&#39;</span>)
new_range <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DatetimeIndex(np<span style="color:#f92672">.</span>append(rng, pd<span style="color:#f92672">.</span>Index(df<span style="color:#f92672">.</span>time)))
</code></pre></div><blockquote>
</blockquote>
<ul>
<li>In the posted content on stackoverflow.com, it is an A time series + B time series, but it will be an error.</li>
<li>I checked and it was possible with DatetimeIndex(np.append(A,B)).</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#A time series + B time series remain, so sort by time series</span>
new_range <span style="color:#f92672">=</span> new_range<span style="color:#f92672">.</span>sort_values()
Change to a new index <span style="color:#66d9ef">with</span> <span style="color:#75715e">#&#39;time&#39; as the index</span>
df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;time&#39;</span>)<span style="color:#f92672">.</span>reindex(new_range)<span style="color:#f92672">.</span>head()
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.000</span> NaN
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.499</span> <span style="color:#ae81ff">0.567731</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.000</span> NaN
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.232</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.751466</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.238</span> <span style="color:#ae81ff">1.250118</span>
<span style="color:#f92672">&gt;</span>
Update the value <span style="color:#66d9ef">with</span> <span style="color:#75715e">#ffill()</span>
df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;time&#39;</span>)<span style="color:#f92672">.</span>reindex(new_range)<span style="color:#f92672">.</span>ffill()<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">10</span>)
<span style="color:#f92672">&gt;</span>
value
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.000</span> NaN
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00.499</span> <span style="color:#ae81ff">0.567731</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.000</span> <span style="color:#ae81ff">0.567731</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.232</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.751466</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.238</span> <span style="color:#ae81ff">1.250118</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01.533</span> <span style="color:#ae81ff">0.588161</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02.000</span> <span style="color:#ae81ff">0.588161</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02.210</span> <span style="color:#ae81ff">0.996543</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02.652</span> <span style="color:#ae81ff">0.322535</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03.000</span> <span style="color:#ae81ff">0.322535</span>
</code></pre></div><h2 id="resampling">Resampling</h2>
<h4 id="how-do-i-divide-a-single-value-in-a-data-frame-by-the-monthly-average-clipboardthumbsup">How do I divide a single value in a data frame by the monthly average? :clipboard::thumbsup:</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">1000</span>, <span style="color:#ae81ff">1200</span>, (<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">1</span>)), columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;value&#39;</span>],
                  index <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2014-01-01 00:15:00&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;15min&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>))

df
value
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1122</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1132</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">45</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1091</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1188</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1156</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1089</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">45</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1148</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1040</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1010</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1130</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">45</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1178</span>
 <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1186</span>

df[<span style="color:#e6db74">&#39;normed&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(grouper)<span style="color:#f92672">.</span>transform(<span style="color:#66d9ef">lambda</span> x: x <span style="color:#f92672">/</span> x<span style="color:#f92672">.</span>mean())

df
value normed
Date
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1122</span> <span style="color:#ae81ff">0.999555</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1132</span> <span style="color:#ae81ff">1.008463</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">45</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1091</span> <span style="color:#ae81ff">0.971938</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1188</span> <span style="color:#ae81ff">1.058352</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1156</span> <span style="color:#ae81ff">1.029844</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1089</span> <span style="color:#ae81ff">0.970156</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">45</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1148</span> <span style="color:#ae81ff">1.022717</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1040</span> <span style="color:#ae81ff">0.926503</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1010</span> <span style="color:#ae81ff">0.899777</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1130</span> <span style="color:#ae81ff">1.006682</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">45</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1178</span> <span style="color:#ae81ff">1.049443</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1186</span> <span style="color:#ae81ff">1.056570</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Date&#39;</span>
<span style="color:#75715e"># Use Grouper to group by a specific cycle or interval. In this case, it is one month, so set `freq=&#39;M&#39;`.</span>
grouper <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Grouper(level<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;M&#39;</span>)
<span style="color:#f92672">&gt;</span>
If you refer to the contents of grouper <span style="color:#66d9ef">with</span> the <span style="color:#75715e">#groups property, you can see that it is a month unit on the last day.</span>
df<span style="color:#f92672">.</span>groupby(grouper)<span style="color:#f92672">.</span>groups
{Timestamp(<span style="color:#e6db74">&#39;2014-01-31 00:00:00&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;M&#39;</span>): <span style="color:#ae81ff">12</span>}
<span style="color:#f92672">&gt;</span>
A method that can be easily requested without using <span style="color:#75715e"># grouper is posted. This is convenient!</span>
df<span style="color:#f92672">.</span>groupby([df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year, df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month])<span style="color:#f92672">.</span>transform(<span style="color:#66d9ef">lambda</span> x: x<span style="color:#f92672">/</span>x<span style="color:#f92672">.</span>mean())
</code></pre></div><h4 id="grouping-with-multiindex-clipboard">Grouping with MultiIndex: clipboard:</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">36</span>, list(pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;1/1/2011&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">36</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;H&#39;</span>)), list(np<span style="color:#f92672">.</span> random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">36</span>))], index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Group&#39;</span>,<span style="color:#e6db74">&#39;Time&#39;</span>,<span style="color:#e6db74">&#39;Value&#39;</span>])<span style="color:#f92672">.</span>T,
                  pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#e6db74">&#39;B&#39;</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">36</span>, list(pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;1/1/2011&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">36</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;H&#39;</span>)), list(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">36</span>)) ], index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Group&#39;</span>,<span style="color:#e6db74">&#39;Time&#39;</span>,<span style="color:#e6db74">&#39;Value&#39;</span>])<span style="color:#f92672">.</span>T,
                  pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#e6db74">&#39;C&#39;</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">36</span>, list(pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;1/1/2011&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">36</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;H&#39;</span>)), list(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">36</span>)) ], index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Group&#39;</span>,<span style="color:#e6db74">&#39;Time&#39;</span>,<span style="color:#e6db74">&#39;Value&#39;</span>])<span style="color:#f92672">.</span>T],
                  axis <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>set_index([<span style="color:#e6db74">&#39;Group&#39;</span>,<span style="color:#e6db74">&#39;Time&#39;</span>])

data

Value
Group Time
A <span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.306533</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.653431</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.0284997</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.852406</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">04</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.856705</span>
<span style="color:#f92672">...</span> <span style="color:#f92672">...</span> <span style="color:#f92672">...</span>
C <span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">07</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.607041</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">08</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.291705</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">09</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.480091</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.890153</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">11</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.628454</span>
<span style="color:#ae81ff">108</span> rows <span style="color:#960050;background-color:#1e0010">×</span> <span style="color:#ae81ff">1</span> columns

<span style="color:#75715e">#Result</span>
Time Group
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> A <span style="color:#ae81ff">0.497803</span>
            B <span style="color:#ae81ff">0.524934</span>
            C <span style="color:#ae81ff">0.566736</span>
<span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> A <span style="color:#ae81ff">0.442884</span>
            B <span style="color:#ae81ff">0.452267</span>
            C <span style="color:#ae81ff">0.632567</span>
Name: Value, dtype: float64
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data[<span style="color:#e6db74">&#39;Value&#39;</span>] <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;Value&#39;</span>]<span style="color:#f92672">.</span>astype(float)
<span style="color:#75715e"># Two Keys (Grouper A: Daily, Grouper B:&#39;Group&#39;) are grouped and averaged.</span>
daily_counts <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>groupby([pd<span style="color:#f92672">.</span>Grouper(freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>, level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Time&#39;</span>), pd<span style="color:#f92672">.</span>Grouper(level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Group&#39;</span>)])[<span style="color:#e6db74">&#39;Value&#39;</span>]<span style="color:#f92672">.</span>mean()
</code></pre></div><h3 id="how-can-i-resample-in-my-own-time">How can I resample in my own time?</h3>
<pre><code class="language-pythondtrange" data-lang="pythondtrange">df = pd.DataFrame(('p1': np.random.rand(len(dtrange)) + 5,
                   'p2': np.random.rand(len(dtrange)) + 10},
                 index=dtrange)
p1 p2
2013-01-01 5.428541 10.292222
2013-01-02 5.172898 10.077244
2013-01-03 5.414736 10.587493
2013-01-04 5.235626 10.567700
2013-01-05 5.659100 10.270270
2013-01-06 5.144520 10.033026
2013-01-07 5.340707 10.561371
2013-01-08 5.256909 10.647431
2013-01-09 5.491950 10.036358
2013-01-10 5.869493 10.010417

#Result
df.groupby(date).mean()
p1 p2
2013-01-01 5.401448 10.308353
2013-01-11 5.362789 10.463397
2013-01-21 5.531094 10.346834
2013-02-01 5.559112 10.551347
2013-02-11 5.551023 10.451666
</code></pre><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#This d creates the index for early/mid/late.</span>
d <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span>np<span style="color:#f92672">.</span>clip((df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
d
Int64Index([ <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>,
             <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>,
             <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
<span style="color:#75715e"># This gets the index date of the data.</span>
df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day
Int64Index([ <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>,
            <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>,
             <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
<span style="color:#75715e"># Decrement the index by 10 units.</span>
df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
Int64Index([ <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>,
            <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>,
             <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
<span style="color:#75715e"># Create index for early, mid and late</span>
(df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> <span style="color:#ae81ff">10</span>
Int64Index([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>,
            <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
            <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
<span style="color:#75715e"># np.clip(a, a_min, a_max, out=None, **kargs)</span>
<span style="color:#75715e">#np.clip processes the value of an element to fall within an arbitrary range. Here, it falls within the range of 0 to 2</span>
np<span style="color:#f92672">.</span>clip((df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>)
Int64Index([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>,
            <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
            <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
<span style="color:#75715e"># Converted for early: 0, mid: 10, late: 20</span>
np<span style="color:#f92672">.</span>clip((df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>
Int64Index([ <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>,
            <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
             <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>],
           dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int64&#39;</span>)
Check the calculation of <span style="color:#75715e">#d.</span>
tmp <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>:df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">.</span>values,
                    <span style="color:#e6db74">&#39;B&#39;</span>:np<span style="color:#f92672">.</span>clip((df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>},
                  index<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">51</span>))
tmp[<span style="color:#e6db74">&#39;Diff&#39;</span>] <span style="color:#f92672">=</span> tmp[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">-</span>tmp[<span style="color:#e6db74">&#39;B&#39;</span>]
tmp<span style="color:#f92672">.</span>head()
A B Diff
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">5</span>
<span style="color:#f92672">&gt;</span>
tmp[<span style="color:#e6db74">&#39;Diff&#39;</span>] <span style="color:#f92672">=</span> (tmp[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">-</span>tmp[<span style="color:#e6db74">&#39;B&#39;</span>])<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
A B Diff
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">4</span>
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># Create time index for 2020-01-01, 2020-01-11, 2020-01-21, 2020-02-01, 2020-02-11</span>
If you convert <span style="color:#75715e">#d to timedelta format and subtract it from the original time series, it will be the index of seasonal data.</span>
date <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>values<span style="color:#f92672">-</span>np<span style="color:#f92672">.</span>array(d, dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;timedelta64[D]&#39;</span>)
<span style="color:#f92672">&gt;</span>
array([<span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-01-21T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-01T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>,<span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>, <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>,
       <span style="color:#e6db74">&#39;2013-02-11T00:00:00.000000000&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;datetime64[ns]&#39;</span>)
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># Group this&#39;date&#39; and take the average.</span>
df<span style="color:#f92672">.</span>groupby(date)<span style="color:#f92672">.</span>mean()
p1 p2
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">5.401448</span> <span style="color:#ae81ff">10.308353</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">5.362789</span> <span style="color:#ae81ff">10.463397</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span> <span style="color:#ae81ff">5.531094</span> <span style="color:#ae81ff">10.346834</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">5.559112</span> <span style="color:#ae81ff">10.551347</span>
<span style="color:#ae81ff">2013</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">5.551023</span> <span style="color:#ae81ff">10.451666</span>
</code></pre></div><blockquote>
</blockquote>
<ul>
<li>Create DatetimeIndex of the standard you want to aggregate and aggregate by that index standard.</li>
<li>This one-liner process was difficult for beginners, and I had to disassemble it.</li>
</ul>
<h3 id="aggregate-trading-hours-without-adding-new-days">Aggregate trading hours without adding new days</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Create with minute data</span>
dates <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2014-01-01&#39;</span>,<span style="color:#e6db74">&#39;2014-01-11&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;T&#39;</span>)[<span style="color:#ae81ff">0</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#75715e"># Only on business days</span>
dates <span style="color:#f92672">=</span> dates[dates<span style="color:#f92672">.</span>dayofweek <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span>]
s <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(dates<span style="color:#f92672">.</span>size), dates)
s
<span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2.593328</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.173850</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.781819</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.734917</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">04</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.323457</span>
<span style="color:#f92672">...</span> <span style="color:#f92672">...</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.158127</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">56</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1.205610</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">57</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.757652</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">58</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.350570</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.886426</span>
<span style="color:#ae81ff">11520</span> rows <span style="color:#960050;background-color:#1e0010">×</span> <span style="color:#ae81ff">1</span> columns

<span style="color:#75715e"># Resample the date and time of the data frame every 30 minutes and take the average</span>
s<span style="color:#f92672">.</span>groupby(<span style="color:#66d9ef">lambda</span> d: d<span style="color:#f92672">.</span>date())<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;30min&#39;</span>)<span style="color:#f92672">.</span>mean()
<span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.152332</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.172909</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.110629</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.070501</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.058135</span>
<span style="color:#f92672">...</span> <span style="color:#f92672">...</span> <span style="color:#f92672">...</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.158843</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.204738</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.057380</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">0.212008</span>
<span style="color:#ae81ff">2014</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.021065</span>
<span style="color:#ae81ff">384</span> rows <span style="color:#960050;background-color:#1e0010">×</span> <span style="color:#ae81ff">1</span> columns
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font>
Resampling was performed every 30 minutes, and the average value was calculated and grouped by day.
The initial number of cases is 14,400, which is 11,520 when extracted only on business days and aggregated into 30 minutes to be 384.</p>
</blockquote>
<h4 id="group-daily-data-by-month-clipboardthumbsup">Group daily data by month. :clipboard::thumbsup:</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> random
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame((<span style="color:#e6db74">&#39;string&#39;</span>: [random<span style="color:#f92672">.</span>choice((<span style="color:#e6db74">&#39;about&#39;</span>,<span style="color:#e6db74">&#39;contact&#39;</span>,<span style="color:#e6db74">&#39;home&#39;</span>,<span style="color:#e6db74">&#39;blog&#39;</span>)) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">120</span>)],
                 <span style="color:#e6db74">&#39;visits&#39;</span>:np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2000</span>, (<span style="color:#ae81ff">120</span>,))},
               index <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2001-01-01&#39;</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1d&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">120</span>))

re_df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;string&#39;</span>)<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;M&#39;</span>)<span style="color:#f92672">.</span>sum()

visits
string
about <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">4879</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">6713</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">5747</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">9286</span>
blog <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">9164</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">8318</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">4770</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">6571</span>
contact <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">6883</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">6177</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">10228</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">3531</span>
home <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">5496</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">5261</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">7083</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">11383</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<ul>
<li>random.choice(&lsquo;character string A&rsquo;,&lsquo;character string B&rsquo;,&lsquo;character string C&rsquo;) Randomly extracts the character string of the argument.</li>
<li>Group data by classification name, resample by&rsquo;M&rsquo; month and total.</li>
</ul>
<blockquote>
</blockquote>
<h4 id="add-monthly-composition-to-new-column">Add monthly composition to new column</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">re_df[<span style="color:#e6db74">&#39;ratio&#39;</span>] <span style="color:#f92672">=</span> re_df<span style="color:#f92672">.</span>groupby(level<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>transform(<span style="color:#66d9ef">lambda</span> x: x <span style="color:#f92672">/</span> x<span style="color:#f92672">.</span>sum())
<span style="color:#f92672">&gt;</span>
visits ratio
string
about <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">4879</span> <span style="color:#ae81ff">0.184657</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">6713</span> <span style="color:#ae81ff">0.253617</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">5747</span> <span style="color:#ae81ff">0.206519</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">9286</span> <span style="color:#ae81ff">0.301778</span>
blog <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">9164</span> <span style="color:#ae81ff">0.346832</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">8318</span> <span style="color:#ae81ff">0.314254</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">4770</span> <span style="color:#ae81ff">0.171410</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">6571</span> <span style="color:#ae81ff">0.213545</span>
contact <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">6883</span> <span style="color:#ae81ff">0.260503</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">6177</span> <span style="color:#ae81ff">0.233367</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">10228</span> <span style="color:#ae81ff">0.367543</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">3531</span> <span style="color:#ae81ff">0.114751</span>
home <span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">5496</span> <span style="color:#ae81ff">0.208008</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span> <span style="color:#ae81ff">5261</span> <span style="color:#ae81ff">0.198761</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#ae81ff">7083</span> <span style="color:#ae81ff">0.254528</span>
<span style="color:#ae81ff">2001</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span> <span style="color:#ae81ff">11383</span> <span style="color:#ae81ff">0.369926</span>
</code></pre></div><h1 id="merge">Merge</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">177</span>]: rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2000-01-01&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>)
In [<span style="color:#ae81ff">178</span>]: df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>), index<span style="color:#f92672">=</span>rng, columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;A&#39;</span>,<span style="color:#e6db74">&#39;B&#39;</span>,<span style="color:#e6db74">&#39;C&#39;</span>])
In [<span style="color:#ae81ff">179</span>]: df2 <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>copy()
In [<span style="color:#ae81ff">180</span>]: df <span style="color:#f92672">=</span> df1<span style="color:#f92672">.</span>append(df2, ignore_index<span style="color:#f92672">=</span>True)

In [<span style="color:#ae81ff">181</span>]: df
Out[<span style="color:#ae81ff">181</span>]:
           A B C
<span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.870117</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.479265</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.790855</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0.144817</span> <span style="color:#ae81ff">1.726395</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.464535</span>
<span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.821906</span> <span style="color:#ae81ff">1.597605</span> <span style="color:#ae81ff">0.187307</span>
<span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.128342</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.511638</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.289858</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0.399194</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.430030</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.639760</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">1.115116</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2.012600</span> <span style="color:#ae81ff">1.810662</span>
<span style="color:#ae81ff">6</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.870117</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.479265</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.790855</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0.144817</span> <span style="color:#ae81ff">1.726395</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.464535</span>
<span style="color:#ae81ff">8</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.821906</span> <span style="color:#ae81ff">1.597605</span> <span style="color:#ae81ff">0.187307</span>
<span style="color:#ae81ff">9</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.128342</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.511638</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.289858</span>
<span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0.399194</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.430030</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.639760</span>
<span style="color:#ae81ff">11</span> <span style="color:#ae81ff">1.115116</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2.012600</span> <span style="color:#ae81ff">1.810662</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<ul>
<li>Create 6 items of data, and <code>copy()</code> the same items and combine them vertically.</li>
<li>Depending on the combination, <code>ignore_index=True</code> may be required.</li>
</ul>
<h4 id="dataframe-self-join">DataFrame self-join</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">182</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;Area&#39;</span>: [<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">+</span> [<span style="color:#e6db74">&#39;C&#39;</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>,
                           <span style="color:#e6db74">&#39;Bins&#39;</span>: [<span style="color:#ae81ff">110</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> [<span style="color:#ae81ff">160</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> [<span style="color:#ae81ff">40</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>,
                           <span style="color:#e6db74">&#39;Test_0&#39;</span>: [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>],
                           <span style="color:#e6db74">&#39;Data&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">7</span>)})

In [<span style="color:#ae81ff">183</span>]: df
Out[<span style="color:#ae81ff">183</span>]:
Area Bins Test_0 Data
<span style="color:#ae81ff">0</span> A <span style="color:#ae81ff">110</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.632955</span>
<span style="color:#ae81ff">1</span> A <span style="color:#ae81ff">110</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1.485463</span>
<span style="color:#ae81ff">2</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.193891</span>
<span style="color:#ae81ff">3</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.324484</span>
<span style="color:#ae81ff">4</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1.293263</span>
<span style="color:#ae81ff">5</span> C <span style="color:#ae81ff">40</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.476979</span>
<span style="color:#ae81ff">6</span> C <span style="color:#ae81ff">40</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.467655</span>

In [<span style="color:#ae81ff">184</span>]: df[<span style="color:#e6db74">&#39;Test_1&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Test_0&#39;</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>

In [<span style="color:#ae81ff">185</span>]: pd<span style="color:#f92672">.</span>merge(df, df, left_on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Bins&#39;</span>,<span style="color:#e6db74">&#39;Area&#39;</span>,<span style="color:#e6db74">&#39;Test_0&#39;</span>],
                   right_on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Bins&#39;</span>,<span style="color:#e6db74">&#39;Area&#39;</span>,<span style="color:#e6db74">&#39;Test_1&#39;</span>],
                   suffixes<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;_L&#39;</span>,<span style="color:#e6db74">&#39;_R&#39;</span>))

Out[<span style="color:#ae81ff">185</span>]:
Area Bins Test_0_L Data_L Test_1_L Test_0_R Data_R Test_1_R
<span style="color:#ae81ff">0</span> A <span style="color:#ae81ff">110</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.632</span> <span style="color:#ae81ff">955</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1.485463</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.193891</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.324484</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">2</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.324484</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1.293263</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">3</span> C <span style="color:#ae81ff">40</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.476979</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.467655</span> <span style="color:#ae81ff">0</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#</span>
df[<span style="color:#e6db74">&#39;Test_1&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Test_0&#39;</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
<span style="color:#f92672">&gt;</span>
Area Bins Test_0 Data Test_1
<span style="color:#ae81ff">0</span> A <span style="color:#ae81ff">110</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0.632</span> <span style="color:#ae81ff">955</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> A <span style="color:#ae81ff">110</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1.485463</span> <span style="color:#ae81ff">02</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.193891</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">3</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.324484</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">4</span> A <span style="color:#ae81ff">160</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1.293263</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">5</span> C <span style="color:#ae81ff">40</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.476979</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">6</span> C <span style="color:#ae81ff">40</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.467655</span> <span style="color:#ae81ff">0</span>

<span style="color:#75715e">#### Combine on condition based on value: clipboard:</span>
The code below has been partially modified <span style="color:#f92672">from</span> a post on stackoverfolw.com.

<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span>python
<span style="color:#f92672">import</span> operator <span style="color:#f92672">as</span> op

df_a <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([{<span style="color:#e6db74">&#34;a&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;b&#34;</span>: <span style="color:#ae81ff">4</span>}, {<span style="color:#e6db74">&#34;a&#34;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;b&#34;</span>: <span style="color:#ae81ff">5</span>}, {<span style="color:#e6db74">&#34;a&#34;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;b&#34;</span>: <span style="color:#ae81ff">6</span>}])
df_b <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([{<span style="color:#e6db74">&#34;c&#34;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;d&#34;</span>: <span style="color:#ae81ff">7</span>}, {<span style="color:#e6db74">&#34;c&#34;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;d&#34;</span>: <span style="color:#ae81ff">8</span>}])

binOp <span style="color:#f92672">=</span> op<span style="color:#f92672">.</span>lt
matches <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(binOp(df_a<span style="color:#f92672">.</span>a[:,None],df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values))

pd<span style="color:#f92672">.</span>concat([df<span style="color:#f92672">.</span>ix[idxs]<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span>True)
                 <span style="color:#66d9ef">for</span> df,idxs <span style="color:#f92672">in</span> zip([df_a,df_b],matches)], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
df_a
a b
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">6</span>
df_b

c d
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">8</span>
<span style="color:#75715e">#Result</span>
a b c d
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">8</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">8</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<ul>
<li>First, if you disassemble the <code>machtes</code></li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Check the contents of columns df.a and df.b</span>
df_a<span style="color:#f92672">.</span>a[:,None]
array([[<span style="color:#ae81ff">1</span>],
       [<span style="color:#ae81ff">2</span>],
       [<span style="color:#ae81ff">3</span>]])
df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values
array([<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
</code></pre></div><blockquote>
</blockquote>
<ul>
<li>The standard functional operator <code>operator.lt(a,b)</code> is <code>a &lt;b</code> and is equivalent to <code>a &lt;b</code>.</li>
</ul>
<blockquote>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">op<span style="color:#f92672">.</span>lt(df_a<span style="color:#f92672">.</span>a[:,None],df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values)
array([[ True, True],
       [False, True],
       [False, False]])
<span style="color:#75715e"># I could write like this if it was written differently</span>
df_a<span style="color:#f92672">.</span>a[:,None] <span style="color:#f92672">&lt;</span>df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values
array([[ True, True],
       [False, True],
       [False, False]])
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e">#To check this content</span>
df_a<span style="color:#f92672">.</span>a[:,None][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;</span>df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">0</span>]
array([ True])
df_a<span style="color:#f92672">.</span>a[:,None][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;</span>df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">1</span>]
array([ True])
df_a<span style="color:#f92672">.</span>a[:,None][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span>df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">0</span>]
array([False])
df_a<span style="color:#f92672">.</span>a[:,None][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span>df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">1</span>]
array([ True])
df_a<span style="color:#f92672">.</span>a[:,None][<span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;</span>df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">0</span>]
array([False])
df_a<span style="color:#f92672">.</span>a[:,None][<span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;</span>df_b<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">1</span>]
array([False])
<span style="color:#f92672">&gt;</span>
For <span style="color:#75715e">#np.where (condition), the index of the element that satisfies the condition is returned in tuple format.</span>
np<span style="color:#f92672">.</span>where([[True, True], [False, True], [False, False]])
(array([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]), array([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>]))
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># Extract based on the conditions obtained in&#39;matches&#39;.</span>
[df<span style="color:#f92672">.</span>loc[idxs]<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span>True) <span style="color:#66d9ef">for</span> df,idxs <span style="color:#f92672">in</span> zip([df_a,df_b],matches)]
[a b
 <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
 <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
 <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>, c d
 <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">7</span>
 <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">8</span>
 <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">8</span>]
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># Combine this in the horizontal direction (axis=1).</span>
a b c d
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">8</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">8</span>
</code></pre></div><h2 id="plotting">Plotting</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">n [<span style="color:#ae81ff">186</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(
   <span style="color:#f92672">.....</span>: (<span style="color:#e6db74">&#39;stratifying_var&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">20</span>),
   <span style="color:#f92672">.....</span>:<span style="color:#e6db74">&#39;price&#39;</span>: np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">20</span>)})
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">187</span>]: df[<span style="color:#e6db74">&#39;quartiles&#39;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>qcut(
   <span style="color:#f92672">.....</span>: df[<span style="color:#e6db74">&#39;stratifying_var&#39;</span>],
   <span style="color:#f92672">.....</span>:     Four,
   <span style="color:#f92672">.....</span>: labels<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;0-25%&#39;</span>, <span style="color:#e6db74">&#39;25-50%&#39;</span>, <span style="color:#e6db74">&#39;50-75%&#39;</span>, <span style="color:#e6db74">&#39;75-100%&#39;</span>])
   <span style="color:#f92672">.....</span>:

In [<span style="color:#ae81ff">188</span>]: df<span style="color:#f92672">.</span>boxplot(column<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;price&#39;</span>, by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;quartiles&#39;</span>)
Out[<span style="color:#ae81ff">188</span>]: <span style="color:#f92672">&lt;</span>matplotlib<span style="color:#f92672">.</span>axes<span style="color:#f92672">.</span>_subplots<span style="color:#f92672">.</span>AxesSubplot at <span style="color:#ae81ff">0x7fc66b7f1710</span><span style="color:#f92672">&gt;</span>
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/126042/2cf99833-8743-fae4-0991-e03d30625ced.png" alt="box_plot.png"></p>
<blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># pandas.qcut(x, q, labels=None...)</span>
<span style="color:#75715e">#x is divided by q:bin division number and labels are given.</span>
df[<span style="color:#e6db74">&#39;quartiles&#39;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>qcut(df[<span style="color:#e6db74">&#39;stratifying_var&#39;</span>], <span style="color:#ae81ff">4</span>, labels<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;0-25%&#39;</span>, <span style="color:#e6db74">&#39;25-50%&#39;</span>, <span style="color:#e6db74">&#39;50-75%&#39;</span>, <span style="color:#e6db74">&#39;75-100%&#39;</span> ])
<span style="color:#f92672">&gt;</span>
stratifying_var price quartiles
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">95.463259</span> <span style="color:#ae81ff">110.468740</span> <span style="color:#ae81ff">75</span><span style="color:#f92672">-</span><span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">61.567537</span> <span style="color:#ae81ff">105.038334</span> <span style="color:#ae81ff">50</span><span style="color:#f92672">-</span><span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">93.169189</span> <span style="color:#ae81ff">99.502664</span> <span style="color:#ae81ff">75</span><span style="color:#f92672">-</span><span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">32.881181</span> <span style="color:#ae81ff">100.462400</span> <span style="color:#ae81ff">25</span><span style="color:#f92672">-</span><span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">22.735506</span> <span style="color:#ae81ff">95.821731</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">85.662861</span> <span style="color:#ae81ff">101.262124</span> <span style="color:#ae81ff">75</span><span style="color:#f92672">-</span><span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">24.251856</span> <span style="color:#ae81ff">102.351950</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">26.323525</span> <span style="color:#ae81ff">91.812003</span> <span style="color:#ae81ff">25</span><span style="color:#f92672">-</span><span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">6.192982</span> <span style="color:#ae81ff">111.425087</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">25.520758</span> <span style="color:#ae81ff">104.666583</span> <span style="color:#ae81ff">25</span><span style="color:#f92672">-</span><span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">10</span> <span style="color:#ae81ff">75.505473</span> <span style="color:#ae81ff">104.450480</span> <span style="color:#ae81ff">75</span><span style="color:#f92672">-</span><span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">11</span> <span style="color:#ae81ff">30.6</span> <span style="color:#ae81ff">20504</span> <span style="color:#ae81ff">100.044772</span> <span style="color:#ae81ff">25</span><span style="color:#f92672">-</span><span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">12</span> <span style="color:#ae81ff">40.438555</span> <span style="color:#ae81ff">102.697402</span> <span style="color:#ae81ff">50</span><span style="color:#f92672">-</span><span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">13</span> <span style="color:#ae81ff">18.171318</span> <span style="color:#ae81ff">102.612876</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">14</span> <span style="color:#ae81ff">57.080747</span> <span style="color:#ae81ff">101.067847</span> <span style="color:#ae81ff">50</span><span style="color:#f92672">-</span><span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">15</span> <span style="color:#ae81ff">44.066472</span> <span style="color:#ae81ff">93.410125</span> <span style="color:#ae81ff">50</span><span style="color:#f92672">-</span><span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">16</span> <span style="color:#ae81ff">64.131972</span> <span style="color:#ae81ff">103.707151</span> <span style="color:#ae81ff">50</span><span style="color:#f92672">-</span><span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">17</span> <span style="color:#ae81ff">33.548572</span> <span style="color:#ae81ff">103.359709</span> <span style="color:#ae81ff">25</span><span style="color:#f92672">-</span><span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">18</span> <span style="color:#ae81ff">88.433754</span> <span style="color:#ae81ff">99.416668</span> <span style="color:#ae81ff">75</span><span style="color:#f92672">-</span><span style="color:#ae81ff">100</span><span style="color:#f92672">%</span>
<span style="color:#ae81ff">19</span> <span style="color:#ae81ff">21.660715</span> <span style="color:#ae81ff">91.229785</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>
</code></pre></div><hr>
<h1 id="data-inout">Data IN/Out</h1>
<h3 id="read-multiple-files-and-create-a-single-dataframe-thumbsup">read multiple files and create a single DataFrame :thumbsup:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#A example</span>
n [<span style="color:#ae81ff">189</span>]: <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
             data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>))
             data<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#39;file_{}.csv&#39;</span><span style="color:#f92672">.</span>format(i))

In [<span style="color:#ae81ff">190</span>]: files <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;file_0.csv&#39;</span>,<span style="color:#e6db74">&#39;file_1.csv&#39;</span>,<span style="color:#e6db74">&#39;file_2.csv&#39;</span>]
In [<span style="color:#ae81ff">191</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([pd<span style="color:#f92672">.</span>read_csv(f) <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> files], ignore_index<span style="color:#f92672">=</span>True)

<span style="color:#75715e">#B example</span>
In [<span style="color:#ae81ff">192</span>]: <span style="color:#f92672">import</span> glob
In [<span style="color:#ae81ff">193</span>]: <span style="color:#f92672">import</span> os

In [<span style="color:#ae81ff">194</span>]: files <span style="color:#f92672">=</span> glob<span style="color:#f92672">.</span>glob(<span style="color:#e6db74">&#39;file_*.csv&#39;</span>)
In [<span style="color:#ae81ff">195</span>]: result <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([pd<span style="color:#f92672">.</span>read_csv(f) <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> files], ignore_index<span style="color:#f92672">=</span>True)
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<ul>
<li>A example creates a sample file in a loop, reads the sample file, and combines them.</li>
<li>In the B example, the created file name is read with the glob function, and that file is read and combined.</li>
</ul>
<h3 id="parsing-multi-column-date-components">Parsing multi-column date components</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">196</span>]: i <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;20000101&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>)

In [<span style="color:#ae81ff">197</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;year&#39;</span>: i<span style="color:#f92672">.</span>year,<span style="color:#e6db74">&#39;month&#39;</span>: i<span style="color:#f92672">.</span>month,<span style="color:#e6db74">&#39;day&#39;</span>: i<span style="color:#f92672">.</span>day})

In [<span style="color:#ae81ff">198</span>]: df<span style="color:#f92672">.</span>head()
Out[<span style="color:#ae81ff">198</span>]:
   year month day
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2000</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2000</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2000</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2000</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">2000</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5</span>

In [<span style="color:#ae81ff">199</span>]: <span style="color:#f92672">%</span>timeit pd<span style="color:#f92672">.</span>to_datetime(df<span style="color:#f92672">.</span>year <span style="color:#f92672">*</span> <span style="color:#ae81ff">10000</span> <span style="color:#f92672">+</span> df<span style="color:#f92672">.</span>month <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">+</span> df<span style="color:#f92672">.</span>day, format<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;%Y%m</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>)
 ds <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04d%02d%02d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span>(x[<span style="color:#e6db74">&#39;year&#39;</span>],
                                          x[<span style="color:#e6db74">&#39;month&#39;</span>], x[<span style="color:#e6db74">&#39;day&#39;</span>]), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
ds<span style="color:#f92672">.</span>head()
 <span style="color:#f92672">%</span>timeit pd<span style="color:#f92672">.</span>to_datetime(ds)

<span style="color:#ae81ff">9.98</span> ms <span style="color:#f92672">+-</span> <span style="color:#ae81ff">235</span> us per loop (mean <span style="color:#f92672">+-</span> std<span style="color:#f92672">.</span>dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">100</span> loops each)
<span style="color:#ae81ff">2.91</span> ms <span style="color:#f92672">+-</span> <span style="color:#ae81ff">57.5</span> us per loop (mean <span style="color:#f92672">+-</span> std<span style="color:#f92672">.</span>dev<span style="color:#f92672">.</span> of <span style="color:#ae81ff">7</span> runs, <span style="color:#ae81ff">100</span> loops each)
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># When calculating and creating time series information using the values of the created data frame</span>
df<span style="color:#f92672">.</span>year <span style="color:#f92672">*</span> <span style="color:#ae81ff">10000</span> <span style="color:#f92672">+</span> df<span style="color:#f92672">.</span>month <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">+</span> df<span style="color:#f92672">.</span>day
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># When creating time series information with a function from the created data frame element</span>
 ds <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04d%02d%02d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span>(x[<span style="color:#e6db74">&#39;year&#39;</span>], x[<span style="color:#e6db74">&#39;month&#39;</span>], x[<span style="color:#e6db74">&#39;day&#39;</span>]), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#f92672">&gt;</span> Difference <span style="color:#f92672">in</span> calculation cost<span style="color:#960050;background-color:#1e0010">?</span>

<span style="color:#75715e">### Skip lines between header and data</span>

<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span>python
In [<span style="color:#ae81ff">200</span>]: data <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">         date;Param1;Param2;Param4;Param5
</span><span style="color:#e6db74">             ;m²;°C;m²;m
</span><span style="color:#e6db74">        ;;;;
</span><span style="color:#e6db74">         01.01.1990 00:00;1;1;2;3
</span><span style="color:#e6db74">         01.01.1990 01:00;5;3;4;5
</span><span style="color:#e6db74">         01.01.1990 02:00;9;5;6;7
</span><span style="color:#e6db74">         01.01.1990 03:00;13;7;8;9
</span><span style="color:#e6db74">         01.01.1990 04:00;17;9;10;11
</span><span style="color:#e6db74">         01.01.1990 05:00;21;11;12;13
</span><span style="color:#e6db74"> &#34;&#34;&#34;</span>
</code></pre></div><h3 id="option-1-pass-lines-explicitly-and-skip-lines">Option 1: Pass lines explicitly and skip lines</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">201</span>]: <span style="color:#f92672">from</span> io <span style="color:#f92672">import</span> StringIO

In [<span style="color:#ae81ff">202</span>]: pd<span style="color:#f92672">.</span>read_csv(StringIO(data), sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>, skiprows<span style="color:#f92672">=</span>[<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>],

Out[<span style="color:#ae81ff">202</span>]:
                     Param1 Param2 Param4 Param5
date
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">13</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">04</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">17</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">21</span> <span style="color:#ae81ff">11</span> <span style="color:#ae81ff">12</span> <span style="color:#ae81ff">13</span>
</code></pre></div><h3 id="option-2-read-column-name-before-reading-data">Option 2: Read column name before reading data</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">203</span>]: pd<span style="color:#f92672">.</span>read_csv(StringIO(data), sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>, header<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, nrows<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">.</span>columns
Out[<span style="color:#ae81ff">203</span>]: Index([<span style="color:#e6db74">&#39;date&#39;</span>,<span style="color:#e6db74">&#39;Param1&#39;</span>,<span style="color:#e6db74">&#39;Param2&#39;</span>,<span style="color:#e6db74">&#39;Param4&#39;</span>,<span style="color:#e6db74">&#39;Param5&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;object&#39;</span>)

In [<span style="color:#ae81ff">204</span>]: columns <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(StringIO(data), sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>, header<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, nrows<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">.</span>columns

In [<span style="color:#ae81ff">205</span>]: pd<span style="color:#f92672">.</span>read_csv(StringIO(data), sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>, index_col<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,
                      header<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>, parse_dates<span style="color:#f92672">=</span>True, names<span style="color:#f92672">=</span>columns)

Out[<span style="color:#ae81ff">205</span>]:
                     Param1 Param2 Param4 Param5
date
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">01</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">13</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">04</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">17</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">11</span>
<span style="color:#ae81ff">1990</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span> <span style="color:#ae81ff">21</span> <span style="color:#ae81ff">11</span> <span style="color:#ae81ff">12</span> <span style="color:#ae81ff">13</span>
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<p>I don&rsquo;t think one of them is advantageous, regardless of the size of the data. In any case, since it is necessary to find the number of lines to be skipped or the line corresponding to the header line, it is necessary to open an appropriate number of lines without skipping, or to open it in an editor first.</p>
<hr>
<h1 id="computation">Computation</h1>
<h3 id="correlation">correlation</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">211</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>random(size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">5</span>)))

In [<span style="color:#ae81ff">212</span>]: corr_mat <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>corr()

In [<span style="color:#ae81ff">213</span>]: mask <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>tril(np<span style="color:#f92672">.</span>ones_like(corr_mat, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>bool), k<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)

In [<span style="color:#ae81ff">214</span>]: corr_mat<span style="color:#f92672">.</span>where(mask)
Out[<span style="color:#ae81ff">214</span>]:
          <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">0</span> NaN NaN NaN NaN NaN
<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.018923</span> NaN NaN NaN NaN
<span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.076296</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.012464</span> NaN NaN NaN
<span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.169941</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.289416</span> <span style="color:#ae81ff">0.076462</span> NaN NaN
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0.064326</span> <span style="color:#ae81ff">0.018759</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.084140</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.079859</span> NaN
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mask
array([[False, False, False, False, False],
       [True, False, False, False, False],
       [True, True, False, False, False],
       [True, True, True, False, False],
       [True, True, True, True, False]])
<span style="color:#f92672">&gt;</span>
mask2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>triu(np<span style="color:#f92672">.</span>ones_like(corr_mat, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>bool), k<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
mask2
array([[ True, True, True, True, True],
       [True, True, True, True, True],
       [False, True, True, True, True],
       [False, False, True, True, True],
       [False, False, False, True, True]])
<span style="color:#f92672">&gt;</span>
corr_mat<span style="color:#f92672">.</span>where(mask2)
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1.000000</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.022615</span> <span style="color:#ae81ff">0.047486</span> <span style="color:#ae81ff">0.092043</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.112379</span>
<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.022615</span> <span style="color:#ae81ff">1.000000</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.336864</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.025473</span> <span style="color:#ae81ff">0.004696</span>
<span style="color:#ae81ff">2</span> NaN <span style="color:#f92672">-</span><span style="color:#ae81ff">0.336864</span> <span style="color:#ae81ff">1.000000</span> <span style="color:#ae81ff">0.047746</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.008458</span>
<span style="color:#ae81ff">3</span> NaN NaN <span style="color:#ae81ff">0.047746</span> <span style="color:#ae81ff">1.000000</span> <span style="color:#ae81ff">0.133289</span>
<span style="color:#ae81ff">4</span> NaN NaN NaN <span style="color:#ae81ff">0.133289</span> <span style="color:#ae81ff">1.000000</span>
</code></pre></div><blockquote>
</blockquote>
<p>numpy.tril() -&gt; extract lower triangular matrix from Numpy array (Lower triangle of an array.)
numpy.triu() -&gt; Extract upper triangle of an array from Numpy array</p>
<hr>
<h1 id="timedeltas">Timedeltas</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">218</span>]: <span style="color:#f92672">import</span> datetime

In [<span style="color:#ae81ff">219</span>]: s <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2012-1-1&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>))

In [<span style="color:#ae81ff">220</span>]: s<span style="color:#f92672">-</span>s<span style="color:#f92672">.</span>max()
Out[<span style="color:#ae81ff">220</span>]:
<span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> days
<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> days
<span style="color:#ae81ff">20</span> days
dtype: timedelta64[ns]

In [<span style="color:#ae81ff">221</span>]: s<span style="color:#f92672">.</span>max()<span style="color:#f92672">-</span>s
Out[<span style="color:#ae81ff">221</span>]:
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span> days
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> days
<span style="color:#ae81ff">20</span> days
dtype: timedelta64[ns]

In [<span style="color:#ae81ff">222</span>]: s<span style="color:#f92672">-</span>datetime<span style="color:#f92672">.</span>datetime(<span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>)
Out[<span style="color:#ae81ff">222</span>]:
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">364</span> days <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">365</span> days <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">366</span> days <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">00</span>
dtype: timedelta64[ns]

In [<span style="color:#ae81ff">223</span>]: s <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(minutes<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
Out[<span style="color:#ae81ff">223</span>]:
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
dtype: datetime64[ns]

In [<span style="color:#ae81ff">224</span>]: datetime<span style="color:#f92672">.</span>datetime(<span style="color:#ae81ff">2011</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>)<span style="color:#f92672">-</span>s
Out[<span style="color:#ae81ff">224</span>]:
<span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">365</span> days <span style="color:#f92672">+</span><span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">366</span> days <span style="color:#f92672">+</span><span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">367</span> days <span style="color:#f92672">+</span><span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
dtype: timedelta64[ns]

In [<span style="color:#ae81ff">225</span>]: datetime<span style="color:#f92672">.</span>timedelta(minutes<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> s
Out[<span style="color:#ae81ff">225</span>]:
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">00</span>
dtype: datetime64[ns]
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 2 weeks later</span>
s <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(weeks<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">15</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span>
dtype: datetime64[ns]
<span style="color:#75715e"># 2 weeks ago</span>
s <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>timedelta(weeks<span style="color:#f92672">=-</span><span style="color:#ae81ff">2</span>)
<span style="color:#f92672">&gt;</span>
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">18</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2011</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>
dtype: datetime64[ns]
</code></pre></div><h3 id="addition-and-subtraction-of-elapsed-time-and-date">Addition and subtraction of elapsed time and date</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">226</span>]: deltas <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([datetime<span style="color:#f92672">.</span>timedelta(days<span style="color:#f92672">=</span>i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)])

In [<span style="color:#ae81ff">227</span>]: df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;A&#39;</span>: s,<span style="color:#e6db74">&#39;B&#39;</span>: deltas})

In [<span style="color:#ae81ff">228</span>]: df
Out[<span style="color:#ae81ff">228</span>]:
           A B0 <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0</span> days
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">1</span> days
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">2</span> days

In [<span style="color:#ae81ff">229</span>]: df[<span style="color:#e6db74">&#39;New Dates&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">+</span> df[<span style="color:#e6db74">&#39;B&#39;</span>]

In [<span style="color:#ae81ff">230</span>]: df[<span style="color:#e6db74">&#39;Delta&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#f92672">-</span>df[<span style="color:#e6db74">&#39;New Dates&#39;</span>]

In [<span style="color:#ae81ff">231</span>]: df
Out[<span style="color:#ae81ff">231</span>]:
           A B New Dates Delta
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0</span> days
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">1</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> days
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">2</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> days

In [<span style="color:#ae81ff">232</span>]: df<span style="color:#f92672">.</span>dtypes
Out[<span style="color:#ae81ff">232</span>]:
A datetime64[ns]
B timedelta64[ns]
New Dates datetime64[ns]
Delta timedelta64[ns]
dtype: object
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Perform weekly addition</span>
w_deltas <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([datetime<span style="color:#f92672">.</span>timedelta(weeks<span style="color:#f92672">=</span>i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)])
w_deltas
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> days
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">7</span> days
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">14</span> days
dtype: timedelta64[ns]
<span style="color:#f92672">&gt;</span>
df[<span style="color:#e6db74">&#39;W_Delta&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">+</span> w_deltas
<span style="color:#f92672">&gt;</span>
A B New Dates Delta W_Delta
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">0</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">1</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span>
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">2</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> days <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span>
</code></pre></div><hr>
<h1 id="axis-name-alias">Axis name alias</h1>
<h3 id="to-provide-the-axis-name-alias-globally-you-can-define-two-functions">To provide the axis name alias globally, you can define two functions:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_axis_alias</span>(cls, axis, alias):
    <span style="color:#66d9ef">if</span> axis <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> cls<span style="color:#f92672">.</span>_AXIS_NUMBERS:
        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#34;invalid axis [</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">] for alias [</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">]&#34;</span> <span style="color:#f92672">%</span>(axis, alias))
     cls<span style="color:#f92672">.</span>_AXIS_ALIASES[alias] <span style="color:#f92672">=</span> axis

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">clear_axis_alias</span>(cls, axis, alias):
     <span style="color:#66d9ef">if</span> axis <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> cls<span style="color:#f92672">.</span>_AXIS_NUMBERS:
        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#34;invalid axis [</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">] for alias [</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">]&#34;</span> <span style="color:#f92672">%</span>(axis, alias))
     cls<span style="color:#f92672">.</span>_AXIS_ALIASES<span style="color:#f92672">.</span>pop(alias, None)

set_axis_alias(pd<span style="color:#f92672">.</span>DataFrame,<span style="color:#e6db74">&#39;columns&#39;</span>,<span style="color:#e6db74">&#39;myaxis2&#39;</span>)
df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>), columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;c1&#39;</span>,<span style="color:#e6db74">&#39;c2&#39;</span>],
                   index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;i1&#39;</span>,<span style="color:#e6db74">&#39;i2&#39;</span>,<span style="color:#e6db74">&#39;i3&#39;</span>])

In [<span style="color:#ae81ff">241</span>]: df2<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;myaxis2&#39;</span>)
Out[<span style="color:#ae81ff">241</span>]:
i1 <span style="color:#f92672">-</span><span style="color:#ae81ff">0.461013</span>
i2 <span style="color:#ae81ff">2.040016</span>
i3 <span style="color:#ae81ff">0.904681</span>
dtype: float64

In [<span style="color:#ae81ff">242</span>]: clear_axis_alias(pd<span style="color:#f92672">.</span>DataFrame,<span style="color:#e6db74">&#39;columns&#39;</span>,<span style="color:#e6db74">&#39;myaxis2&#39;</span>)
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">An error occurred <span style="color:#66d9ef">with</span> <span style="color:#75715e"># df2.sum(axis=&#39;myaxis2&#39;).</span>
df2<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><blockquote>
</blockquote>
<p>I think this function allows you to define your own axis name, but in fact it gives an error and no result. Obtained by specifying <code>axis=1</code>.</p>
<h1 id="creating-example-data">Creating example data</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">243</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">expand_grid</span>(data_dict):
              rows <span style="color:#f92672">=</span> itertools<span style="color:#f92672">.</span>product(<span style="color:#f92672">*</span>data_dict<span style="color:#f92672">.</span>values())
              <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>DataFrame<span style="color:#f92672">.</span>from_records(rows, columns<span style="color:#f92672">=</span>data_dict<span style="color:#f92672">.</span>keys())

In [<span style="color:#ae81ff">244</span>]: df <span style="color:#f92672">=</span> expand_grid({<span style="color:#e6db74">&#39;height&#39;</span>: [<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">70</span>],
                            <span style="color:#e6db74">&#39;weight&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">180</span>],
                            <span style="color:#e6db74">&#39;sex&#39;</span>: [<span style="color:#e6db74">&#39;Male&#39;</span>,<span style="color:#e6db74">&#39;Female&#39;</span>]})

In [<span style="color:#ae81ff">245</span>]: df
Out[<span style="color:#ae81ff">245</span>]:
    height weight sex
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">100</span> Male
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">100</span> Female
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">140</span> Male
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">140</span> Female
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">180</span> Male
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">180</span> Female
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">100</span> Male
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">100</span> Female
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">140</span> Male
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">140</span> Female
<span style="color:#ae81ff">10</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">180</span> Male
<span style="color:#ae81ff">11</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">180</span> Female
</code></pre></div><hr>
<p>#Create sample data</p>
<ul>
<li>To create a dataframe from all combinations of specific values, you can create a dictionary where the keys are column names and the values are lists of data values.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">243</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">expand_grid</span>(data_dict):
              rows <span style="color:#f92672">=</span> itertools<span style="color:#f92672">.</span>product(<span style="color:#f92672">*</span>data_dict<span style="color:#f92672">.</span>values())
              <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>DataFrame<span style="color:#f92672">.</span>from_records(rows, columns<span style="color:#f92672">=</span>data_dict<span style="color:#f92672">.</span>keys())

In [<span style="color:#ae81ff">244</span>]: df <span style="color:#f92672">=</span> expand_grid({<span style="color:#e6db74">&#39;height&#39;</span>: [<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">70</span>],
                            <span style="color:#e6db74">&#39;weight&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">180</span>],
                            <span style="color:#e6db74">&#39;sex&#39;</span>: [<span style="color:#e6db74">&#39;Male&#39;</span>,<span style="color:#e6db74">&#39;Female&#39;</span>]})

In [<span style="color:#ae81ff">245</span>]: df
Out[<span style="color:#ae81ff">245</span>]:
    height weight sex
<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">100</span> Male
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">100</span> Female
<span style="color:#ae81ff">2</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">140</span> Male
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">140</span> Female
<span style="color:#ae81ff">4</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">180</span> Male
<span style="color:#ae81ff">5</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">180</span> Female
<span style="color:#ae81ff">6</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">100</span> Male
<span style="color:#ae81ff">7</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">100</span> Female
<span style="color:#ae81ff">8</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">140</span> Male
<span style="color:#ae81ff">9</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">140</span> Female
<span style="color:#ae81ff">10</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">180</span> Male
<span style="color:#ae81ff">11</span> <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">180</span> Female
</code></pre></div><blockquote>
<p><font color="crimson">**[Code Reading]**</font></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># *dict.values() expands dictionary values</span>
d_dict <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;height&#39;</span>: [<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">70</span>],<span style="color:#e6db74">&#39;weight&#39;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">180</span>],<span style="color:#e6db74">&#39;sex&#39;</span>: [<span style="color:#e6db74">&#39;Male&#39;</span>,<span style="color:#e6db74">&#39;Female&#39;</span>]}
<span style="color:#66d9ef">print</span>(<span style="color:#f92672">*</span>d_dict<span style="color:#f92672">.</span>values())
[<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">70</span>] [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">180</span>] [<span style="color:#e6db74">&#39;Male&#39;</span>,<span style="color:#e6db74">&#39;Female&#39;</span>]
<span style="color:#f92672">&gt;</span>
<span style="color:#75715e"># All combinatorial direct products (Cartesian products) itertools.product is an iterator</span>
rows <span style="color:#f92672">=</span> itertools<span style="color:#f92672">.</span>product(<span style="color:#f92672">*</span>d_dict<span style="color:#f92672">.</span>values())
<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">for</span> r <span style="color:#f92672">in</span> rows:
    <span style="color:#66d9ef">print</span>(r)
<span style="color:#f92672">&gt;</span>
(<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">100</span>,<span style="color:#e6db74">&#39;Male&#39;</span>)
(<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">100</span>,<span style="color:#e6db74">&#39;Female&#39;</span>)
(<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">140</span>,<span style="color:#e6db74">&#39;Male&#39;</span>)
(<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">140</span>,<span style="color:#e6db74">&#39;Female&#39;</span>)
(<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;Male&#39;</span>)
(<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;Female&#39;</span>)
(<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">100</span>,<span style="color:#e6db74">&#39;Male&#39;</span>)
(<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">100</span>,<span style="color:#e6db74">&#39;Female&#39;</span>)
(<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">140</span>,<span style="color:#e6db74">&#39;Male&#39;</span>)
(<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">140</span>,<span style="color:#e6db74">&#39;Female&#39;</span>)
(<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;Male&#39;</span>)
(<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;Female&#39;</span>)
</code></pre></div><p>#Postscript</p>
<ul>
<li>Thank you for visiting our website. About two and a half years after I started learning the Python language, the self-study of the official cookbook was a real struggle.</li>
<li>At the first time, I started by preparing the same data as the formula myself, but I gave up because I could not think of sample data in the middle.</li>
<li>For the second time, I tried to make the code reading part with the folding function in the form of quoting the official, but I decided that it would not be felt if it looked difficult.
*Please forgive me if the explanation is not sufficient, even though I cannot understand and describe the language accurately.</li>
<li>When I finished, I felt that <strong>&ldquo;Anyone who controls the index controls Pandas&rdquo;</strong>.</li>
<li>The explanation in code reading is the first time I used mathjax, but I am not sure if it worked.</li>
</ul>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
