<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>Get pdf and png from Tableau server using TSC (Tableau Server Client). | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Get pdf and png from Tableau server using TSC (Tableau Server Client).</h1>
<p>
  <small class="text-secondary">
  
  
  Mar 10, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/api"> API</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/tableau"> Tableau</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/tableauserver"> TableauServer</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/tsc"> tsc</a></code></small>

</p>
<pre><code># Introduction
</code></pre>
<p>Use python 3.8.0.
TSC requires installation.
github (<a href="https://github.com/tableau/server-client-python">https://github.com/tableau/server-client-python</a>)
PyPI (<a href="https://pypi.org/project/tableauserverclient/">https://pypi.org/project/tableauserverclient/</a>)</p>
<pre><code>pip install tableauserverclient
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> tableauserverclient <span style="color:#f92672">as</span> TSC
</code></pre></div><p>For username, password, siteid, serverurl enter the account and server information used.
Also, I want to use the latest version, so I set the user_server_version option to True.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tableau_auth <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>TableauAuth(<span style="color:#e6db74">&#39;username&#39;</span>,<span style="color:#e6db74">&#39;password&#39;</span>,<span style="color:#e6db74">&#39;siteid&#39;</span>)
server <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>Server(<span style="color:#e6db74">&#39;serverurl&#39;</span>, use_server_version<span style="color:#f92672">=</span>True)
</code></pre></div><p>Run the following code to see if the view exists on your site.
Also, be sure to execute <code>all_views</code> because it will be used later.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">all_views, pagination_item <span style="color:#f92672">=</span> server<span style="color:#f92672">.</span>views<span style="color:#f92672">.</span>get()
<span style="color:#66d9ef">print</span>([view<span style="color:#f92672">.</span>name <span style="color:#66d9ef">for</span> view <span style="color:#f92672">in</span> all_views])
</code></pre></div><h1 id="save-as-pdf">Save as PDF</h1>
<p>To get the view in file format: pdf, size: A4, orientation: landscape, use the following code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pdf_req_option <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>PDFRequestOptions(page_type<span style="color:#f92672">=</span>TSC<span style="color:#f92672">.</span>PDFRequestOptions<span style="color:#f92672">.</span>PageType<span style="color:#f92672">.</span>A4,
                 orientation<span style="color:#f92672">=</span>TSC<span style="color:#f92672">.</span>PDFRequestOptions<span style="color:#f92672">.</span>Orientation<span style="color:#f92672">.</span>Landscape)
<span style="color:#66d9ef">with</span> server<span style="color:#f92672">.</span>auth<span style="color:#f92672">.</span>sign_in(tableau_auth):
    <span style="color:#66d9ef">for</span> view_item <span style="color:#f92672">in</span> all_views:
        <span style="color:#75715e"># generate pdf image</span>
        server<span style="color:#f92672">.</span>views<span style="color:#f92672">.</span>populate_pdf(view_item, req_options<span style="color:#f92672">=</span>pdf_req_option)
        <span style="color:#66d9ef">with</span> open(f<span style="color:#e6db74">&#39;{view_item.name}.pdf&#39;</span>,<span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> f:
            f<span style="color:#f92672">.</span>write(view_item<span style="color:#f92672">.</span>pdf)
</code></pre></div><h2 id="pdfrequestoptions">PDFRequestOptions</h2>
<blockquote>
<p>Use this class to specify the format of the PDF that is returned for the view.See views.populate_pdf.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">PDFRequestOptions(page_type<span style="color:#f92672">=</span>None, orientation<span style="color:#f92672">=</span>None)
</code></pre></div><h3 id="page_type">page_type</h3>
<p>You can specify the size of the pdf. The default is <code>Legal</code>.</p>
<ul>
<li><code>PageType.A3</code></li>
<li><code>PageType.A4</code></li>
<li><code>PageType.A5</code></li>
<li><code>PageType.B5</code></li>
<li><code>PageType.Executive</code></li>
<li><code>PageType.Folio</code></li>
<li><code>PageType.Ledger</code></li>
<li><code>PageType.Legal</code></li>
<li><code>PageType.Letter</code></li>
<li><code>PageType.Note</code></li>
<li><code>PageType.Quarto</code></li>
<li><code>PageType.Tabloid</code></li>
</ul>
<h3 id="orientation">orientation</h3>
<p>You can specify the page orientation. The default is <code>Portrait</code> (vertical).</p>
<ul>
<li><code>Orientation.Portrait</code>: Vertical</li>
<li><code>Orientation.Landscape</code>: Horizontal</li>
</ul>
<p>###vf (filter)
You can also use the <code>vf</code> method on this class to filter the view.
For example,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># (optional) set a view filter</span>
pdf_req_option<span style="color:#f92672">.</span>vf(<span style="color:#e6db74">&#39;Region&#39;</span>,<span style="color:#e6db74">&#39;West&#39;</span>)
</code></pre></div><p>Then, the view in which the <code>Region</code> is filtered to <code>West</code> is made into pdf.</p>
<p>Reference: <a href="https://tableau.github.io/server-client-python/docs/api-ref#pdfrequestoptions-class">PDFRequestOptions Class</a></p>
<h1 id="save-as-png">Save as PNG</h1>
<p>To get the view in file format: png, orientation: landscape, use the following code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">image_req_option <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>ImageRequestOptions(imageresolution<span style="color:#f92672">=</span>TSC<span style="color:#f92672">.</span>ImageRequestOptions<span style="color:#f92672">.</span>Resolution<span style="color:#f92672">.</span>High)
<span style="color:#66d9ef">with</span> server<span style="color:#f92672">.</span>auth<span style="color:#f92672">.</span>sign_in(tableau_auth):
    <span style="color:#66d9ef">for</span> view_item <span style="color:#f92672">in</span> all_views:
        <span style="color:#75715e"># png Generate image</span>
        server<span style="color:#f92672">.</span>views<span style="color:#f92672">.</span>populate_image(view_item, req_options<span style="color:#f92672">=</span>image_req_option)
        <span style="color:#66d9ef">with</span> open(f<span style="color:#e6db74">&#39;{view_item.name}.png&#39;</span>,<span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> f:
f<span style="color:#f92672">.</span>write(view_item<span style="color:#f92672">.</span>image)
</code></pre></div><h2 id="imagerequestoptions">ImageRequestOptions</h2>
<blockquote>
<p>Use this class to specify the resolution of the view returned as an image.You can also use this class to specify view filters to be applied when the image is generated.See views.populate_image.</p>
</blockquote>
<p>It seems that you can specify the resolution with imageresolution.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ImageRequestOptions(imageresolution<span style="color:#f92672">=</span>None)
</code></pre></div><h3 id="imageresolution">imageresolution</h3>
<p>If you do not specify it, it will be output with a width of 784 pixels, and if you specify <code>Rresolution.High</code> (highest value) as above, it will be 1568 pixels (the image will keep its aspect ratio, so the height will change according to the width). To do).</p>
<h3 id="vf-filter">vf (filter)</h3>
<p>You can also filter the view by image format.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># (optional) set a view filter</span>
image_req_option<span style="color:#f92672">.</span>vf(<span style="color:#e6db74">&#39;Category&#39;</span>,<span style="color:#e6db74">&#39;Furniture&#39;</span>)
</code></pre></div><p>Reference: <a href="https://tableau.github.io/server-client-python/docs/api-ref#imagerequestoptions-class">ImageRequestOptions Class</a></p>
<p>#Summary</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
<span style="color:#75715e">#Python 3.8.0 (tags/v3.8.0:fa919fd, Oct 14 2019, 19:21:23) [MSC v.1916 32 bit (Intel)] on win32</span>
<span style="color:#f92672">import</span> tableauserverclient <span style="color:#f92672">as</span> TSC

<span style="color:#75715e"># Enter credentials</span>
username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;input&#39;</span>
password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Enter&#39;</span>
siteid <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;input&#39;</span>
serverurl <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;input&#39;</span>

tableau_auth <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>TableauAuth(username, password, siteid)
server <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>Server(serverurl, use_server_version<span style="color:#f92672">=</span>True)

<span style="color:#66d9ef">with</span> server<span style="color:#f92672">.</span>auth<span style="color:#f92672">.</span>sign_in(tableau_auth):
    all_views, pagination_item <span style="color:#f92672">=</span> server<span style="color:#f92672">.</span>views<span style="color:#f92672">.</span>get()

pdf_req_option <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>PDFRequestOptions(page_type<span style="color:#f92672">=</span>TSC<span style="color:#f92672">.</span>PDFRequestOptions<span style="color:#f92672">.</span>PageType<span style="color:#f92672">.</span>A4,
                 orientation<span style="color:#f92672">=</span>TSC<span style="color:#f92672">.</span>PDFRequestOptions<span style="color:#f92672">.</span>Orientation<span style="color:#f92672">.</span>Landscape)
<span style="color:#66d9ef">with</span> server<span style="color:#f92672">.</span>auth<span style="color:#f92672">.</span>sign_in(tableau_auth):
    <span style="color:#66d9ef">for</span> view_item <span style="color:#f92672">in</span> all_views:
        <span style="color:#75715e"># generate pdf image</span>
        server<span style="color:#f92672">.</span>views<span style="color:#f92672">.</span>populate_pdf(view_item, req_options<span style="color:#f92672">=</span>pdf_req_option)
        <span style="color:#66d9ef">with</span> open(f<span style="color:#e6db74">&#39;{view_item.name}.pdf&#39;</span>,<span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> f:
            f<span style="color:#f92672">.</span>write(view_item<span style="color:#f92672">.</span>pdf)

image_req_option <span style="color:#f92672">=</span> TSC<span style="color:#f92672">.</span>ImageRequestOptions(imageresolution<span style="color:#f92672">=</span>TSC<span style="color:#f92672">.</span>ImageRequestOptions<span style="color:#f92672">.</span>Resolution<span style="color:#f92672">.</span>High)
<span style="color:#66d9ef">with</span> server<span style="color:#f92672">.</span>auth<span style="color:#f92672">.</span>sign_in(tableau_auth):
    <span style="color:#66d9ef">for</span> view_item <span style="color:#f92672">in</span> all_views:
        <span style="color:#75715e"># png Generate image</span>
        server<span style="color:#f92672">.</span>views<span style="color:#f92672">.</span>populate_image(view_item, req_options<span style="color:#f92672">=</span>image_req_option)
        <span style="color:#66d9ef">with</span> open(f<span style="color:#e6db74">&#39;{view_item.name}.png&#39;</span>,<span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> f:
            f<span style="color:#f92672">.</span>write(view_item<span style="color:#f92672">.</span>image)
</code></pre></div><p>Please note that images and pdfs of all views on the server are output in the same hierarchy as the above script.
Please specify the output file as you like.</p>
<hr>
<p><a href="https://tableau.github.io/server-client-python/docs/api-ref">Tableau Server Client (Python) API reference</a>
<a href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref.htm">Tableau REST API-API Referenceâ€”All Methods</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
