<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Draw gears | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Draw gears</h1>
<p>
  <small class="text-secondary">
  
  
  May 12, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/image-processing"> image processing</a></code></small>


<small><code><a href="https://memotut.com/tags/shapes"> shapes</a></code></small>


<small><code><a href="https://memotut.com/tags/gears"> gears</a></code></small>

</p>
<pre><code>Gears are cool, aren't they? I feel that I can look at any number of movements of a clock that works in conjunction with various large and small gears.
</code></pre>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/3cc9b5d2-ef9b-f2c1-028f-3cd3f1bb8060.png" alt="gear00.png"></p>
<h1 id="article-purpose">Article purpose</h1>
<p>I will draw a gear by programming. There are various types of gears, but we will try focusing on ** spur gears **. This is the type of gear that the general public first think of when they hear a gear, as in the image above. The goal is to create an animation that looks like the above gears meshing like that.</p>
<p>For the time being, we will proceed while keeping in mind the ISO standard, which is a global standard, but it is far from being compliant, and it is &ldquo;<strong>Namchatte Gear</strong>&rdquo;.</p>
<h1 id="make-gears">Make gears</h1>
<p>First, let&rsquo;s draw one gear.</p>
<h2 id="required-3-elements">Required 3 elements</h2>
<p>Well, there are many things to decide when making spur gears, but the most important are the following three points.</p>
<ul>
<li>m: Module (tooth size)</li>
<li>z: number of teeth</li>
<li>α: Pressure angle</li>
</ul>
<p>Each will be explained in turn.</p>
<h3 id="module">module</h3>
<p>A module is a unit that determines the tooth size of a gear, which is defined by ISO. It seems to use <code>m</code> as a symbol. Indicates the type of gear, such as m=1 or m=5.
The larger the value of <code>m</code>, the larger the tooth. Below, when the number of teeth is 20, try arranging the gears with m=1,2,5,10.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/2bd4481d-0cbb-5c09-262f-0e8969ae5ef3.png" alt="gear02.png"></p>
<p>In this way, the value of <code>m</code>, the teeth, and the size of the gear itself are linked.</p>
<h3 id="number-of-teeth">Number of teeth</h3>
<p>That means the number of teeth on the gear. This affects the size of the gear. When the module value is <code>m=5</code>, try arranging the gears with z=10,20,30,40.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/606bd1d2-ec49-7bbe-8c01-dad37190dba9.png" alt="gear03.png"></p>
<p>Since the values of <code>m</code> are the same, the tooth shapes are the same. Since the teeth are arranged by the number of teeth, the larger the value of <code>z</code>, the larger the size of the gear. If you have few teeth, the roots of your teeth will be scooped out and become brittle, so it seems not good.</p>
<p>**Because the module value, that is, <code>m</code>, must match for the gears to mesh with each other, <strong>the size of the gears is basically adjusted by the number of teeth</strong>.</p>
<h3 id="pressure-angle">Pressure angle</h3>
<p>The pressure angle is the angle value (degree) that represents the inclination of the teeth. The symbol uses <code>α</code> (alpha). It&rsquo;s hard to explain how it&rsquo;s different, so look at the following figure. Arrange the cases of α=14.5, 17.5, 20.0 with m=20, z=40.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/cd6bd7b2-1c52-fcd6-de6b-494f079e16a6.png" alt="gear04.png"></p>
<p>It may be a little difficult to understand, but you can see that the thickness of the tip of the tooth, the shape of the root of the tooth, and the angle of inclination of the tooth have changed slightly. It seems that gears with a pressure angle of 20.0 degrees are the mainstream in modern industry, but it may be better to consider the pressure angle when designing gears visually rather than for practical purposes. I think the appearance will change quite a bit.</p>
<h2 id="4-circles">4 circles</h2>
<p>Once the three parameters <code>m</code>, <code>z</code>, and <code>α</code> are determined, it becomes possible to draw four circles that roughly represent the shape of the gear.</p>
<ul>
<li>Tip circle: Outermost circle around the tip of the tooth</li>
<li>Base circle: The base circle for the other three circles. Also called pitch circle</li>
<li>Basic circle: The basic circle of the involute curve (described later)</li>
<li>Bottom circle: The circle that represents the lowest position excluding the body of the gear</li>
</ul>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/43d6ef19-3691-2159-b386-88b50740b346.png" alt="gear01.png"></p>
<p>I will draw the shape of the tooth using these four circles. But it&rsquo;s not that hard.</p>
<p>The tip circle and the root circle are completely visible, so I will omit the explanation, but I will explain the reference circle and basic circle in a little more detail.</p>
<h3 id="standard-yen">Standard yen</h3>
<p>The base circle is used to calculate the other three circles. First, the diameter <code>dp</code> of the reference circle is decided as follows.</p>
<pre><code class="language-math" data-lang="math">d_p = zm
</code></pre><p>And the diameter of the tip circle <code>dk</code>, the diameter of the root circle <code>df</code> and the diameter of the basic circle <code>db</code> are as follows.</p>
<pre><code class="language-math" data-lang="math">\begin{align}
d_k &amp;= d_p + 2m \\
d_f &amp;= d_p-2.5m \\
d_b &amp;= d_p\ cos(\frac{2πα}{360})
\end{align}
</code></pre><p>When actually performing the calculation, use the radius instead of the diameter, so obtain it. I just halve it.</p>
<pre><code class="language-math" data-lang="math">\begin{align}
r_p &amp;= d_p / 2 = \frac{zm}{2} \\
r_k &amp;= d_k / 2 = \frac{d_p}{2} + m \\
r_f &amp;= d_f / 2 = \frac{d_p}{2}-1.25m \\
r_b &amp;= d_b / 2 = \frac{d_p\ cos(\frac{2πα}{360})}{2}
\end{align}
</code></pre><p>Another characteristic of the reference circle is that, as shown in the following figure, half of the circumference is inside the gear and half is outside the gear.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/7c780933-84c7-f594-bb37-f0e40ae2b0c7.png" alt="gear05.png"></p>
<p>The arc length of this purple part is called &ldquo;tooth thickness&rdquo;. The symbol uses <code>s</code>. Since the length of the circumference is equal to π times the diameter, and the sum of red and purple in the above figure is equal to 1/z of the circumference,</p>
<pre><code class="language-math" data-lang="math">2s = \frac{d_{p}π}{z} = πm \\
s = \frac{πm}{2}
</code></pre><p>It will be You will use this value later.</p>
<h3 id="basic-circle">Basic circle</h3>
<p>The feature of the basic circle is that the circle and the tooth intersect vertically.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/6519a783-402a-169c-83d0-b3340fe91c91.png" alt="gear06.png"></p>
<p>The tooth curve formation switches from the point where the base circle and the tooth intersect perpendicularly to the outside and the inside, respectively. In other words, based on this, parts are created separately inside and outside.</p>
<p>There are various types of curves that make up the outer teeth, but the one most commonly used today is the <a href="https://en.wikipedia.org/wiki/%E3%82%A4%E3%83%B3%E3%83%9C%E3%83%AA%E3%83%A5%E3%83%BC%E3%83%88%E6%9B%B2%E7%B7%9A">involute curve</a>. This time we will use this involute curve to create the tooth.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/35a81f42-5447-657b-97c4-8a70a0dfeab3.png" alt="gear07.png"></p>
<h2 id="outside-the-tooth-draw-an-involute-curve">Outside the tooth-draw an involute curve</h2>
<p>As for involute curves, you can find many excellent documents by searching, so I will not explain it here.</p>
<p>For the time being, it is OK if the required numerical values can be calculated using the following formula.</p>
<pre><code class="language-math" data-lang="math">α = cos^{-1}\frac{r_b}{r} \\
inv\ α = tan\ α-α \\
x = r\ cos(inv\ α) \\
y = r\ sin(inv\ α)
</code></pre><p>Here, <code>r</code> represents the distance from the center of the gear. When drawing an involute curve, it draws from the basic circle to the tip circle, so you will increase <code>r</code> little by little from the radius <code>rb</code> to the radius <code>rk</code> and obtain <code>x</code>,<code>y</code>. ..</p>
<p><code>inv α</code> is a function called involute function.</p>
<p>In order to deepen the understanding, let&rsquo;s try <code>rb</code>=100 and show it in the graph as follows.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/08a93f4c-736b-7a4e-8dbd-141dc7ca1417.png" alt="gear08.png"></p>
<table>
<thead>
<tr>
<th>r</th>
<th>inv α(radian)</th>
<th>inv α(degree)</th>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>100</td>
<td>0.000</td>
<td>0.000</td>
<td>100.000</td>
<td>0.000</td>
</tr>
<tr>
<td>105</td>
<td>0.010</td>
<td>0.591</td>
<td>104.994</td>
<td>1.083</td>
</tr>
<tr>
<td>110</td>
<td>0.029</td>
<td>1.636</td>
<td>109.955</td>
<td>3.141</td>
</tr>
<tr>
<td>115</td>
<td>0.051</td>
<td>2.946</td>
<td>114.848</td>
<td>5.910</td>
</tr>
<tr>
<td>120</td>
<td>0.078</td>
<td>4.448</td>
<td>119.639</td>
<td>9.307</td>
</tr>
<tr>
<td>125</td>
<td>0.106</td>
<td>6.102</td>
<td>124.292</td>
<td>13.287</td>
</tr>
<tr>
<td>&hellip;</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The value of <code>r</code> is started from <code>rb</code>, and <code>x</code> and <code>y</code> are calculated by increasing it little by little. In the above table, it is 5 steps, but since it is too coarse for actual use, it is actually 0.5, 0.1 or more finely. Then, you will have an involute curve that gradually increases its slope while drawing an arc. After that, if the calculation is stopped when <code>r</code> reaches <code>rk</code> (the tip circle), the curve of the tooth is completed with that alone.</p>
<h3 id="draw-a-curve-on-one-side">draw a curve on one side</h3>
<p>Draw a line on one side of the tooth on the actual gear, following the instructions above. As <code>m=10</code>,<code>z=30</code>, set the gear as <code>rb=140.95</code>.</p>
<p>When I draw it together with the four circles, it looks like this. In addition, 1 pixel is converted per unit.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/642adbf0-931f-eaf1-f88d-468d9e495d56.png" alt="gear09.png"></p>
<p>&hellip;&hellip;It looks like hair has grown, so it&rsquo;s a little dull.</p>
<p>Next, make a copy by rotating it by the number of teeth. Since the number of teeth is <code>z</code> and the circumference is <code>2π</code> (radian), the angle per tooth is <code>2π/z</code>, so the coordinates (xi, yi) of each curve are calculated as follows. It is possible.</p>
<pre><code class="language-math" data-lang="math">\begin{align}
\begin{pmatrix}
x_i \\
y_i
\end{pmatrix}
&amp;=
\begin{pmatrix}
cos\frac{2πi}{z} &amp; -sin\frac{2πi}{z} \\sin\frac{2πi}{z} &amp; cos\frac{2πi}{z}
\end{pmatrix}
\times
\begin{pmatrix}
x \\
y
\end{pmatrix} \\
&amp;=
\begin{pmatrix}
x\ cos\frac{2πi}{z}-y\ sin\frac{2πi}{z} \\
x\ sin\frac{2πi}{z} + y\ cos\frac{2πi}{z}
\end{pmatrix}
\quad (0 \leq i \lt z)
\end{align}
</code></pre><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/c4774104-c6f0-04e6-3b8b-2cc26f2a0bf9.png" alt="gear10.png"></p>
<p>It looks a bit like a gear.</p>
<h3 id="draw-the-curve-on-the-other-side">Draw the curve on the other side</h3>
<p>I could draw one, so next I want to draw the other side. The concept of the routing is as follows.</p>
<ol>
<li>Prepare the original involute curve with the Y axis reversed</li>
<li>Rotate it by <code>θb</code> and place it</li>
</ol>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/22c060cf-d1d4-7f4a-5c7b-37930e0e45d2.png" alt="gear11.png"></p>
<p>The concept is very simple, but the problem is &ldquo;How much is <code>θb</code> in ②?&rdquo;. I googled a lot and looked into it, but I couldn&rsquo;t find any explanations, so I decided to calculate it myself.</p>
<p>From the conclusion</p>
<pre><code class="language-math" data-lang="math">θ_b = \frac{s}{r_p} + 2\ inv\ α
</code></pre><p>You can ask at. <code>s</code> is the &ldquo;tooth thickness on the reference circle&rdquo; obtained earlier, &ldquo;inv α&rdquo; is the involute function, and &ldquo;α&rdquo; is the design value (unit is radian) of the pressure angle.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/994908aa-7359-3ded-6e13-efb64729c43f.png" alt="gear12.png"></p>
<p>The length of the intersection of the circle and the tooth is called the tooth thickness. The length of the circular arc <code>A'B'</code> represented by the green line is the tooth thickness <code>s</code>. Consider the fan-shaped <code>A'OB'</code> that is cut off when connecting the ends of this arc to the center of the gear. According to the &ldquo;arc length&rdquo; formula that appears in high school mathematics, the angle of <code>θp</code> in the figure can be calculated from the arc length <code>s</code> and radius <code>rp</code>.</p>
<pre><code class="language-math" data-lang="math">s = r_p\ θ_p \\
θ_p = \frac{s}{r_p}
</code></pre><p>If you check the figure again and consider the difference between <code>θp</code> and <code>θb</code>, you can see that <code>∠AOA'</code> and <code>∠BOB'</code> are that. And this value can actually be obtained with the involute function <code>inv α</code>. The involute function is a function that expresses how much the declination from the center changes as the involute curve grows.</p>
<pre><code class="language-math" data-lang="math">\begin{align}
θ_b-∠AOA'-∠BOB' &amp;= θ_p
θ_b-2\ inv\ α &amp;= θ_p
\end{align}
</code></pre><p>Therefore</p>
<pre><code class="language-math" data-lang="math">\begin{align}
θ_b &amp;= θ_p + 2\ inv\ α \\
    &amp;= \frac{s}{r_p} + 2\ inv\ α \\
    &amp;= \frac{π}{z} + 2(tanα-α)
\end{align}
</code></pre><p>Finally, I got <code>θb</code>, so I will draw the involute curve on the other side.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/2a61d802-21a1-b31d-6855-8002262adb10.png" alt="sample10-30.png"></p>
<p>It looks like Oita gear! I have another breath.</p>
<h2 id="draw-the-root">Draw the root</h2>
<p>Next, make the inner part from the basic circle. This part does not come into contact with the gear of the other party, rather it is the part that should not contact.</p>
<p>However, since I can&rsquo;t find any material that says &ldquo;make it like this&rdquo; from here, it is my original method. Please let me know if you have any good information.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/c4dff512-c222-f301-966b-760a5f54dd14.png" alt="gear13.png"></p>
<h3 id="plan-1-cut-out-vertically">(Plan 1) Cut out vertically</h3>
<p>Without any particular consideration, draw a line vertically from the root of the involute curve toward the root circle. Then, you will forcefully connect the two points on the root circle.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/4096e9a9-5c7e-2cd7-beb7-c589bdc76b2b.png" alt="gear14.png"></p>
<p>The calculation formula is omitted. The points at the bottom of red and blue have already been calculated, so I think that it is easy to calculate the points on the root circle by using the rf/rb ratio.</p>
<p>It will be a gear with a crisp feeling. In detail, it may be better to draw an arc on the root circle than to connect it with a straight line of the root circle, but I think that unless you draw a very large gear, you will not see the difference. ..</p>
<p>(It seems to crack at a right angle&hellip;)</p>
<h3 id="plan-2-use-spline-curve">(Plan 2) Use spline curve</h3>
<p>In order to create a curve that looks like that, decide some points that &ldquo;I want you to pass through this area&rdquo; and find the curve that passes through them by spline interpolation.</p>
<p>For example, try this.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/c3839833-4374-5c12-8c15-c84ea68aadfe.png" alt="gear15.png"></p>
<p>As before, draw a perpendicular on the root circle and take two points, then divide the line connecting them into three equal parts. Spline interpolation is performed using 2 points in the middle and 2 points on the basic circle, totaling 4 points.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/4fbfb2d5-ea93-8673-5bbf-4b238410c182.png" alt="gear16.png"></p>
<p>Isn&rsquo;t it okay? It&rsquo;s a rough calculation, so it&rsquo;s a little out of the way.</p>
<p>If the two points on the root circle are further apart, the shape approaches a pan-bottom shape, and if they are closer, it approaches a parabola.</p>
<h2 id="make-a-tooth-tip">Make a tooth tip</h2>
<p>The rest is only the tip of the tooth. However, there is not much you can do in this part.</p>
<p>For the time being, I think it is better to connect the two ends of the involute curve with a straight line.</p>
<p>I think that it may be possible to tamper with the shape of the addendum to some extent, but if it sticks out of the addendum circle, it may cause interference when assembling the gears, so it is NG. Even if it&rsquo;s called &ldquo;Nanchatte cogwheel&rdquo; that gives priority to appearance.</p>
<h2 id="complete">Complete</h2>
<p>I will combine the parts I have made so far and paint the color.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/e73ec2e2-cca1-186d-f2c4-7842f916e3b2.png" alt="gear17.png"></p>
<p>The left is the type 1 of tooth base plan, and the right is the type of tooth base plan 2. Both are ants, aren&rsquo;t they? I think it was good.</p>
<p>After that, I think you can make a hole in the center, lighten it for weight reduction, decorate it, make it 3D, etc.</p>
<h1 id="turn">Turn</h1>
<p>There is no option to make gears and not turn them, right? The goal is finally to make a video that feels like it&rsquo;s spinning while engaging.</p>
<h3 id="decide-which-gear-to-use">decide which gear to use</h3>
<p>The gears to be engaged must be gears made with the same module <code>m</code> and the same pressure angle <code>α</code>. Set the number of teeth <code>z</code> to your liking.</p>
<p>** Added May 14, 2020 **
The number of the gear <code>z</code> is free, but as commented by busyoumono99, in the real gear, <strong>the number of teeth of two gears is relatively prime</strong> (the greatest common divisor is 1). I am. For example, if both gears have the same number of teeth, they will always mesh with each other, and if one of the teeth is sharp, only the pair of teeth will be sharpened and broken. By making them disjoint, the combination of teeth will shift, and you can delay the damage as much as possible (damage dispersion).</p>
<p>If you just move it as a CG, you don&rsquo;t need to consider it, but if you follow this principle, it will be more realistic.</p>
<h3 id="center-distance">Center distance</h3>
<p>How far apart should the gears be so that they can engage each other? The value can be derived by the value of &ldquo;center distance&rdquo;.</p>
<pre><code class="language-math" data-lang="math">a = \frac{d_{p1}+d_{p2}}{2} = r_{p1} + r_{p2}
</code></pre><p>Simply add the reference circle radii of the two gears. After arranging the two gears so that they are separated by this distance, the angle of the gears is finely adjusted by hand so that the gears can be seen in mesh. This fine adjustment amount should be able to be calculated, but it is troublesome, so I will stop it.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/ae7b0633-cd99-76a1-2222-126d57ead0eb.png" alt="gear18.png"></p>
<h3 id="rotational-speed">Rotational speed</h3>
<p>If the speed ratios of the two gears are not properly maintained, they will not appear to rotate while meshing.</p>
<pre><code class="language-math" data-lang="math">\frac{z1}{z2} = \frac{ω2}{ω1}
</code></pre><p>The ratio of the angular velocities of the gear 1 and the gear 2 is equal to the reciprocal of the ratio of the number of teeth of the gear 1 and the gear 2. In other words, if the number of teeth on gear 1 is twice the number of teeth on gear 2, then the angular velocity must be half that of gear 2.</p>
<pre><code class="language-math" data-lang="math">ω2 = \frac{z1ω1}{z2}
</code></pre><p>The angular velocity ω1 of gear 1 should be decided appropriately and the angular velocity ω2 of gear 2 should be calculated from the above formula.</p>
<p>Also, the rotation directions are opposite to each other.</p>
<h3 id="completed-animation">Completed animation</h3>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/235258/a1d8a636-6ff0-cdb7-d6d2-5fcd5f92e49a.gif" alt="2020-05-11 11-57-22.gif"></p>
<p>Output the created gear in PNG and write a program to rotate the image with <a href="https://www.pygame.org/news">Pygame</a>,andwriteitinthescreenrecordingsoftware(<a href="https://obsproject.com/ja">OBSStudio</a>)inMKVformatandconverttoGIF(<a href="https://sourceforge.net/projects/openavitogif/">openAvitoGif</a>)andedit(<a href="http://www.virtualdub.org/">VirtualDub</a>) It&rsquo;s flickering, but don&rsquo;t worry.I feel that the gap is a little big, but I think it&rsquo;s the best point.</p>
<h1 id="source-code">Source code</h1>
<p>The source code is written in Python. I put it on Github because it has become quite long after being organized.</p>
<p><a href="https://github.com/chromia/figgear">https://github.com/chromia/figgear</a></p>
<table>
<thead>
<tr>
<th>File name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>gear.py</td>
<td>I have implemented the make_gear_figure function to generate the gear shape data and the make_gear_image function to generate the image. Also, you can easily create a gear image by specifying the parameter from the command line</td>
</tr>
<tr>
<td>gear_anim.py</td>
<td>A sample with 5 gears rotating (from the very first image in this article). I am using <a href="https://www.pygame.org/news">Pygame</a></td>
</tr>
</tbody>
</table>
<p>Required library</p>
<ul>
<li>Numpy</li>
<li>SciPy</li>
<li>Pillow</li>
<li>Pygame</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">python -m pip install numpy scipy pillow pygame
</code></pre></div><p>How to use</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># gear.py Output image file name Module number m Number of teeth z [Option]</span>
python gear.py sample.png <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">20</span>
<span style="color:#75715e"># If you want to change the color, use -r -g -b option</span>
python gear.py sample.png <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">20</span> -r<span style="color:#f92672">=</span><span style="color:#ae81ff">255</span> -g<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> -b<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#75715e"># Use the --ssaa option to antialias the contours</span>
python gear.py sample.png <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">20</span> -r<span style="color:#f92672">=</span><span style="color:#ae81ff">255</span> -g<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> -b<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> --ssaa<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>
<span style="color:#75715e"># Make a hole in the center</span>
python gear.py sample.png <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">20</span> --draw-center-hole<span style="color:#f92672">=</span>true --center-hole-size<span style="color:#f92672">=</span>0.2
<span style="color:#75715e"># Use -h or --help for more options</span>
python gear.py -h
</code></pre></div><p>When writing and using the source code yourself.
If you want raw data, use the <code>make_gear_figure</code> function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:test_figure.py" data-lang="python:test_figure.py"><span style="color:#f92672">from</span> gear <span style="color:#f92672">import</span> make_gear_figure

How to use <span style="color:#75715e">#make_gear_figure</span>
help(make_gear_figure) <span style="color:#75715e"># Display usage instructions</span>

m <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span> <span style="color:#75715e"># module</span>
z <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span> <span style="color:#75715e"># number of teeth</span>
alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">20.0</span> <span style="color:#75715e"># pressure angle</span>
bottom_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spline&#34;</span> <span style="color:#75715e"># Bottom shape &#34;spline&#34; or &#34;line&#34;</span>
points, blueprint <span style="color:#f92672">=</span> make_gear_figure(m, z, alpha, bottom_type)
<span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> points: <span style="color:#75715e"># points gives a sequence of points representing the shape of a gear</span>
    <span style="color:#66d9ef">print</span>(x, y) <span style="color:#75715e"># If you connect these points in order, the outer circumference of the gear will be created.</span>
<span style="color:#66d9ef">for</span> k, v <span style="color:#f92672">in</span> blueprint<span style="color:#f92672">.</span>items(): <span style="color:#75715e">#blueprint contains various dimensions</span>
    <span style="color:#66d9ef">print</span>(k, v)
</code></pre></div><p>If you want an image for the time being, use the <code>make_gear_image</code> function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:test.py" data-lang="python:test.py"><span style="color:#f92672">from</span> gear <span style="color:#f92672">import</span> make_gear_image

How to use <span style="color:#75715e">#make_gear_image</span>
help(make_gear_image) <span style="color:#75715e"># Display usage instructions</span>

m <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
z <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>
alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">20.0</span>

<span style="color:#75715e"># The first three arguments (output file, module, number of teeth) are fixed and the rest are specified as options</span>
<span style="color:#75715e"># However, hyphens cannot be used, so it is necessary to replace them with underbars</span>
<span style="color:#75715e"># See python gear.py -h for options you can specify</span>
make_gear_image(<span style="color:#e6db74">&#34;sample.png&#34;</span>, m, z, alpha<span style="color:#f92672">=</span>alpha, ssaa<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>,
                draw_center_hole<span style="color:#f92672">=</span>True, image_margin<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
make_gear_image(<span style="color:#e6db74">&#34;sample2.png&#34;</span>, m, z) <span style="color:#75715e"># If no option is specified, the initial value will be used</span>

It <span style="color:#f92672">is</span> smart to use variable length arguments because the <span style="color:#75715e"># arguments will be too long.</span>
options <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;alpha&#34;</span>: alpha,
           <span style="color:#e6db74">&#34;ssaa&#34;</span>: <span style="color:#ae81ff">4</span>,
           <span style="color:#e6db74">&#34;draw_center_hole&#34;</span>: True,
           <span style="color:#e6db74">&#34;image_margin&#34;</span>: <span style="color:#ae81ff">10</span>}
make_gear_image(<span style="color:#e6db74">&#34;sample3.png&#34;</span>, m, z, <span style="color:#f92672">**</span>options)
</code></pre></div><p>If you use <code>io.BytesIO</code> etc., you can use it in-memory instead of writing it to a real file. Please refer to gear_anim.py.</p>
<p>#References</p>
<p>Most of the contents explained this time were selling and receiving of published materials by <a href="https://www.khkgears.co.jp/index.html">Ohara Gear Industry Co., Ltd.</a>. We would like to express our deep gratitude for providing a large amount of information that is easy to understand.</p>
<p><a href="https://www.khkgears.co.jp/gear_technology/index.html">Gear Technical Data-Ohara Gear Industry Co., Ltd.</a></p>
<p>In particular, the &ldquo;Gear ABC Basics&rdquo; and &ldquo;Gear Technical Data&rdquo; in the above URL are described from the basics of the basics to the calculation formulas, and they were a great resource.</p>
<p>The definition of JIS gear terms was also useful. It was convenient for the technique of checking the name of the part I want to make with this and then doing a web search.</p>
<p><a href="https://www.jisc.go.jp/site/index.html">JISC-Japan Industrial Standards Committee</a>*Searchby&quot;B0102-1&rdquo;(Gearterm-Part1:Definitionofgeometricshape)</p>
<h1 id="at-the-end">At the end</h1>
<p>I was wondering if it would be easier to make it, but the number of messed up technical terms was so large that it was hard to research because it felt like there was a rough sea of information. After all, there are still many things I do not understand, and I realized that it is a deep world.</p>
<p>There are planetary gears, bevel gears, and more complicated and interesting gears, so I would like to try them someday.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
