<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Super introduction] Machine learning using Python-From environment construction to simple perceptron implementation- | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Super introduction] Machine learning using Python-From environment construction to simple perceptron implementation-</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 7, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/neural-network"> neural network</a></code></small>


<small><code><a href="https://memotut.com/tags/jupyter"> Jupyter</a></code></small>


<small><code><a href="https://memotut.com/tags/anaconda"> Anaconda</a></code></small>


<small><code><a href="https://memotut.com/tags/machine-learning-introduction"> machine learning introduction</a></code></small>

</p>
<pre><code># First of all
</code></pre>
<p>This article is from the 7th day of the DMM WEBCAMP Advent Calendar.
This time it&rsquo;s a super introduction, so I created it for those who have never tried machine learning but want to start **.</p>
<p><strong>The purpose is to get a rough idea of machine learning and try to implement a basic simple perceptron for the time being</strong>, so I&rsquo;ve written a lot about the explanation of machine learning etc.(If you write one by one It will be extremely long). If you want to know more, please check it out.</p>
<p>In addition, this time we are introducing the environment construction in windows 10.
If there is a part that is difficult to convey or mistakenly recognized in Qiita&rsquo;s first post, I would appreciate it if you could point it out in the comment.</p>
<h1 id="overview">Overview</h1>
<p>Rough explanation of machine learning
Python installation
Install Miniconda
Implementation of simple perceptron (neural network)</p>
<h1 id="rough-explanation-of-machine-learning">Rough explanation of machine learning</h1>
<h3 id="what-is-machine-learning">What is machine learning?</h3>
<p>Suppose a person coming from the front takes some animals on a walk.
I think you mainly judge visually what the animal is (dog or cat?) and what kind of breed or cat it is.
Suppose another person hears a sound like &ldquo;kotsu, kotsutsu, kotsutsu&hellip;&rdquo;.
I think that I mainly judge whether the sound I hear is footsteps, claps, or clock hands.
In this way, human beings, in their daily lives, judge everything based on their experience.</p>
<p>There&rsquo;s machine learning to make that happen to computers as well.
By letting a computer repeat learning and make highly accurate decisions, it becomes possible to predict results for unknown data.</p>
<h3 id="machine-learning-types">Machine learning types</h3>
<p>Machine learning methods are broadly divided into <strong>unsupervised</strong> machine learning and <strong>supervised</strong> machine learning.</p>
<h4 id="unsupervised-machine-learning">Unsupervised machine learning</h4>
<p>The biggest difference from supervised machine learning is that there is no correct answer data. If there are 1000 data, all are treated as training data. Clustering is mainly done, and grouping is done based on common features. The famous implementation method is the <strong>K-Means method</strong>. I&rsquo;m not going to touch on unsupervised machine learning anymore, but if you&rsquo;re interested, check it out.</p>
<h4 id="supervised-machine-learning">Supervised machine learning</h4>
<p>Unlike unsupervised machine learning, it is a learning method with correct answer data. Similarly, assuming that there are 1000 pieces of data, for example, 700 pieces are training data, 300 pieces are correct answer data, and training is divided into correct answer data and learning is repeated.
Among them, this time we will touch on neural networks and deep learning.</p>
<h5 id="neural-network">neural network</h5>
<p>This is a learning method based on the model of nerve cells in the human brain. Nerve cells are connected in series and receive input from the synapse of adjacent nerve cells and transmit information to adjacent nerve cells. In such a way, the neural network is divided into an input layer and an output layer, and when the total weight of the input layer exceeds a certain value, a value is input to the output layer. This time, we will create a program that implements this neural network.</p>
<h5 id="deep-learning">Deep learning</h5>
<p>Roughly speaking, deep learning is the result of incorporating multiple layers of neural networks and making it more complicated. Compared with machine learning in last year&rsquo;s <strong>DMM WEBCAMP Advent Calendar</strong> <a href="https://qiita.com/sugulu/items/e3fc39f2e552f2355209">[For super beginners. The difference between deep learning and machine learning]</a> Since it was written about deep learning, please refer to this as well.</p>
<p>The brief explanation continued, but the explanation is over. Could you somehow understand what machine learning is like? Now, let&rsquo;s build an environment for machine learning.</p>
<p>#Install Python
After all, the first thing is to install Python.</p>
<h3 id="check-the-version-of-windows">check the version of windows</h3>
<p>And before that, make sure you have the latest version of windows. The latest version as of December 2019 is <strong>Version 1909</strong>. If you do not have the latest version, we recommend updating to the latest version.
<img width="382" alt="winver.JPG" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/b65f8bef-6806-cb2b-9b8f-2b457613f7cf.jpeg"></p>
<h3 id="install-python">Install Python</h3>
<p>Visit <a href="https://www.python.org">https://www.python.org</a>andinthemiddleofthepageyouvisited,youcanfindtheLatest:<strong>Python(<em>Vision</em>in</strong>Download**)**Click. The latest version of Python as of December 2019 is **Python 3.8.0**.
<img width="909" alt="python.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/7cce612e-45a3-0a3a-102e-bf2e3852331b.png"></p>
<p>Click <strong>Windows x86-64 executable installer</strong> from <strong>Files</strong> at the bottom of the transition destination page to download the Python installer.
<img width="907" alt="python2.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/2c6a70d8-aad2-77f8-530e-778f20aacf95.png"></p>
<p>Start the downloaded installer and check <strong>add Python (<em>Virsion</em>) to PATH</strong> before starting the installation. By doing this, you will be able to start Python from the command prompt. If you don&rsquo;t need it, start the installation without checking it.
<img width="497" alt="python_installer.JPG" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/7c5ffdce-71ad-4690-5248-d7c5abbc71a8.jpeg"></p>
<p>Notify when the installation is complete If <strong>disable path length limit</strong> is displayed on this page, you can remove the file path length limit by selecting it. The image is not displayed because I removed the restrictions when I previously installed Python.
<img width="497" alt="python_installer2.JPG" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/ca0169ca-f2a7-cd62-8cd3-fb0e40953dbb.jpeg"></p>
<p>Python installation is now complete. You can type <strong>IDLE</strong> in the windows start menu, select the program and start entering the code. So you can easily create a Python program without a text editor like Sublime Text 3 or Visual Stdio Code.</p>
<p><strong>If you haven&rsquo;t written a Python program at all</strong>, it&rsquo;s a good idea to touch it before implementing the simple perceptron. If you are a person who usually writes C or Java, you can express what you want to do with a few descriptions, so I think it is easy to understand.</p>
<p>#Install Miniconda</p>
<h3 id="what-is-miniconda">What is Miniconda</h3>
<p>Miniconda is one of the systems provided by an open source management system called <strong>Conda</strong>. There is another one called <strong>Anaconda</strong> that is similar to Miniconda, but it is basically the same, and since the installation of Anaconda requires a fairly large file, the one with only the minimum required function is This is Miniconda. It is an image like <strong>Anaconda ⊆ Miniconda</strong>.</p>
<p>You can use Python + Miniconda to proceed with data analysis more conveniently.</p>
<h3 id="install-miniconda">Install Miniconda</h3>
<p>Go to <a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda — Conda documentation</a> and download the Miniconda installer. Select <strong>Miniconda3 Windows 64-bit</strong> of the latest Python version from <strong>Windows installer</strong> and download it.
This time there is no Miniconda for Python 3.8, but there is no problem with Miniconda for Python 3.7.
<img width="909" alt="miniconda.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/4d53525a-8cf3-d072-890f-b275138b76e0.png"></p>
<p>Launch the downloaded installer, select <em>Next -&gt; I Agree</em>, and make sure the <strong>Just Me (recommended)</strong> radio button is selected before proceeding.
<img width="372" alt="miniconda_installer.JPG" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/b90b8dc9-4dc1-b19a-03f8-404d4a0a3819.jpeg"></p>
<p>Changing the <strong>Destination Folder</strong> displayed on the next screen can be troublesome, so we recommend that you proceed to the next screen without making any changes.</p>
<p>On the <strong>Advanced installation Options</strong> screen, fix the default Python version to 3.7, and uncheck <strong>Register Aaconda as my default Python 3.7</strong> to start the installation.
<img width="373" alt="miniconda_installer2.JPG" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/9338f9c1-49f1-205e-02d1-6693e80de7c2.jpeg"></p>
<p>On this screen that appears after the installation is complete, uncheck both of them and then exit the installer.<img width="372" alt="miniconda_installer3.JPG" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/2910ff1a-1905-122d-f0c8-abc6b170d1a0.jpeg"></p>
<h3 id="build-a-virtual-environment">Build a virtual environment</h3>
<p>Let&rsquo;s start Anaconda Prompt from the start button of windows. I installed Miniconda, but as mentioned above, it is Miniacda that has only the minimum functions of Anaconda, so the notation is Anaconda. Enter the following command to proceed with the environment construction.</p>
<h4 id="update-of-installed-conda">Update of installed conda</h4>
<p><code>conda update conda -y</code></p>
<pre><code class="language-:AnacondaPrompt" data-lang=":AnacondaPrompt">&gt;conda update conda -y
Collecting package metadata (current_repodata.json): done
Solving environment: done

# All requested packages already installed.
</code></pre><p>If it appears like this, there is no problem.</p>
<p>As of December 2019, there is no Miniconda that supports Python 3.8, so Anaconda Prompt supports Python 3.7 version. However, there are few problems.
You can check it with <code>conda list</code>.</p>
<pre><code class="language-:AnacondaPrompt" data-lang=":AnacondaPrompt">&gt;conda list
# packages in environment at C:\Users\username\Miniconda3:
#
# Name Version Build Channel
asn1crypto 1.2.0 py37_0
ca-certificates 2019.11.27 0
････
python 3.7.4 h5263a28_0
</code></pre><h3 id="creating-a-virtual-environment">Creating a virtual environment</h3>
<p>The environment name is free, but this time we will proceed with <strong>NN_sample</strong>. Create a virtual environment with the Python version specified as 3.7.4 in order to eliminate the problem caused by the version difference due to Python 3.8 being installed.
For <strong>Proceed ([y]/n)?</strong> that appears in the middle, enter <strong>y</strong> and press Enter.</p>
<p><code>conda create -n NN_sample python=3.7.4</code></p>
<pre><code class="language-:AnacondaPrompt" data-lang=":AnacondaPrompt">&gt;conda create -n NN_sample python=3.7.4
Collecting package metadata (current_repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: C:\Users\username\Miniconda3\envs\NN_sample



Proceed ([y]/n)? y

Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
# $ conda activate NN_sample
#
# To deactivate an active environment, use
#
# $ conda deactivate
</code></pre><p>Start the virtual environment. You can activate it with <code>activate environment name</code>. If the startup is successful, <strong>(base)</strong> will change to <strong>(environment name)</strong>.</p>
<pre><code class="language-:AnacomdaPrompt" data-lang=":AnacomdaPrompt">(base) C:\Users\username&gt;activate NN_sample
(NN_sample) C:\Users\ username&gt;
</code></pre><h4 id="add-required-libraries">Add required libraries</h4>
<p>Add necessary libraries to the virtual environment so that you can use <code>#include &lt;~.h&gt;</code> in C and <code>import java.io.~</code> in Java. Please proceed with the virtual environment activated.
The following five are installed this time.</p>
<ul>
<li>Jupyter Lab</li>
<li>NumPy</li>
<li>matplotlib</li>
<li>TensorFlow</li>
<li>Keras</li>
</ul>
<p>Unlike other installations this time, <strong>jupyter lab</strong> is not a library, but a text editor, such as a web tool for checking code while checking data. Previously, the mainstream was <strong>jupyter notebook</strong>, but nowadays, I tend to use jupyter lab. Enter the following command to install jupyter lab.</p>
<pre><code class="language-:AnacondaPrompt" data-lang=":AnacondaPrompt">&gt;conda install -c conda-forge jupyterlab
</code></pre><p>Install the required libraries. I won&rsquo;t go into each library, but at the very least, they&rsquo;re all necessary to implement a simple perceptron.</p>
<pre><code class="language-:AnacondaPrompt" data-lang=":AnacondaPrompt">&gt;conda install numpy matplotlib tensorflow keras
</code></pre><p>There are many other libraries out there, and I&rsquo;ll just write a few that will be used for any machine learning in the future.</p>
<ul>
<li>Python Imaging Library</li>
<li>SciPy</li>
<li>pandas</li>
<li>NetWorkX (graph algorithms, etc. rather than machine learning)</li>
</ul>
<p>That is all for building the environment, including the virtual environment.</p>
<p>#Implementing a simple perceptron
I&rsquo;ve finally come here. We will create a program that implements the simple perceptron in jupyter lab. Before we do that, let&rsquo;s take a brief look at the simple perceptron.</p>
<h4 id="what-is-simple-perceptron">What is Simple Perceptron?</h4>
<p>As mentioned earlier, the simple perceptron is a type of neural network. Therefore, it is divided into an input layer and an output layer, and when the sum of the input layers exceeds a certain value, information is transmitted to the output layer. A simple perceptron <strong>has multiple inputs and a single output</strong>.
If the weight of each input layer is W1, W2, &hellip;, Wx and the weight not related to the input layer is θ, if the sum of the sum of the input value and the weight and θ is greater than 0, It outputs 1 and 0 otherwise. When written as a model, it becomes as follows.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/44fd16af-3cd4-278b-4048-9ab596ce1123.jpeg" alt="perceptron.jpg">
If you write it with a mathematical formula,</p>
<pre><code class="language-math" data-lang="math">N₁ × W₁ + N₂ × W₂ + ... + Nx × Wx + θ&gt; 0
</code></pre><p>Will be. Also, rearranging the left side,</p>
<pre><code class="language-math" data-lang="math">\frac{N₁}{N₂} × W₁ + W₂ + \frac{θ}{N₂} = 0 \\
W₂ = (- \frac{N₁}{N₂}) × W₁ + (- \frac{θ}{N₂})
</code></pre><p>It&rsquo;s hard to understand, so if you change the variable</p>
<pre><code class="language-math" data-lang="math">y = a × x + b
</code></pre><p>And you can see that it is a straight line. In other words, with the simple perceptron, you can draw a straight line that divides the input value and the output value as shown below.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/0193363b-0919-9afa-bc37-655b886255ec.jpeg" alt="perceptron2.jpg"></p>
<p>That&rsquo;s all about the brief description of simple perceptrons. Could you understand this somehow? This time, we will create a program that divides the two-input <strong>AND function</strong> into two. The AND function outputs 1 if both inputs are 1 and 0 otherwise. Therefore, it is expected to be divided as follows.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/6a17c462-1e0b-9c65-c3ed-9793668ded89.jpeg" alt="perceptoron3.jpg"></p>
<h4 id="advance-preparation">Advance preparation</h4>
<p>Move to the working folder with the <strong>cd command</strong> and then start jupyter lab. This time it will be done under <code>Documents/sample</code>.</p>
<pre><code class="language-:AnacondaPrompt" data-lang=":AnacondaPrompt">(base) C:\Users\username&gt; cd Documents

# create sample folder
(base) C:\Users\username\Documents&gt;mkdir sample

(base) C:\Users\username\Documents&gt;cd sample

(base) C:\Users\username\Documents\sample&gt;activate NN_sample

(NN_sample) C:\Users\username\Documents\sample&gt;
</code></pre><h4 id="launch-jupyter-lab">Launch Jupyter Lab</h4>
<p>Just enter <code>jupyter lab</code> for jupyter lab, jupyter lab will start and the web browser will start up. If you can&rsquo;t get up, after executing <code>jupyter lab</code>, copy the URL at the end of the sentence that appears and access it with a browser.</p>
<pre><code class="language-:AnacondaPrompt" data-lang=":AnacondaPrompt">(NN_sample) C:\Users\username\Documents\foldername&gt;jupyter lab
[I 20:43:50.910 LabApp] JupyterLab extension loaded from C:\Users\username\Miniconda3\envs\environmentname\lib\site-packages\jupyterlab
････
    Or copy and paste one of these URLs:
        http://localhost:8888/?token=43ed3a669bd4da587fa6febf75f3e38b0f7de64916e96648
     or http://127.0.0.1:8888/?token=43ed3a669bd4da587fa6febf75f3e38b0f7de64916e96648
</code></pre><h4 id="creating-a-notebook">Creating a notebook</h4>
<p>It doesn&rsquo;t matter how you create it, but from the top left of the jupyter lab, select <em>File -&gt; New -&gt; Notebook</em> to create a new notebook. The <strong>Select Kernel</strong> that appears after selection remains <strong>python 3</strong>.<img width="906" alt="jupyterlab.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/1d277260-85f0-8fb3-b118-8ae4c597825c.png"></p>
<p>In the notebook made, the code is divided into cells, and you can select code, Markdown, or Raw for each cell. If you can divide cells properly, you can execute only the necessary part of the program. Each cell can be executed by shift + Enter.</p>
<h4 id="code-creation">Code creation</h4>
<h5 id="import-required-libraries">Import required libraries</h5>
<p>First, install the necessary libraries. Describe with <code>import library name</code> or <code>import library name as name used in program</code>.</p>
<pre><code class="language-python:sample.ipynb" data-lang="python:sample.ipynb">import numpy as np
import matplotlib.pyplot as plt
import os
import csv
from keras.models import Sequential
from keras.layers import Dense, Activation
</code></pre><h5 id="definition-of-environment-variables">Definition of environment variables</h5>
<p>Variables used in the code are defined here. This time it is a short code, but especially in machine learning, there are many opportunities to change the number of learning and the specified file, so if you define it at once and edit this cell, it can be applied in all in the program.</p>
<pre><code class="language-python:sample.ipynb" data-lang="python:sample.ipynb">CSVFILE ='data.csv'
GRIDFILE ='grid.csv'
header = ['x','y','class']
body = [
    [0, 0, 0],
    [1, 0, 0],
    [0, 1, 0],
    [1, 1, 1]
]
</code></pre><h5 id="create-csv-file">Create csv file</h5>
<p>Write the Add function that will be the model later to the csv file. Also, create a csv file to create the grid required to draw the graph after learning. Since it is not an essential part, you can skip it and have no problem.
Since only the csv file is created, basically this cell only needs to be executed once.</p>
<pre><code class="language-python:sample.ipynb" data-lang="python:sample.ipynb">Delete the csv file with the name #CSVFILE
if os.path.exists(CSVFILE):
    os.unlink(CSVFILE)
if os.path.exists(GRIDFILE):
    os.unlink(GRIDFILE)

#Write to file
# with open (file name you want to handle, mode (w: write)) as variable name:
with open(CSVFILE,'w') as v:
    writer = csv.writer(v)
    writer.writerow(header)
    writer.writerows(body)

with open(GRIDFILE,'w') as v:
    x = float(0)
    y = float(0)
    writer = csv.writer(v)
    writer.writerow([x, y])
    pre_x = x
    pre_y = y
    for _ in range(0, 20):
        pre_y += 0.05
        writer.writerow([round(pre_x, 4), round(pre_y, 4)])
    for _ in range(0, 20):
        pre_y = y
        pre_x += 0.05
        for _ in range(0, 21):
            writer.writerow([round(pre_x, 4), round(pre_y, 4)])
            pre_y += 0.05
</code></pre><h5 id="read-csv-file">Read csv file</h5>
<p>Extract the data required for learning from the csv file. Extract using a <strong>slice</strong> unique to python. In addition to slices, you can also extract as <strong>Dataflame type</strong> using <strong>pandas</strong>, but this time, ndarray type is required, so extract with slice. Slice also has elements that you should know, so please refer to <a href="https://note.nkmk.me/python-numpy-select-element-row-column-array/">here</a> etc. to learn.</p>
<pre><code class="language-python:sample.ipynb" data-lang="python:sample.ipynb"># CSVFILE, skip the first line, delimit with',', and store in variable data in ndarray type
data = np.loadtxt(CSVFILE, delimiter=',', skiprows=1)

Extract all but the last column of #data
ip_train = data[:, :-1]
# [[0. 0.]
#  [Ten.]
# [0. 1.]
# [1. 1.]]

Get the last column of #data
class_train = data[:, -1]
# [0. 0. 0. 1.]

</code></pre><h5 id="perform-learning">Perform learning</h5>
<p>If a Warning appears, there is no problem, but try again.</p>
<ul>
<li>Sequential()</li>
</ul>
<p>Generate a constructor for learning. Therefore, you can add layers with the variable .add(&hellip;)<code>that stores</code>Sequential().
Of course, you can also describe layers at once, including layers such as <code>Sequential([Dense(...), Activation(...)])</code>.</p>
<ul>
<li>add(Dense(&hellip;))</li>
</ul>
<p>As I mentioned earlier, I will add layers to the constructor for learning. This time, the activation function is sigmoid, the number of neurons is 1, and the input value is 2.
The activation function determines in this case how <em>N₁ × W₁ + N₂ × W₂ + &hellip; + Nx × Wx + θ</em> is transmitted to the output layer. Others include <strong>softmax</strong> and <strong>relu</strong>.</p>
<ul>
<li>compile(&hellip;)</li>
</ul>
<p>In compile, detailed learning settings are made. Set the loss function that you want to minimize in learning to <strong>binary_crossentropy</strong>, the evaluation function that evaluates performance regardless of learning to <strong>accuracy</strong>, and the optimization method to <strong>sgd</strong>.</p>
<ul>
<li>fit(&hellip;)</li>
</ul>
<p>Learning is performed here. Specify the test model, number of epochs, and batch size.</p>
<pre><code class="language-python:sample.ipynb" data-lang="python:sample.ipynb">#Generate neural network constructor
model = Sequential()

model.add(Dense(1, input_dim=2, activation='sigmoid')) # Dense(number of layer neurons, input dimensionality, activation function)

# Learning settings .compile(loss function, optimization method, evaluation function)
model.compile(loss='binary_crossentropy', optimizer='sgd', metrics=['accuracy'])

# Perform learning
fg = model.fit(ip_train, class_train, epochs=1000, batch_size=1)
# Train on 4 samples
# Epoch 1/1000
# 4/4 [==============================]-1s 137ms/sample-loss: 0.7022-acc: 0.7500
# Epoch 2/1000
# 4/4 [==============================]-0s 5ms/sample-loss: 0.7004-acc: 0.7500
# Epoch 3/1000
# 4/4 [==============================]-0s 5ms/sample-loss: 0.6987-acc: 0.7500
# ･･･
# Epoch 999/1000
# 4/4 [==============================]-0s 4ms/sample-loss: 0.2649-acc: 1.0000
# Epoch 1000/1000
# 4/4 [==============================]-0s 3ms/sample-loss: 0.2647-acc: 1.0000
</code></pre><h5 id="graph-drawing">Graph drawing</h5>
<p>Now that the training is complete, I&rsquo;d like to predict() the boundaries and display the results using matplotlib. Again, we will use slices to extract and display the necessary data. Since there is no other detailed explanation in the code, I hope you will take a look at the code.</p>
<pre><code class="language-python:sample.ipynb" data-lang="python:sample.ipynb">t1 = ip_train[ class_train==1]
t0 = ip_train[ class_train==0]

# Array of x-coordinates of points with 1 teacher signal
t1_x = t1[:, 0]
# Array of y-coordinates of points with 1 teacher signal
t1_y = t1[:, 1]
t0_x = t0[:, 0]
t0_y = t0[:, 1]

# Read GRIDFILE with',' delimiter
g = np.loadtxt(GRIDFILE, delimiter=',')

# Predict boundaries from learning results
pred_g = model.predict(g)[:, 0]

# Array of points with predictor 1
g1 = g[ pred_g &gt;= 0.5]
# Array of points with predicted value 0
g0 = g[ pred_g &lt;0.5]

# Array of x-coordinates of points with predicted value 1
g1_x = g1[:, 0]
# Array of y-coordinates of points with predicted value of 1
g1_y = g1[:, 1]

g0_x = g0[:, 0]
g0_y = g0[:, 1]

plt.scatter(t1_x, t1_y, marker='o', facecolor='black', s=100)
plt.scatter(t0_x, t0_y, marker='o', facecolor='white', edgecolor='black', s=100)
plt.scatter(g1_x, g1_y, marker='o', facecolor='black', s=20)
plt.scatter(g0_x, g0_y, marker='o', facecolor='white', edgecolor='black', s=20)
plt.show()
</code></pre><p><img width="289" alt="result.JPG" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/534562/56f57b32-222b-3b36-96c5-fb850413d72d.jpeg">When I ran it, I couldn&rsquo;t see the lines, but I think I could do the classification I was expecting. The black ◯ is the part that is regarded as the output result 1, and the white ◯ is the part that is regarded as the output result 0. This is the end including the implementation.</p>
<h1 id="finally">Finally</h1>
<p>I have roughly gone through the implementation of the first basic simple perceptron. Once again, the purpose of this article is to <strong>get a rough idea of machine learning, and try to implement a basic simple perceptron</strong>**, so I hope it will give you a chance to start machine learning. I will.
If it becomes more complicated, it will be possible to distinguish what is shown in the image and identify audio data. Please check it out and implement it.
Also, in the <a href="https://qiita.com/advent-calendar/2019/infratop">DMM WEBCAMP Advent Calendar</a> that I am participating in this time, senior mentors and employees are writing more amazing articles. If you have something interesting, please take a look.</p>
<h1 id="reference-page">Reference page</h1>
<h5 id="machine-learning-related">Machine learning related</h5>
<p><a href="https://qiita.com/taki_tflare/items/42a40119d3d8e622edd2">Machine Learning Starting from scratch (Outline of Machine Learning)</a>
<a href="https://newtechnologylifestyle.net/%E6%95%99%E5%B8%AB%E3%81%82%E3%82%8A%E5%AD%A6%E7%BF%92%E3%81%A8%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92%E3%81%AE%E9%81%95%E3%81%84%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/">About the difference between supervised learning and unsupervised learning-AI artificial intelligence technology -</a>
<a href="https://jp.mathworks.com/discovery/deep-learning.html">Deep Learning-Three things I need to know -</a>
[Cluster analysis with scikit-learn (K-means method) – Data science with Python](<a href="https://pythondatascience.plavox.info/scikit-learn/%E3%82%AF%E3%83%A9%E3%82(%B9%E3%82%BF%E5%88%86%E6%9E%90-k-means)">https://pythondatascience.plavox.info/scikit-learn/%E3%82%AF%E3%83%A9%E3%82(%B9%E3%82%BF%E5%88%86%E6%9E%90-k-means)</a></p>
<h5 id="python-related">Python related</h5>
<p><a href="https://gammasoft.jp/python/python-install-on-windows/">Python installation method (Windows)</a></p>
<h5 id="miniconda-related">Miniconda related</h5>
<p><a href="https://showa-yojyo.github.io/notebook/python-miniconda.html">Miniconda Usage Notes — Reading Notes v1.5dev-Prefab Hut</a>
<a href="https://qiita.com/FukuharaYohei/items/cf72049b2a97687037bb">Install Miniconda on Windows (2018)-Qiita</a>
<a href="https://qiita.com/ozaki_physics/items/985188feb92570e5b82d">[For beginners] Creating a virtual environment with Anaconda-Qiita</a>
<a href="https://qiita.com/kirikei/items/a1639954ce5ccaf7ac3c">Jupyter Lab&rsquo;s Isuzu-Qiita</a></p>
<h5 id="perse-proton-related">Perse proton related</h5>
<p><a href="https://newtechnologylifestyle.net/%E4%B8%80%E7%95%AA%E7%B0%A1%E5%8D%98%E3%81%AA%E5%8D%98%E7%B4%94%E3%83%91%E3%83%BC%E3%82%BB%E3%83%97%E3%83%88%E3%83%AD%E3%83%B3%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/">About the simplest simple perceptron-AI artificial intelligence technology</a>
<a href="https://qiita.com/yampy/items/706d44417c433e68db0d">Getting Started with Deep Learning with Keras / Tensorflow-Qiita</a>
<a href="http://darden.hatenablog.com/entry/2018/04/16/204307">Implementation of multi-layer perceptron-Python and machine learning</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
