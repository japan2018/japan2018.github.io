<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] I haven&#39;t read the official documentation properly until I understand Django&#39;s static files | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] I haven&rsquo;t read the official documentation properly until I understand Django&rsquo;s static files</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 11, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/django">Django</a></code></small>


<small><code><a href="https://memotut.com/tags/python3">Python3</a></code></small>

</p>
<pre><code>This is the 11th day of the Advent Calendar.
</code></pre>
<p>#Introduction
Weekend/midnight Pythonista. It&rsquo;s a person who flutters around pandas, numpy, scipy when collecting data at work.
As a hobby, I often stumbled on static files when using Django, so I&rsquo;d like to be able to summarize the stumbling points and solutions for those who don&rsquo;t know what they don&rsquo;t understand.
We would appreciate if you could point out any mistakes.</p>
<p>~~ When you flutter, the <a href="https://docs.djangoproject.com/ja/3.0/">official document</a> is extremely kind, so
If you read it carefully, understand it, and then move your hand exactly, you should understand it. ~~</p>
<h2 id="q1-what-is-a-static-file-in-the-first-place">Q1: What is a static file in the first place?</h2>
<p>Static file? :thinking:
What&rsquo;s a file that doesn&rsquo;t work&hellip;?</p>
<h2 id="a1-learn-how-the-web-works-">A1: **Learn how the Web works. **</h2>
<p><del>Let&rsquo;s read the official document</del>
Quite roughly, CSS, JS, etc.
It refers to the file that is provided to the client side without any processing from the server for the dynamic content generated by Django.</p>
<p>Web server mechanism: <a href="https://developer.mozilla.org/ja/docs/Learn/Common_questions/What_is_a_web_server">MDN Reference</a></p>
<p>The term static file itself seems to be a Django-specific phrase (?), but if you understand the mechanism of a web application, you can understand it without difficulty.</p>
<p>If you do not understand this (in the past), let&rsquo;s study the mechanism of the Web.</p>
<blockquote>
<p>Manage static files (images, JavaScript, CSS, etc.)¶
Websites usually need to serve additional files such as images, JavaScript, and CSS. Django calls these files &ldquo;static files&rdquo;. To ease static file management, Django provides django.contrib.staticfiles.
(Django official documentation)</p>
</blockquote>
<p>It is written in the official document properly. .. ..</p>
<h2 id="q2-what-is-the-correct-place-to-put-static-files-after-all">Q2: What is the correct place to put static files after all?</h2>
<p>The DjangoGirlsTutorial (famous Django tutorial) that comes with the official Django documentation describes how to dig a static directory into your app.</p>
<p>Create a static directory inside the &gt;polls directory. Django will look for static files in it.</p>
<blockquote>
<p>(Django official documentation)</p>
</blockquote>
<p>Since the above polls is the application name, we are instructing to create a directory in the application.</p>
<blockquote>
<p>Where should static files be placed in the project?
Django knows where to look for static files with its built-in &ldquo;admin&rdquo; app. All we have to do is add a static file for our blog app.</p>
</blockquote>
<blockquote>
<p>For that, create a folder called static in the blog application</p>
</blockquote>
<blockquote>
<p>djangogirls
├── blog
│ ├── migrations
│ ├── static
│ └── templates
└── mysite
(DjangoGirlsTutorial)</p>
</blockquote>
<p>This also creates a directory in the application as well.</p>
<p>On the other hand, best practice recommends placing a static folder directly under the project.</p>
<h2 id="a2-either-way">A2: Either way</h2>
<p>This is because even when creating a static directory in the application, the namespace is mostly used with the following configuration. (* In the extra edition, I will introduce the bad cases when you do not use namespaces)
In a nutshell, it&rsquo;s hard to see personally if they&rsquo;re scattered, so we recommend that you follow best practices.
Avoid using it together.</p>
<pre><code>(app name) 
┣ static
     └ (app name)
           ┣ css
           ┣ js
</code></pre><h2 id="q3-problem-that-production-environment-css-does-not-hit">Q3: Problem that production environment css does not hit</h2>
<p>Those who try to deploy a Django app are confident that it is a static file. .. ..</p>
<h2 id="a3-lets-review-the-web-server-settings">A3: Let&rsquo;s review the web server settings</h2>
<p>I think that the web server side is often responsible for providing static files in the production environment.
Are static files organized in one place? Make sure that the delivery settings are correct.</p>
<p>All Django cares about is having static files in one place.
The command to combine static files in one place is <code>python manage.py collectstatic</code>.</p>
<p>If you hit this command, the static files visible from django.contrib.staticfiles in the development environment will be collected in <code>STATIC_ROOT</code> set in settings.py.</p>
<p>Moreover, if there is already a file with the same name, Sgremono will check the time stamp and save the new one!
Doing this will make it easier to configure Nginx etc.</p>
<p>The official documents around this collectstatic command may not be translated into Japanese and remain in English. .. ..</p>
<h2 id="extra-static-file-collision">Extra: Static File Collision</h2>
<p>If you create a static directory in your app, be careful of static file name collisions.
If Django has a static file with the same name, it will only serve the first file it finds.</p>
<p>If a static file with the same name exists as shown below, Django does not know which static file to serve.
In this case, you will guess the <strong>first</strong> css found by saticfiles.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-project_root/app1/static/main.css" data-lang="project_root/app1/static/main.css"><span style="color:#f92672">h1</span>{
  <span style="color:#66d9ef">color</span>: <span style="color:#66d9ef">blue</span>;
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-project_root/app2/static/main.css" data-lang="project_root/app2/static/main.css"><span style="color:#f92672">h1</span>{
  <span style="color:#66d9ef">color</span>: <span style="color:#66d9ef">red</span>;
}
</code></pre></div><p>So even if you try to call <code>main.css</code> in each template as follows&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-project_root/app1/templates/app1.html" data-lang="project_root/app1/templates/app1.html">{% load static %}
&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{% static &#34;</span><span style="color:#a6e22e">main</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">css</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">%}&#34;</span>&gt;
{% static &#34;main.css&#34; %} <span style="color:#75715e">&lt;!-- For debugging --&gt;</span>
&lt;<span style="color:#f92672">h1</span>&gt;App1.html &lt;<span style="color:#f92672">h1</span>&gt;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-project_root/app2/templates/app2.html" data-lang="project_root/app2/templates/app2.html">{% load static %}
&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{% static &#34;</span><span style="color:#a6e22e">main</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">css</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">%}&#34;</span>&gt;
{% static &#34;main.css&#34; %} <span style="color:#75715e">&lt;!-- For debugging --&gt;</span>
&lt;<span style="color:#f92672">h1</span>&gt;App2.html &lt;<span style="color:#f92672">h1</span>&gt;
</code></pre></div><p>As you can see, only one CSS hits.
I wanted to make App1 text blue and App2 text red, but both are blue
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/251535/13ad9720-7b8a-44a0-3cbf-73e064858f92.png" alt="app1_app2.PNG"></p>
<p>In such a case, hit the findstatic command.
You can use this command to find Django&rsquo;s search order.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$python manage.py findstatic main.css
Found<span style="color:#e6db74">&#39;main.css&#39;</span> here:
  C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\C</span>uz<span style="color:#ae81ff">\D</span>esktop<span style="color:#ae81ff">\P</span>rojects<span style="color:#ae81ff">\s</span>tatic_files_sample<span style="color:#ae81ff">\a</span>pp1<span style="color:#ae81ff">\s</span>tatic<span style="color:#ae81ff">\m</span>ain.css
  C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\C</span>uz<span style="color:#ae81ff">\D</span>esktop<span style="color:#ae81ff">\P</span>rojects<span style="color:#ae81ff">\s</span>tatic_files_sample<span style="color:#ae81ff">\a</span>pp2<span style="color:#ae81ff">\s</span>tatic<span style="color:#ae81ff">\m</span>ain.css
</code></pre></div><p>At this time, you can see that the css of app1 above is hit and the css of app2 is not hit.</p>
<p>This is also written in <a href="https://docs.djangoproject.com/en/2.2/ref/contrib/staticfiles/">official docs</a></p>
<h2 id="summary">Summary</h2>
<p>Read the official documentation! let&rsquo;s read! Read it!
That&rsquo;s all. .. ..
It is recommended that you read it carefully from corner to corner, as it will be very detailed when you read it again.</p>
<p>(I didn&rsquo;t have enough time to get involved with media files and deploy&hellip; I&rsquo;ll write it next year systematically!)</p>
<p>Tomorrow is @skd_nw&rsquo;s &ldquo;The story of the library used in development&rdquo;!
Thank you!</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
