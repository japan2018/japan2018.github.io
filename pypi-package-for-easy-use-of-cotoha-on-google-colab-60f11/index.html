<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>PyPI package for easy use of Cotoha on Google colab | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>PyPI package for easy use of Cotoha on Google colab</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 10, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/python3"> Python3</a></code></small>


<small><code><a href="https://memotut.com/tags/colaboratory"> colaboratory</a></code></small>


<small><code><a href="https://memotut.com/tags/googlecolaboratory"> GoogleColaboratory</a></code></small>


<small><code><a href="https://memotut.com/tags/cotoha"> COTOHA</a></code></small>

</p>
<pre><code>## 2020/04/10 PyPI package has been released!
</code></pre>
<p>For details, see <a href="https://github.com/TOOOOOOMY/Cotoha_at_python">here</a>(I&rsquo;mreallyhappytohaveastar!)</p>
<p>If you want to use it quickly, please refer to the code below</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#960050;background-color:#1e0010">$</span> pip install cotoha_at_python

<span style="color:#f92672">from</span> cotohacall.main <span style="color:#f92672">import</span> cotoha_call
<span style="color:#f92672">import</span> os

os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#39;CLIENT_ID&#39;</span>] <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Your ID&#39;</span>
os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#39;CLIENT_SECRET&#39;</span>] <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Ypur Secret&#39;</span>

sentence <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;API service that enables highly accurate natural language analysis of Japanese. With the COTOHA API, you can easily use the natural language analysis technology that utilizes the research results of NTT Group for over 40 years. &#39;</span>
cotoha_call(<span style="color:#e6db74">&#39;keyword&#39;</span>, sentence)

<span style="color:#75715e"># Return</span>
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">[{&#39;form&#39;:&#39;high precision&#39;,&#39;score&#39;: 20.0},
</span><span style="color:#e6db74"> {&#39;form&#39;:&#39;realization&#39;,&#39;score&#39;: 16.8278},
</span><span style="color:#e6db74"> {&#39;form&#39;:&#39;Easy&#39;,&#39;score&#39;: 10.8133},
</span><span style="color:#e6db74"> {&#39;form&#39;:&#39;Research Results&#39;,&#39;score&#39;: 10.0},
</span><span style="color:#e6db74"> {&#39;form&#39;:&#39;cotoha api&#39;,&#39;score&#39;: 10.0}]
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</code></pre></div><h2 id="foreword">Foreword</h2>
<p>Regarding the usage of COTOHA, it is already very easy to understand (<a href="https://qiita.com/gossy5454/items/83072418fb0c5f3e269f">I tried using the COTOHA API rumored to be able to handle natural language processing easily with Python</a>and<a href="https://qiita.com/youwht/items/16e67f4ada666e679875">&ldquo;MentosandTheresultofhavingMr.COTOHAsummarize&quot;MemoryofGo&rdquo;.WithCOTOHAfastesttutorial</a>),</p>
<p><a href="https://zine.qiita.com/event/collaboration-cotoha-api/?utm_source=qiita&amp;utm_medium=top_banner">[Qiita x COTOHA API present project]</a>
・Because it is troublesome to build the environment, use <a href="https://colab.research.google.com/notebooks/intro.ipynb#recent=true">Google Colab</a>!
・You can use it with one copy without thinking!</p>
<p>Since I wanted something like that, I published it as an article.</p>
<p>If you read this article, you will be able to analyze it immediately with one copy and paste&hellip;! (Should).</p>
<h2 id="what-you-can-do-with-this-copy-and-paste--implementation-example">What you can do with this copy and paste + Implementation example</h2>
<pre><code class="language-py:" data-lang="py:">cotoha_call(&quot;ne&quot;, &quot;I want to eat Black Thunder&quot;)
</code></pre><p>If you type
The analysis result of &ldquo;<strong>Black Thunder wants to eat</strong>&rdquo; (this is the unique expression extraction) is returned.</p>
<blockquote>
</blockquote>
<p>===&gt;
Proper expression extraction
===&gt;
{&lsquo;message&rsquo;:'&rsquo;,
&lsquo;result&rsquo;: [{&lsquo;begin_pos&rsquo;: 0,
&lsquo;class&rsquo;:&lsquo;ART&rsquo;,
&lsquo;end_pos&rsquo;: 8,
&lsquo;extended_class&rsquo;:&lsquo;Product_Other&rsquo;,
&lsquo;form&rsquo;:&lsquo;Black Thunder&rsquo;,
&lsquo;source&rsquo;:&lsquo;basic&rsquo;,
&lsquo;std_form&rsquo;:&lsquo;Black Thunder&rsquo;}],
&lsquo;status&rsquo;: 0}</p>
<blockquote>
</blockquote>
<p>&ldquo;ne&rdquo; can be changed to the following (it should cover all apis available to developers)</p>
<table>
<thead>
<tr>
<th align="center">API name</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Parsing</td>
<td align="center">parse</td>
</tr>
<tr>
<td align="center">Entity extraction</td>
<td align="center">ne</td>
</tr>
<tr>
<td align="center">Keyword extraction</td>
<td align="center">keyword</td>
</tr>
<tr>
<td align="center">Anaphora analysis</td>
<td align="center">coref</td>
</tr>
<tr>
<td align="center">Similarity calculation</td>
<td align="center">simi</td>
</tr>
<tr>
<td align="center">Sentence type determination</td>
<td align="center">sen_type</td>
</tr>
<tr>
<td align="center">User attribute estimation (β)</td>
<td align="center">user_at</td>
</tr>
<tr>
<td align="center">Stagnation removal (β)</td>
<td align="center">filter</td>
</tr>
<tr>
<td align="center">Speech recognition error detection (β)</td>
<td align="center">detect</td>
</tr>
<tr>
<td align="center">Sentiment analysis</td>
<td align="center">senti</td>
</tr>
<tr>
<td align="center">Summary (β)</td>
<td align="center">summary</td>
</tr>
</tbody>
</table>
<p>When I try everything using the for statement, it looks like this →</p>
<pre><code class="language-py:" data-lang="py:">for api_type in [&quot;ne&quot;, &quot;parse&quot;, &quot;coref&quot;, &quot;keyword&quot;, &quot;simi&quot;, &quot;sen_type&quot;, &quot;user_at&quot;, &quot;filter&quot;, &quot;detect&quot;, &quot;senti&quot;, &quot;summary&quot;]:
    cotoha_call(api_type, &quot;I want to eat Black Thunder.&quot;)
    print(&quot;\n&quot;) # line breaks to make the results easier to see
print(&quot;Analysis complete!&quot;)
</code></pre><details><summary>output</summary><div>
>
===>
Proper expression extraction
===>
{'message':'',
 'result': [{'begin_pos': 0,
   'class':'ART',
   'end_pos': 8,
   'extended_class':'Product_Other',
   'form':'Black Thunder',
   'source':'basic',
   'std_form':'Black Thunder'}],
 'status': 0}
>
>
===>
Parsing
===>
{'message':'',
 'result': [{'chunk_info': {'chunk_func': 2,
    'chunk_head': 1,
    'dep':'D',
    'head': 1,
    'id': 0,
    'links': []},
   'tokens': [{'attributes': {},
     'features': [],
     'form':'black',
     'id': 0,
     'kana':'Black',
     'lemma':'black',
     'pos':'noun'},
    {'attributes': {},
     'dependency_labels': [{'label':'compound','token_id': 0},
      {'label':'case','token_id': 2}],
     'features': [],
     'form':'Thunder',
     'id': 1,
     'kana':'Thunder',
     'lemma':'Thunder',
     'pos':'noun'},
    {'attributes': {},
     'features': ['continuous use'],
     'form':'to',
     'id': 2,
     'kana':'wo',
     'lemma':'to',
     'pos':'case particle'}]},
  {'chunk_info': {'chunk_func': 1,
    'chunk_head': 0,
    'dep':'O',
    'head': -1,
    'id': 1,
    'links': [{'label':'object','link': 0}],
    'predicate': []},
   'tokens': [{'attributes': {},
     'dependency_labels': [{'label':'dobj','token_id': 1},
      {'label':'aux','token_id': 4},
      {'label':'punct','token_id': 5}],
     'features': ['A'],
     'form':'eat',
     'id': 3,
     'kana':'Tabe',
     'lemma':'eat',
     'pos':'verb stem'},
    {'attributes': {},
     'features': ['end'],
     'form':'tai',
     'id': 4,
     'kana':'Thailand',
     'lemma':'tai',
     'pos':'verb suffix'},
    {'attributes': {},
     'features': [],
     'form':'. ',
     'id': 5,
     'kana': ``,
     'lemma':'. ',
     'pos':'punctuation'}]}],
 'status': 0}
>
>
===>
Anaphora analysis
===>
{'message':'OK',
 'result': {'coreference': [],
  'tokens': [['Black','Thunder','I','Eat','I want','. ']]},
 'status': 0}
>
>
===>
Keyword extraction
===>
{'message':'','result': [{'form':'Black Thunder','score': 10.0}],'status': 0}
>
>
===>
Similarity calculation
===>
{'message':'OK','result': {'score': 0.99846786},'status': 0}
>
>
===>
Sentence type judgment
===>
{'message':'',
 'result': {'dialog_act': ['information-providing'],
  'modality':'declarative'},
 'status': 0}
>
>
===>
User attribute estimation (β)
===>
{'message':'OK',
 'result': {'civilstatus':'married',
  'hobby': ['ANIMAL',
   'COOKING',
   'FISHING',
   'FORTUNE',
   'GYM',
   'INTERNET',
   'SHOPPING',
   'STUDY']},
 'status': 0}
>
>
===>
Stagnation removal (β)
===>
{'message':'OK',
 'result': [{'fillers': [],
   'fixed_sentence':'I want to eat Black Thunder. ',
   'normalized_sentence':'I want to eat Black Thunder. '}],
 'status': 0}
>
>
===>
Speech recognition error detection (β)
===>
{'message':'OK',
 'result': {'candidates': [{'begin_pos': 4,
    'correction': [{'correct_score': 0.709220240165901,'form':'dancer'},
     {'correct_score': 0.6137611877341953,'form':'Vander'},
     {'correct_score': 0.6054945064139393,'form':'thunder'},{'correct_score': 0.5943849175403254,'form':'Sanda'},
     {'correct_score': 0.5878497568567171,'form':'Zander'}],
    'detect_score': 0.05464221591729093,
    'end_pos': 8,
    'form':'Thunder'}],
  'score': 0.05464221591729093},
 'status': 0}
>
>
===>
Sentiment analysis
===>
{'message':'OK',
 'result': {'emotional_phrase': [],
  'score': 0.38033421036210907,
  'sentiment':'Neutral'},
 'status': 0}
>
>
===>
Summary (β)
===>
{'result':'I want to eat Black Thunder. ','status': 0}
>
>
Analysis finished!
>
</div></details>
<h2 id="before-copy-and-paste">Before copy and paste</h2>
<p>・Register as a user from <a href="https://api.ce-cotoha.com/contents/index.html">COTOHA API</a>andobtainclient_idandclient_secret(userregistrationwasfairlyeasytounderstand).</p>
<ul>
<li>If you want to try it even though it is in &ldquo;Python is what?&rdquo;, this is a very easy-to-understand explanation (<a href="https://qiita.comPleaseread/gossy5454/items/83072418fb0c5f3e269f">I tried using the rumored COTOHA API with Python</a>).</li>
</ul>
<h2 id="code-to-copy-and-paste">Code to copy and paste</h2>
<details><summary>Copy and paste code</summary><div>
<pre><code class="language-py:" data-lang="py:"># -*- coding:utf-8 -*-
#Reference: https://qiita.com/gossy5454/items/83072418fb0c5f3e269f#python%E3%81%A7%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3 %81%9F

import os
import urllib.request
import json
import configparser
import codecs
import sys

client_id = &quot;Client ID&quot;
client_secret = &quot;client secret&quot;

developer_api_base_url = &quot;https://api.ce-cotoha.com/api/dev/nlp/&quot;
access_token_publish_url = &quot;https://api.ce-cotoha.com/v1/oauth/accesstokens&quot;

api_name_show_switch = 1 # Set to 0 if you do not want to show the api name in the output result

def cotoha_call(api_type, sentence_1, sentence_2 = &quot;I want to eat White Thunder&quot;, sent_len = 1, ):
    # Get access token
    def getAccessToken():
        # Specify access token acquisition URL
        url = access_token_publish_url

        #Header specification
        headers={
            &quot;Content-Type&quot;: &quot;application/json;charset=UTF-8&quot;
        }

        # Request body specification
        data = {
            &quot;grantType&quot;: &quot;client_credentials&quot;,
            &quot;clientId&quot;: client_id,
            &quot;clientSecret&quot;: client_secret
        }
        # Encode request body specification in JSON
        data = json.dumps(data).encode()

        #Request generation
        req = urllib.request.Request(url, data, headers)

        #Send requests and receive responses
        res = urllib.request.urlopen(req)

        # Get response body
        res_body = res.read()

        # Decode response body from JSON
        res_body = json.loads(res_body)

        # Get access token from response body
        access_token = res_body[&quot;access_token&quot;]

        return access_token

    # Specify API URL
    if api_type == &quot;parse&quot;:
        api_name = &quot;parsing&quot;
        base_url_footer = &quot;v1/&quot; + api_type
        request_body_type = 1
    elif api_type == &quot;ne&quot;:
        api_name = &quot;property extraction&quot;
        base_url_footer = &quot;v1/&quot; + api_type
        request_body_type = 1
    elif api_type == &quot;keyword&quot;:
        api_name = &quot;keyword extraction&quot;
        base_url_footer = &quot;v1/&quot; + api_type
        request_body_type = 2
    elif api_type == &quot;coref&quot;:
        api_name = &quot;anaphora analysis&quot;
        base_url_footer = &quot;v1/coreference&quot;
        request_body_type = 2
    elif api_type == &quot;simi&quot;:
        api_name = &quot;Similarity calculation&quot;
        base_url_footer = &quot;v1/similarity&quot;
        request_body_type = 3
    elif api_type == &quot;sen_type&quot;:
        api_name = &quot;Sentence type judgment&quot;
        base_url_footer = &quot;v1/sentence_type&quot;
        request_body_type = 1
    elif api_type == &quot;user_at&quot;:
        api_name = &quot;User attribute estimation (β)&quot;
        base_url_footer = &quot;beta/user_attribute&quot;
        request_body_type = 2
    elif api_type == &quot;filter&quot;:
        api_name = &quot;Stagnation removal (β)&quot;
        base_url_footer = &quot;beta/remove_filler&quot;
        request_body_type = 4
    elif api_type == &quot;detect&quot;:
        api_name = &quot;Voice recognition error detection (β)&quot;
        base_url_footer = &quot;beta/detect_misrecognition&quot;
        request_body_type = 1
    elif api_type == &quot;senti&quot;:
        api_name = &quot;Sentiment analysis&quot;
        base_url_footer = &quot;v1/sentiment&quot;
        request_body_type = 1
    elif api_type == &quot;summary&quot;:
        api_name = &quot;Summary (β)&quot;
        base_url_footer = &quot;beta/summary&quot;
        request_body_type = 5
    else:
        print(&quot;Api Type Error.&quot;)
        sys.exit()

    if api_name_show_switch == 1:
        print(&quot;===&gt;\n&quot; + api_name + &quot;\n===&gt;&quot;)
    
    url = developer_api_base_url + base_url_footer

    #Header specification
    headers={
        &quot;Authorization&quot;: &quot;Bearer &quot;+ getAccessToken(), #access_token,
        &quot;Content-Type&quot;: &quot;application/json;charset=UTF-8&quot;,
    }
    # Request body specification
    if request_body_type == 1:
        data = {
            &quot;sentence&quot;: sentence_1
        }
    elif request_body_type == 2:
        data = {
            &quot;document&quot;: sentence_1
        }
    elif request_body_type == 3:
        data = {
            &quot;s1&quot;: sentence_1,
            &quot;s2&quot;: sentence_2
        }
    elif request_body_type == 4:
        data = {
            &quot;text&quot;: sentence_1
        }
    elif request_body_type == 5:
        data = {
            &quot;document&quot;: sentence_1,
            &quot;sent_len&quot;: sent_len
        }

    # Encode request body specification in JSON
    data = json.dumps(data).encode()
        #Request generation
    req = urllib.request.Request(url, data, headers)
        #Send requests and receive responses
    try:
        res = urllib.request.urlopen(req)
    # Processing when error occurs in request
    except urllib.request.HTTPError as e:# If the status code is 401 Unauthorized, get the access token again and request again
        if e.code == 401:
            access_token = getAccessToken()
            headers[&quot;Authorization&quot;] = &quot;Bearer &quot;+ access_token
            req = urllib.request.Request(url, data, headers)
            res = urllib.request.urlopen(req)
        If the error is not #401, the cause is displayed.
        else:
            print (&quot;&lt;Error&gt; &quot;+ e.reason)
            #sys.exit()

    # Get response body
    res_body = res.read()
    # Decode response body from JSON
    res_body = json.loads(res_body)
    # Get analysis result from response body
    return res_body

</code></pre></div></details>
<p>later</p>
<pre><code class="language-py:" data-lang="py:">cotoha_call(&quot;input&quot;, &quot;text to analyze&quot;)
</code></pre><p>Analysis begins with!</p>
<h2 id="postscript">Postscript</h2>
<p>Those who participate in the project Let&rsquo;s do our best!</p>
<p>##reference
<a href="https://qiita.com/gossy5454/items/83072418fb0c5f3e269f">I tried using the COTOHA API rumored to be easy to handle natural language processing with Python</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
