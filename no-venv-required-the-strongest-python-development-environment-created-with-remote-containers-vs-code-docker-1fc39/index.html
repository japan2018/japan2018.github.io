<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[No venv required] The strongest Python development environment created with Remote Containers [VS Code/Docker] | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[No venv required] The strongest Python development environment created with Remote Containers [VS Code/Docker]</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 21, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/ide">IDE</a></code></small>


<small><code><a href="https://memotut.com/tags/docker">Docker</a></code></small>


<small><code><a href="https://memotut.com/tags/python3">Python3</a></code></small>


<small><code><a href="https://memotut.com/tags/vscode">VSCode</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>Python has been attracting attention because it shines in the top 1 popular languages <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> and becomes a test subject for the IPA Basic Information Engineer Exam <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>.</p>
<p>But wait a minute! Are you able to benefit from the Python ecosystem and develop properly?</p>
<p>By creating a good development environment, not only can the development be made more efficient by input interpolation and formatters <strong>, but also unexpected problems can be prevented by static analysis</strong>, ① Easy ② Explosion speed ③ You can write programs safely.</p>
<p>Of course, there are many How to articles on how to create such a comfortable environment, but the problem is that even if you can create an oleore Python development environment, it is difficult to share it between different PCs.</p>
<p>Because</p>
<ul>
<li>You have to install the same version of the module to be inserted with Python or pip.</li>
<li>You have to install and configure the extension functions of fommter / linter / IDE.</li>
</ul>
<p>That is because there will be problems depending on the development environment.
**I want you to guarantee that the same operation will be performed even between different PCs regardless of individual / multiple people **.
Also, there is a requirement that <strong>the development environment should be built automatically by just opening the project in a text editor</strong>.</p>
<p>So, in this article, I will solve this problem by using VS Code&rsquo;s Remote Container.
With the method described in this article, you can:</p>
<ul>
<li>Whether it&rsquo;s Win / Mac / Linux, the same behavior is guaranteed in all environments <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>, a portable Python development environment can be created.</li>
<li>Even in a new environment, all the settings such as static analysis and automatic formatting are completed just by opening the project.</li>
</ul>
<p>Let&rsquo;s do it</p>
<h1 id="install">Install</h1>
<p>The following tools are used in this article.
Please install while referring to other articles.</p>
<ul>
<li>VSCode</li>
<li>Docker</li>
</ul>
<p>If you can type the following command from the terminal, you are ready to go.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ docker --version
Docker version 19.03.5, build 633a0ea
</code></pre></div><h1 id="remote-containers-settings">Remote Containers settings</h1>
<p>First, create a development directory appropriately and open it with VS Code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ mkdir python-test
</code></pre></div><img width="1025" alt="Screenshots 2019-12-21 16.27.14.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/16ecfe6c-05a6-809e-c5c5-85cb2864a35c.png">
<p>Create the following directory structure</p>
<pre><code>.
└── python-test
    ├── .devcontainer
    │  ├── Dockerfile
    │  └── devcontainer.json
    ├── .vscode
    │  └── extensions.json
    └── src
        └── main.py
</code></pre><p>Copy and paste the following contents into each file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Docker:.devcontainer/Dockerfile" data-lang="Docker:.devcontainer/Dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> python:3.7.3-slim</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> apt-get update <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> apt-get install -y --no-install-recommends <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    apt-utils <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    gcc <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    build-essential <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> pip install --no-cache-dir <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    autopep8 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    flake8 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> apt-get autoremove -y <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> apt-get clean -y <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Here, you can specify the Python version you like by changing the number in the <code>FROM python:3.7.3-slim</code> part.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json:.devcontainer/devcontainer.json" data-lang="json:.devcontainer/devcontainer.json">{
    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Python Project&#34;</span>,
    <span style="color:#f92672">&#34;dockerFile&#34;</span>: <span style="color:#e6db74">&#34;Dockerfile&#34;</span>,
    <span style="color:#f92672">&#34;settings&#34;</span>: {
        <span style="color:#f92672">&#34;terminal.integrated.shell.linux&#34;</span>: <span style="color:#e6db74">&#34;/bin/bash&#34;</span>,
        <span style="color:#f92672">&#34;python.pythonPath&#34;</span>: <span style="color:#e6db74">&#34;/usr/local/bin/python&#34;</span>
    },
    <span style="color:#f92672">&#34;extensions&#34;</span>: [
        <span style="color:#e6db74">&#34;ms-python.python&#34;</span>
    ]
}
</code></pre></div><p>Here, you can replace the &ldquo;&ldquo;name&rdquo;: &ldquo;Python Project&quot;` with any string.</p>
<p><code>settings</code> can be the same as the one written in <code>.vscode/settins.json</code>. Originally, the bash path and python path depend on the environment, so it is necessary to set it for each individual, but this time it is executed in the container, so the path information is known and can be fixed. Is the point.</p>
<p>You can add VS Code extensions to <code>extensions</code>, and the extensions described here will be installed automatically. Remote Containers can force VS Code extensions to be installed, so write the extensions that you want everyone to install. This time we are adding a Python extension for VS Code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:src/main.py" data-lang="python:src/main.py"><span style="color:#f92672">import</span> sys
<span style="color:#66d9ef">print</span>(sys<span style="color:#f92672">.</span>version_info)
</code></pre></div><p>Let&rsquo;s assume that the Python script outputs the version.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json:.vscode/extensions.json" data-lang="json:.vscode/extensions.json">{
    <span style="color:#f92672">&#34;recommendations&#34;</span>: [
        <span style="color:#e6db74">&#34;ms-vscode-remote.remote-containers&#34;</span>
    ]
}
</code></pre></div><p>Specify Remote Containers in Recommendations of VS Code extension.
Note that unlike extensions in <code>devcontainer.json</code>, the description does not actually install it. So once you&rsquo;ve copied and copied the files, re-open VS Code to actually install.
Then you will see the following pop-up at the bottom right. Select Install All to install Remote Container.
<img width="450" alt="Screenshots 2019-12-21 15.09.13.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/4077827c-b05f-148f-0d5f-223bc1c433f0.png"></p>
<p>Once installed successfully, a green button will appear at the bottom left of VS Code.
<img width="141" alt="Screenshots 2019-12-21 14.40.56.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/2239fe12-8517-baab-877f-d577ed4ede4c.png"></p>
<p>When you open it, a menu like this appears,
<img width="594" alt="Screenshots 2019-12-21 14.41.42.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/c9daa882-fc45-92ec-d7c9-f42653384ef9.png"></p>
<p>Select &ldquo;Remote-Containers: Open Folder in Container&hellip;&rdquo;.
When the folder selection screen appears, select the project directory (python-test in this case).</p>
<p>Then, the build of the container described in <code>.devcontainer/Dockerfile</code> runs automatically. You can see the progress by opening details. If you get stuck in the build, see details.
<img width="451" alt="Screenshots 2019-12-21 14.45.37.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/50aad18d-55f8-f073-f030-24ff0b65f0a7.png"></p>
<p>When the build is completed normally, the container will be started and connected as it is. Once connected to the container, open VS Code&rsquo;s internal terminal.
<img width="1138" alt="Screenshots 2019-12-21 14.58.01.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/f9a232e7-4c95-e395-0d88-079ea63f82f4.png"></p>
<p>Oh? Somehow, the shell user is root, and the directory is also <code>/workspaces</code>. This means that it is put in the terminal of the container independent of the host OS, not the terminal of the host OS (Win / Mac etc.).</p>
<p>I don&rsquo;t know Docker! Some people may say, but let&rsquo;s run Python for now.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/workspaces/python-test# python src/main.py
sys.version_info<span style="color:#f92672">(</span>major<span style="color:#f92672">=</span>3, minor<span style="color:#f92672">=</span>7, micro<span style="color:#f92672">=</span>3, releaselevel<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;final&#39;</span>, serial<span style="color:#f92672">=</span>0<span style="color:#f92672">)</span>
</code></pre></div><p>The version of python specified in <code>FROM python:3.7.3-slim</code> is included!
This completes the basic settings.</p>
<p>In the future, even if you <code>git clone</code> on another PC, you can reproduce the same environment by entering into the container with &ldquo;Remote-Containers: Open Folder in Container&hellip;&rdquo;.</p>
<h1 id="requirementstxt-settings">requirements.txt settings</h1>
<p>This is inside the container, so you can do a <code>pip install</code> on it. The module installed here does not affect the host OS at all, so you can proceed with the development destructively.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/workspaces/python-test# pip install numpy
/workspaces/python-test# python
&gt;&gt;&gt; import numpy as np&gt;&gt;&gt; np.__version__
<span style="color:#e6db74">&#39;1.17.4&#39;</span>
</code></pre></div><p>Also, if you build the container again and recreate it, the installed modules will disappear. So, let&rsquo;s fix this pip module while developing! If that happens, let&rsquo;s create a <code>requirements.txt</code>, which is the convention used in Python, and write a module to do <code>pip install</code> there.</p>
<p>The directory structure and how to write <code>requirements.txt</code> is as follows.</p>
<pre><code>.
└── python-test
    ├── .devcontainer
    │  ├── Dockerfile
    │  └── devcontainer.json
    ├── .vscode
    │  └── extensions.json
    └── requirements.txt
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt:requirements.txt" data-lang="txt:requirements.txt">numpy==1.17.4
</code></pre></div><p>In the requirements.txt, you can write a fixed version for <code>pip install</code>. A fixed version is recommended to ensure reproducibility.</p>
<p>And let&rsquo;s make the <code>devcontainer.json</code> as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json:.devcontainer/devcontainer.json" data-lang="json:.devcontainer/devcontainer.json">{
    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Python Project&#34;</span>,
    <span style="color:#f92672">&#34;dockerFile&#34;</span>: <span style="color:#e6db74">&#34;Dockerfile&#34;</span>,
    <span style="color:#f92672">&#34;settings&#34;</span>: {
        <span style="color:#f92672">&#34;terminal.integrated.shell.linux&#34;</span>: <span style="color:#e6db74">&#34;/bin/bash&#34;</span>,
        <span style="color:#f92672">&#34;python.pythonPath&#34;</span>: <span style="color:#e6db74">&#34;/usr/local/bin/python&#34;</span>
    },
    <span style="color:#f92672">&#34;extensions&#34;</span>: [
        <span style="color:#e6db74">&#34;ms-python.python&#34;</span>
    ],
    <span style="color:#f92672">&#34;postCreateCommand&#34;</span>: <span style="color:#e6db74">&#34;pip install -r requirements.txt&#34;</span>
}
</code></pre></div><p>You have added <code>postCreateCommand</code>. This is the command to run after the container is created. In the future, the modules described in <code>requirements.txt</code> will always be installed.</p>
<p>After updating the file, press the green button in the lower left and select &ldquo;Remote-Containers: Rebuild Container&rdquo; to reflect the update in the container.</p>
<p>Set # formatter / linter</p>
<p>Next, set formatter / linter.
The <code>devcontainer.json</code> when the formatter / linter of python is added is as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json:.devcontainer/devcontainer.json" data-lang="json:.devcontainer/devcontainer.json">{
    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Python Project&#34;</span>,
    <span style="color:#f92672">&#34;dockerFile&#34;</span>: <span style="color:#e6db74">&#34;Dockerfile&#34;</span>,
    <span style="color:#f92672">&#34;settings&#34;</span>: {
        <span style="color:#f92672">&#34;terminal.integrated.shell.linux&#34;</span>: <span style="color:#e6db74">&#34;/bin/bash&#34;</span>,
        <span style="color:#f92672">&#34;python.pythonPath&#34;</span>: <span style="color:#e6db74">&#34;/usr/local/bin/python&#34;</span>,
        <span style="color:#f92672">&#34;python.linting.pylintEnabled&#34;</span>: <span style="color:#66d9ef">false</span>,
        <span style="color:#f92672">&#34;python.linting.flake8Enabled&#34;</span>: <span style="color:#66d9ef">true</span>,
        <span style="color:#f92672">&#34;python.linting.flake8Args&#34;</span>: [
            <span style="color:#e6db74">&#34;--ignore=E402,E501&#34;</span>
        ],
        <span style="color:#f92672">&#34;python.formatting.provider&#34;</span>: <span style="color:#e6db74">&#34;autopep8&#34;</span>,
        <span style="color:#f92672">&#34;python.formatting.autopep8Args&#34;</span>: [
            <span style="color:#e6db74">&#34;--ignore&#34;</span>,
            <span style="color:#e6db74">&#34;E402,E501&#34;</span>,
            <span style="color:#e6db74">&#34;--max-line-length&#34;</span>,
            <span style="color:#e6db74">&#34;150&#34;</span>
        ],
        <span style="color:#f92672">&#34;[python]&#34;</span>: {
            <span style="color:#f92672">&#34;editor.formatOnSave&#34;</span>: <span style="color:#66d9ef">true</span>
        }
    },
    <span style="color:#f92672">&#34;extensions&#34;</span>: [
        <span style="color:#e6db74">&#34;ms-python.python&#34;</span>
    ],
    <span style="color:#f92672">&#34;postCreateCommand&#34;</span>: <span style="color:#e6db74">&#34;pip install -r requirements.txt&#34;</span>,
}
</code></pre></div><p>I specified flake8 as linter and autopep8 as formatter, and Ignore E402 (Module level import not at top of file) and E501 (Line too long) respectively. Format is applied when the file is saved.</p>
<p>Even if you write such a messy code with this,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:before.py" data-lang="python:before.py">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">method1</span>(args):
    <span style="color:#66d9ef">print</span>( args)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">method2</span>():
    <span style="color:#66d9ef">if</span> a <span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
            method1( <span style="color:#e6db74">&#34;hoge&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;fuga&#34;</span>)
</code></pre></div><p>In this way, it will be formatted when saving.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:after.py" data-lang="python:after.py">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">method1</span>(args):
    <span style="color:#66d9ef">print</span>(args)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">method2</span>():
    <span style="color:#66d9ef">if</span> a <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        method1(<span style="color:#e6db74">&#34;hoge&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;fuga&#34;</span>)
</code></pre></div><p>Usually, such formatter / linter settings are described in <code>.vscode/settings.json</code>. However, since <code>.vscode/settings.json</code> is a personal setting file, many projects set it to <code>.gitignore</code>. In addition, just because you need to manually run <code>pip install flake8 autopep8</code>, just because you wrote the configuration file does not mean that formatter / linter is applied.</p>
<p>On the other hand, this time, since it can be written in the configuration file of Remote Containers, it is easy to share it, and the state that flake8 and autopep8 are included can be reproduced reliably, so &ldquo;source code without format is committed&rdquo;. You can also prevent that.</p>
<p>By the way, where was <code>pip install flake8 autopep8</code> running?
The answer is in <code>.devcontainer/Dockerfile</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Docker:.devcontainer/Dockerfile" data-lang="Docker:.devcontainer/Dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> python:3.7.3-slim</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> apt-get update <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> apt-get install -y --no-install-recommends <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    apt-utils <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    gcc <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    build-essential <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> pip install --no-cache-dir <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    autopep8 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    flake8 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> apt-get autoremove -y <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> apt-get clean -y <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>If you want to write <code>pytest</code> in the container, you can add it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Docker:.devcontainer/Dockerfile" data-lang="Docker:.devcontainer/Dockerfile"><span style="color:#66d9ef">RUN</span> pip install --no-cache-dir <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    autopep8 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    flake8 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    pytest<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Also, autopep8 and flake8 are needed at development time, not at runtime. You can write such a module in a Dockerfile and write the files required at runtime in <code>requirements.txt</code>.</p>
<h1 id="static-type-analysis">Static type analysis</h1>
<p>Finally, let&rsquo;s introduce Type Hints that can be used with Python 3.6 or later <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>. By introducing Type Hints, QoL will explode.</p>
<p>Make the <code>devcontainer.json</code> look like this
Here, pyright is used as a static analysis tool of Type Hints.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json:.devcontainer/devcontainer.json" data-lang="json:.devcontainer/devcontainer.json"> <span style="color:#e6db74">&#34;extensions&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> [
    <span style="color:#e6db74">&#34;ms-python.python&#34;</span>,
    <span style="color:#e6db74">&#34;ms-pyright.pyright&#34;</span>
 ]<span style="color:#960050;background-color:#1e0010">,</span>
</code></pre></div><p>After changing, press the green button on the bottom left and select &ldquo;Remote-Containers: Rebuild Container&rdquo;.</p>
<p>Next, write the pyright configuration file.
The directory structure is as follows.</p>
<pre><code>.
└── python-test
    ├── pyrightconfig.json
    └── src
        └── main.py
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json:pyrightconfig.json" data-lang="json:pyrightconfig.json">{
    <span style="color:#f92672">&#34;include&#34;</span>: [
        <span style="color:#e6db74">&#34;src&#34;</span>
    ],
    <span style="color:#f92672">&#34;reportTypeshedErrors&#34;</span>: <span style="color:#66d9ef">false</span>,
    <span style="color:#f92672">&#34;reportMissingImports&#34;</span>: <span style="color:#66d9ef">true</span>,
    <span style="color:#f92672">&#34;reportMissingTypeStubs&#34;</span>: <span style="color:#66d9ef">false</span>,
    <span style="color:#f92672">&#34;pythonVersion&#34;</span>: <span style="color:#e6db74">&#34;3.7&#34;</span>,
    <span style="color:#f92672">&#34;pythonPlatform&#34;</span>: <span style="color:#e6db74">&#34;Linux&#34;</span>,
    <span style="color:#f92672">&#34;executionEnvironments&#34;</span>: [
        {
            <span style="color:#f92672">&#34;root&#34;</span>: <span style="color:#e6db74">&#34;src&#34;</span>
        }
    ]
}
</code></pre></div><p>See other articles for details on how to write pyrightconfig.json. (Maybe I&rsquo;ll write another)</p>
<p>Now, let&rsquo;s edit <code>src/main.py</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:src/main.py" data-lang="python:src/main.py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>(name: str, age: int) <span style="color:#f92672">-&gt;</span> str:
    result1: str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;My name is &#34;</span><span style="color:#f92672">+</span> name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
    result2: int <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;I am &#34;</span><span style="color:#f92672">+</span> str(age) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;years old.&#34;</span>
    <span style="color:#66d9ef">return</span> result1 <span style="color:#f92672">+</span> result2


result: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
result <span style="color:#f92672">=</span> hello(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Otao&#34;</span>, age<span style="color:#f92672">=</span><span style="color:#ae81ff">23</span>)
<span style="color:#66d9ef">print</span>(result)
</code></pre></div><p>With Type Hints in python, you can add type annotations to functions and variables like this.
If you open <code>src/main.py</code> with pyright installed,&hellip;<img width="432" alt="Screenshots 2019-12-21 16.13.41.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/a4e06f22-726d-7f3d-f020-1cb61d7bc93a.png">
result2 is an int type, so str type cannot be assigned!
<img width="619" alt="Screenshots 2019-12-21 16.14.01.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/f38d1287-ddb8-4cf2-8330-4c860c7729ff.png">
The str and int <code>+</code> operators are not defined! !
<img width="507" alt="Screenshots 2019-12-21 16.14.10.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/2fc87f18-9f7f-757f-b5fc-79e093713d28.png">
result is defined as int type, but I&rsquo;m trying to assign str type to it! ! !
I will also post the definition of the hello function! ! !
<img width="570" alt="Screenshots 2019-12-21 16.14.22.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/23949/d3b20420-6b2c-1997-f941-407bb85816c3.png">
The error about the type is displayed like this.</p>
<p>Using Type Hints is recommended for the following reasons.</p>
<ul>
<li>Defining types messes up readability</li>
<li>The possibility of unexpected types coming into variables and causing problems is reduced.</li>
<li>Input completion function on VS Code works</li>
</ul>
<p>Let&rsquo;s introduce it.</p>
<p>Well, mysteriously (?) This script can be executed w
(Type Hints are annotations, so they are ignored during execution.)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/workspaces/python-test# python3 src/main.py
My name is Otao.
I am <span style="color:#ae81ff">23</span> years old.
</code></pre></div><h1 id="at-the-end">At the end</h1>
<p>Have a comfortable Python life!
(Articles will be updated accordingly.)</p>
<ul>
<li>Author information
<ul>
<li>Twitter: <a href="https://twitter.com/0MeO">@0meo</a></li>
</ul>
</li>
</ul>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>Programming language you want to learn, language you do not want, <a href="https://tech.nikkeibp.co.jp/atcl/nxt/column/18/00501/111200004/">https://tech.nikkeibp.co.jp/atcl/nxt/column/18/00501/111200004/</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>Press announcement Review the questions in the basic information engineer examination, <a href="https://www.ipa.go.jp/about/press/20190124.html">https://www.ipa.go.jp/about/press/20190124.html</a> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>Actually, the behavior may differ depending on the host OS, and it may be necessary to modify the Dockerfile. <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>It&rsquo;s not accurate because Type Hints for functions have been from 3.5, but it is 3.6 or later that you can add type annotations to variables, so I want you to use 3.6 or later <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
