<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Hash chain, a data structure that grows with history | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Hash chain, a data structure that grows with history</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 18, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/hash">hash</a></code></small>


<small><code><a href="https://memotut.com/tags/blockchain">Blockchain</a></code></small>

</p>
<pre><code>This article is the data structure and algorithm Advent Calendar 2019 Day 18 article.
</code></pre>
<p>On the 17th day, @takilog wrote about &ldquo;Fréchet distance calculation algorithm&rdquo;. It was interesting, so I decided to study a little!
On the 19th day, I&rsquo;m in charge of @tsukasa__diary!</p>
<p>Blockchain technology has been attracting attention in various fields such as cryptographic assets, traceability, and intellectual property management as tamper resistant technology. One of the things that play a major role in improving the security of such blockchains is the <strong>hash chain</strong> data structure.</p>
<p>#Skillful structure that makes use of hash function
A hash function is a function that outputs a constant bit length regardless of the input bit length. The hash function has the following typical characteristics.</p>
<ul>
<li>Outputs data of a certain bit length regardless of the bit length of the input value</li>
<li>The output value changes greatly even if the input value changes slightly</li>
</ul>
<p>Now, for the hash chain of the main subject, this is generated by using the hash function to output the hash value together with other data to generate a hash value and connecting it like a chain.</p>
<p>This creates a dependency on the surrounding hash values.</p>
<p>Considering that one of the features of the hash function is <strong>outputting data of a fixed length regardless of the data size of the input value</strong>, which data is hashed together with the hash value? However, you can see that you can make the length constant by multiplying it by a hash function, even if there are many.</p>
<p>In addition, <strong>the output value changes greatly even if the input value changes slightly</strong>, so if the data that exists in time before a certain hash value changes, the changed data You can see that the data in the back fluctuates greatly.</p>
<p>In this way, the hash chain has a data structure that can make a dependency before and after by making good use of the characteristics of the hash function. As a result, it is possible to express the data before or after the time, so that it can be used as a time stamp.</p>
<h1 id="simple-implementation-of-hash-chain">Simple implementation of hash chain</h1>
<p>Now let&rsquo;s easily implement a hash chain. This time I will implement using Python. By the way, to use the hash function, we use a package called hashlib. SHA256 is used as the hash function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:hashchain.py" data-lang="python:hashchain.py"><span style="color:#f92672">import</span> hashlib

hashchain <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;0000000000000000000000000000000000000000000000000000000000000000&#34;</span>]

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>):
    previous_hash <span style="color:#f92672">=</span> hashchain[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    input_data <span style="color:#f92672">=</span> previous_hash <span style="color:#f92672">+</span> str(i)
    hash_value <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha256(input_data<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest()
    hashchain<span style="color:#f92672">.</span>append(hash_value)

<span style="color:#66d9ef">for</span> h <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">21</span>):
    <span style="color:#66d9ef">print</span>(str(h)<span style="color:#f92672">.</span>rjust(<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;0&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;→ &#34;</span><span style="color:#f92672">+</span> hashchain[h])
</code></pre></div><p>The output result is as follows.</p>
<pre><code>00 → 0000000000000000000000000000000000000000000000000000000000000000
01 → e531ef0f962409170917abf9de3287afec23dd1c42c9e1fea66c5feab99e8f7c
02 → 78bfc883be934340ac839dcb172ccc44fb71e321660ff5f96a2fde51987e6dde
03 → 7e09bd321bed764f23e8bf63dacf242c877bf3c220f6e8972f211048493ad482
04 → e4724753b4de43f674d58796e5c34b6a37027ff753f487628f0db1e98d60d6f5
05 → 2c3ad1f6144d93e3a32d16dbcfb35255f2e137a14807bd7d5deba9a9a67a8a59
06 → dfa3e16e515d92158e3cf192b335732526aeaa32214bb1ab176cad4b8dce44cc
07 → 4400045f0173fe5321d0f0804b2c62b087bcba990d780bcecc5e8d9cc3d1bc23
08 → 15fda2298655bb712584d22703c7d479180f2b8657049a67293936a435259382
09 → 5cd5f8e2d12357755c5f6a4c8c87697c112123d04c8c463d546dc2577651aad4
10 → 39e239f7562b413273704c13e7eb9581f04c3257d0ef6be10976c48df6585922
11 → df9cc505cf339e98b59f2da52e24a8d7b8fdf02f7ebee88071677f8f3e7ddff0
12 → 459d019e029356caccfbe78309f740306770e511c483ad3fe8339ddbe7e237dd
13 → 6af212f574623719c3ed33ec84b70a01cf8d9b48c989c83c690f37d969c17d3b
14 → f9fdc2226652ebc68e5898f1e319a1e229587e7d794c5367a6b11365604fa179
15 → f3af5537bc19fb1ad26854ac137fb6161743f5c0cd356971394384a9910bb625
16 → a07c0ca7f03d623ecc5641ab0632146dc7b9519f0b3c651c1075f03e4bd5109f
17 → 1923f411a6b9fa14ac7a4daa0aa93d5a9b78c732533b25af88fd9d1c4e7ca5c1
18 → d18af50c3f49d2f1ae2560064d32be044b17097330964ca6b9a958a1c6e53101
19 → 017c93cf83997aa5f7adb1583e39ced9b98215e154f76931c08821225b7ebd0b
20 → e978d91667b6e2031500ef28282bbe20fc8358945b76e2b229ae58c3f7b1088f
</code></pre><p>This time, we simply add an index to the previous hash value and collectively hash it.</p>
<p>#In the actual blockchain?
Hash chains are used in blockchain technology, but they are not as simple as the simple implementation above. It is also used in combination with other technologies such as consensus algorithms. (In fact, it&rsquo;s more complicated&hellip;)</p>
<h2 id="what-is-a-consensus-algorithm">What is a consensus algorithm?</h2>
<p>The consensus algorithm is a procedure for uniquely determining the correct information on a distributed network.</p>
<p>For example, in a P2P network, there is no one who decides the correct data, so it is impossible to decide which data to believe. Therefore, there is a consensus algorithm in order to form consensus among machines in equal positions.</p>
<p>Recently, various types of blockchains have appeared, and the consensus algorithm is also increasing in variation. Famous places include Proof of Work, Proof of Stake, Proof of Importance, Delegated Proof of Stake.</p>
<p>In terms of the relationship between the hash chain and the consensus algorithm, I think that it is basically okay to think of it as a procedure for deciding which calculated hash value is correct.</p>
<p>#Summary</p>
<p>The new hash value at the beginning of the hash chain carries the history of all the hash calculations that have been done on that hash chain. For blockchains such as Bitcoin, there is a rule that the longest blockchain is correct information. This is partly because the longest chains have accumulated the most correct calculations.</p>
<p>I personally think that the data structure of the hash chain is a funny guy that grows up while incorporating history and time, but what about you guys?</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
