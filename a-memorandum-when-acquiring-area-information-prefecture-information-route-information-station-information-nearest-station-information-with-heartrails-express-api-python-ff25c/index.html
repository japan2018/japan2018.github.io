<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>A memorandum when acquiring area information / prefecture information / route information / station information / nearest station information with HeartRails Express API (python) | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>A memorandum when acquiring area information / prefecture information / route information / station information / nearest station information with HeartRails Express API (python)</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 1, 2019
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>

</p>
<pre><code># Purpose
</code></pre>
<p>A memorandum when acquiring area information / prefecture information / route information / station information / nearest station information with HeartRails Express API (python)</p>
<blockquote>
<p><a href="http://express.heartrails.com/api.html#nearest">http://express.heartrails.com</a></p>
</blockquote>
<p>#Preparation</p>
<p>Install request transmission module</p>
<pre><code>pip install requests
</code></pre><p>#Test</p>
<h3 id="area-information-acquisition-api">Area information acquisition API</h3>
<p>Get default area</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-b:sample.py" data-lang="b:sample.py"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#75715e"># -*- coding: utf-8 -*-</span>

<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> requests

url <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://express.heartrails.com/api/json?method=getAreas&#39;</span>
ret <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
ret_json <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(ret<span style="color:#f92672">.</span>text)
<span style="color:#66d9ef">print</span>(ret_json)
</code></pre></div><pre><code>$python sample1.py
{'response': {'area': ['Hokkaido','Tohoku','Kanto','Chubu','Kinki','China','Shikoku','Kyushu']}}
</code></pre><h3 id="prefecture-information-acquisition-api">Prefecture information acquisition API</h3>
<p>Get default prefecture name</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-b:sample.py" data-lang="b:sample.py"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#75715e"># -*- coding: utf-8 -*-</span>

<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> requests

url <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://express.heartrails.com/api/json?method=getPrefectures&#39;</span>
ret <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
ret_json <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(ret<span style="color:#f92672">.</span>text)
<span style="color:#66d9ef">print</span>(ret_json)
</code></pre></div><pre><code>$python sample.py
{'response': {'prefecture': ['Hokkaido','Aomori prefecture','Iwate prefecture','Miyagi prefecture','Akita prefecture','Yamagata prefecture','Fukushima prefecture','Ibaraki prefecture', 'Tochigi prefecture','Gunma prefecture','Saitama prefecture','Chiba prefecture','Tokyo','Kanagawa prefecture','Niigata prefecture','Toyama prefecture','Ishikawa prefecture','Fukui prefecture', 'Yamanashi prefecture','Nagano prefecture','Gifu prefecture','Shizuoka prefecture','Aichi prefecture','Mie prefecture','Shiga prefecture','Kyoto prefecture','Osaka prefecture','Hyogo prefecture', 'Nara prefecture','Wakayama prefecture','Tottori prefecture','Shimane prefecture','Okayama prefecture','Hiroshima prefecture','Yamaguchi prefecture','Tokushima prefecture','Kagawa prefecture','Ehime prefecture', 'Kochi prefecture','Fukuoka prefecture','Saga prefecture','Nagasaki prefecture','Kumamoto prefecture','Oita prefecture','Miyazaki prefecture','Kagoshima prefecture','Okinawa prefecture']}}
</code></pre><h3 id="route-information-acquisition-api">Route information acquisition API</h3>
<p>ex. prefecture=Osaka Prefecture route information acquired</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-b:sample.py" data-lang="b:sample.py"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#75715e"># -*- coding: utf-8 -*-</span>

<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> requests

url <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://express.heartrails.com/api/json?method=getLines&amp;prefecture=Osaka Prefecture&#39;</span>
ret <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
ret_json <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(ret<span style="color:#f92672">.</span>text)
<span style="color:#66d9ef">print</span>(ret_json)
<span style="color:#66d9ef">print</span>(ret_json[<span style="color:#e6db74">&#34;response&#34;</span>][<span style="color:#e6db74">&#34;line&#34;</span>][<span style="color:#ae81ff">0</span>])
<span style="color:#66d9ef">print</span>(len(ret_json[<span style="color:#e6db74">&#34;response&#34;</span>][<span style="color:#e6db74">&#34;line&#34;</span>]))
</code></pre></div><pre><code>$python sample.py
{'response': {'line': ['JR Kyoto Line','JR Yamato Line','JR Osaka Loop Line','JR Tozai Line','JR Sakurajima Line','JR Katamachi Line','JR 'Kobe Line','JR Fukuchiyama Line','JR Kansai Airport Line','JR Hanwa Line','Keihan Katano Line','Keihan Main Line','Keihan Nakanoshima Line','Kita Osaka Express','Nankai Tanagawa Line' ','Nankai Main Line','Nankai Shiomibashi Line','Nankai Airport Line','Nankai Takashihama Line','Nankai Koya Line','Osaka Monorail','Osaka Monorail Saito Line','Osaka Chuo Line' ,'Osaka Sennichimae Line','Osaka Nanko Port Town Line','Osaka Yotsubashi Line','Osaka Sakaisuji Line','Osaka Midosuji Line','Osaka Tanimachi Line','Osaka Nagahori Tsurumi Ryokuchi Line', 'Sanyo Shinkansen','Tokaido Shinkansen','Mizu Railway','Senboku High Speed Rail','Nose Electric Railway Myoken Line','Kintetsu Keihanna Line','Kintetsu Shinki Line','Kintetsu Minami Osaka Line','Kintetsu Line' 'Osaka Line','Kintetsu Nara Line','Kintetsu Nishinobu Cable Line','Kintetsu Myoji Line','Kintetsu Nagano Line','Hankai Denki Kamimachi Line','Hankai Denki Hankai Line',' Hankyu Kyoto Main Line, Hankyu Senri Line, Hankyu Takarazuka Main Line, Hankyu Kobe Main Line, Hankyu Minoh Line, Hanshin Main Line, Hanshin Namba Line, Osaka Imazato Line, and Osaka East line']}}
JR Kyoto Line
54
</code></pre><h3 id="station-information-acquisition-api">Station information acquisition API</h3>
<p>ex. Enter &ldquo;name=Osaka&rdquo;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rb:sample.py" data-lang="rb:sample.py"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#75715e"># -*- coding: utf-8 -*-</span>

<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> requests

url <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://express.heartrails.com/api/json?method=getStations&amp;name=Osaka&#39;</span>
ret <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
ret_json <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(ret<span style="color:#f92672">.</span>text)
<span style="color:#66d9ef">print</span>(ret_json)
</code></pre></div><pre><code>$python sample.py
{'response': {'station': [{'name':'Osaka','prefecture':'Osaka prefecture','line':'JR Kyoto line','x': 135.495188,'y': 34.702398 ,'postal': '5300001','prev':'Shin Osaka','next': None}, {'name':'Osaka','prefecture':'Osaka Prefecture','line':'JR Osaka Loop line','x': 135.495188,'y': 34.702398,'postal': '5300001','prev': None,'next':'Fukushima'}, {'name':'Osaka','prefecture ':'Osaka Prefecture','line':'JR Kobe Line','x': 135.495188,'y': 34.702398,'postal': '5300001','prev': None,'next':'Tsukamoto' }, {'name':'Osaka','prefecture':'Osaka Prefecture','line':'JR Fukuchiyama Line','x': 135.495188,'y': 34.702398,'postal': '5300001', 'prev': None,'next':'Amagasaki'}]}}
</code></pre><h3 id="nearest-station-information-acquisition-api">Nearest station information acquisition API</h3>
<p>ex. Enter the latitude and longitude of Osaka (x=135.495188, y=34.702398)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-b:sample.py" data-lang="b:sample.py"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#75715e"># -*- coding: utf-8 -*-</span>

<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> requests

url <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://express.heartrails.com/api/json?method=getStations&amp;x=135.495188&amp;y=34.702398&#39;</span>
ret <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
ret_json <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(ret<span style="color:#f92672">.</span>text)
<span style="color:#66d9ef">print</span>(ret_json)
</code></pre></div><pre><code>$python sample.py
{'response': {'station': [{'name':'Osaka','prefecture':'Osaka prefecture','line':'JR Kyoto line','x': 135.495188,'y': 34.702398 ,'postal': '5300001','distance': '00m','prev':'Shin-Osaka','next': None}, {'name':'Osaka','prefecture':'Osaka Prefecture' ,'line':'JR Osaka Loop Line','x': 135.495188,'y': 34.702398,'postal': '5300001','distance': '00m','prev': None,'next': 'Fukushima'}, {'name':'Osaka','prefecture':'Osaka Prefecture','line':'JR Kobe Line','x': 135.495188,'y': 34.702398,'postal':' 5300001','distance': '00m','prev': None,'next':'Tsukamoto'}, {'name':'Osaka','prefecture':'Osaka prefecture','line':'JR Fukuchiyama Line','x': 135.495188,'y': 34.702398,'postal': '5300001','distance': '00m','prev': None,'next':'Amagasaki'}, {'name ':'Umeda','prefecture':'Osaka Prefecture','line':'Hanshin Main Line','x': 135.496745,'y': 34.701242,'postal': '5300001','distance': '190m ','prev':'Fukushima','next': None}, {'name':'Umeda','prefecture':'Osaka Prefecture','line':'Osaka Midosuji Line','x': 135.497496 ,'y': 34.703765,'postal': '5300017','distance': '260m','prev':'Nakatsu','next':' Yodoyabashi'}, {'name':' Nishiumeda', ' prefecture':'Osaka prefecture', 'line':'Osaka Yotsubashi Line','x': 135.495802,'y': 34.699642,'postal': '5300001','distance': '310m','prev': None,'next': 'Higobashi'}]}}
</code></pre><h1 id="error-countermeasure">Error countermeasure</h1>
<pre><code>$python sample3.py
{'response': {'error': &quot;Area'%E5%A4%A7%E9%98%AA%E5%BA%9C' not found.&quot;}}
</code></pre><p>If the HTTP request parameter is incorrect, the above error will occur</p>
<p>#Reference
<a href="http://express.heartrails.com/api.html#nearest">http://express.heartrails.com</a>
<a href="https://qiita.com/Frisys/items/b754d9ecf4b3b5f638e3">I tried using API such as route map</a>
<a href="https://qiita.com/MYamate_jp/items/0f01742e0b32a012a5a9">Use transfer guidance open API in apps</a><a href="https://qiita.com/valsitoh/items/37e18cb76944cc7d05fe">TryusingWebAPIwithStationSpareWebService</a>
<a href="https://biz.jorudan.co.jp/file/norikae_openAPI.pdf">Transfer guidance open API specifications</a>
<a href="https://qiita.com/izmth/items/3574c8d435c289a41955">Get time from any address to the nearest station with Google Maps API</a>
<a href="https://ferret-plus.com/2481">20 APIs provided by public institutions and related services</a>
<a href="https://qiita.com/pyon2/items/3805165b65abcb14d79b">Memo writing of open data</a>
<a href="https://qiita.com/ryo-a/items/4f651dbcf82537ac36f1">I made an API like JSON of JMA data</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
