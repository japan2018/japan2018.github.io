<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>When a local variable with the same name as a global variable is defined in the function | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>When a local variable with the same name as a global variable is defined in the function</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 24, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>

</p>
<pre><code>Variable `bar` in the function definition below is interpreted as a global variable because `bar` is not defined in the function block.
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">foo</span>():
    <span style="color:#66d9ef">print</span>(bar)
</code></pre></div><p>The code below succeeds because the global variable <code>bar</code> is defined before calling <code>foo</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">bar <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">foo</span>():
    <span style="color:#66d9ef">print</span>(bar)

foo() <span style="color:#75715e"># =&gt; 4</span>
</code></pre></div><p>The global variable of <code>foo</code> can be confirmed by the attribute <code>co_names</code> of the code object of <code>foo</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">foo<span style="color:#f92672">.</span>__code__<span style="color:#f92672">.</span>co_names <span style="color:#75715e"># =&gt; (&#39;print&#39;,&#39;bar&#39;)</span>
</code></pre></div><p>By the way, Python&rsquo;s <a href="https://docs.python.org/3/library/inspect.html">official document</a>saysthat<code>co_names</code>isthelocalvariablename<code>tuple</code>,but<a href="https://stackoverflow.com/questions/45147260/what-is-co-names">(localvariablenameAnd(excludingfreevariables)misnamed</a>.</p>
<p><code>bar</code> in the function definition below is interpreted as a local variable because <code>bar</code> is defined in the function block.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">foo</span>():
    <span style="color:#66d9ef">print</span>(bar)
    bar <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">foo<span style="color:#f92672">.</span>__code__<span style="color:#f92672">.</span>co_names <span style="color:#75715e"># =&gt; (&#39;print&#39;,)</span>
</code></pre></div><p>The local variables of <code>foo</code> can be checked by the attribute <code>co_varnames</code> of the code object of <code>foo</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">foo<span style="color:#f92672">.</span>__code__<span style="color:#f92672">.</span>co_varnames <span style="color:#75715e"># =&gt; (&#39;bar&#39;,)</span>
</code></pre></div><p>Since this interpretation is determined when the function definition is made, even if <code>bar</code> precedes the definition of <code>bar</code>, it is not interpreted as a global variable and an error is output as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">bar <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">foo</span>():
    <span style="color:#66d9ef">print</span>(bar)
    bar <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>

foo()
<span style="color:#75715e"># =&gt; UnboundLocalError: local variable&#39;bar&#39; referenced before assignment</span>
</code></pre></div><p>In other words, the name in the function block is determined to be a global variable or a local variable (or free variable) at the stage of function definition, and it is not rebound from the global variable to the local variable at the time of assignment to the name.</p>
<p>In addition, comprehensions such as lists introduce a new scope, but only the iterable corresponding to the first <code>for</code> is interpreted in the outer scope. The example below succeeds, but of the three <code>bar</code>s in the list comprehension, the rightmost <code>bar</code> is interpreted as the scope of <code>foo</code>, the global variable <code>bar</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">bar <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">3</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">foo</span>():
    <span style="color:#66d9ef">print</span>([bar <span style="color:#66d9ef">for</span> bar <span style="color:#f92672">in</span> bar])

foo() <span style="color:#75715e"># =&gt; [0, 1, 2]</span>
</code></pre></div>
    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
