<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Build environment with pyenv and pyenv-virtualenv | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Build environment with pyenv and pyenv-virtualenv</h1>
<p>
  <small class="text-secondary">
  
  
  Oct 30, 2015
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/pyenv">pyenv</a></code></small>


<small><code><a href="https://memotut.com/tags/pyenv-virtualenv">pyenv-virtualenv</a></code></small>

</p>
<pre><code>## A note on how to build your own environment
</code></pre>
<p>I will write it down because I need it when working remotely
The referenced website may be easier to understand
The environment is <code>mac OSX: Yosemite</code>.</p>
<p>#pyenv
pyenv manages the python environment.
You can create a python environment that is different from the standard environment.</p>
<p>Reference URL:
<a href="https://www.qoosky.net/references/263/">How to use pyenv and virtualenv</a>
<a href="https://omoshetech.com/how-to-manage-python-environments-by-pyenv/">How to manage Python environment with pyenv</a>
<a href="http://cocodrips.hateblo.jp/entry/2014/09/02/171127">Try using pyenv and virtualenv</a></p>
<h2 id="people-who-do-not-want-to-read-explanations-knowledgeable-people">People who do not want to read explanations (knowledgeable people)</h2>
<p><a href="https://github.com/KodairaTomonori/Qiita/blob/master/shell/construct_pyenv.sh">https://github.com/KodairaTomonori/Qiita/blob/master/shell/construct_pyenv.sh</a>
Copy this and run it to build the environment in your home
If you want to build it other than home, you can rewrite the ~/ part to any path.
*It is additionally written to ~/.bash_profile.</p>
<h2 id="enable-pyenv">enable pyenv</h2>
<p>First, git clone
<code>$ git clone https://github.com/yyuu/pyenv.git ~/.pyenv</code></p>
<p>And write the following in <code>~/.bash_profile</code>. (About .bashrc and .bash_profile: [Really correct use of .bashrc and .bash_profile]](<a href="http://qiita.com/magicant/items/d3bb7ea1192e63fba850">http://qiita.com/magicant/items/d3bb7ea1192e63fba850</a>)</p>
<pre><code>export PYENV_ROOT=&quot;$HOME/.pyenv&quot;
export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;
eval &quot;$(pyenv init -)&quot;
</code></pre><p>* 2020/03/17 Modified: Double quote added</p>
<h2 id="install-each-version-of-python">Install each version of python</h2>
<p>You can install it with <code>pyenv install 3.5.0</code>. The version is optional.</p>
<h1 id="heading"></h1>
<pre><code class="language-install-version." data-lang="install-version.">$ pyenv install 3.5.0
$ pyenv install 2.7.9
</code></pre><p>If you make a mistake, uninstall it by changing <code>install</code> to <code>uninstall</code>.</p>
<h2 id="python-version-switching">Python version switching</h2>
<p>You can switch the version with <code>pyenv global x.x.x</code> or <code>pyenv local x.x.x</code>.
If you set it to <code>global</code>, it will be reflected in the whole directory, and if you set it to <code>local</code>, it will be reflected in the current directory. Since this reflection continues even if you exit terminal, it is very convenient to set it for each folder with <code>local</code>.</p>
<p>You can change the shell by using <code>shell</code>. If you use this, only the shell you are using will reflect that environment. So if you reopen the shell after closing it, or if you have multiple shells open, the environment change won&rsquo;t affect anything else.</p>
<p>If you want to use it temporarily, <code>shell</code>, if you want to set it for each folder, <code>local</code>, if you want to change the default environment as a whole, you need <code>global</code>.</p>
<p>It can be restored by setting <code>x.x.x</code> part to <code>system</code>.</p>
<h1 id="heading-1"></h1>
<pre><code class="language-swich-python-version." data-lang="swich-python-version.">python --version
Python 2.7.3

$ pyenv shell 2.7.9
$ python --version
Python 2.7.9

$ pyenv shell 3.5.0
$ python --version
Python 3.5.0

$ pyenv shell system
$ python --version
Python 2.7.3
</code></pre><p>##module installation
The installed python (2.7.9 and 3.5.0) contains only the default module (nothing is included even if pip freeze), so install it.
To install modules, just use <code>pip install</code> to install any modules as usual.</p>
<p><code>pip install xxxxx</code></p>
<p>#pyenv-virtualenv
Even <code>pyenv</code> is convenient enough, but more convenient.
<code>pyenv-virtualenv</code> is a plugin for pyenv, for creating different environments with the same (python) version.</p>
<h2 id="installation-method">Installation method</h2>
<p><code>$ git clone https://github.com/yyuu/pyenv-virtualenv.git ~/.pyenv/plugins/pyenv-virtualenv</code></p>
<p>And write the settings to <code>.bash_profile</code></p>
<blockquote>
<p>eval &ldquo;$(pyenv virtualenv-init -)&rdquo;</p>
</blockquote>
<h2 id="creating-a-new-environment">Creating a new environment</h2>
<p>To create a new python environment, use <code>pyenv virtualenv [version] &lt;virtualenv-name&gt;</code> to create a new environment called <code>virtualenv-name</code>. Specify an existing environment in <code>[version]</code> here.</p>
<h2 id="heading-2"></h2>
<pre><code class="language-make_new." data-lang="make_new.">pyenv virtualenv 3.5.0 new_3.5.0
</code></pre><p>Here, in the newly created environment, the module installed with <code>pip</code> etc. in the environment created with pyenv cannot be used.
If you want to use the one you used in <code>[version]</code>, add the option <code>--system-site-package</code>.
Then, pass the path to the <code>site-packages</code> that was built with <code>pyenv</code>.</p>
<p>In the example below, adding <code>--system-site-packages</code> will add <code>~/.pyenv/versions/3.5.0/lib/python3.5/site-packages</code> to your path.</p>
<h3 id="heading-3"></h3>
<pre><code class="language-sample_site-packages." data-lang="sample_site-packages.">$ pyenv virtualenv 3.5.0 inde-3.5.0
$ pyenv virtualenv --system-site-packages 3.5.0 co-3.5.0
$ pyenv virtualenv --system-site-packages inde-3.5.0 co-inde-3.5.0

# sys.path Partially omitted.
$ python -c'import sys; print(sys.path)' # where 3.5.0
['','~/.pyenv/versions/3.5.0/lib/python35.zip',...,'~/.pyenv/versions/3.5.0/lib/python3.5/site-packages']

(inde-3.5.0) $ python -c'import sys; print(sys.path)'
['','~/.pyenv/versions/3.5.0/lib/python35.zip', .... ,'~/.pyenv/versions/inde-3.5.0/lib/python3.5/site- packages']

(co-3.5.0) $ python -c'import sys; print(sys.path)'
['','~/.pyenv/versions/3.5.0/lib/python35.zip', ...,'~/.pyenv/versions/co-3.5.0/lib/python3.5/site-packages ','~/.pyenv/versions/3.5.0/lib/python3.5/site-packages']

(co-inde-3.5.0)kodaira@fomalhaut:~$ python -c'import sys; print(sys.path)'
['','~/.pyenv/versions/co-inde-3.5.0/lib/python35.zip', ...,'~/.pyenv/versions/co-inde-3.5.0/lib/python3 .5/site-packages','~/.pyenv/versions/3.5.0/lib/python3.5/site-packages']

</code></pre><p>If you want to install module of other environment, you can write <code>pip freeze</code> somewhere and install with <code>pip install -r</code>. (There seemed to be a way to copy it when doing <code>pyenv virtualenv</code>, but I couldn&rsquo;t find it.</p>
<h2 id="heading-4"></h2>
<pre><code class="language-pip_install." data-lang="pip_install.">- -- In the environment you want to copy ----
$ pip freeze&gt; pyp_list.txt
- -- After changing the environment ----
$ pip install -r pyp_list.txt
</code></pre><h2 id="saving-and-rebuilding-the-virtual-environment">Saving and rebuilding the virtual environment</h2>
<p>I think this is the advantage of using pyenv-virtualenv.
It is a story of saving the environment and reproducing the same environment in another place.</p>
<h4 id="first-install-what-you-need-wheel">First, install what you need (wheel)</h4>
<h1 id="heading-5"></h1>
<pre><code class="language-install_wheel." data-lang="install_wheel.">$ pyenv exec pip install wheel
</code></pre><p>Save information of modules installed with pip using ####wheel
Save to any directory with <code>--wheel-dir=[dir]</code>
I used the output of <code>pip freeze</code> as it is, but it seems better to use <code>wheel</code>.</p>
<h1 id="heading-6"></h1>
<pre><code class="language-save_module_info." data-lang="save_module_info.">$ pyenv exec pip freeze &gt;pyp_list.txt
$ pyenv exec pip wheel --wheel-dir=~/tmp/wheelhouse -r pyp_list.txt
</code></pre><h4 id="install-the-same-thing-using-the-wheel-you-just-made-when-you-created-a-new-environment">Install the same thing using the wheel you just made when you created a new environment</h4>
<p>By doing a <code>wheel</code>, you can save the built package, so you do not have to compile it each time.
Reference URL: <a href="http://tdoc.info/blog/2014/01/15/pip.html">I will write it there somehow. </a></p>
<h1 id="heading-7"></h1>
<pre><code class="language-install_using_wheel." data-lang="install_using_wheel.">$ pyenv virtualenv 3.5.0 tes-3.5
$ pyenv global tes-3.5
$ pip install -r pyp_list.txt --use-wheel --no-index --find-links=tmp/wheelhouse
$ pip freeze
</code></pre><p>#Summary
You can build your environment by using <code>pyenv</code> and <code>pyenv-virtualenv</code>.
You can save the environment with&rsquo;wheel&rsquo; and reproduce the same environment in other places.</p>
<p>Please tell me if there is something wrong or more convenient</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
