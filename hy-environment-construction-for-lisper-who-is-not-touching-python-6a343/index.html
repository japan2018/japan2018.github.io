<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Hy environment construction for Lisper who is not touching Python | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Hy environment construction for Lisper who is not touching Python</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 15, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/lisp"> lisp</a></code></small>


<small><code><a href="https://memotut.com/tags/hy"> hy</a></code></small>

</p>
<pre><code>This article is the 15th day article of [Lisp Advent Calendar 2019](https://qiita.com/advent-calendar/2019/lisp).
</code></pre>
<h1 id="summary-of-this-article">Summary of this article</h1>
<p>Hy is a Clojure-like Lisp dialect that runs on Python&rsquo;s Virtual Machine.
For Lisper (mainly Clojurian) who has never touched Python, I will focus on how to build Hy environment.</p>
<h1 id="target-audience">Target audience</h1>
<ul>
<li>Lisper who has never touched Python (mainly Clojurian)</li>
</ul>
<p>For an introductory document to Hy itself, I suggest you to refer to the official tutorial or the one written by my ancestors.</p>
<ul>
<li><a href="http://docs.hylang.org/en/stable/tutorial.html">Hy tutorial</a></li>
<li><a href="https://booth.pm/en/items/1570502">Hy Short Intro Book</a></li>
</ul>
<h1 id="environment">Environment</h1>
<h2 id="install-python">Install Python</h2>
<h3 id="for-windows-10">For Windows 10</h3>
<p>It&rsquo;s easy to download and install the installer from <a href="https://www.python.org/">python.org</a>.
It is a trap suddenly, but the latest version installer that can be downloaded from the top page of python.org is a 32-bit version (as of December 12, 2019).
Be careful not to install unless you have a 32bit environment.</p>
<img width="1920" alt="2019-12-10_22h14_25.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/543140/8c56e78f-3a53-ce86-9cf1-cdbd736d5ef9.png">
<h3 id="for-macos">For MacOS</h3>
<p>It seems common to install Homebrew and then use the <code>brew</code> command.</p>
<p>When I checked the installable version with <code>$ brew info python</code>, it was 3.7.5 (as of December 13, 2019).</p>
<p>Location of Python 3 (3.7.5) installed with Homebrew</p>
<pre><code>/usr/local/bin/python3
</code></pre><p>location of site-packages</p>
<pre><code>/usr/local/lib/python3.7/site-packages
</code></pre><h2 id="building-a-virtual-environment">Building a virtual environment</h2>
<p>It works even if I install a third-party module in site-packages of Python itself,
By using the virtual environment properly for each project, the original environment can be kept clean and the impact on other projects can be avoided.
If you use the <code>venv</code> command that comes by default to create a virtual environment, execute it as follows under the directory you want to create.</p>
<pre><code>$ python -m venv &lt;venv name&gt;
</code></pre><p>If, while using the virtual environment, the dependencies of third-party modules, which will be described later, become messed up, just discard them and recreate them.</p>
<p>To enable/disable the virtual environment, use the <code>activate</code> and <code>deactivate</code> commands.
The location of <code>activate</code> in venv depends on the Shell and OS, so [venv &mdash; Create virtual environment](<a href="https://docs.python.org/ja/3/library/venv.See%22Commandsforenablingvirtualenvironment%22in(html)">https://docs.python.org/ja/3/library/venv.See&quot;Commandsforenablingvirtualenvironment&quot;in(html)</a>.</p>
<h2 id="module-installation">Module installation</h2>
<p>When Python is installed, the <a href="https://docs.python.org/ja/3/library/index.html">Standard library</a> is installed together, and you can use them from Hy. Python is a built-in battery language, so you can do a lot with the standard library alone.</p>
<p>If you want to use a third-party module other than the standard library, use the package management tool <a href="https://docs.python.org/ja/3/installing/index.html">pip</a> to install it in the virtual environment. I will.
Basically, all (most) Python modules work in Hy.
Of course, modules written in Hy will work as long as they have the same version (almost never&hellip;).
You can find Python third party modules at <a href="https://pypi.org/">PyPI</a>.
Occasionally, I have Python modules that are not registered with PyPI, but I&rsquo;ll also show you how to install them below (for those maintained in the GitHub repository).</p>
<p>You can also install Anaconda, a library for scientific calculation, and manage modules with <code>conda</code>.
We will not install it in this article, because using it with <code>pip</code> may break the environment.</p>
<p><code>activate</code> the virtual environment and install the module with <code>pip install &lt;module name&gt;</code>.
If you want to install all at once, write requirements.txt with the module name separated by a line break and execute <code>pip install -r requirements.txt</code>. By convention it&rsquo;s called requirements.txt, but you can use a different name.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text:requirements.txt" data-lang="text:requirements.txt">hy
openpyxl
PySide2
</code></pre></div><p>You can also specify a specific version.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text:requirements.txt" data-lang="text:requirements.txt">hy==0.17.0
openpyxl==3.0.2
PySide2==5.13.2
</code></pre></div><p>If your module is only in the GitHub repository,</p>
<pre><code>pip install git+https://github.com/hoge/fuga.git
</code></pre><p>Like
You can also include this in requirements.txt.</p>
<p>If you want to see the list of 3rd party modules installed in that environment, run <code>pip freeze</code>.
If you write it out like <code>pip freeze &gt;requirements.txt</code>, it will be easy to recover even if the environment is broken.</p>
<h2 id="editoride">Editor/IDE</h2>
<p>Very few editors/IDEs yet have Hy plugins. As far as I know, there are only the following three.</p>
<ul>
<li>
<p>Emacs</p>
</li>
<li>
<p><a href="https://melpa.org/#/hy-mode">hy-mode</a></p>
</li>
<li>
<p>Vim</p>
</li>
<li>
<p><a href="https://github.com/hylang/vim-hy">vim-hy</a></p>
</li>
<li>
<p>Visual Studio Code</p>
</li>
<li>
<p><a href="https://marketplace.visualstudio.com/items?itemName=xuqinghan.vscode-hy">vscode-hy</a></p>
</li>
</ul>
<h1 id="how-to-make-a-package">How to make a package</h1>
<p>If you want to layer your own applications and libraries, create a package for easy management.</p>
<pre><code>hy ─┬─ hoge ─┬─ fuga ─┬─ __init__.hy
    .│ ..
    └─ piyo │ └─ bar.hy
             │
             ├─ __init__.hy
             .
             └─ foo.hy
</code></pre><p>If you add the <code>hy</code> directory to the environment variable <a href="https://docs.python.org/ja/3/using/cmdline.html#envvar-PYTHONPATH">PYTHONPATH</a> in the above figure,
By putting __init__.hy in each directory under hoge</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-hylang:example_import.hy" data-lang="hylang:example_import.hy">(<span style="color:#66d9ef">import </span>hoge) <span style="color:#75715e">;; hoge&#39;s __init__.hy is imported</span>
(<span style="color:#66d9ef">import </span>hoge.foo)
(<span style="color:#66d9ef">import </span>hoge.fuga) <span style="color:#75715e">;; hoinit/fuga&#39;s __init__.hy is imported</span>
(<span style="color:#66d9ef">import </span>hoge.fuga.bar)
</code></pre></div><p>Can be written as The structure of this package is similar to Python.</p>
<p><a href="https://docs.python.org/ja/3/tutorial/modules.html#packages">Python Tutorial&gt; 6. Modules&gt; 6.4. Packages</a></p>
<p>#Summary</p>
<ul>
<li>Hy&rsquo;s environment construction is almost the same as Python&rsquo;s.</li>
<li>Creating a virtual environment keeps the original environment clean. If your virtual environment breaks, just throw it away and recreate it.</li>
<li>Hy uses the standard Python library by default.</li>
<li>If it is not in the standard library, find a third-party module with PyPI etc. and install it with <code>pip</code>.
*If you write out requirements.txt with <code>pip freeze</code>, you will get insurance.</li>
</ul>
<p>Well then, have a good Hy life.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
