<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://japan2018.github.io/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://japan2018.github.io/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://japan2018.github.io/favicon-16x16.png">

  
  <link rel="manifest" href="https://japan2018.github.io/site.webmanifest">

  
  <link rel="mask-icon" href="https://japan2018.github.io/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://japan2018.github.io/css/bootstrap.min.css" />

  
  <title>[Chapter 4] Introduction to Python with 100 knocks | Some Title</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Chapter 4] Introduction to Python with 100 knocks</h1>
<p>
  <small class="text-secondary">
  
  
  May 3, 2020
  </small>
  

<small><code><a href="https://japan2018.github.io/tags/python">Python</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/nlp"> NLP</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/matplotlib"> matplotlib</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/itertools"> itertools</a></code></small>


<small><code><a href="https://japan2018.github.io/tags/language-processing-100-knocks"> language processing 100 knocks</a></code></small>

</p>
<pre><code>This article is a sequel to my book [Introduction to Python with 100 knocks](https://qiita.com/hi-asano/items/8e303425052781d95f09).[100knocksChapter4](https://nlp100.github.io/ja/ch04.html) will be explained.
</code></pre>
<p>First, install the morphological analyzer MeCab, download neko.txt, and perform morphological analysis to check the contents.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ mecab &lt;neko.txt&gt; neko.txt.mecab
</code></pre></div><p>It is &ldquo;I am a cat&rdquo; from Aozora Bunko.</p>
<p>MeCab&rsquo;s default dictionary system is similar to school grammar, but adjective verbs are nouns + auxiliary verbs, and Sa verbs are nouns + verbs. The output format probably looks like this:</p>
<pre><code>Surface form \t Part-of-speech, Part-of-speech subclass 1, Part-of-speech subclass 3, Part-of-speech subclass 3, Conjugate, Conjugate, Prototype, Yomi
</code></pre><p>Also, the statements are separated by <code>EOS</code>. By the way, many morphological analyzers assume double-byte characters, so it is a good idea to replace single-byte characters when analyzing web text.</p>
<h1 id="itertools">itertools</h1>
<p>Since it&rsquo;s a big deal, let&rsquo;s know the <a href="https://docs.python.org/ja/3/library/itertools.html">itertools</a> module. There are methods to create a convenient iterator.</p>
<h2 id="islice">islice()</h2>
<p>It also appeared in Chapter 2. You can slice the iterator with <code>islice(iterable, start, stop, step)</code>. When <code>step</code> is omitted, it becomes 1, and when <code>start</code> is omitted, it becomes <code>start=0</code>. If you set <code>stop=None</code>, it means to the end. It&rsquo;s very convenient, so let&rsquo;s use it.</p>
<h2 id="groupby">groupby()</h2>
<p>You can do <code>uniq</code> like Unix commands.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> groupby
a <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]
<span style="color:#66d9ef">for</span> k, g <span style="color:#f92672">in</span> groupby(a):
    <span style="color:#66d9ef">print</span>(k, list(g))
</code></pre></div><pre><code>1 [1, 1, 1]
0 [0, 0]
1 [1]
</code></pre>
<p>If you pass <code>iterable</code> as the first argument like this, it will create a pair of the value of that element and an iterator that returns the group. As with <code>sort</code>, you can also specify <code>key</code> as the second argument. Often used is <code>operator.itemgetter</code> (what people who read <a href="https://docs.python.org/ja/3/howto/sorting.html">Sort HOW TO</a>inChapter2know)Iguess). You can also use a lambda expression that returns a Boolean value. ..</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> operator <span style="color:#f92672">import</span> item getter
a <span style="color:#f92672">=</span> [(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)]
<span style="color:#66d9ef">for</span> k, g <span style="color:#f92672">in</span> groupby(a, key<span style="color:#f92672">=</span>itemgetter(<span style="color:#ae81ff">1</span>)):
    <span style="color:#66d9ef">print</span>(k, list(g))
</code></pre></div><pre><code>0 [(3, 0), (4, 0)]
1 [(2, 1)]
</code></pre>
<h2 id="chainfrom_iterable">chain.from_iterable()</h2>
<p>You can <code>flatten</code> a secondary array in one dimension.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> chain
a <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>], [<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>]
<span style="color:#66d9ef">print</span>(list(chain<span style="color:#f92672">.</span>from_iterable(a))
</code></pre></div><pre><code>[1, 2, 3, 4, 5, 6]
</code></pre>
<h2 id="zip_longest">zip_longest()</h2>
<p>The built-in function <code>zip()</code> matches short iterables, but use this if you want long iterables. If you use it normally, it will be filled with <code>None</code>, but you can specify the value to use for filling with the second argument, <code>fillvalue</code>.</p>
<h2 id="product">product()</h2>
<p>Calculate the Cartesian product. Besides, it is hard to implement <code>permutations()</code> and <code>combinations()</code> by yourself, so I think there is no loss in knowing it.</p>
<p>These are just a few of the <code>itertools</code>, so if you&rsquo;re interested, read <a href="https://docs.python.org/ja/3/library/itertools.html">docs</a>.</p>
<p>#30. Loading morphological analysis results</p>
<blockquote>
<p>Implement a program that reads the morphological analysis result (neko.txt.mecab). However, each morpheme is stored in the mapping type with the surface type (surface), basic form (base), part-of-speech (pos), and part-of-speech subclassification 1 (pos1) as keys, and one sentence is represented as a list of morphemes (mapping type) Get it. For the rest of Chapter 4, use the program you created here.</p>
</blockquote>
<p>If you&rsquo;re an object-oriented language, you&rsquo;ll want to use classes, but that&rsquo;s up to the next chapter. You can also use Pandas as in Chapter 2, but I&rsquo;ll leave it off because it seems to deviate from the intention of the problem statement.</p>
<p>Below is an example answer.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-q30.py" data-lang="q30.py"><span style="color:#f92672">import</span> argparse
<span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> groupby, islice
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint
<span style="color:#f92672">import</span> sys


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    parser <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser()
    parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#39;num&#39;</span>, type<span style="color:#f92672">=</span>int)
    args <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse_args()
    <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> islice(read_mecab(sys<span style="color:#f92672">.</span>stdin), args<span style="color:#f92672">.</span>num<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, args<span style="color:#f92672">.</span>num):
        pprint(sent_lis)

            
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_mecab</span>(fi):
    <span style="color:#66d9ef">for</span> is_eos, sentence <span style="color:#f92672">in</span> groupby(fi, <span style="color:#66d9ef">lambda</span> line: line<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;EOS&#39;</span>)):
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> is_eos:
            <span style="color:#66d9ef">yield</span> list(map(line2dic, sentence))


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">line2dic</span>(line):
    surface, info <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>rstrip()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span>)
    col <span style="color:#f92672">=</span> info<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;,&#39;</span>)
    dic <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;surface&#39;</span>: surface,
          <span style="color:#e6db74">&#39;pos&#39;</span>: col[<span style="color:#ae81ff">0</span>],
          <span style="color:#e6db74">&#39;pos1&#39;</span>: col[<span style="color:#ae81ff">1</span>],
          <span style="color:#e6db74">&#39;base&#39;</span>: col[<span style="color:#ae81ff">6</span>]}
    <span style="color:#66d9ef">return</span> dic


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    main()

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$python q30.py <span style="color:#ae81ff">2</span> &lt;neko.txt.mecab
</code></pre></div><pre><code>[{'base':'\u3000','pos':'symbol','pos1':'space','surface':'\u3000'},
 {'base':'I',' pos':'Noun','pos1':'Pronoun','surface':'I''},
 {'base':'is','pos':'particle','pos1':' particle','surface':'wa'},
 {'base':'cat','pos':'noun','pos1':'general','surface':'cat'},
 {'base':'da','pos':'auxiliary verb','pos1':'*','surface':'at'},
 {'base':'is','pos':'auxiliary verb','pos1':'*','surface':'is'},
 {'base':'. ','pos':'symbol','pos1':'punctuation','surface':'. '}]
</code></pre>
<p>The output is narrowed down in <code>main()</code>. If you use <code>pprint.pprint()</code> instead of <code>print()</code>, it will print out (pretty print) with line breaks arranged.</p>
<p>This kind of form can be written smartly by passing a function that returns whether the line is <code>EOS</code> to the <code>key</code> of <code>groupby()</code>. You did <code>yield</code> in Chapter 2.</p>
<p>The problem is the <code>list(map())</code>. <code>map(func, iterable)</code> works by applying the function <code>func</code> to each element of <code>iterable</code> and returning an iterator. The result is the same as <code>[line2sic(x) for x in sentence]</code>, but Python seems to call the self-made function slowly in the <code>for</code> statement, so I tried to use this notation ((<a href="https://qiita.com/hi-asano/items/aa2976466739f280b887"> Reference</a>).</p>
<p>#31. Verb</p>
<blockquote>
<p>Extract all surface forms of verbs.</p>
</blockquote>
<p>Below is an example answer.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-q31.py" data-lang="q31.py"><span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> islice
<span style="color:#f92672">import</span> sys

<span style="color:#f92672">from</span> q30 <span style="color:#f92672">import</span> read_mecab


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> islice(read_mecab(sys<span style="color:#f92672">.</span>stdin), <span style="color:#ae81ff">5</span>):
        <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> filter(<span style="color:#66d9ef">lambda</span> x: x[<span style="color:#e6db74">&#39;pos&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;verb&#39;</span>, sent_lis):
            <span style="color:#66d9ef">print</span>(word[<span style="color:#e6db74">&#39;surface&#39;</span>])

                
<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    main()

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python q31.py &lt;neko.txt.mecab
</code></pre></div><pre><code>Birth
Tsuka
Shi
Crying
Shi
Are
</code></pre>
<p>I try to get the first N sentences. I also omit <code>argpase</code> because it is a hassle.</p>
<p>There was nothing else to say, so I tried using <code>filter()</code> forcibly. This is equivalent to <code>(x for x in iterable if condition(x))</code> and returns only the elements that match the condition. Honestly, it is enough to use the <code>if</code> statement normally, so it&rsquo;s not likely to come out (or rather, in this case, it seems slow to use <code>filter()</code>).</p>
<h1 id="32-original-form-of-verb">32. Original form of verb</h1>
<blockquote>
<p>Extract all forms of verbs.</p>
</blockquote>
<p>Omitted since it is almost the same as 31.</p>
<p>#33. &ldquo;A&rsquo;s B&rdquo;</p>
<blockquote>
<p>Extract a noun phrase in which two nouns are connected by &ldquo;no&rdquo;.</p>
</blockquote>
<p>There is nothing to say because it can be done by pushing. Below is an example answer.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-q33.py" data-lang="q33.py"><span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> islice
<span style="color:#f92672">import</span> sys


<span style="color:#f92672">from</span> q30 <span style="color:#f92672">import</span> read_mecab


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> islice(read_mecab(sys<span style="color:#f92672">.</span>stdin), <span style="color:#ae81ff">20</span>):
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(sent_lis)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>):
            <span style="color:#66d9ef">if</span> (sent_lis[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][<span style="color:#e6db74">&#39;base&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;of&#39;</span> <span style="color:#f92672">and</span> sent_lis[i][<span style="color:#e6db74">&#39;pos&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;noun&#39;</span><span style="color:#f92672">and</span> sent_lis[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>][<span style="color:#e6db74">&#39;pos&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;noun&#39;</span>):
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(x[<span style="color:#e6db74">&#39;surface&#39;</span>] <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> sent_lis[i: i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]))

                
<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    main()

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python q33.py &lt;neko.txt.mecab
</code></pre></div><pre><code>His palm
On the palm
Calligraphy face
Supposed face
In the middle of the face
In the hole
Calligraphy hand
Behind the palm
</code></pre>
<p>I used to say that line continuation is <code>\</code> in Python, but you can freely break lines inside parentheses. The conditional expression of the if statement is enclosed in <code>()</code> in vain just because I want to say that.</p>
<p>#34. Concatenation of nouns</p>
<blockquote>
<p>Extract the concatenation of nouns (nouns that appear consecutively) with the longest match.</p>
</blockquote>
<p>You can do <code>groupby()</code> with the part of speech. Below is an example answer.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-q34.py" data-lang="q34.py"><span style="color:#f92672">import</span> sys
<span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> groupby, islice

<span style="color:#f92672">from</span> q30 <span style="color:#f92672">import</span> read_mecab


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> islice(read_mecab(sys<span style="color:#f92672">.</span>stdin), <span style="color:#ae81ff">20</span>):
        <span style="color:#66d9ef">for</span> key, group <span style="color:#f92672">in</span> groupby(sent_lis, <span style="color:#66d9ef">lambda</span> word: word[<span style="color:#e6db74">&#39;pos&#39;</span>]):
            <span style="color:#66d9ef">if</span> key <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;noun&#39;</span>:
                words <span style="color:#f92672">=</span> [word[<span style="color:#e6db74">&#39;surface&#39;</span>] <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> group]
                <span style="color:#66d9ef">if</span> len(words) <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span>:
                    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(words))

                
<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    main()

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python q34.py &lt;neko.txt.mecab
</code></pre></div><pre><code>In humans
The worst
Timely
One hair
Then the cat
one time
Puupu and smoke
</code></pre>
<p>#35. Word frequency</p>
<blockquote>
<p>Find the words that appear in the sentence and their frequencies, and arrange them in descending order of frequency of occurrence.</p>
</blockquote>
<p>Just use <code>collections.Counter</code>. Below is an example answer.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-q35.py" data-lang="q35.py"><span style="color:#f92672">import</span> sys
<span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Counter
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint

<span style="color:#f92672">from</span> q30 <span style="color:#f92672">import</span> read_mecab


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_freq</span>():
    word_freq <span style="color:#f92672">=</span> Counter(word[<span style="color:#e6db74">&#39;surface&#39;</span>] <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> read_mecab(sys<span style="color:#f92672">.</span>stdin)
                            <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> sent_lis)
    <span style="color:#66d9ef">return</span> word_freq<span style="color:#f92672">.</span>most_common(<span style="color:#ae81ff">10</span>)


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    pprint(get_freq())

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$python q35.py &lt;neko.txt.mecab
</code></pre></div><pre><code>[('No', 9194),
 ('.', 7486),
 ('Te', 6868),
 (',', 6772),
 ('Wa', 6420),
 ('To', 6243),
 ('To', 6071),
 ('And', 5508),
 ('Ga', 5337),
 ('Ta', 3988)]
</code></pre>
<h1 id="matplotlib">matplotlib</h1>
<p>Now that we have a graph for the next question, it&rsquo;s time to start. Let&rsquo;s do a <code>pip install</code>. I don&rsquo;t want to explain external modules too much in the article &ldquo;Introduction to Python&rdquo;, and if you seriously explain this, you can write one book. First, read this <a href="https://qiita.com/skotaro/items/08dc0b8c5704c94eafb9">Qiita article</a> to understand the hierarchical structure of matplotlib. It&rsquo;s a mess, isn&rsquo;t it? It is <code>Pyplot</code> that sets the area appropriately. This time I will not adjust the appearance so I will do this. Here is a simple example.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#75715e">#Specify graph type and data</span>
plt<span style="color:#f92672">.</span>plot([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">16</span>])
<span style="color:#75715e"># Set up</span>
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;example&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;some numbers&#39;</span>)
<span style="color:#75715e">#Draw</span>
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/531660/f7364d3c-ebc1-f339-db41-7cd08df3b252.png" alt="output_28_0.png"></p>
<p>The meaning of the import statement is &ldquo;import the submodule <code>pyplot</code> of the <code>matplotlib</code> module with the name <code>plt</code>&rdquo;.</p>
<p>First, decide the type of graph. A line chart is <code>plt.plot()</code>, a horizontal bar chart is <code>plt.barh()</code>, and a vertical bar chart is <code>plt.bar()</code>. (Iterables are <code>numpy</code> inside pyplot. It may be really better to pass a <code>numpy</code> array, as it will be converted to an array by itself).</p>
<p>Next, set the appearance of what you like. <code>plt.yticks()</code> can set the y coordinate and the character to attach to it. You can set the maximum and minimum values of the x axis using <code>plt.xlim()</code>. If you use <code>plt.yscale(&quot;log&quot;)</code>, the y axis will be a logarithmic scale.</p>
<p>Finally, draw. I use Jupyter, so I call it <code>plt.show()</code>. It is better for the person who executes the script to output the file using <code>plt.savefig(filename)</code>.</p>
<p>To be honest, this method is MATLAB-like and not Pythonic, but it is easy.</p>
<h2 id="how-to-display-japanese-with-matplotlib">How to display Japanese with matplotlib</h2>
<p>Since the default font does not support Japanese, it will be tofu. Therefore, in order to display Japanese in the graph, you can set a font compatible with Japanese, but depending on your environment, Japanese font is not found, or it is not installed in the first place, so installation is necessary. It&rsquo;s tough. I will do my best at <a href="https://github.com/uehara1414/japanize-matplotlib">japanize-matplotlib</a>.</p>
<p>#36. Top 10 words</p>
<blockquote>
<p>Display the 10 most frequently occurring words and their frequencies in a graph (eg bar graph).</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Counter

<span style="color:#f92672">from</span> q30 <span style="color:#f92672">import</span> read_mecab
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> japanize_matplotlib

word_freq <span style="color:#f92672">=</span> Counter(word[<span style="color:#e6db74">&#39;base&#39;</span>] <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> read_mecab(open(<span style="color:#e6db74">&#39;neko.txt.mecab&#39;</span>))
                            <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> sent_lis)
word, count <span style="color:#f92672">=</span> zip(<span style="color:#f92672">*</span>word_freq<span style="color:#f92672">.</span>most_common(<span style="color:#ae81ff">10</span>))
len_word <span style="color:#f92672">=</span> range(len(word))

plt<span style="color:#f92672">.</span>barh(len_word, count, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>)
plt<span style="color:#f92672">.</span>yticks(len_word, word)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;frequency&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;word&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;36. Top 10 words by frequency&#39;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/531660/79a73987-c08f-1967-1ee6-e6cd29711604.png" alt="output_31_0.png"></p>
<p>What is the <code>*</code> in <code>zip()</code>? That said, what I want to do here is transpose. That is, transforming data such as <code>[[a,b],[c,d]]</code> into <code>[[a,c],[b,d]]</code>. So the easiest way to transpose is <code>zip(*seq)</code>. This is equivalent to <code>zip(seq[0], seq[1], ...)</code> (<a href="https://docs.python.org/ja/3/tutorial/controlflow.html#unpacking-argument-lists">unpacking argument list</a>).<code>zip([a,b],[c,d])</code>is<code>[(a,c),(b,d)]</code>, right? Furthermore, if you use unpack assignment, you can assign to different variables at once.</p>
<p>(This completes the explanation of the alternative solution of the ngram function in Chapter 1)</p>
<p>Keep in mind that the top words in terms of word frequency are functional words (particles, punctuation).</p>
<p>#37. Top 10 words with the highest frequency of co-occurrence with &ldquo;cat&rdquo;</p>
<blockquote>
<p>Display 10 words that often co-occur with &ldquo;cats&rdquo; (high co-occurrence frequency) and their frequency of occurrence in a graph (eg, bar graph).</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">word_freq <span style="color:#f92672">=</span> Counter()
<span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> read_mecab(open(<span style="color:#e6db74">&#39;neko.txt.mecab&#39;</span>)):
    <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> sent_lis:
        <span style="color:#66d9ef">if</span> word[<span style="color:#e6db74">&#39;surface&#39;</span>] <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;cat&#39;</span>:
            word_freq<span style="color:#f92672">.</span>update(x[<span style="color:#e6db74">&#39;base&#39;</span>] <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> sent_lis <span style="color:#66d9ef">if</span> x[<span style="color:#e6db74">&#39;surface&#39;</span>] <span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;cat&#39;</span>)
            <span style="color:#66d9ef">break</span>
            
words, count <span style="color:#f92672">=</span> zip(<span style="color:#f92672">*</span>word_freq<span style="color:#f92672">.</span>most_common(<span style="color:#ae81ff">10</span>))
len_word <span style="color:#f92672">=</span> range(len(words))

plt<span style="color:#f92672">.</span>barh(len_word, count, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>)
plt<span style="color:#f92672">.</span>yticks(len_word, words)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;frequency&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;word&#39;</span>)
plt<span style="color:#f92672">.</span>title (<span style="color:#e6db74">&#39;37. Top 10 words with high frequency of co-occurrence with &#34;cat&#34;&#39;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/531660/47dd0892-404d-921c-72b1-1944e48cc8b8.png" alt="output_34_0.png"></p>
<p>You can update the <code>Counter</code> object with <code>Counter.update(iterable)</code>. However, if you do not focus on independent words, the result will be uninteresting.</p>
<p>#38. Histogram&gt; Draw a histogram of word frequency (a bar graph showing the number of types of words with the frequency of occurrence on the horizontal axis and the frequency of occurrence on the vertical axis).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">word_freq <span style="color:#f92672">=</span> Counter(word[<span style="color:#e6db74">&#39;base&#39;</span>] <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> read_mecab(open(<span style="color:#e6db74">&#39;neko.txt.mecab&#39;</span>))
                        <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> sent_lis)
data <span style="color:#f92672">=</span> Counter(count <span style="color:#66d9ef">for</span> count <span style="color:#f92672">in</span> word_freq<span style="color:#f92672">.</span>values())

x, y <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>keys(), data<span style="color:#f92672">.</span>values()

plt<span style="color:#f92672">.</span>bar(x, y)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;38. Histogram&#34;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;frequency&#34;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;number of the words&#34;</span>)
plt<span style="color:#f92672">.</span>xlim(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">30</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/531660/87ecddb2-21b5-1495-0276-1a66eac7b5b3.png" alt="output_34_0.png"></p>
<p>You can get all keys with <code>dict.keys()</code> and all values with <code>dict.values()</code>.</p>
<p>Looking at the number of word types, you can see that many words are infrequent. Somehow it seems to be inversely proportional. In deep learning, low frequency word processing is also important for these reasons.</p>
<h1 id="39-zipfs-law">39. Zipf&rsquo;s Law</h1>
<blockquote>
<p>Plot a log-log graph with word frequency as the horizontal axis and frequency as the vertical axis.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">word_freq <span style="color:#f92672">=</span> Counter(word[<span style="color:#e6db74">&#39;base&#39;</span>] <span style="color:#66d9ef">for</span> sent_lis <span style="color:#f92672">in</span> read_mecab(open(<span style="color:#e6db74">&#39;neko.txt.mecab&#39;</span>))
                        <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> sent_lis)
_, count <span style="color:#f92672">=</span> zip(<span style="color:#f92672">*</span>word_freq<span style="color:#f92672">.</span>most_common())
plt<span style="color:#f92672">.</span>plot(range(<span style="color:#ae81ff">1</span>, len(count)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), count)
plt<span style="color:#f92672">.</span>yscale(<span style="color:#e6db74">&#34;log&#34;</span>)
plt<span style="color:#f92672">.</span>xscale(<span style="color:#e6db74">&#34;log&#34;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;39. Zipf&#39;s Law&#34;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;log(rank)&#34;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;log(frequency)&#34;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/531660/7c09781c-224e-4bac-3368-2187cf2400d1.png" alt="output_37_0.png"></p>
<p>The slope of the log-log graph is roughly -1. This means <code>freq ∝ rank^(-1)</code>. It seems to be related to the 38th result. Googling for more details on Zipf&rsquo;s Law.</p>
<p>#Summary</p>
<ul>
<li><code>itertools</code></li>
<li><code>map()</code>, <code>filter()</code></li>
<li><code>matplotlib</code></li>
<li>Transposition</li>
<li><code>dict.keys()</code>, <code>dict.values()</code></li>
</ul>
<p>#Next is Chapter 5
I will finally use the class. Is this the next and final intro to Python?</p>
<p>(5/16) I wrote → <a href="https://qiita.com/hi-asano/items/5e18e3a5a711a752ad99">https://qiita.com/hi-asano/items/5e18e3a5a711a752ad99</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
