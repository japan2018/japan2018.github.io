<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Excel table creation with Python [Progress management table] | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Excel table creation with Python [Progress management table]</h1>
<p>
  <small class="text-secondary">
  
  
  Feb 28, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/excel">Excel</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>I thought about making a simple progress management table for myself.
&hellip;Isn&rsquo;t it a pain to make this every time? ?</p>
<p>That&rsquo;s why I wrote a code that creates a table when I start it after learning python.</p>
<p>â†“ The result looks like this
<img width="1000" alt="project.gif" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/497538/91be8b92-0169-2bc1-98ab-d0876fed641d.gif"></p>
<p>Now I will explain each part.</p>
<h2 id="file-creation">File creation</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python" data-lang="Python"><span style="color:#f92672">import</span> openpyxl.utils
<span style="color:#f92672">import</span> os

<span style="color:#f92672">from</span> openpyxl.styles <span style="color:#f92672">import</span> PatternFill
<span style="color:#f92672">from</span> openpyxl.styles.borders <span style="color:#f92672">import</span> Border, Side
<span style="color:#f92672">from</span> openpyxl.formatting.rule <span style="color:#f92672">import</span> FormulaRule

wb <span style="color:#f92672">=</span> openpyxl<span style="color:#f92672">.</span>Workbook()
sheet <span style="color:#f92672">=</span> wb<span style="color:#f92672">.</span>active
sheet<span style="color:#f92672">.</span>title <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Progress management table&#39;</span>
</code></pre></div><p>First, create an Excel file.
Create a new file with openpyxl.Workbook(). active targets the currently selected sheet. Since the file is launched, sheet1 is selected. You can change the name of the selected sheet in title.</p>
<h2 id="cell-size-setting">Cell size setting</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cellwidth</span>(start, end, wide):
    <span style="color:#66d9ef">for</span> length <span style="color:#f92672">in</span> range(start, end):
        alpha <span style="color:#f92672">=</span> sheet<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, column<span style="color:#f92672">=</span>length)<span style="color:#f92672">.</span>coordinate[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
        sheet<span style="color:#f92672">.</span>column_dimensions[<span style="color:#e6db74">&#39;{}&#39;</span><span style="color:#f92672">.</span>format(alpha)]<span style="color:#f92672">.</span>width <span style="color:#f92672">=</span> wide


cellwidth(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8.38</span>)
cellwidth(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">17.38</span>)
cellwidth(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0.38</span>)
cellwidth(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">335</span>, <span style="color:#ae81ff">4.88</span>)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">100</span>):
    sheet<span style="color:#f92672">.</span>row_dimensions[rows]<span style="color:#f92672">.</span>height <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span>
</code></pre></div><p>You can set column width with colomn_dimensions[&lsquo;specified column&rsquo;].width and row height with row_dimensions[&lsquo;specified row&rsquo;].height.
Since I wanted to specify each, I used a for statement as a function.
It is difficult to understand the column, but it is converted to A=1, B=2, C=3&hellip;
(Example: B1 if cell(row=1, column=2))
Since I wanted to put the alphabet in the specified column, I get the position of the cell with cell(row= ,column= ).coordinate and get the last -1 character from the beginning with [:-1]. (Example: If the cell&rsquo;s AAA1 gets AAA)
Since the line width is uniform this time, it is not a function.</p>
<p>##Frame border</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">side1 <span style="color:#f92672">=</span> Side(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;thin&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;000000&#39;</span>)
side2 <span style="color:#f92672">=</span> Side(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;double&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;000000&#39;</span>)
side3 <span style="color:#f92672">=</span> Side(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;hair&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;000000&#39;</span>)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        <span style="color:#66d9ef">if</span> cell<span style="color:#f92672">.</span>row <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(right<span style="color:#f92672">=</span>side1, bottom<span style="color:#f92672">=</span>side2)
        <span style="color:#66d9ef">else</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(top<span style="color:#f92672">=</span>None, right<span style="color:#f92672">=</span>side1, bottom<span style="color:#f92672">=</span>None, left<span style="color:#f92672">=</span>None)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">335</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        <span style="color:#66d9ef">if</span> cell<span style="color:#f92672">.</span>row <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(right<span style="color:#f92672">=</span>side3, bottom<span style="color:#f92672">=</span>side2)
        <span style="color:#66d9ef">else</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(top<span style="color:#f92672">=</span>side3, right<span style="color:#f92672">=</span>side3, bottom<span style="color:#f92672">=</span>side3, left<span style="color:#f92672">=</span>side3)
</code></pre></div><p>Define the border with Side(style='Border style&rsquo;, color='Color&rsquo;).
Border(top= ,right= ,bottom= ,left=) allows you to set the top, bottom, left and right borders of the cell.
Here, a for sentence is used to set a frame line for each cell in the range specified by min to max.
Since I wanted to put a line under the frame of only the 5th line, I branched it with an if statement.
Please note that if you make different lines for top and bottom, right and left, adjacent parts will be overwritten by the frame line changed later.</p>
<h2 id="insert-numbers-and-expressions">Insert numbers and expressions</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">startYear <span style="color:#f92672">=</span> <span style="color:#ae81ff">2020</span>
startMonth <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
startDay <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

sheet[<span style="color:#e6db74">&#34;B5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;task&#34;</span>
sheet[<span style="color:#e6db74">&#34;C4&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Start date&#34;</span>
sheet[<span style="color:#e6db74">&#34;C5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plan&#34;</span>
sheet[<span style="color:#e6db74">&#34;D5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;actual&#34;</span>
sheet[<span style="color:#e6db74">&#34;E4&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;completion date&#34;</span>
sheet[<span style="color:#e6db74">&#34;E5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plan&#34;</span>
sheet[<span style="color:#e6db74">&#34;F5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;actual&#34;</span>
sheet[<span style="color:#e6db74">&#34;G5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Remarks&#34;</span>
sheet[<span style="color:#e6db74">&#34;I2&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> startYear
sheet[<span style="color:#e6db74">&#34;J2&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;year&#34;</span>
sheet[<span style="color:#e6db74">&#34;I3&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> startMonth
sheet[<span style="color:#e6db74">&#34;J3&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;month&#34;</span>

sheet[<span style="color:#e6db74">&#34;I4&#34;</span>]<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;d&#34;</span>
sheet[<span style="color:#e6db74">&#34;I4&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;= DATE(I2, I3, {})&#39;</span><span style="color:#f92672">.</span>format(startDay)
sheet[<span style="color:#e6db74">&#34;I5&#34;</span>]<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aaa&#34;</span>
sheet[<span style="color:#e6db74">&#34;I5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;=I4&#39;</span>

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">334</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        <span style="color:#66d9ef">if</span> cell<span style="color:#f92672">.</span>row <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
            cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;d&#39;</span>
            cell<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;={}+1&#39;</span><span style="color:#f92672">.</span>format(sheet<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row, column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>coordinate)
        <span style="color:#66d9ef">else</span>:
            cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;aaa&#39;</span>
            cell<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;={}&#39;</span><span style="color:#f92672">.</span>format(sheet<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column)<span style="color:#f92672">.</span>coordinate)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">334</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;m&#34;</span>
        cell<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;=IF(DAY({0})=1, {1},&#34;&#34;)&#39;</span><span style="color:#f92672">.</span>format(sheet<span style="color:#f92672">.</span>cell(column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column, row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>coordinate,
                                                      sheet<span style="color:#f92672">.</span>cell(column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column, row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>coordinate)
</code></pre></div><p>The value will be entered in the specified cell with cell.value. If you want to enter a formula, use'= formula&rsquo;.
It is necessary to be careful because if you simply enter a formula, the calculation result will be entered.
You can change the display format with number_format. You can actually see the display format in Excel or check it with print(cell.number_format).
By the way, d is the date and aaa is the day of the week.
I start the month, add the date from it, and if the day is one, the month is also displayed.
With this, the month, day, and day of the week for 11 months are included.</p>
<h2 id="conditional-formatting">Conditional formatting</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">colorMake</span>(types, start, end):
    <span style="color:#66d9ef">return</span> PatternFill(fill_type<span style="color:#f92672">=</span>types, start_color<span style="color:#f92672">=</span>start, end_color<span style="color:#f92672">=</span>end)

grayfill <span style="color:#f92672">=</span> colorMake(<span style="color:#e6db74">&#39;solid&#39;</span>,<span style="color:#e6db74">&#39;d3d3d3&#39;</span>,<span style="color:#e6db74">&#39;d3d3d3&#39;</span>)
goldfill <span style="color:#f92672">=</span> colorMake(<span style="color:#e6db74">&#39;solid&#39;</span>,<span style="color:#e6db74">&#39;ffd700&#39;</span>,<span style="color:#e6db74">&#39;ffd700&#39;</span>)
bluefill <span style="color:#f92672">=</span> colorMake(<span style="color:#e6db74">&#39;solid&#39;</span>, <span style="color:#e6db74">&#39;1e90ff&#39;</span>, <span style="color:#e6db74">&#39;1e90ff&#39;</span>)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;m/d&#34;</span>
sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;C6:G100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;NOT($F6=&#34;&#34;)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>grayfill))

sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;I4:ME100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;OR(WEEKDAY(I$5)=1, WEEKDAY(I$5)=7)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>grayfill))

sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;I6:ME100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;AND($D6&lt;=I$4, $F6&gt;=I$4)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>goldfill))
sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;I6:ME100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;AND($C6&lt;=I$4, $E6&gt;=I$4)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>bluefill))
</code></pre></div><p>Selection sheet. Conditional_formatting.add(&lsquo;applicable cell range&rsquo;, FormulaRule(formula=[applying condition], stopIfTrue=True or False, fill=color)) can be used to set conditions in the order of description.This is a stumbling block, but the content of the conditional expression in formula=[applicable condition] must not start with =. I don&rsquo;t get an error, but why isn&rsquo;t there any conditional formatting in Excel? ? ? I will.
stopIfTrue is a conditional format &ldquo;Stop if condition is met&rdquo;. If you haven&rsquo;t used Excel, what is it? I feel like&hellip;
After that, the color of the cell when the condition is satisfied is set with fill.
PatternFill(filltype=fill pattern, start_color=, end_color=)
If you don&rsquo;t use gradation, start_color and end_color can be the same.</p>
<h2 id="save">Save</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">desktop_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;HOMEDRIVE&#34;</span>) <span style="color:#f92672">+</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;HOMEPATH&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">Desktop&#34;</span>
wb<span style="color:#f92672">.</span>save(desktop_path <span style="color:#f92672">+</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74"> progress management table.xlsx&#39;</span>)
</code></pre></div><p>It&rsquo;s the end.
You can save it as a workbook .save (file name). Please be aware that without this, no matter how much you create, it will not be saved.
This time, specify the absolute path to the desktop and save. If only the file name is saved, it will be saved in the current directory.</p>
<h2 id="at-the-end">At the end</h2>
<p>This time, the range of cells is too fixed, so if you make a property file for variables and you can customize it by tampering with the values in it, the degree of freedom will increase.
I learned a lot because various elements were packed. (Small feeling)</p>
<h2 id="whole-code">Whole code</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python" data-lang="Python"><span style="color:#f92672">import</span> openpyxl.utils
<span style="color:#f92672">import</span> os

<span style="color:#f92672">from</span> openpyxl.styles <span style="color:#f92672">import</span> PatternFill
<span style="color:#f92672">from</span> openpyxl.styles.borders <span style="color:#f92672">import</span> Border, Side
<span style="color:#f92672">from</span> openpyxl.formatting.rule <span style="color:#f92672">import</span> FormulaRule

wb <span style="color:#f92672">=</span> openpyxl<span style="color:#f92672">.</span>Workbook()
sheet <span style="color:#f92672">=</span> wb<span style="color:#f92672">.</span>active
sheet<span style="color:#f92672">.</span>title <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Progress management table&#39;</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cellwidth</span>(start, end, wide):
    <span style="color:#66d9ef">for</span> length <span style="color:#f92672">in</span> range(start, end):
        alpha <span style="color:#f92672">=</span> sheet<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, column<span style="color:#f92672">=</span>length)<span style="color:#f92672">.</span>coordinate[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
        sheet<span style="color:#f92672">.</span>column_dimensions[<span style="color:#e6db74">&#39;{}&#39;</span><span style="color:#f92672">.</span>format(alpha)]<span style="color:#f92672">.</span>width <span style="color:#f92672">=</span> wide


cellwidth(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8.38</span>)
cellwidth(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">17.38</span>)
cellwidth(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0.38</span>)
cellwidth(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">335</span>, <span style="color:#ae81ff">4.88</span>)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">100</span>):
    sheet<span style="color:#f92672">.</span>row_dimensions[rows]<span style="color:#f92672">.</span>height <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span>

side1 <span style="color:#f92672">=</span> Side(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;thin&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;000000&#39;</span>)
side2 <span style="color:#f92672">=</span> Side(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;double&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;000000&#39;</span>)
side3 <span style="color:#f92672">=</span> Side(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;hair&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;000000&#39;</span>)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        <span style="color:#66d9ef">if</span> cell<span style="color:#f92672">.</span>row <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(right<span style="color:#f92672">=</span>side1, bottom<span style="color:#f92672">=</span>side2)
        <span style="color:#66d9ef">else</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(top<span style="color:#f92672">=</span>None, right<span style="color:#f92672">=</span>side1, bottom<span style="color:#f92672">=</span>None, left<span style="color:#f92672">=</span>None)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">335</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        <span style="color:#66d9ef">if</span> cell<span style="color:#f92672">.</span>row <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(right<span style="color:#f92672">=</span>side3, bottom<span style="color:#f92672">=</span>side2)
        <span style="color:#66d9ef">else</span>:
            cell<span style="color:#f92672">.</span>border <span style="color:#f92672">=</span> Border(top<span style="color:#f92672">=</span>side3, right<span style="color:#f92672">=</span>side3, bottom<span style="color:#f92672">=</span>side3, left<span style="color:#f92672">=</span>side3)

startYear <span style="color:#f92672">=</span> <span style="color:#ae81ff">2020</span>
startMonth <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
startDay <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

sheet[<span style="color:#e6db74">&#34;B5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;task&#34;</span>
sheet[<span style="color:#e6db74">&#34;C4&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Start date&#34;</span>
sheet[<span style="color:#e6db74">&#34;C5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plan&#34;</span>
sheet[<span style="color:#e6db74">&#34;D5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;actual&#34;</span>
sheet[<span style="color:#e6db74">&#34;E4&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;completion date&#34;</span>
sheet[<span style="color:#e6db74">&#34;E5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plan&#34;</span>
sheet[<span style="color:#e6db74">&#34;F5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;actual&#34;</span>
sheet[<span style="color:#e6db74">&#34;G5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Remarks&#34;</span>
sheet[<span style="color:#e6db74">&#34;I2&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> startYear
sheet[<span style="color:#e6db74">&#34;J2&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;year&#34;</span>
sheet[<span style="color:#e6db74">&#34;I3&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> startMonth
sheet[<span style="color:#e6db74">&#34;J3&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;month&#34;</span>

sheet[<span style="color:#e6db74">&#34;I4&#34;</span>]<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;d&#34;</span>
sheet[<span style="color:#e6db74">&#34;I4&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;= DATE(I2, I3, {})&#39;</span><span style="color:#f92672">.</span>format(startDay)
sheet[<span style="color:#e6db74">&#34;I5&#34;</span>]<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aaa&#34;</span>
sheet[<span style="color:#e6db74">&#34;I5&#34;</span>]<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;=I4&#39;</span>

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">334</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        <span style="color:#66d9ef">if</span> cell<span style="color:#f92672">.</span>row <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
            cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;d&#39;</span>
            cell<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;={}+1&#39;</span><span style="color:#f92672">.</span>format(sheet<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row, column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>coordinate)
        <span style="color:#66d9ef">else</span>:
            cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;aaa&#39;</span>
            cell<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;={}&#39;</span><span style="color:#f92672">.</span>format(sheet<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column)<span style="color:#f92672">.</span>coordinate)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">334</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;m&#34;</span>
        cell<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;=IF(DAY({0})=1, {1},&#34;&#34;)&#39;</span><span style="color:#f92672">.</span>format(sheet<span style="color:#f92672">.</span>cell(column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column, row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>coordinate,
                                                      sheet<span style="color:#f92672">.</span>cell(column<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>column, row<span style="color:#f92672">=</span>cell<span style="color:#f92672">.</span>row <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>coordinate)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">colorMake</span>(types, start, end):
    <span style="color:#66d9ef">return</span> PatternFill(fill_type<span style="color:#f92672">=</span>types, start_color<span style="color:#f92672">=</span>start, end_color<span style="color:#f92672">=</span>end)


grayfill <span style="color:#f92672">=</span> colorMake(<span style="color:#e6db74">&#39;solid&#39;</span>,<span style="color:#e6db74">&#39;d3d3d3&#39;</span>,<span style="color:#e6db74">&#39;d3d3d3&#39;</span>)
goldfill <span style="color:#f92672">=</span> colorMake(<span style="color:#e6db74">&#39;solid&#39;</span>,<span style="color:#e6db74">&#39;ffd700&#39;</span>,<span style="color:#e6db74">&#39;ffd700&#39;</span>)
bluefill <span style="color:#f92672">=</span> colorMake(<span style="color:#e6db74">&#39;solid&#39;</span>, <span style="color:#e6db74">&#39;1e90ff&#39;</span>, <span style="color:#e6db74">&#39;1e90ff&#39;</span>)

<span style="color:#66d9ef">for</span> rows <span style="color:#f92672">in</span> sheet<span style="color:#f92672">.</span>iter_rows(min_row<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>, min_col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, max_row<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, max_col<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>):
    <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> rows:
        cell<span style="color:#f92672">.</span>number_format <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;m/d&#34;</span>
sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;C6:G100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;NOT($F6=&#34;&#34;)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>grayfill))

sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;I4:ME100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;OR(WEEKDAY(I$5)=1, WEEKDAY(I$5)=7)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>grayfill))

sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;I6:ME100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;AND($D6&lt;=I$4, $F6&gt;=I$4)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>goldfill))
sheet<span style="color:#f92672">.</span>conditional_formatting<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;I6:ME100&#39;</span>, FormulaRule(formula<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;AND($C6&lt;=I$4, $E6&gt;=I$4)&#39;</span>], stopIfTrue<span style="color:#f92672">=</span>True, fill<span style="color:#f92672">=</span>bluefill))

desktop_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;HOMEDRIVE&#34;</span>) <span style="color:#f92672">+</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;HOMEPATH&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">Desktop&#34;</span>
wb<span style="color:#f92672">.</span>save(desktop_path <span style="color:#f92672">+</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74"> progress management table.xlsx&#39;</span>)

</code></pre></div>
    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
