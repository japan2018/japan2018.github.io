<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Kaggle&#39;s initial equipment-a cell that collects frequently used codes- | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Kaggle&rsquo;s initial equipment-a cell that collects frequently used codes-</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 30, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/beginners"> Beginners</a></code></small>


<small><code><a href="https://memotut.com/tags/machine-learning"> Machine Learning</a></code></small>


<small><code><a href="https://memotut.com/tags/jupyter"> Jupyter</a></code></small>


<small><code><a href="https://memotut.com/tags/kaggle"> Kaggle</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>When working on Kaggle<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, which is a competition platform for data science, Python<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> written in Notebook<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>(orJupyterNotebook[^JupyterNotebook]orGoogleColaboratory[^GoogleColaboratory])istheexecutionenvironment.]]Ithinkthereisa&quot;highlyusedcode&rdquo;.Inordertoreuseit,Iwillintroduceitinonecellasaformatthatiseasytocopyandpasteanyway.Wehopethatbyreusingthecontentsofthiscell,wecanimprovetheefficiencyofdataanalysisinKaggle.(Thisis“Kaggle&rsquo;sinitialequipment”!)</p>
<p>*This article is based on the Notebook published by Kaggler (Kaggle participant) predecessors and the book [Technology of data analysis that wins at Kaggle]. However, it is the individual subjectivity as of December 2019. Therefore, please see for your reference.</p>
<p>#Conclusion</p>
<p>What is Kaggle&rsquo;s initial equipment?</p>
<p>This cell!</p>
<pre><code class="language-python:" data-lang="python:">#Display Notebook
from IPython.core.interactiveshell import InteractiveShell
InteractiveShell.ast_node_interactivity = &quot;all&quot;

# A convenient thing
import tqdm
import warnings
warnings.simplefilter('ignore')

# Data manipulation
import numpy as np
import pandas as pd
pd.set_option('display.max_columns', None)

#Data visualization
import pandas_profiling as pdp
import matplotlib.pyplot as plt
%matplotlib inline
import seaborn as sns
sns.set()

# Preprocessing
from sklearn.impute import SimpleImputer
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import MinMaxScaler
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import OneHotEncoder

# Cross-validation
from sklearn.model_selection import StratifiedKFold

#Constant definition
SEED = 2019
N_FOLDS = 10

output a list of filenames given as # input
import os
for dirname, _, filenames in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))
</code></pre><h1 id="commentary">Commentary</h1>
<p>Each point is explained about the above cell.</p>
<h2 id="display-notebook">Display Notebook</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> IPython.core.interactiveshell <span style="color:#f92672">import</span> InteractiveShell
InteractiveShell<span style="color:#f92672">.</span>ast_node_interactivity <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;all&#34;</span>
</code></pre></div><p>Notebook does not output the chart that you tried to output in the middle of the cell (for example, pandas DataFrame). By using <code>InteractiveShell</code><sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>, all the charts that are tried to be output in the middle of the cell will be output by the above description. However, it must be done in a different cell than the cell you are trying to print. That is, if you run this cell, it will be applied in other cells.</p>
<h2 id="a-convenient-thing">A convenient thing</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> tqdm
<span style="color:#f92672">import</span> warnings
warnings<span style="color:#f92672">.</span>simplefilter(<span style="color:#e6db74">&#39;ignore&#39;</span>)
</code></pre></div><p>Data analysis can be a time-consuming process. By using <code>tqdm</code> <sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>, you can check the progress of the process with the progress bar.
You may also see a warning that does not affect your execution. To ignore this, we use the module <code>warnings</code><sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup> which handles the warning display. The warning is not displayed by writing <code>warnings.simplefilter('ignore')</code>.</p>
<h2 id="data-manipulation">Data manipulation</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
pd<span style="color:#f92672">.</span>set_option(<span style="color:#e6db74">&#39;display.max_columns&#39;</span>, None)
</code></pre></div><p>This is the code written as default in Kaggle&rsquo;s Notebook. It uses two essential modules for data analysis, <code>numpy</code><sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> for numerical calculation and <code>pandas</code><sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup> for matrix processing. Also, the description <code>set_option('display.max_columns', None)</code> is set to always display all columns.</p>
<h2 id="data-visualization">Data visualization</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas_profiling <span style="color:#f92672">as</span> pdp
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
sns<span style="color:#f92672">.</span>set()
</code></pre></div><p>By handling <code>pandas_profiling</code><sup id="fnref:9"><a href="#fn:9" class="footnote-ref" role="doc-noteref">9</a></sup>, the data type and distribution of each feature, missing value, correlation coefficient, etc. can be output together. Useful for exploratory data analysis (EDA).
<code>matplotlib</code><sup id="fnref:10"><a href="#fn:10" class="footnote-ref" role="doc-noteref">10</a></sup> is a library used to draw graphs, and it can be used in combination with <code>seaborn</code> <sup id="fnref:11"><a href="#fn:11" class="footnote-ref" role="doc-noteref">11</a></sup> that operates as a wrapper to draw beautiful graphs.
Data visualization as described above is important for understanding the overall picture of data.</p>
<h2 id="preprocessing">Preprocessing</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.impute <span style="color:#f92672">import</span> SimpleImputer
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> OneHotEncoder
</code></pre></div><p>Among the pre-processing, by using <code>SimpleImputer</code><sup id="fnref:12"><a href="#fn:12" class="footnote-ref" role="doc-noteref">12</a></sup>, the missing value can be filled with either mean value (mean), median value (median) or mode value (mode).</p>
<p>Also, <code>sklearn.preprocessing</code> <sup id="fnref:13"><a href="#fn:13" class="footnote-ref" role="doc-noteref">13</a></sup> exists as a module implemented for preprocessing. By using <code>StandardScaler</code> <sup id="fnref:14"><a href="#fn:14" class="footnote-ref" role="doc-noteref">14</a></sup> as preprocessing of numerical values in the methods that belong to them, the scale of feature quantities can be standardized. Normalize the scale of features by using <code>MinMaxScaler</code><sup id="fnref:15"><a href="#fn:15" class="footnote-ref" role="doc-noteref">15</a></sup>. By using <code>LabelEncoder</code> <sup id="fnref:16"><a href="#fn:16" class="footnote-ref" role="doc-noteref">16</a></sup> as the preprocessing of the categorical variable, the character string can be converted to the ID represented by a numerical value. It can be converted into a vector by using <code>OneHotEncoder</code><sup id="fnref:17"><a href="#fn:17" class="footnote-ref" role="doc-noteref">17</a></sup>.</p>
<h2 id="cross-validation">Cross validation</h2>
<pre><code class="language-pythonfrom" data-lang="pythonfrom"></code></pre><p>Cross-validation is performed to prevent overtraining of the model (improving generalization performance). By using <code>StratifiedKFold</code><sup id="fnref:18"><a href="#fn:18" class="footnote-ref" role="doc-noteref">18</a></sup>, which implements stratified K-fold cross-validation, you can verify the accuracy of the model by splitting the data for training and testing while maintaining the distribution ratio. ..</p>
<h2 id="constant-definition">Constant definition</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">SEED <span style="color:#f92672">=</span> <span style="color:#ae81ff">2019</span>
N_FOLDS <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</code></pre></div><p>The pseudo random number seed (<code>SEED</code>) is fixed and the cross-validation division number (<code>N_FOLDS</code>) is set in advance. By assigning these to <code>StratifiedKFold</code>, which is a function that implements cross validation, the reproducibility of validation is maintained. An example is shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">skf <span style="color:#f92672">=</span> StratifiedKFold(n_splits<span style="color:#f92672">=</span>N_FOLDS, random_state<span style="color:#f92672">=</span>SEED)
</code></pre></div><p>*As for the number of divisions for cross-validation, there are many 10s, and I myself set it to 10 first, so I set it to <code>N_FOLDS = 10</code>.</p>
<h2 id="output-the-list-of-file-names-given-as-input">Output the list of file names given as input</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> os
<span style="color:#66d9ef">for</span> dirname, _, filenames <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(<span style="color:#e6db74">&#39;/kaggle/input&#39;</span>):
    <span style="color:#66d9ef">for</span> filename <span style="color:#f92672">in</span> filenames:
        <span style="color:#66d9ef">print</span>(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(dirname, filename))
</code></pre></div><p>This is the code written by default in Kaggle&rsquo;s Notebook. This will first check the given filename.</p>
<h1 id="in-conclusion">in conclusion</h1>
<p>In this article, we have put together &ldquo;the frequently used code&rdquo; in Notebook as &ldquo;Initial equipment of Kaggle&rdquo; and introduced it as one cell. And I explained the points. If you have any suggestions or suggestions, please do not hesitate to contact us.</p>
<p>(Added December 03, 2019)
It was posted in the following article! Thank you!</p>
<ul>
<li>[[Python] Qiita weekly stock ranking [automatic update]](
(<a href="https://qiita.com/kou_pg_0131/items/01127f188250a2d68dbf">https://qiita.com/kou_pg_0131/items/01127f188250a2d68dbf</a>) (December 01, 2019 13:00 update)</li>
<li>[Python article summary (automatic update daily)](
(<a href="https://qiita.com/kamata1729/items/eaf1d7b945b3a61a4fdd">https://qiita.com/kamata1729/items/eaf1d7b945b3a61a4fdd</a>) (Updated at 18:00 on December 02, 2019)</li>
</ul>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://www.kaggle.com/">https://www.kaggle.com/</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><a href="https://www.python.org/">https://www.python.org/</a> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p><a href="https://www.kaggle.com/docs/kernels">https://www.kaggle.com/docs/kernels</a> <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p><a href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.core.interactiveshell.html">https://ipython.readthedocs.io/en/stable/api/generated/IPython.core.interactiveshell.html</a> <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5" role="doc-endnote">
<p><a href="https://tqdm.github.io/">https://tqdm.github.io/</a> <a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6" role="doc-endnote">
<p><a href="https://docs.python.org/ja/3/library/warnings.html">https://docs.python.org/ja/3/library/warnings.html</a> <a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7" role="doc-endnote">
<p><a href="https://numpy.org/">https://numpy.org/</a> <a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8" role="doc-endnote">
<p><a href="https://pandas.pydata.org/">https://pandas.pydata.org/</a> <a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:9" role="doc-endnote">
<p><a href="https://pandas-profiling.github.io/pandas-profiling/docs/">https://pandas-profiling.github.io/pandas-profiling/docs/</a> <a href="#fnref:9" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:10" role="doc-endnote">
<p><a href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.html">https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.html</a> <a href="#fnref:10" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:11" role="doc-endnote">
<p><a href="https://seaborn.pydata.org/">https://seaborn.pydata.org/</a> <a href="#fnref:11" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:12" role="doc-endnote">
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html">https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html</a> <a href="#fnref:12" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:13" role="doc-endnote">
<p><a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing">https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing</a> <a href="#fnref:13" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:14" role="doc-endnote">
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html</a> <a href="#fnref:14" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:15" role="doc-endnote">
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html">https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html</a> <a href="#fnref:15" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:16" role="doc-endnote">
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html</a> <a href="#fnref:16" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:17" role="doc-endnote">
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html">https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html</a> <a href="#fnref:17" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:18" role="doc-endnote">
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html</a> <a href="#fnref:18" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
