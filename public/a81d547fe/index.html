<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] That&#39;s right, let&#39;s eat Bubu-zuke. [Natural language processing starting with Kyoto dialect] | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] That&rsquo;s right, let&rsquo;s eat Bubu-zuke. [Natural language processing starting with Kyoto dialect]</h1>
<p>
  <small class="text-secondary">
  
  
  Mar 15, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/scraping"> scraping</a></code></small>


<small><code><a href="https://memotut.com/tags/natural-language-processing"> natural language processing</a></code></small>


<small><code><a href="https://memotut.com/tags/material"> material</a></code></small>


<small><code><a href="https://memotut.com/tags/cotoha"> COTOHA</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p>I will do natural language processing for the first time. Excited.
This article is [Qiita x COTOHA API present project] Let&rsquo;s do text analysis with COTOHA API! ](<a href="https://zine.qiita.com/event/collaboration-cotoha-api/?utm_source=qiita&amp;utm_medium=banner">https://zine.qiita.com/event/collaboration-cotoha-api/?utm_source=qiita&amp;utm_medium=banner</a>) ~~ I want more prizes! ~~ The post was in time.</p>
<h1 id="immediately-the-main-subject-what-to-do-now">Immediately the main subject. What to do now</h1>
<p>First, I will briefly explain what to do.
I could do the following â†“</p>
<pre><code>python3 bubuduke.py &quot;Getta&quot;
&quot;Do not be good&quot;
</code></pre><p>I will make a Kyoto dialect translator like this.
Bubu pickles are delicious! Yay!
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/359997/bd8def10-a310-a1a1-d03f-4fe2e3618faf.jpeg" alt="bubu.jpg"></p>
<h1 id="flow-of-this-article">Flow of this article</h1>
<ul>
<li>For the time being, try using the COTOHA API (I used it for the first time)</li>
<li>What is natural language processing</li>
<li>Try natural language processing on text</li>
</ul>
<p>So, when you notice it, the convenient tools like the above are made. Very easy.</p>
<h2 id="make-the-cotoha-api-usable-for-the-time-being">Make the COTOHA API usable for the time being</h2>
<p>Register now for free from <a href="https://api.ce-cotoha.com/contents/index.html">here</a>.Pleasesendanemailaddressandcreateanaccount.Loginifyoucan.Thenthescreenlookslikethis.(Advertisetohere)
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/359997/77232ff6-2ff3-d7f7-5359-8fb2dffb72b0.png" alt="cotohaapi.png"></p>
<p>For this site, I will only use ID later, so this is the end.</p>
<h2 id="what-is-natural-language-processing">What is natural language processing?</h2>
<p>To put it simply, processing the words that humans usually use (= natural language). No, don&rsquo;t do it as it is.
What is difficult about this is that <strong>natural language, especially Japanese is not well-defined</strong>.</p>
<h3 id="japanese-is-not-well-defined">Japanese is not well-defined</h3>
<p>&ldquo;Not well-defined&rdquo; means that the definition does not assign a unique interpretation or value.
It means that one sentence can have multiple interpretations.</p>
<p>Consider a simple example. As follows.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/359997/20697b4f-38b7-5cb8-a832-847a9b6303c1.png" alt=" toilet.png">
There are no people who think that it is useless to watch this.
However, if you try to write this sentence literally in pseudo code, it will be like this.</p>
<pre><code>if something == &quot;toilet paper&quot; then
  You can run
</code></pre><p>that? I feel like I can&rsquo;t poop.</p>
<h3 id="the-kyoto-dialect-is-at-its-peak">The Kyoto dialect is at its peak.</h3>
<p>The Kyoto dialect I thought I would handle this time. For example,
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/359997/38e81117-e8bc-3176-0a63-d98c158d7f25.png" alt=" bubuduke.png"></p>
<p>The top is the famous Bubu pickle.
Bubu-zuke should mean ochazuke in Kyoto dialect.
Even so, being able to recommend Bubu-zuke means that you should return home.
I don&rsquo;t understand.</p>
<h3 id="anyway-the-kyoto-dialect-is-insidious">Anyway, the Kyoto dialect is insidious</h3>
<p>Let me give you another example.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/359997/38712a2f-f0fb-32e9-c705-f519bc5863b7.png" alt=" tokei.png"></p>
<p>I&rsquo;m sorry the derailment is long.
There are many other Kyoto words that I don&rsquo;t like, but I omit them. If you are curious, <a href="https://iirou.com/kazoekata/">here</a> can be listed in various ways.
In short, *Kyoto dialect is insidious and not well-defined. **</p>
<p>In natural language processing, we process words and syntax based on information from these natural languages.
After all, I only explain about natural language. From now on, we will implement a bot that processes the natural language of Japanese and can reply to such insidious Kyoto dialect &ldquo;Kaze&rdquo;.</p>
<h2 id="try-natural-language-processing-on-text">Try natural language processing on text</h2>
<p>Let&rsquo;s ignore the part that makes a bot for the time being and proceed with natural language processing.
~~ To be honest, this is the essence, so you don&rsquo;t have to read anything else. ~~
From here on is the essence, but COTOHA was so terrible that it ended immediately.</p>
<h3 id="sample-1">Sample 1</h3>
<p>For now, let&rsquo;s accept the input and process it lightly.
It is a demo that receives sentences and returns only nouns.
I referred to <a href="https://qiita.com/Harusugi/items/f499e8707b36d0f570c4">Masterpiece</a>.
The power of the <a href="https://github.com/obilixilido/cotoha-nlp">library</a> is so odd that it can be done without knowing anything.
First, insert the library.</p>
<pre><code>pip install git+https://github.com/obilixilido/cotoha-nlp.git
</code></pre><details><summary> This is the code I made. </summary><div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:samplecode1.py" data-lang="python:samplecode1.py"><span style="color:#f92672">from</span> cotoha_nlp.parse <span style="color:#f92672">import</span> Parser

parser <span style="color:#f92672">=</span> Parser(<span style="color:#e6db74">&#34;Client ID&#34;</span>,
  <span style="color:#e6db74">&#34;Client secret&#34;</span>,
  <span style="color:#e6db74">&#34;https://api.ce-cotoha.com/api/dev/nlp&#34;</span>,
  <span style="color:#e6db74">&#34;https://api.ce-cotoha.com/v1/oauth/accesstokens&#34;</span>
)
s <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse(input())

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join([token<span style="color:#f92672">.</span>form <span style="color:#66d9ef">for</span> token <span style="color:#f92672">in</span> s<span style="color:#f92672">.</span>tokens <span style="color:#66d9ef">if</span> token<span style="color:#f92672">.</span>pos <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;noun&#34;</span>]])))
</code></pre></div></div></details>
<p>I will post it again later, but please see that as the sample code is posted on GitHub.
Let&rsquo;s run this code. If you enter in order of <code>python file name string</code>, the result of processing the string will be returned.</p>
<pre><code>python samplecode1.py Spring is Akebono. Yes, let's go to Kyoto.
</code></pre><p>Then it will come back.</p>
<pre><code>&gt;&gt;Spring Akebono Kyoto
</code></pre><p>What do you think. With just this code, I was able to process natural language sufficiently well. Too bad.
~~ I don&rsquo;t understand anything. ~~</p>
<h3 id="kyoto-dialect-wind-conversion-script-completed-form">Kyoto dialect &ldquo;wind&rdquo; conversion script completed form</h3>
<p>Next, I&rsquo;ll start implementing the Kyoto Benfu bot.
Scraping from <a href="https://iirou.com/kazoekata/">the site above</a>, and if there is a Japanese direct translation that matches the extracted noun, return the Kyoto dialect.
Here is the flow for making from ordinary Japanese input.
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/359997/a117d6c5-2489-22fd-610f-f8507b856267.png" alt="image.png"></p>
<p>Since I&rsquo;m scraping, I&rsquo;ll put in a little library.</p>
<pre><code>pip3 install requests
pip3 install beautifulsoup4
</code></pre><details><summary> It looks like this. </summary><div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:bubuduke.py" data-lang="python:bubuduke.py"><span style="color:#f92672">from</span> cotoha_nlp.parse <span style="color:#f92672">import</span> Parser
<span style="color:#f92672">import</span> requests
<span style="color:#f92672">from</span> bs4 <span style="color:#f92672">import</span> BeautifulSoup
<span style="color:#f92672">import</span> re

parser <span style="color:#f92672">=</span> Parser(<span style="color:#e6db74">&#34;Client ID&#34;</span>,
  <span style="color:#e6db74">&#34;Client secret&#34;</span>,
  <span style="color:#e6db74">&#34;https://api.ce-cotoha.com/api/dev/nlp&#34;</span>,
  <span style="color:#e6db74">&#34;https://api.ce-cotoha.com/v1/oauth/accesstokens&#34;</span>
)
<span style="color:#75715e"># input</span>
s <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse(input())

<span style="color:#75715e"># get nouns</span>
nouns <span style="color:#f92672">=</span> [token<span style="color:#f92672">.</span>form <span style="color:#66d9ef">for</span> token <span style="color:#f92672">in</span> s<span style="color:#f92672">.</span>tokens <span style="color:#66d9ef">if</span> token<span style="color:#f92672">.</span>pos <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;noun&#34;</span>]]

<span style="color:#75715e"># web scraping</span>
r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://iirou.com/kazoekata/&#39;</span>)
soup <span style="color:#f92672">=</span> BeautifulSoup(r<span style="color:#f92672">.</span>content, <span style="color:#e6db74">&#34;html.parser&#34;</span>)
block <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>find_all(<span style="color:#e6db74">&#34;p&#34;</span>)

<span style="color:#75715e"># output</span>
<span style="color:#66d9ef">for</span> noun <span style="color:#f92672">in</span> nouns:
  <span style="color:#66d9ef">for</span> tag <span style="color:#f92672">in</span> block:
    <span style="color:#66d9ef">if</span> noun <span style="color:#f92672">in</span> str(tag):
      Cut out the Kyoto dialect <span style="color:#f92672">in</span> the <span style="color:#75715e">#strong tag</span>
      output <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#39;&lt;strong&gt;.*&lt;/strong&gt;&#39;</span>, str(tag))
      out <span style="color:#f92672">=</span> output[<span style="color:#ae81ff">0</span>]
      out <span style="color:#f92672">=</span> out<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;&lt;strong&gt;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)
      out <span style="color:#f92672">=</span> out<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;&lt;/strong&gt;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)
      <span style="color:#66d9ef">print</span>(out)
</code></pre></div></div></details>
<p>Execute immediately.</p>
<pre><code>python bubuduke.py &quot;Unsolicited&quot;
</code></pre><p>The insidious Kyoto dialect is back!</p>
<pre><code>&gt;&gt; &quot;Young lady, you've become a good piano player&quot;
</code></pre><p>This ends the natural language processing part.
Next time, just make a bot. The genre will change, and this is the end of this article.</p>
<h1 id="what-to-do-next-time">What to do next time</h1>
<p>I want to be a bot for LINE.
I want to improve the accuracy a little more. I want to pick up words that do not match exactly. There are so few words that I support so far.
I&rsquo;ll write that area again next time.</p>
<h1 id="in-conclusion">in conclusion</h1>
<p><a href="https://github.com/KoukiNAGATA/bubuduke">Repository of code used this time</a>
<a href="https://api.ce-cotoha.com/contents/reference/apireference.html">Reference</a>
After all, the official reference can be used most for any language, library, framework, etc.</p>
<p>Thank you for reading until the end.
<del>I want too much free gifts</del> LGTM, please.
For those who are not accepted by LGTM, please refer to <a href="https://qiita.com/HirosuguTakeshita/items/f015fee48f42a41045ef">this area</a> for reference.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
