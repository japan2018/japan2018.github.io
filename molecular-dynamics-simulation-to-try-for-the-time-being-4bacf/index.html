<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Molecular dynamics simulation to try for the time being | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Molecular dynamics simulation to try for the time being</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 21, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/numerical-calculation"> numerical calculation</a></code></small>


<small><code><a href="https://memotut.com/tags/molecular-dynamics"> molecular dynamics</a></code></small>

</p>
<pre><code>In this article, I'll briefly explain about molecular dynamics and try a simple simulation. For the simulation, we will use a Python module called [Atomic Simulation Environment](https://wiki.fysik.dtu.dk/ase/index.html).
</code></pre>
<h2 id="what-is-molecular-dynamics">What is molecular dynamics?</h2>
<p>Molecular Dynamics (MD) obtains dynamic processes of atoms and molecules by solving equations of motion based on interactions (potentials) between atoms and molecules.</p>
<p>What we see around us is an aggregate of atoms and molecules, if we look at it in detail. Molecular dynamics tries to understand the behavior of an aggregate by calculating the movement of atoms and molecules.</p>
<h2 id="try-it-for-now">Try it for now</h2>
<p>Let&rsquo;s leave the difficult theory behind and do it for now. Here, we will use a convenient package called <a href="https://wiki.fysik.dtu.dk/ase/index.html">Atomic Simulation Environment (ASE)</a>.</p>
<h3 id="put-the-package">put the package</h3>
<p>Python is required, so build the environment appropriately. Once the Python environment is in place,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install --upgrade --user ase
</code></pre></div><p>You can enter with. If you don&rsquo;t have numpy, scipy and matplotlib, install these two too.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install --upgrade --user numpy scipy matplotlib
</code></pre></div><p>The preparation is now complete.</p>
<h2 id="try-a-copper-cu-simulation">Try a copper (Cu) simulation</h2>
<p>Let&rsquo;s try copper atom (Cu) simulation.
(Contents given here are almost the same as <a href="https://wiki.fysik.dtu.dk/ase/tutorials/md/md.html">Tutorial</a>.)</p>
<h3 id="make-initial-placement">make initial placement</h3>
<p>In order to perform a simulation, the initial placement of copper atoms is required. Here, <a href="https://en.wikipedia.org/wiki/%E9%9D%A2%E5%BF%83%E7%AB%8B%E6%96%B9%E6%A0%BC%E5%AD%90%E6%A7%8B%E9%80%A0">FCC</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> ase.visualize.plot <span style="color:#f92672">import</span> plot_atoms
<span style="color:#f92672">from</span> ase.lattice.cubic <span style="color:#f92672">import</span> FaceCenteredCubic

size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
atoms <span style="color:#f92672">=</span> FaceCenteredCubic(directions<span style="color:#f92672">=</span>[[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]],
                          symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Cu&#34;</span>,
                          size<span style="color:#f92672">=</span>(size, size, size),
                          (pbc<span style="color:#f92672">=</span>True)
plot_atoms(atoms, rotation<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;0x,0y,0z&#39;</span>))
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>When I run this,
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/434103/7e91f9ee-b6d9-430b-268f-d100a76eed5e.png" alt="Figure_1.png">
It can be obtained. You can make FCC of $3\times3\times3$!</p>
<h3 id="determine-your-potential">Determine your potential</h3>
<p>In order to perform MD, it is necessary to know the potential between copper atoms. This time, we will use <a href="https://en.wikipedia.org/wiki/Effective_medium_approximations">EMT(effective medium theory)</a> potential.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> ase.calculators.emt <span style="color:#f92672">import</span> EMT
atoms<span style="color:#f92672">.</span>set_calculator(EMT())
</code></pre></div><h3 id="determine-the-initial-speed">Determine the initial speed</h3>
<p>To perform the simulation, it is necessary to determine not only the initial placement but also the initial velocity. Here, the velocity is determined according to the Maxwell-Boltzmann distribution with the temperature of $300k_B$.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> ase <span style="color:#f92672">import</span> units
<span style="color:#f92672">from</span> ase.md.velocitydistribution <span style="color:#f92672">import</span> MaxwellBoltzmannDistribution
MaxwellBoltzmannDistribution(atoms, <span style="color:#ae81ff">300</span> <span style="color:#f92672">*</span> units<span style="color:#f92672">.</span>kB)
</code></pre></div><h3 id="solve-the-equation-of-motion">Solve the equation of motion</h3>
<p>Finally, decide how to solve the equation of motion (differential equation).
Here is the simplest <a href="https://en.wikipedia.org/wiki/%E3%83%9F%E3%82%AF%E3%83%AD%E3%82%AB%E3%83%8E%E3%83%8B%E3%82%AB%E3%83%AB%E3%82%A2%E3%83%B3%E3%82%B5%E3%83%B3%E3%83%96%E3%83%AB">microcanonical ensemble</a>(numberofparticles$N$,volume$V$,energy$E$isconstant)iscalculatedbythe<a href="https://en.wikipedia.org/wiki/Verlet_integration">velocityVerleetmethod</a> to solve.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> ase <span style="color:#f92672">import</span> units
<span style="color:#f92672">from</span> ase.md.verlet <span style="color:#f92672">import</span> VelocityVerlet
dyn <span style="color:#f92672">=</span> VelocityVerlet(atoms, <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> units<span style="color:#f92672">.</span>fs)
</code></pre></div><p>At this time, the time step is $5$fs (femtosecond). By the way, $1$fs is $10^{-15}$s.</p>
<h3 id="run-md">Run MD.</h3>
<p>Let&rsquo;s execute MD based on the preparations so far.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> ase.lattice.cubic <span style="color:#f92672">import</span> FaceCenteredCubic
<span style="color:#f92672">from</span> ase.md.velocitydistribution <span style="color:#f92672">import</span> MaxwellBoltzmannDistribution
<span style="color:#f92672">from</span> ase.md.verlet <span style="color:#f92672">import</span> VelocityVerlet
<span style="color:#f92672">from</span> ase <span style="color:#f92672">import</span> units
<span style="color:#f92672">from</span> ase.calculators.emt <span style="color:#f92672">import</span> EMT

<span style="color:#75715e">#Create initial layout (FCC)</span>
size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
atoms <span style="color:#f92672">=</span> FaceCenteredCubic(directions<span style="color:#f92672">=</span>[[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]],
                          symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Cu&#34;</span>,
                          size<span style="color:#f92672">=</span>(size, size, size),
                          (pbc<span style="color:#f92672">=</span>True)
<span style="color:#75715e"># Use EMT (effective medium theory) for potential</span>
atoms<span style="color:#f92672">.</span>set_calculator(EMT())
Set the momentum according to Maxwell<span style="color:#f92672">-</span>Boltzmann distribution of <span style="color:#75715e">#300kb</span>
MaxwellBoltzmannDistribution(atoms, <span style="color:#ae81ff">300</span> <span style="color:#f92672">*</span> units<span style="color:#f92672">.</span>kB)
<span style="color:#75715e"># Perform MD calculation with constant NVE by velocity Berre method</span>
dyn <span style="color:#f92672">=</span> VelocityVerlet(atoms, <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> units<span style="color:#f92672">.</span>fs)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printenergy</span>(a<span style="color:#f92672">=</span>atoms): <span style="color:#75715e"># Output of potential energy and kinetic energy</span>
    epot <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>get_potential_energy() <span style="color:#f92672">/</span> len(a)
    ekin <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>get_kinetic_energy() <span style="color:#f92672">/</span> len(a)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Energy per atom: Epot = </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">eV Ekin = </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">eV (T=</span><span style="color:#e6db74">%3.0f</span><span style="color:#e6db74">K) &#39;</span>
          <span style="color:#e6db74">&#39;Etot = </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">eV&#39;</span> <span style="color:#f92672">%</span>(epot, ekin, ekin <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1.5</span> <span style="color:#f92672">*</span> units<span style="color:#f92672">.</span>kB), epot <span style="color:#f92672">+</span> ekin))


<span style="color:#75715e"># MD calculation</span>
dyn<span style="color:#f92672">.</span>attach(printenergy, interval<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
dyn<span style="color:#f92672">.</span>run(<span style="color:#ae81ff">1000</span>)
</code></pre></div><p>When you run the above, you will get output similar to the following:</p>
<pre><code>Energy per atom: Epot = -0.006eV Ekin = 0.044eV (T=340K) Etot = 0.038eV
Energy per atom: Epot = -0.006eV Ekin = 0.044eV (T=340K) Etot = 0.038eV
Energy per atom: Epot = 0.029eV Ekin = 0.010eV (T= 76K) Etot = 0.038eV
.....
</code></pre><p><code>Epot</code> is potential energy, <code>Ekin</code> is kinetic energy, and <code>Etot</code> is total energy.
In the graph,</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/434103/398cd2af-ede6-1096-03e2-421d975ecc5e.png" alt="Figure_2.png"></p>
<p>You can see that the total energy is well stored and the NVE constant simulation is done correctly.</p>
<h2 id="in-conclusion">in conclusion</h2>
<p>This simulation was performed for a very small and simple system in a very short time.</p>
<p>In order to carry out more practical simulations, it is necessary to devise various means. For example, this time we performed a constant NVE simulation, but in reality there are many cases where we want to perform a constant NVT (canonical ensemble) simulation. To perform a constant NVT simulation, <a href="https://en.wikipedia.org/wiki/%E8%83%BD%E5%8B%A2%EF%BC%9D%E3%83%95%E3%83%BC%E3%83%90%E3%83%BC%E3%83%BB%E3%82%B5%E3%83%BC%E3%83%A2%E3%82%B9%E3%82%BF%E3%83%83%E3%83%88">Nosé–Hoover thermostat</a>and<a href="https://en.wikipedia.org/wiki/%E3%83%A9%E3%83%B3%E3%82%B8%E3%83%A5%E3%83%90%E3%83%B3%E5%8B%95%E5%8A%9B%E5%AD%A6">Langevindynamics</a> ..
Alternatively, the potential has <a href="https://en.wikipedia.org/wiki/%E7%AC%AC%E4%B8%80%E5%8E%9F%E7%90%86%E8%25Thereisalsofirst-principlesmoleculardynamicsusingA8%88%E7%AE%97">first principle calculation</a>.</p>
<p>Thankfully, ASE is easy to try. Please try playing it once.</p>
<p>(I noticed that it was an advertisement for ASE&hellip;)</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
