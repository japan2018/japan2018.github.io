<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>I participated in Kaggle&#39;s NFL competition | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>I participated in Kaggle&rsquo;s NFL competition</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 7, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/neural-networks"> Neural Networks</a></code></small>


<small><code><a href="https://memotut.com/tags/kaggle"> Kaggle</a></code></small>


<small><code><a href="https://memotut.com/tags/competition"> Competition</a></code></small>

</p>
<pre><code>## Competition overview
</code></pre>
<ul>
<li>Held from October 10, 2019 to November 27, 2019 (<a href="https://www.kaggle.com/c/nfl-big-data-bowl-2020/">https://www.kaggle.com/c/nfl-big-data-bowl-2020/</a>
)</li>
<li>Predict the number of yards the attacker will advance in an American football run play</li>
</ul>
<h2 id="available-data">Available data</h2>
<ul>
<li>General information and player-specific information is given for each run play
-General information:
-Weather, temperature, wind speed, wind direction
-Stadium, location, turf condition
-  Start time
-Home/away score
-Number of downs (attack ends after 4 times *1)
-Number of yards required to continue the attack
-Number of yards advanced ← Predict this
-etc&hellip;
-Information by player *2
-NFL ID
-Location information (X, Y)
-Movement information (S: speed, A: acceleration)
-Orientation (Dir: Body orientation, Orientation: Face orientation)
-  Birthday
-  height, weight
-Home/away
-Jersey number
-Position
-etc&hellip;</li>
</ul>
<p>*1: If you advance 10 yards or more within 4 downs, you will continue to attack. If you cannot do it, the offense and defense will change.
*2: There are 22 lines of data, 11 for each attack/defense per play.</p>
<h2 id="about-the-team">About the team</h2>
<ul>
<li>The team name &ldquo;Griffin Series&rdquo; is the same as <a href="https://ai-rush.com/">AI RUSH</a></li>
<li>The team member this time is Mitsuno (tenyaf <img width=30 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/96e4a688-d095-2bf1-1881-53bc4ae3f055.png">) and Sato (foo_foo<img width=30 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/5dcf2163-faec-6886-6531-5058073adae4.png">)</li>
<li>Use Slack for communication and task management (I think that Trello etc. should have been used for task management)</li>
<li>Code management forks Kaggle notebooks to each other</li>
<li>Both have no prior knowledge of American football</li>
</ul>
<h2 id="result">result</h2>
<ul>
<li>Public 47th place (2,038 teams) *1st stage end (November 28)</li>
<li>I was able to enter the silver circle!
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/bfc316f2-baf0-4811-34cd-121c12fcd76e.png" alt="image.png"></li>
</ul>
<h2 id="introduction-of-team-solution">Introduction of team solution</h2>
<h3 id="solution-overview">Solution overview</h3>
<ul>
<li>Characteristic engineering centered on player position and speed</li>
<li>The state after 0.5 and 1.0 seconds was estimated (calculated from velocity and acceleration), and the feature amount was doubled.</li>
<li>Model is a simple MLP</li>
<li>Addition of post-processing to remove unacceptable yards</li>
</ul>
<img width=300 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/9c6b503a-2949-dd82-f7be-555683fcad1f.png">
<h3 id="preprocessing">Preprocessing</h3>
<ul>
<li>There are two attacking directions, &ldquo;Attack Left&rdquo; and &ldquo;Attack Right&rdquo;, so the directions are unified</li>
<li>Team name identification</li>
<li>Weather/wind speed/height processing
-Weather: Categorize by including a certain keyword (sunny)
-Wind speed: Extract the value excluding the unit such as &ldquo;mph&rdquo;
-Height: Unified in feet and inches</li>
</ul>
<h3 id="feature-engineering">Feature engineering</h3>
<ul>
<li>
<p>Statistics for each play
-X, Y, S, A min, max, ave, std, var
-Min, max, ave, std, var in S X direction and Y direction
<img width=400 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/7129e394-695f-47e6-c5e4-98b0c6125eed.png"></p>
</li>
<li>
<p>Lasher (*1) information
-X, Y, S, A min, max, ave, std, var
-S size in X direction, S size in Y direction
-Distance from attack/defense team members (min, max, ave, sum, var)
-Time of the shortest collision with the defensive team f member (min, max, ave, std)
-Speed ratio with the closest defending member
-Distance from the center of gravity of the attack/defense team members
-Distance from scrimmage line
-Other player information</p>
</li>
</ul>
<img width=350 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/eeec38a4-beb3-a9ca-5477-9747cee31be3.png">
<ul>
<li>Wide receiver (*2) information
-Wide receiver distance from scrammage line (min, max, ave)
-X, Y, S, A (min, max, ave, std, var) of enemies/ally within 5 yards of wide receiver</li>
</ul>
<img width=350 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/f675b6ac-c262-344f-61bd-b093cff5f1e7.png">
<p>*1: Ball holder. Basically a running back (RB).
*2: Multiple wide receivers (1 to 3 people)</p>
<h3 id="reinforcement-using-data-after-05-seconds-and-10-seconds">Reinforcement using data after 0.5 seconds and 1.0 seconds</h3>
<ul>
<li>Estimate and calculate X, Y, and S after 0 seconds based on &ldquo;speed&rdquo;, &ldquo;acceleration&rdquo;, and &ldquo;body direction&rdquo; *1</li>
<li>After 0.5 seconds, after 1.0 seconds, replace with X, Y, S, then extract and combine various features (number of features: 146 → 379 *2)</li>
</ul>
<p>Position at start and 1.0 seconds later
<img title="Start time" width=300 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/c41bb1cb-29ae-49f0-0c06-4d9f9ee0d327.png"> <img witdh=300 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/065c25f4-f028-f89f-90ea-bc13b001863a.png"></p>
<p>*1: Calculation assuming uniform acceleration motion
*2: Duplicate features are excluded and counted</p>
<h3 id="neural-network-architecture">Neural Network architecture</h3>
<ul>
<li>Use the public kernel model as a fork
-Optimizer = Adam
-Loss = categorical cross entropy</li>
<li>Since the possible values of the number of yards are discrete, the model is trained as a 199 class classification of [-99, 99].</li>
</ul>
<img width=300 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/151539f0-180b-a180-4d63-539e97b9a15f.png">
<h3 id="post-processing">post-processing</h3>
<ul>
<li>Set the likelihood other than possible values to 0 based on the scrammage line</li>
<li>According to the submission rule, form a cumulative distribution of -99 to 99 yards</li>
</ul>
<p><img width=500 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/edcb0043-8df2-f672-10a8-d7cf58e59562.png"><img width =250 src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181219/ff08cd37-04e1-3c50-6736-2193b2374068.png"></p>
<h3 id="ideas-that-could-not-be-realized">Ideas that could not be realized</h3>
<ul>
<li>Graph Convolution with player position information as a graph</li>
<li>Sort 22 players in a certain order and just add X,Y,S,A to the column</li>
<li>X,Y,S,A information of other important positions</li>
<li>Neural Network Tuning</li>
</ul>
<h2 id="impression">Impression</h2>
<ul>
<li>tenyaf
-I participated in the Kaggle competition for the first time, but I enjoyed the subject very much
-It became a battle with the processing time and realized the necessity of writing fast code
-There were many ideas that came up but could not be implemented, so I wanted to improve the implementation ability</li>
<li>foo_foo
-Feature engineering was relatively good
-Need to learn NN technology at table competition
-I should have used a tool for task management
-I will do my best to get gold</li>
</ul>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
