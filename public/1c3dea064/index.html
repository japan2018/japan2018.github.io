<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] 1 Click to become an executive button | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] 1 Click to become an executive button</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 4, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/natural-language-processing"> natural language processing</a></code></small>


<small><code><a href="https://memotut.com/tags/xbrl"> xbrl</a></code></small>


<small><code><a href="https://memotut.com/tags/fucking-apps"> fucking apps</a></code></small>

</p>
<pre><code>The looming year-end, is it cold because of winter or bosom...
</code></pre>
<p>We created an app that is similar to a faint match this season when you have a feeling of gray. With 1 Click, you can become an executive of a listed company! Its name is &ldquo;Executive Button&rdquo;. Click the image below to start it.</p>
<a href="http://executive-loadbalancer-1470189009.ap-northeast-1.elb.amazonaws.com/" target="_blank">
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/25990/fa632141-9325-14b3-cca3-3309b1e5d2bb.png" width=500>
</a>
<p><strong>Executive button here is amazing!</strong></p>
<p>Get paid for executives at listed companies with the push of a button! !</p>
<p><strong>The fucking executive button is here!</strong></p>
<p>Not really available! !</p>
<p>The implementation is here.</p>
<p><a href="https://github.com/icoxfog417/executive_button">https://github.com/icoxfog417/executive_button</a></p>
<h2 id="executive-remuneration-for-listed-companies">Executive remuneration for listed companies</h2>
<p>Beginning in 2019, executive remuneration, etc. will be disclosed as part of disclosure of governance. Specifically, we are now describing in disclosure documents that are obligatory for listed companies, such as securities reports.</p>
<p>Although it&rsquo;s hard to expose, <a href="https://www.tis.co.jp/documents/jp/ir/finance/securities_report/report_3103_4.pdf">Our executive compensation is as follows</a>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/25990/da45b9df-3835-e135-ff23-aebab160df4e.png" alt="image.png"></p>
<p>It is about 40 million per person. Hmm, quite&hellip; (a vague smile). This value can be obtained without the pain of reading from PDF. Since the disclosed document is written in XBRL, which is an extended form of XML, it is possible to obtain data by performing XML parsing. The tags used are revised every year and are announced as follows each time.</p>
<p>(<a href="https://www.fsa.go.jp/search/20190228.html">Announcement of 2019 EDINET taxonomy</a>)</p>
<p>The total amount of executive compensation can be obtained with the tag &ldquo;TotalAmountOfRemunerationEtcPaidByGroupRemunerationEtcPaidByGroupToEachDirectorOrOtherOfficer&rdquo; in the namespace &ldquo;jpcrp_cor&rdquo; (long). The name space is decided for each disclosure document, so it will be long if you talk, so if you are interested <a href="https://medium.com/programming-soda/%E8%B2%A1%E5%8B%99%E5%88%86%E6%9E%90%E3%81%AB%E6%AC%A0%E3%81%8B%E3%81%9B%E3%81%AA%E3%81%84-xbrl%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B-part1-d4165fe0e84a">here</a>.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/25990/b42cca94-ea60-3355-0fcb-62a4de97c16c.png" alt="image.png"></p>
<p>This time, we have created a data set &ldquo;<a href="https://www.tis.co.jp/news/2019/tis_news/20191114_1.html">CoARiJ</a>&rdquo; that summarizes recently released documents such as securities reports and financial figures. To use.</p>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/25990/3d1c5a3c-df80-6294-4d12-cc34f9f9e920.png" width=700>
<p>CoARiJ records text information and numerical information as a set, so &ldquo;I say good things but are they reflected in the management index?&rdquo; or &ldquo;If the numerical value is bad, environmental activities (reports) will be modest. It is possible to analyze from both text/numerical value such as &ldquo;Are there?&rdquo; This time, I am pulling out the data of executive compensation contained in the text and displaying it randomly in the application.</p>
<h2 id="application-configuration">Application configuration</h2>
<p>The application and infrastructure configuration this time are as follows.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/25990/002bcb20-c86f-6126-1028-ba80f126fd6e.png" alt="image.png"></p>
<ul>
<li>Application configuration
<ul>
<li>Frontend: <a href="https://ja.nuxtjs.org/">Nuxt</a></li>
<li>Backend: <a href="https://www.django-rest-framework.org/">Django Rest Framework</a></li>
<li>Proxy: <a href="https://docs.traefik.io/">Traefik</a>/Productionis<a href="https://nginx.org/en/">Nginx</a></li>
</ul>
</li>
<li>Infrastructure configuration
<ul>
<li>Use GitHub Action to register Docker image to Docker Hub / Deploy to Fargate using the registered image.</li>
</ul>
</li>
</ul>
<p>There is a reason why proxies are different between development and production.</p>
<ol>
<li>Traefik needs access to the host <code>docker.sock</code>, but <a href="https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/developerguide/bind-mounts.html">Fargate cannot do volume bind</a>.</li>
<li>Fargate cannot use <code>links</code>, so Nginx cannot resolve the host name. Instead, <a href="https://qiita.com/taishin/items/84122ad85bedf8b8a682">You can access other containers with <code>localhost</code></a>.</li>
<li>Therefore, it is necessary to change the value of <code>nginx.conf</code> even if Nginx is used for both development/production (it cannot be accessed by localhost when developing). In any case, Traefik is used because it is a double management, so it is easy to set up in development.</li>
</ol>
<p>If this is a hassle, I think I should have a proxy, but there is a reason for having a proxy.
When separating containers with Nuxt/backend, a proxy is required for both access from the server side and client side of Nuxt (For details, see [here] [https://stackoverflow.com/questions/55090038] /get-http-api1337-games-neterr-name-not-resolved-for-nuxt-js-pages-using-asy)). On the server side, Nuxt proxy settings can be used.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nuxt.config.js" data-lang="nuxt.config.js">  <span style="color:#a6e22e">modules</span><span style="color:#f92672">:</span> [
    <span style="color:#75715e">// Doc: https://axios.nuxtjs.org/usage
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#34;@nuxtjs/axios&#34;</span>,
    <span style="color:#e6db74">&#34;@nuxtjs/proxy&#34;</span>
  ],
  <span style="color:#75715e">/*
</span><span style="color:#75715e">   ** Axios module configuration
</span><span style="color:#75715e">   ** See https://axios.nuxtjs.org/options
</span><span style="color:#75715e">   */</span>
  <span style="color:#a6e22e">axios</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">prefix</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;/api&#34;</span>,
    <span style="color:#a6e22e">proxy</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
  },
  <span style="color:#a6e22e">proxy</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;/api/&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">BACKEND_URL</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;http://localhost:8000/&#34;</span>
  },
</code></pre></div><p>However, JavaScript (access from the client side) after being rendered does not require proxy settings. Therefore, the host name cannot be resolved or a cross domain error occurs. In order to properly convey the access from the client side to the backend, it is necessary to put a reverse proxy and relay it.</p>
<p>Traefik is well suited for this reverse proxy role. You can set the proxy just by setting the label in Traefik 2.0 series and docker-compose. The following is a quote from the official tutorial, but simply setting <code>Host</code> in <code>labels</code> in the <code>whoami</code> container will relay the request to the corresponding host.</p>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/25990/0602b742-8a0c-799a-7aa9-291748b1783b.png" width=600>
<p>Great convenience! However, as mentioned above, it can not be used with Fargate which can not use binding because it refers to <code>docker.sock</code> of the host. It can be supported by switching to EC2, but please note that the policy of <code>AmazonEC2ContainerServiceforEC2Role</code> is required at this time (<a href="https://stackoverflow.com/questions/36523282/aws-ecs-error-when-running-task-no-container-instances-were-found-in-your-clust">Reference</a>).</p>
<p>In addition, Public IP will change every time you deploy Fargate. Since it is difficult as it is, let&rsquo;s relay the request in front of the load balancer (it is just relaying something &hellip;). For details on how to make a load balancer, see the following.</p>
<p><a href="https://itnext.io/run-your-containers-on-aws-fargate-c2d4f6a47fda">Run your container on AWS Fargate</a></p>
<p>When registering from <code>ecs-cli</code>, specify with <code>--target-group-arn</code> (target group) instead of <code>--load-balancer-name</code> (load balancer). When specified by the load balancer, it was said to be <code>Classic Load Balancers are not supported with Fargate</code>.</p>
<pre><code> ecs-cli compose service create \
       --target-group-arn &quot;$ARN&quot; \
       --container-name service_name_on_docker_compose \
       --container-port exposed_port
```For the final deployment using GitHub Action, please refer to the repository (https://github.com/icoxfog417/executive_button/blob/master/.github/workflows/dockerimage.yml).

## Officer compensation ranking

Well, just tell me which companies get the most! I created the top 10 for those who say. Of the 1944 companies that have been able to obtain compensation, the following companies have the highest compensation per person.

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/25990/bfcb39ef-6b76-ae10-c62e-a13e9630a8bf.png)

If you work for 10 million years at Tokyo Electron Limited, you can get 5000 trillion yen! (Is the calculation correct?). The data for all companies is in the repository, so take a look.</code></pre>
    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
