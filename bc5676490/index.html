<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] An engineer who has noticed the emo of cryptography is trying to implement it in Python and defeat it | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] An engineer who has noticed the emo of cryptography is trying to implement it in Python and defeat it</h1>
<p>
  <small class="text-secondary">
  
  
  Dec 15, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/python3">Python3</a></code></small>


<small><code><a href="https://memotut.com/tags/crypto">crypto</a></code></small>


<small><code><a href="https://memotut.com/tags/%E6%9A%97%E5%8F%B7">暗号</a></code></small>

</p>
<pre><code>It is no exaggeration to say that the modern information society is supported by cryptographic technology. Nevertheless, we are reaping the benefits without being particularly aware of cryptography. What's more, cryptography has been around for a long time, as it existed around 100 BC. In addition, Hyundai Cryptography is trying to ensure high security by making full use of advanced mathematics, and eventually it will be derived from blockchain technology.
</code></pre>
<p>What is the length of this history and the range of defense! !</p>
<p>So, I&rsquo;m aware of the emo of cryptography, but I will talk about trying to implement cryptography in Python to maintain and update knowledge.</p>
<h1 id="basic-idea-of-cryptographic-technology">Basic idea of cryptographic technology</h1>
<p>Cryptography is largely made up of three elements: <strong>key generation</strong>, <strong>encryption</strong>, and <strong>decryption</strong>.</p>
<p>In particular, keys play a very important role in cryptography. Rather, I think it can be said that cryptography is a technology of how to generate this key. Because this key is used for both encryption and decryption, it is directly related to security.</p>
<p>Depending on how the keys are handled, they can be classified into two types: <strong>common key cryptography</strong> and <strong>public key cryptography</strong>.</p>
<p>Secret key cryptography uses the same key for both encryption and decryption processes. This was the mainstream method for a while after the birth of cryptographic technology, but it had the drawback of costing key management because the key had to be exchanged only by the parties without being known to a third party.</p>
<p>In public key cryptography, in order to overcome the drawbacks of common key cryptography, two kinds of corresponding keys, a private key and a public key, are generated, and the public key is literally disclosed, thereby drastically reducing the cost of key management. You can do it. Public key cryptography is often used because it can be used by opening the public key, which is compatible with the exchange of information on the Internet. In the case of public key cryptography, the private key and the public key must have a correspondence like a tally, and at the same time, the private key must not be inferred from the public key. Therefore, mathematics such as prime factorization of huge numbers and discrete logarithm problem are used.</p>
<p>#First from the classical cipher</p>
<p>Cryptography has changed dramatically since the first half of the 20th century. Until then, it was called the classical cipher, and the deciphering of the cipher was mainly the work of linguists. This is because I was trying to make encryption and decryption while fiddling with the characters, such as shifting the alphabet by several characters or using the correspondence table prepared in advance.</p>
<p>However, during the Second World War, the Enigma developed by the German Army and the crypto-decoding team led by Turing, an information scientist in the United Kingdom, called the crypto war, became one opportunity, and gradually the cryptography became the work of mathematicians and informatics. It was coming.</p>
<p>In addition, cryptographic technology is constantly repeating the game of development and decryption. In fact, the British army, who had deciphered the Enigma, had hidden the fact that it had been deciphered for about 20 years. This is because, if it is announced that it can be decrypted, there is a risk that stronger encryption will be developed.</p>
<p>This is just one point of view, but given this background, I think that cryptographic technology can be relatively easily understood if we learn from classical cryptography to modern cryptography. It is highly recommended because you can understand the differences such as which areas have been improved by learning by tracing the genealogy of the development of cryptography.</p>
<h1 id="for-example-caesar-cipher">For example, Caesar cipher</h1>
<p>The Caesar cipher is said to be the oldest cipher in the world (?). As the name implies, it is a code created by Julius Caesar who was active around the 1st century BC. This is to shift the characters by shifting them by 3 when the characters are arranged in alphabetical order. The implementation of the encrypted part in Python is as follows. ASCII code is used for the part to shift the characters.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:caesar-cipher.py" data-lang="python:caesar-cipher.py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">enc</span>(text):
    result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(text)):
        cha <span style="color:#f92672">=</span> text[i]
        <span style="color:#66d9ef">if</span>(cha<span style="color:#f92672">.</span>isupper()):
            result <span style="color:#f92672">+=</span> chr((ord(cha)<span style="color:#f92672">-</span><span style="color:#ae81ff">62</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span>)
        <span style="color:#66d9ef">else</span>:
            result <span style="color:#f92672">+=</span> chr((ord(cha)<span style="color:#f92672">-</span><span style="color:#ae81ff">94</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">print</span>(result)
</code></pre></div><p>It actually looks like this when encrypted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:caesar-cipher.py" data-lang="python:caesar-cipher.py">enc(<span style="color:#e6db74">&#34;Caesar&#34;</span>)
<span style="color:#75715e"># Ciphertext: Fdhvdu</span>
</code></pre></div><p>When decrypting, you can reverse the encryption, so the implementation is as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:caesar-cipher.py" data-lang="python:caesar-cipher.py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dec</span>(text):
    result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(text)):
        cha <span style="color:#f92672">=</span> text[i]
        <span style="color:#66d9ef">if</span>(cha<span style="color:#f92672">.</span>isupper()):
            result <span style="color:#f92672">+=</span> chr((ord(cha)<span style="color:#f92672">-</span><span style="color:#ae81ff">42</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span>)
        <span style="color:#66d9ef">else</span>:
            result <span style="color:#f92672">+=</span> chr((ord(cha)<span style="color:#f92672">-</span><span style="color:#ae81ff">74</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">print</span>(result)
</code></pre></div><p>It looks like this when executed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:caesar-cipher.py" data-lang="python:caesar-cipher.py">dec(<span style="color:#e6db74">&#34;Fdhvdu&#34;</span>)
<span style="color:#75715e">#Decipher text: Caesar</span>
</code></pre></div><h2 id="shift-cipher">Shift cipher</h2>
<p>The key to the Caesar cipher was to shift 3 characters. For example, if there is a spy, if you notice that you have shifted three letters, that is the end of the first volume. Therefore, a cipher in which the third part, that is, the part of the key was changed was also devised. That is what is called shift cipher.</p>
<p>The encryption part is as follows. This time, the number of characters to shift is specified as an argument. You can create a function to generate a key, but I decided to specify it as an argument because it will just return the incoming numerical value as it is.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:shift-cipher.py" data-lang="python:shift-cipher.py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">enc</span>(plaintext, rot):
    <span style="color:#66d9ef">if</span>(rot<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">25</span>):
        rot <span style="color:#f92672">=</span> rot <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span>
    result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(plaintext)):
        cha <span style="color:#f92672">=</span> plaintext[i]
        <span style="color:#66d9ef">if</span>(cha<span style="color:#f92672">.</span>isupper()):
            result <span style="color:#f92672">+=</span> chr((ord(cha) <span style="color:#f92672">+</span> rot<span style="color:#f92672">-</span><span style="color:#ae81ff">65</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span>)
        <span style="color:#66d9ef">else</span>:
            result <span style="color:#f92672">+=</span> chr((ord(cha) <span style="color:#f92672">+</span> rot<span style="color:#f92672">-</span><span style="color:#ae81ff">97</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">print</span>(result)
</code></pre></div><p>Decryption is the reverse of encryption.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:shift-cipher.py" data-lang="python:shift-cipher.py"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dec</span>(encryptedtext, rot):
    <span style="color:#66d9ef">if</span>(rot<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">25</span>):
        rot <span style="color:#f92672">=</span> rot <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span>
    result <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(encryptedtext)):
        cha <span style="color:#f92672">=</span> encryptedtext[i]
        <span style="color:#66d9ef">if</span>(cha<span style="color:#f92672">.</span>isupper()):
            result <span style="color:#f92672">+=</span> chr((ord(cha)<span style="color:#f92672">-</span>rot<span style="color:#f92672">-</span><span style="color:#ae81ff">39</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span>)
        <span style="color:#66d9ef">else</span>:
            result <span style="color:#f92672">+=</span> chr((ord(cha)<span style="color:#f92672">-</span>rot<span style="color:#f92672">-</span><span style="color:#ae81ff">71</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">print</span>(result)
</code></pre></div><h1 id="from-now-on">from now on</h1>
<p>I plan to implement and defeat the classic ciphers from the BC to the latest modern ciphers in Python, while also maintaining and updating the knowledge. When I tried it, I could see the history of cryptography and the struggles of my predecessors, and it became unexpectedly fun.</p>
<p>For the time being, the immediate goal is to get to the zero knowledge proof system and secret sharing that often appear in the block chain area.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
