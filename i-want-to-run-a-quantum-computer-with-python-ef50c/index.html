<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>I want to run a quantum computer with Python | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>I want to run a quantum computer with Python</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 10, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/quantum-computer"> quantum computer</a></code></small>

</p>
<pre><code>#Introduction
</code></pre>
<p><a href="https://mainichi.jp/articles/20191023/k00/00m/020/298000c">Google has demonstrated quantum transcendence</a>Newscameoutanditwasatopicrecentlyaboutquantumcomputers,soIwaslightlyinvestigatingHowever,therewasamethodthatanyonecantryandoperateaquantumcomputer(whichwillbedescribedlater,differentfromthemethodbeingdevelopedbyGoogleorthequantumannealingmethod) ** So I have summarized it here.
I am not an expert in this area, so there may be some mistakes in the explanation. Please note that.</p>
<p>##reference
I have referred to the following to understand the quantum computer and actually operate the quantum computer.</p>
<ul>
<li><a href="https://www.amazon.co.jp/dp/4274223728/ref=cm_sw_r_tw_dp_U_x_.hGXDbP05GB67">The world changed by quantum computers</a>MasanobuTerabe(Author),MasayukiOzeki(Author) Publisher; Ohmsha</li>
<li><a href="https://cloud.dwavesys.com/leap/login/?next=/leap/">D-wave Leap</a>(registerheretorunthequantumcomputer)</li>
<li><a href="https://docs.ocean.dwavesys.com/en/latest/index.html">Ocean Software Documentation</a>(Pythonlibraryforrunningquantumcomputers)</li>
</ul>
<p>#What is a quantum computer
Regarding the explanation of the quantum computer, the explanation that appeared in the Nikkei newspaper was completed and easy to understand,
First of all, I will quote as it is.</p>
<blockquote>
</blockquote>
<p>â–¼Quantum computer
A computer that applies the &ldquo;quantum mechanics&rdquo;, a physical law that holds true in the microscopic world, such as the atoms and electrons that make up materials. Conventional computers represent and calculate information in units of &ldquo;0&rdquo; and &ldquo;1&rdquo; bits, but a huge amount of calculation is required depending on how 0s and 1s are arranged. On the other hand, the quantum computer uses a special state called &ldquo;superposition&rdquo; which is both 0 and 1 for calculation. If this principle is applied, it is expected that previously difficult calculations can be done in a short time.
*2019/10/19 Nikkei Shimbun &ldquo;What is a quantum computer?</p>
<p>Quantum computers are very important because of the existence of qubits that can have a state of superposition of 0s and 1s, and use this to instantly find the best combination from all combinations. It is said that the machine that can be found in is a quantum computer.</p>
<p>There are two types of quantum computers currently being developed.</p>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">Overview</th>
<th align="left">Development Vendor</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Quantum annealing method</td>
<td align="left">Method specialized for combinatorial optimization task processing</td>
<td align="left">D-wave Systems etc.</td>
</tr>
<tr>
<td align="left">Quantum gate method</td>
<td align="left">A general-purpose method that can calculate anything like a conventional computer</td>
<td align="left">Google, IBM, etc.</td>
</tr>
</tbody>
</table>
<p>Quantum annealing machines are currently undergoing verification experiments by companies.
In 2011, a company called D-wave Systems in Canada started commercial sales of quantum annealing machines, and various companies are conducting demonstration experiments.</p>
<p>Japanese companies <a href="http://dwavejapan.com/recruit-communications-d-wave-collaborate-apply-quantum-computing-marketing-advertising-communications-Itseemsthattheyaredoingresearchanddevelopmentaimingatoptimization/">Apply Recruit Communications to quantum computer ad optimization</a>.</p>
<p>This time, the quantum annealing machine of D-wave Systems is run by Python. **As of November 2019, anyone can run the quantum annealing machine for 1 minute for free just by registering. **</p>
<p>#Preparation</p>
<h2 id="preparation-for-running-a-quantum-computer">Preparation for running a quantum computer</h2>
<p>First, register as a user from the <a href="https://cloud.dwavesys.com/leap/login/">here</a> site. You can register by simply entering your name, email address, and occupation information, and no credit card information is required.</p>
<p>![Screenshot 2019-11-09 9.44.21.png](<a href="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/395230/fa994c0f-8857-afcd-057b-(b7aade36c573.png)">https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/395230/fa994c0f-8857-afcd-057b-(b7aade36c573.png)</a></p>
<p>When you log in, you will first see a screen like this at the top. On the far left, various explanation movies explain what this quantum annealing machine can do. You can see a demo of the quantum computer in the middle, but be careful as it consumes time from the trial one minute. On the far right is a description of how to run a quantum annealing machine with the Python library.</p>
<p>![Screenshot 2019-11-04 18.33.11.png](<a href="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/395230/f0dee9be-1839-f75c-5a46-(3fd564b8bced.png)">https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/395230/f0dee9be-1839-f75c-5a46-(3fd564b8bced.png)</a></p>
<p>If you scroll, you will also see a dashboard like this.
Here you can see how much time you have left to operate the quantum computer.</p>
<p>![Screenshot 2019-11-04 18.33.30.png](<a href="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/395230/44fd61ec-d114-39db-3d80-(9c7e7ab6e7ed.png)">https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/395230/44fd61ec-d114-39db-3d80-(9c7e7ab6e7ed.png)</a></p>
<p>If you use it, the time will decrease like this.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/395230/075634b6-1a3e-464c-ac5e-6a3292177c97.png" alt="Screenshot 2019-11-09 9.53.24.png"></p>
<h2 id="python-library-preparation">Python library preparation</h2>
<p>It is a library, but you can install it with pip normally.
However, in the environment that I always use, for some reason errors occurred frequently during installation, so I launched a container from the image for machine learning with Docker and installed it there.</p>
<pre><code>pip install dwave-ocean-sdk
</code></pre><p>Please execute the following command when the installation here is completed.</p>
<pre><code>dwave config create
</code></pre><p>Then, the following is displayed in order from the top, but basically press Enter as it is,
Please put your API token in place of &ldquo;Authentication token&rdquo;.
You can copy your own API token from the top of my page.</p>
<pre><code>Confirm configuration file path [/home/jane/.config/dwave/dwave.conf]:
Profile (create new) [prod]:
API endpoint URL [skip]:
Authentication token [skip]: Describe your API token
Default client class (qpu or sw) [qpu]:
Default solver [skip]:
Configuration saved.
</code></pre><p>Preparations are complete here.
Execute the following command to confirm that the connection is successful.</p>
<pre><code>dwave ping
</code></pre><p>It is OK if it looks like this.</p>
<pre><code>Using endpoint: https://my.dwavesys.url/
Using solver: My_DWAVE_2000Q

Wall clock time:
 * Solver definition fetch: 2007.239 ms
 * Problem submit and results fetch: 1033.931 ms
 * Total: 3041.171 ms

QPU timing:
 * total_real_time = 10493 us
 * anneal_time_per_run = 20 us
 * post_processing_overhead_time = 128 us
 * qpu_anneal_time_per_sample = 20 us
</code></pre><h1 id="solve-tasks-with-quantum-computers">Solve tasks with quantum computers</h1>
<p>Then, we will actually solve the task using a quantum computer.</p>
<h2 id="tasks-solved-by-quantum-computers">Tasks solved by quantum computers</h2>
<p>This time, it is prepared as <a href="https://docs.ocean.dwavesys.com/en/latest/examples/scheduling.html#scheduling">API reference sample problem</a>,
Solve the scheduling task with constraints.
###problem
The following rules are set as conditions for holding MTG.
We will try to comprehensively extract the conditions under which MTG can be held without violating this rule.
<strong>Rules</strong></p>
<ul>
<li>If you are on time and in the office, you must participate in the MTG directly (no conference call)</li>
<li>Must participate in the MTG that is held on time (forced participation)</li>
<li>Non-scheduled MTG must be held by conference call</li>
<li>Non-scheduled MTG should not exceed 30 minutes</li>
</ul>
<h2 id="solve-the-task">Solve the task</h2>
<h3 id="problem-conversion">Problem conversion</h3>
<p>First, convert the above conditions with 0 and 1 so that they can be read by the computer.</p>
<ul>
<li>When <code>time</code> is 1, &ldquo;on time&rdquo;, when 0 is &ldquo;outside time&rdquo;</li>
<li>When the location is 1, it is &ldquo;in the office&rdquo;, when it is 0, it is &ldquo;outside the office&rdquo;</li>
<li>When length is 1, &ldquo;MTG time is 30 minutes or less&rdquo;, when it is 0, &ldquo;MTG time is 30 minutes or more&rdquo;</li>
<li>When <code>mandatory</code> is 1, &ldquo;compulsory participation&rdquo;, when it is 0, &ldquo;voluntary participation&rdquo;</li>
</ul>
<p>Now, create a function that drops the above 0,1 conversion for the rule.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scheduling</span>(time, location, length, mandatory):
    <span style="color:#66d9ef">if</span> time: <span style="color:#75715e"># fixed time</span>
        <span style="color:#66d9ef">return</span> (location <span style="color:#f92672">and</span> mandatory) <span style="color:#75715e"># Forced participation in the office</span>
    <span style="color:#66d9ef">else</span>: <span style="color:#75715e"># out of time</span>
        <span style="color:#66d9ef">return</span> ((<span style="color:#f92672">not</span> location) <span style="color:#f92672">and</span> length) <span style="color:#75715e"># Conference call less than 30 minutes</span>
</code></pre></div><p>Create constraints from this function using the library.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> dwavebinarycsp
csp <span style="color:#f92672">=</span> dwavebinarycsp<span style="color:#f92672">.</span>ConstraintSatisfactionProblem(dwavebinarycsp<span style="color:#f92672">.</span>BINARY)csp<span style="color:#f92672">.</span>add_constraint(scheduling, [<span style="color:#e6db74">&#39;time&#39;</span>,<span style="color:#e6db74">&#39;location&#39;</span>,<span style="color:#e6db74">&#39;length&#39;</span>,<span style="color:#e6db74">&#39;mandatory&#39;</span>])
</code></pre></div><p>Furthermore, this is converted into a form called an aging model (quadratic form minimization problem).
<strong>Conversion of the problem to this format is essential for the quantum computer to solve the problem</strong>.
Although it is <code>min_classical_gap</code> specified by the following argument, it is not specified in the official sample code. The default does not work, and I specified it here, but I could not find out the cause&hellip;I would appreciate it if anyone who understands could tell me.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">bqm <span style="color:#f92672">=</span> dwavebinarycsp<span style="color:#f92672">.</span>stitch(csp, min_classical_gap<span style="color:#f92672">=</span><span style="color:#ae81ff">2.1</span>)
<span style="color:#66d9ef">print</span>(bqm)
</code></pre></div><pre><code>BinaryQuadraticModel({'a': -1.0,'aux0': -2.0,'aux1': 0.0,'b': 2.0,'c': 1.0,'aux2': -1.0}, {('aux0', ' a'): 1.0, ('aux1','a'): 1.0, ('aux1','aux0'): -1.0, ('b','a'): -1.0, ('b', ' aux0'): -1.0, ('b','aux1'): -1.0, ('c','a'): 0.0, ('c','aux0'): -1.0, ('c', 'aux1'): -1.0, ('c','b'): 1.0, ('aux2','a'): 1.0, ('b','aux2'): -1.0, ('c', 'aux2'): 1.0}, 0.0, Vartype.SPIN)
</code></pre><p>The above output corresponds mathematically here.
$\sum_i^N q_ix_i + \sum_{i&lt;j}^N q_{i,j}x_i x_j$</p>
<h3 id="let-the-quantum-computer-solve-the-problem">Let the quantum computer solve the problem</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> dwave.system.samplers <span style="color:#f92672">import</span> DWaveSampler
<span style="color:#f92672">from</span> dwave.system.composites <span style="color:#f92672">import</span> EmbeddingComposite
sampler <span style="color:#f92672">=</span> EmbeddingComposite(DWaveSampler(endpoint<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;https://cloud.dwavesys.com/sapi&#39;</span>, token<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Enter your API token&#39;</span>, solver<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DW_2000Q_2_1&#39;</span>))
</code></pre></div><p>Request the quantum computer to sample.
Because the sampled results are probabilistic, you can call multiple &ldquo;optimal&rdquo; solutions by requesting many samples instead of one, and avoid settling on the non-optimal solutions. The following requests 5000 samples with arguments.</p>
<ul>
<li>This process consumes the quantum computer&rsquo;s usage time.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">response <span style="color:#f92672">=</span> sampler<span style="color:#f92672">.</span>sample(bqm, num_reads<span style="color:#f92672">=</span><span style="color:#ae81ff">5000</span>)
The solution <span style="color:#66d9ef">with</span> the smallest <span style="color:#75715e">#energy value is the optimal solution</span>
min_energy <span style="color:#f92672">=</span> next(response<span style="color:#f92672">.</span>data([<span style="color:#e6db74">&#39;energy&#39;</span>]))
</code></pre></div><p>Now let&rsquo;s look at the sampling results.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">total <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> sample, energy, occurrences <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>data([<span style="color:#e6db74">&#39;sample&#39;</span>,<span style="color:#e6db74">&#39;energy&#39;</span>,<span style="color:#e6db74">&#39;num_occurrences&#39;</span>]):
    total <span style="color:#f92672">=</span> total <span style="color:#f92672">+</span> occurrences
    <span style="color:#66d9ef">if</span> energy <span style="color:#f92672">==</span> min_energy:
        time <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;on time&#39;</span> <span style="color:#66d9ef">if</span> sample[<span style="color:#e6db74">&#39;time&#39;</span>] <span style="color:#66d9ef">else</span><span style="color:#e6db74">&#39;out of time&#39;</span>
        location <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;office&#39;</span> <span style="color:#66d9ef">if</span> sample[<span style="color:#e6db74">&#39;location&#39;</span>] <span style="color:#66d9ef">else</span><span style="color:#e6db74">&#39;conference call&#39;</span>
        length <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;30 minutes or less&#39;</span> <span style="color:#66d9ef">if</span> sample[<span style="color:#e6db74">&#39;length&#39;</span>] <span style="color:#66d9ef">else</span><span style="color:#e6db74">&#39;longer than 30 minutes&#39;</span>
        mandatory <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;compulsory participation&#39;</span> <span style="color:#66d9ef">if</span> sample[<span style="color:#e6db74">&#39;mandatory&#39;</span>] <span style="color:#66d9ef">else</span><span style="color:#e6db74">&#39;voluntary participation&#39;</span>
        sub <span style="color:#f92672">=</span> str(sample[<span style="color:#e6db74">&#39;mandatory&#39;</span>])
<span style="color:#75715e"># print(&#34;{}: During {} at {}, you can schedule a {} meeting that is {}::{}&#34;.format(occurrences, time, location, length, mandatory, sub))</span>
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34; {} is {} and {} MTG can be held in {}.&#34;</span><span style="color:#f92672">.</span>format(time, location, length, mandatory))
</code></pre></div><pre><code>You can hold an MTG of less than 30 minutes by voluntarily participating in a conference call outside the scheduled time.
You can hold an MTG of less than 30 minutes by compulsory participation in the office during the scheduled time.
You can hold an MTG longer than 30 minutes by compulsory participation in the office during the scheduled time.
You can hold an MTG longer than 30 minutes by compulsory participation in the office during the scheduled time.
You can hold an MTG longer than 30 minutes by compulsory participation in the office during the scheduled time.
You can hold an MTG for 30 minutes or less by compulsory participation in a conference call outside the scheduled time.
You can hold an MTG longer than 30 minutes by compulsory participation in the office during the scheduled time.
</code></pre><p>Although there are multiple overlapping solutions, we have been able to extract a solution that satisfies all constraints.</p>
<p>#Next
Although I tried moving the quantum computer for the time being, I had a lot of things I did not understand, such as the QUBO matrix and the imagining model, so I would like to study if I have time.
Also, this time, because the amount of data that was tested was small, and because this quantum computer itself was also connected to the cloud, I could not really realize the calculation speed of the topic. I think this area is an area where we are progressing day by day, so I would like to pursue it properly.</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
