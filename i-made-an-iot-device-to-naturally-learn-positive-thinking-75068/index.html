<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>I made an IoT device to naturally learn positive thinking | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>I made an IoT device to naturally learn positive thinking</h1>
<p>
  <small class="text-secondary">
  
  
  Mar 8, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/raspberrypi">RaspberryPi</a></code></small>


<small><code><a href="https://memotut.com/tags/cotoha">COTOHA</a></code></small>

</p>
<pre><code>Suddenly, do you know about positive thinking?
</code></pre>
<blockquote>
<p>Positive thinking (English: positive thinking) is that if you think positively about anything, it will come true and your life will go well [1], try to see the good side of things, It is a thinking method that aims to change the reality by maintaining a simple attitude and changing the &ldquo;thought itself&rdquo;. Positive thinking is said to bring positive reality, and negative thinking brings negative reality. (From Wikipedia)</p>
</blockquote>
<p>No matter how hard your job is or how bad you may be, things can get better with positive thinking.
From today, I will try to overcome the rough waves of society with positive thinking.</p>
<br>
<p>But if you want to think positively, you want a <strong>friend</strong>, right?</p>
<p>Every time you do one positive thinking, you want someone who will be happy with you, right? **</p>
<br>
<p>I made.</p>
<br>
<h2 id="iot-device-that-makes-you-happy-when-you-make-a-positive-statement">IoT device that makes you happy when you make a positive statement</h2>
<p>When a positive phrase is received, the motor with a diaphragm rotates and quivers. Just as the word &ldquo;shake with joy&rdquo; means.</p>
<p>Just attach this to your favorite figures and stuffed animals to create an IoT device with a natural language processing function.</p>
<p>This time I&rsquo;m inputting a phrase as text, but I think that voice recognition will work if I do my best. I think that the final form is to react when talking to a stuffed animal.</p>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/5182ed5c-33cb-d5b4-6a4a-87303d69ae33.jpeg" width=600>
<h3 id="danboard">Danboard</h3>
<p>First I will try with this child.</p>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/98400c6e-eeca-12cb-8b11-204f2b5373d5.jpeg" width=600>
<p>I managed to stand, so I&rsquo;ll make a positive input.</p>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/f88afd3c-d374-653a-1c5c-b8ad9273764f.jpeg" width=600>
<blockquote>
<p>It&rsquo;s great today with good weather.</p>
</blockquote>
<br>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/578781b6-3683-9f52-5113-4324e319053e.gif" alt="hurueru1.gif"></p>
<br>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/a9721b81-765e-6c7f-5f61-626dcea5e150.gif" alt="hurueru2.gif"></p>
<p>**Success! You can see at a glance that you are trembling with joy! **</p>
<h3 id="plush-horse">Plush horse</h3>
<p>However, I felt that the motor was a little too big for Danbo, so I will try it with a cute stuffed horse.</p>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/82cfd797-688c-5eb6-50bd-47b130fc03b8.jpeg" width=600>
<p>It fits in your hand and is cute.</p>
<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/5ed679de-2e2e-fab6-80e7-39bbc87d6129.jpeg" width=600>
<blockquote>
<p>I&rsquo;m glad to have a job tomorrow on Monday.</p>
</blockquote>
<br>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/beb1c1d3-35b2-9d8e-07e1-21e4bccae53c.gif" alt="hurueru3.gif"></p>
<p>**I started running out of joy. **</p>
<h3 id="summary">Summary</h3>
<p>Even one person can make friends who are willing to be together ** just by making a positive statement. **</p>
<p>With this, both adults and children can naturally learn positive thinking.</p>
<p>However, when I showed this to a friend, I received feedback only as &ldquo;simple and scary&rdquo;, so development will be stopped once.</p>
<p>The circuits and programs are shown below for reference. <a href="https://api.ce-cotoha.com/">COTOHA&rsquo;s API</a> is RESTful, so it seems that it can be applied in various ways, not just to Raspberry Pi.</p>
<details><summary>Circuit or program</summary><div>
<p><strong>Used</strong></p>
<ul>
<li>RaspberryPi3</li>
<li>24V DC motor with diaphragm (details unknown for the one sold at Marutsu)</li>
<li>TB6643KQ motor driver</li>
<li>Other electronic components</li>
</ul>
<p><strong>Circuit configuration</strong></p>
<p>Since there was no TB6643KQ equivalent IC, I used a similar one in the sketch instead. Replace the battery with a 24V DC power supply.</p>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/181869/f93ce170-dc69-ecc2-8e83-d46b7c15087d.png" alt="kairo_hurueru.png"></p>
<p>Python3 program</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">import</span> wiringpi2 <span style="color:#75715e"># For Raspberry Pi pin operation</span>
<span style="color:#f92672">from</span> time <span style="color:#f92672">import</span> sleep
<span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> sys

MOTORPIN <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>

<span style="color:#75715e"># Motor operation class</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OperateMoter</span>:
    <span style="color:#66d9ef">def</span> __init__(self, motorpin):
        self<span style="color:#f92672">.</span>motorpin <span style="color:#f92672">=</span> motorpin
        wiringpi2<span style="color:#f92672">.</span>wiringPiSetupGpio()
        wiringpi2<span style="color:#f92672">.</span>pinMode(self<span style="color:#f92672">.</span>motorpin, <span style="color:#ae81ff">1</span>)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">operate_motor</span>(self, action):
        <span style="color:#66d9ef">if</span> action <span style="color:#f92672">==</span> True:
            wiringpi2<span style="color:#f92672">.</span>digitalWrite(self<span style="color:#f92672">.</span>motorpin, <span style="color:#ae81ff">1</span>)

        <span style="color:#66d9ef">elif</span> action <span style="color:#f92672">==</span> False:
            wiringpi2<span style="color:#f92672">.</span>digitalWrite(self<span style="color:#f92672">.</span>motorpin, <span style="color:#ae81ff">0</span>)

<span style="color:#75715e"># COTOHA API operation class</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CotohaApi</span>:
    <span style="color:#75715e"># Initialization</span>
    <span style="color:#66d9ef">def</span> __init__(self, client_id, client_secret, developer_api_base_url, access_token_publish_url):
        self<span style="color:#f92672">.</span>client_id <span style="color:#f92672">=</span> client_id
        self<span style="color:#f92672">.</span>client_secret <span style="color:#f92672">=</span> client_secret
        self<span style="color:#f92672">.</span>developer_api_base_url <span style="color:#f92672">=</span> developer_api_base_url
        self<span style="color:#f92672">.</span>access_token_publish_url <span style="color:#f92672">=</span> access_token_publish_url
        self<span style="color:#f92672">.</span>getAccessToken()

    <span style="color:#75715e"># Get access token</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getAccessToken</span>(self):
        <span style="color:#75715e"># Specify access token acquisition URL</span>
        url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>access_token_publish_url

        <span style="color:#75715e">#Header specification</span>
        headers<span style="color:#f92672">=</span>{
            <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/json&#34;</span>
        }

        <span style="color:#75715e"># Request body specification</span>
        data <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#34;grantType&#34;</span>: <span style="color:#e6db74">&#34;client_credentials&#34;</span>,
            <span style="color:#e6db74">&#34;clientId&#34;</span>: self<span style="color:#f92672">.</span>client_id,
            <span style="color:#e6db74">&#34;clientSecret&#34;</span>: self<span style="color:#f92672">.</span>client_secret
        }
        <span style="color:#75715e"># Encode request body specification in JSON</span>
        data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(data)

        <span style="color:#75715e">#Send request</span>
        result <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(url, data<span style="color:#f92672">=</span>data, headers<span style="color:#f92672">=</span>headers)

        <span style="color:#75715e"># Get access token from response body</span>
        self<span style="color:#f92672">.</span>access_token <span style="color:#f92672">=</span> result<span style="color:#f92672">.</span>json()[<span style="color:#e6db74">&#34;access_token&#34;</span>]


    <span style="color:#75715e"># Parsing API</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sentiment</span>(self, sentence):
        <span style="color:#75715e"># Specify parsing API URL</span>
        url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>developer_api_base_url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;nlp/v1/sentiment&#34;</span>
        <span style="color:#75715e">#Header specification</span>
        headers<span style="color:#f92672">=</span>{
            <span style="color:#e6db74">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;Bearer &#34;</span><span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>access_token,
            <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/json;charset=UTF-8&#34;</span>,
        }
        <span style="color:#75715e"># Request body specification</span>
        data <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#34;sentence&#34;</span>: sentence
        }

        <span style="color:#75715e"># Encode request body specification in JSON</span>
        data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(data)

        <span style="color:#75715e">#Send request</span>
        result <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(url, data<span style="color:#f92672">=</span>data, headers<span style="color:#f92672">=</span>headers)

        <span style="color:#75715e"># Get analysis result from response body</span>
        <span style="color:#66d9ef">return</span> result<span style="color:#f92672">.</span>json()

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;__main__&#39;</span>:
    operate_motor <span style="color:#f92672">=</span> OperateMoter(MOTORPIN)

    <span style="color:#75715e"># COTOHA API instance generation</span>
    cotoha_api <span style="color:#f92672">=</span> CotohaApi(CLIENT_ID, CLIENT_SECRET, DEVELOPER_API_BASE_URL, ACCESS_TOKEN_PUBLISH_URL)

    message <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>]
    result <span style="color:#f92672">=</span> cotoha_api<span style="color:#f92672">.</span>sentiment(message)
    <span style="color:#66d9ef">if</span> result[<span style="color:#e6db74">&#39;status&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;COTOHA API execution failed.&#34;</span>)
         exit()
     <span style="color:#66d9ef">print</span>(result)

     sentiment <span style="color:#f92672">=</span> result[<span style="color:#e6db74">&#39;result&#39;</span>][<span style="color:#e6db74">&#39;sentiment&#39;</span>]
     score <span style="color:#f92672">=</span> result[<span style="color:#e6db74">&#39;result&#39;</span>][<span style="color:#e6db74">&#39;score&#39;</span>]

     <span style="color:#66d9ef">if</span> sentiment <span style="color:#f92672">==</span><span style="color:#e6db74">&#39;Positive&#39;</span> <span style="color:#f92672">and</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">&lt;</span>score:
         <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;A positive statement is good!!&#34;</span>)
         operate_motor<span style="color:#f92672">.</span>operate_motor(True)
         sleep(<span style="color:#ae81ff">5</span>)
         operate_motor<span style="color:#f92672">.</span>operate_motor(False)

</code></pre></div></div></details>
<h2 id="sites-that-i-refer-to">Sites that I refer to</h2>
<p><a href="https://api.ce-cotoha.com/">COTOHA API Portal</a></p>
<p><a href="https://qiita.com/gossy5454/items/83072418fb0c5f3e269f">I tried using the COTOHA API rumored to be easy to handle natural language processing with Python</a></p>
<p><a href="https://en.wikipedia.org/wiki/%E7%A9%8D%E6%A5%B5%E6%80%9D%E8%80%83">Wikipedia: Positive thinking</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
