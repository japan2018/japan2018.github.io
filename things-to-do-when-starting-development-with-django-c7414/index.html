<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Things to do when starting development with Django | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Things to do when starting development with Django</h1>
<p>
  <small class="text-secondary">
  
  
  May 22, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/django">Django</a></code></small>

</p>
<pre><code>## Introduction
</code></pre>
<p>Things you should do when starting development with Django.
Although it is not always necessary, it may be difficult to change it later, but it is better to set it in the initial stage.
<strong>Create &ldquo;setting directory name that contains settings.py&rdquo;</strong> and <strong>extended user model</strong>.</p>
<p>There may be many other things, but as a memorandum at this stage.</p>
<h3 id="target-of-this-article">Target of this article</h3>
<ul>
<li>People who have just completed all the Django tutorial materials and are about to start application creation</li>
<li>People who want to organize basic knowledge about directory structure, projects, applications</li>
<li>People who want to customize the user model a little</li>
</ul>
<h2 id="1-change-the-name-of-the-setting-directory-when-creating-a-project">(1) Change the name of the setting directory when creating a project</h2>
<p>This is to make the project directory structure easier to understand.
If you normally start a project with <code>$ django-admin startproject myproject</code>, the base directory name and the setting directory name will be created with the same name (<code>myproject</code> here), so it will be difficult to distinguish between them. I will.</p>
<p>What this means is that when you start project creation with this command, you will have a directory structure like this.</p>
<pre><code>myproject &lt;- base directory
|-- manage.py
`-- myproject &lt;- configuration directory
    |-- __init__.py
    |-- settings.py
    |-- urls.py
    |-- manage.py
    `-- wsgi.py
</code></pre><p>There is a base directory with the same name as the project name (<code>myproject</code> here), and a configuration directory with the same name is created in it.
(By the way, [Django&rsquo;s textbook that can be used in the field &laquo;Basic&raquo;] used for learning](<a href="https://www.amazon.co.jp/%E7%8F%BE%E5%A0%B4%E3%81%A7%E4%BD%BF%E3%81%88%E3%82%8B-Django-%E3%81%AE%E6%95%99%E7%A7%91%E6%9B%B8%E3%80%8A%E5%9F%BA%E7%A4%8E%E7%B7%A8%E3%80%8B-%E6%A8%AA%E7%80%AC-%E6%98%8E%E4%25Inthebook(BB%81/dp/4802094744),">https://www.amazon.co.jp/%E7%8F%BE%E5%A0%B4%E3%81%A7%E4%BD%BF%E3%81%88%E3%82%8B-Django-%E3%81%AE%E6%95%99%E7%A7%91%E6%9B%B8%E3%80%8A%E5%9F%BA%E7%A4%8E%E7%B7%A8%E3%80%8B-%E6%A8%AA%E7%80%AC-%E6%98%8E%E4%Inthebook(BB%81/dp/4802094744),</a> it seems easy to distinguish.</p>
<ul>
<li>Base directory = project directory created by <code>django-admin startproject</code></li>
<li>Settings directory = directory containing <code>settings.py</code></li>
</ul>
<p>I will call it according to that name.)</p>
<br>
Then, there is a way to change the name of the configuration directory to make the structure easier to understand.
<p>When creating a project, create a base directory with an arbitrary name (project name), move it to the bottom of the base directory, and specify the configuration directory name (<code>config</code> here) as the first argument and <code>.</code> as the second argument And run <code>startproject</code>.</p>
<pre><code>$ mkdir myproject (put your project name here)
$ cd myproject/
$ django-admin startproject config.
</code></pre><p>By doing this, the directory structure will be</p>
<pre><code>myproject &lt;- base directory
|-- manage.py
`-- config &lt;- configuration directory * This name changes
    |-- __init__.py
    |-- settings.py
    |-- urls.py
    |-- manage.py
    `-- wsgi.py
</code></pre><p>It will be like this, and the structure will be easy to understand.</p>
<h2 id="2-expand-the-user-model">(2) Expand the user model</h2>
<p>The User model is provided by default in Django, so you can easily implement the login function and so on.
It&rsquo;s very convenient by itself, but to make the User model easier to use, it is [formally recommended] to make a customized user model (<a href="https://docs.djangoproject.com/en/2.0/topics/">https://docs.djangoproject.com/en/2.0/topics/</a> auth/customizing/#using-a-custom-user-model-when-starting-a-project).</p>
<p>There are three main ways to extend the User model,</p>
<ol>
<li>Inherit <code>AbstractBaseUser</code></li>
<li>Inherit <code>AbstractUser</code></li>
<li>Create another model and associate it with <code>OneToOneField</code></li>
</ol>
<p>Each method has advantages and disadvantages,
If development progresses and data already exists in the database, method 3 seems to be good.
1 or 2 is recommended at the first stage of starting application production, but 1 seems to be difficult for beginners to beginners, so at first it is safe to get used to the method of 2.</p>
<p>Method 2 allows you to add your own columns to your user model.</p>
<p>This is the only way to create a custom user model.</p>
<p>① Described in <code>app/models.py</code> (<code>app</code> is the application directory name)
② Set <code>AUTH_USER_MODEL</code> in <code>config/settings.py</code> (<code>config</code> is the name of the settings directory created when the project is created)
③ Migrate</p>
<h3 id="-describe-in-modelspy">① Describe in `models.py``</h3>
<p>Define your custom user model here. (Since the information that is the base of the user model is defined in the model called <code>AbstractUser</code>, it will be used by inheriting it.)</p>
<p>Here you can specify the table name and the columns you want to add.
For example, you can set a column called <code>Calendar</code> using a foreign key in a table called <code>custome_user</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3:app/models.py" data-lang="python3:app/models.py"><span style="color:#f92672">from</span> django.contrib.auth.models <span style="color:#f92672">import</span> AbstractUser
<span style="color:#f92672">from</span> django.db <span style="color:#f92672">import</span> models

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomUser</span>(AbstractUser):
    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Meta</span>(AbstractUser<span style="color:#f92672">.</span>Meta):
        db_table <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;custom_user&#39;</span>
        swappable <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;AUTH_USER_MODEL&#39;</span>

    calendar <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>ForeignKey(Calendar, verbose_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Active Calendar&#39;</span>, on_delete<span style="color:#f92672">=</span>models<span style="color:#f92672">.</span>PROTECT, blank<span style="color:#f92672">=</span>True, null<span style="color:#f92672">=</span>True)
</code></pre></div><p>Since this is an example of my actual code, I have a model called <code>Calendar</code> associated with the user model.For example, if you want the user model to have gender, age, email address, password etc., specify the column here. I think it would be good to give
The column will be added to the default User model, so the original column remains (see MEMO at the end of this article for the contents of the default User model).</p>
<h3 id="-set-auth_user_model-in-settingspy">② Set <code>AUTH_USER_MODEL</code> in <code>settings.py</code></h3>
<p>Define a custom user model to use here. Describe as &ldquo;App name.Model name&rdquo;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3:config/settings.py" data-lang="python3:config/settings.py">AUTH_USER_MODEL <span style="color:#f92672">=</span> app<span style="color:#f92672">.</span>CustomUser
</code></pre></div><h3 id="migrate">③Migrate</h3>
<p>Migrate the classic database after changing the model.</p>
<pre><code>$ Python manage.py makemigrations
$ Python manage.py migrate
</code></pre><h2 id="various-for-getting-started-with-django">Various for getting started with Django</h2>
<h3 id="about-version">About version</h3>
<p>As for which version to specify, it seems safe to adopt the version that corresponds to **LTS (Long-Term Support) ** (= version with long-term security support).</p>
<ul>
<li>2.2 =&gt; Support until April 2022</li>
<li>1.11 =&gt; support until April 2020</li>
</ul>
<p>By the way, Django 3 series is out in December 2019, but LTS 3.2 is scheduled to be released in April 2021.</p>
<p>If there is no particular reason, is it correct to start with the latest LTS at the moment? I have the impression.
(If the deployment destination is decided, it may be necessary to investigate whether or not the server supports it.)</p>
<h3 id="about-projects-and-applications">About projects and applications</h3>
<p>Django has the concepts of &ldquo;projects&rdquo; and &ldquo;applications&rdquo;, so let&rsquo;s sort them out a little.</p>
<p><strong>project</strong>
The whole WEB application that is produced.
<code>$ django-admin startproject myproject</code>
The one created with the command (<code>myproject</code> is the project name)
‥
‥
<strong>application</strong>
A group of small functions belonging to a project
<code>python3 manage.py startapp myapp</code>
The one created with the command (<code>myapp</code> is the application name)</p>
 <br>
The project is a big box, and the application is an image created by dividing the function into functions in the box.
<p>When creating one web service, create one project, and if it is a small service, create one application in it and implement it.
As a project grows in size, you can also create and operate multiple applications in a single project.</p>
<ul>
<li>Applications should be made as independent of other applications as possible</li>
<li>Basic style is to add functions to the project one after another</li>
</ul>
<p>When making multiple applications, it seems easy to maintain considering this way.</p>
<h2 id="in-conclusion">in conclusion</h2>
<p>After finishing the tutorial-like teaching material, I also introduced it halfway.</p>
<p>[On-site Django textbook &laquo;Basic&raquo;](<a href="https://www.amazon.co.jp/%E7%8F%BE%E5%A0%B4%E3%81%A7%E4%BD%BF%E3%81%88%E3%82%8B-Django-%E3%81%AE%E6%95%99%E7%A7%91%E6%9B%B8%E3%80%8A%E5%9F%BA(%E7%A4%8E%E7%B7%A8%E3%80%8B-%E6%A8%AA%E7%80%AC-%E6%98%8E%E4%BB%81/dp/4802094744)">https://www.amazon.co.jp/%E7%8F%BE%E5%A0%B4%E3%81%A7%E4%BD%BF%E3%81%88%E3%82%8B-Django-%E3%81%AE%E6%95%99%E7%A7%91%E6%9B%B8%E3%80%8A%E5%9F%BA(%E7%A4%8E%E7%B7%A8%E3%80%8B-%E6%A8%AA%E7%80%AC-%E6%98%8E%E4%BB%81/dp/4802094744)</a></p>
<p>This book is very easy to understand and makes your study easier!</p>
<p>It covers a wide range of basic things and is good for establishing knowledge and understanding. You can read it while eating the knobs.
Many of the best-practice methods summarized here are posted, which is very useful.</p>
<h2 id="memo-about-the-default-user-model">MEMO: About the default User model</h2>
<p>For reference, the fields of the User model confirmed in Django 2.1.7 are listed.
The default User model inherits the AbstractUser model, so the column names of the AbstractUser model will be inherited when you create a custom user model.```python3:lib/django/contrib/auth/models.py
class AbstractUser(AbstractBaseUser, PermissionsMixin):
&quot;&rdquo;&rdquo;
An abstract base class implementing a fully featured User model with
admin-compliant permissions.</p>
<pre><code>Username and password are required. Other fields are optional.
&quot;&quot;&quot;
username_validator = UnicodeUsernameValidator()

username = models.CharField(
    _('username'),
    max_length=150,
    unique=True,
    help_text=_('Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.'),
    validators=[username_validator],
    error_messages={
        'unique': _(&quot;A user with that username already exists.&quot;),
    },
)
first_name = models.CharField(_('first name'), max_length=30, blank=True)
last_name = models.CharField(_('last name'), max_length=150, blank=True)
email = models.EmailField(_('email address'), blank=True)
is_staff = models.BooleanField(
    _('staff status'),
    default=False,
    help_text=_('Designates whether the user can log into this admin site.'),
)
is_active = models.BooleanField(
    _('active'),
    default=True,
    help_text=_(
        'Designates whether this user should be treated as active. '
        'Unselect this instead of deleting accounts.'
    ),
)
date_joined = models.DateTimeField(_('date joined'), default=timezone.now)

objects = UserManager()

EMAIL_FIELD = 'email'
USERNAME_FIELD = 'username'
REQUIRED_FIELDS = ['email']

class Meta:
    verbose_name = _('user')
    verbose_name_plural = _('users')
    abstract = True

def clean(self):
    super().clean()
    self.email = self.__class__.objects.normalize_email(self.email)

def get_full_name(self):
    &quot;&quot;&quot;
    Return the first_name plus the last_name, with a space in between.
    &quot;&quot;&quot;
    full_name = '%s %s' % (self.first_name, self.last_name)
    return full_name.strip()

def get_short_name(self):
    &quot;&quot;&quot;Return the short name for the user.&quot;&quot;&quot;
    return self.first_name

def email_user(self, subject, message, from_email=None, **kwargs):
    &quot;&quot;&quot;Send an email to this user.&quot;&quot;&quot;
    send_mail(subject, message, from_email, [self.email], **kwargs)
</code></pre>
<p>class User(AbstractUser):
&quot;&rdquo;&rdquo;
Users within the Django authentication system are represented by this
model.</p>
<pre><code>Username and password are required. Other fields are optional.
&quot;&quot;&quot;
class Meta(AbstractUser.Meta):
    swappable = 'AUTH_USER_MODEL'
</code></pre>
<pre><code></code></pre>
    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
