<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Open Excel file in Python, and color map of Japan | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Open Excel file in Python, and color map of Japan</h1>
<p>
  <small class="text-secondary">
  
  
  Jan 7, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>

</p>
<pre><code>* Open Excel file in Python
</code></pre>
<ul>
<li>Paint a map of Japan with Python</li>
</ul>
<p>We will deal with these two here. It runs on Google Colaboratory.</p>
<h1 id="color-japan-map">Color Japan map</h1>
<h2 id="install-library-japanmap">Install library japanmap</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">!</span>pip install japanmap
</code></pre></div><h2 id="import-required-libraries">Import required libraries</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> japanmap <span style="color:#f92672">import</span> pref_names,pref_code,picture
</code></pre></div><h2 id="prefecture-name">Prefecture name</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(pref_names)
</code></pre></div><pre><code>['_','Hokkaido','Aomori prefecture','Iwate prefecture','Miyagi prefecture','Akita prefecture','Yamagata prefecture','Fukushima prefecture','Ibaraki prefecture','Tochigi prefecture',' 'Gunma prefecture','Saitama prefecture','Chiba prefecture','Tokyo','Kanagawa prefecture','Niigata prefecture','Toyama prefecture','Ishikawa prefecture','Fukui prefecture','Yamanashi prefecture',' 'Nagano prefecture','Gifu prefecture','Shizuoka prefecture','Aichi prefecture','Mie prefecture','Shiga prefecture','Kyoto prefecture','Osaka prefecture','Hyogo prefecture','Nara prefecture',' 'Wakayama prefecture','Tottori prefecture','Shimane prefecture','Okayama prefecture','Hiroshima prefecture','Yamaguchi prefecture','Tokushima prefecture','Kagawa prefecture','Ehime prefecture','Kochi prefecture',' &quot;Fukuoka Prefecture&quot;, &quot;Saga Prefecture&quot;, &quot;Nagasaki Prefecture&quot;, &quot;Kumamoto Prefecture&quot;, &quot;Oita Prefecture&quot;, &quot;Miyazaki Prefecture&quot;, &quot;Kagoshima Prefecture&quot;, &quot;Okinawa Prefecture&quot;]
</code></pre>
<h2 id="prefecture-code">Prefecture code</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pref_code (<span style="color:#e6db74">&#39;Tokyo&#39;</span>)
</code></pre></div><pre><code>13
</code></pre>
<h2 id="drawing-a-blank-map">Drawing a blank map</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> pylab <span style="color:#f92672">import</span> rcParams
 
rcParams[<span style="color:#e6db74">&#39;figure.figsize&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>
plt<span style="color:#f92672">.</span>imshow(picture())
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211162/209518df-a838-0011-db76-67dcf5810501.png" alt="output_4_1.png"></p>
<h2 id="coloring-of-specified-prefectures">Coloring of specified prefectures</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>imshow(picture({<span style="color:#e6db74">&#39;Tottori&#39;</span>:<span style="color:#e6db74">&#39;red&#39;</span>,<span style="color:#e6db74">&#39;Saga&#39;</span>:(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>)}))
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211162/ff382c97-f159-17d4-7689-34b2137e48f1.png" alt="output_5_1.png"></p>
<p>#Open Excel file</p>
<p>As the subject, we used an Excel file of statistical data by prefecture published on the website of Teikoku Shoin.</p>
<ul>
<li><a href="https://www.teikokushoin.co.jp/statistics/japan/">https://www.teikokushoin.co.jp/statistics/japan/</a></li>
</ul>
<h2 id="download">Download</h2>
<p>urllib is a download library, but if you use it on Google Colab, you will upload it on Google Colab. On Google Colab, the uploaded file will disappear after the session, so at that time, upload again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Download by urllib</span>
<span style="color:#f92672">import</span> urllib.request
url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;URL where the Excel file is located&#34;</span>
urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlretrieve(url,<span style="color:#e6db74">&#39;Teikoku-Shoin-Japan.xlsx&#39;</span>)
</code></pre></div><h2 id="open-excel">Open Excel</h2>
<p>As far as I know, there are two ways to open an Excel file in Python.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
excel <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;Teikoku-Shoin-Japan.xlsx&#39;</span>) <span style="color:#75715e"># This method may not work</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
excel <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>ExcelFile(<span style="color:#e6db74">&#39;Teikoku-Shoin-Japan.xlsx&#39;</span>) <span style="color:#75715e"># I think this works better</span>
</code></pre></div><p>Excel, unlike csv, is made up of multiple sheets.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> enumerate(excel<span style="color:#f92672">.</span>sheet_names):
    <span style="color:#66d9ef">print</span>(s) <span style="color:#75715e"># list sheet names and numbers</span>
</code></pre></div><pre><code>(0,'Area\u3000 (2017)')
(1,'Population\u3000 (2018)')
(2,'Population density\u3000 (2018)')
(3,'Population growth rate \u3000 [2010-2015]')
(4,'Aged (65 years old and over) population rate \u3000 (2018)')
(5,'Population ratio by industry (2015)')
(6,'Average life (female)\u3000 [2015]')
(7,'Average life (male)\u3000 (2015)')
(8,'Cultivated area (2017)')
(9,'Cultivated land rate\u3000 (2017)')
(10,'Forest rate and plantation rate (2017)')
(11,'Wheat production \u3000 (2018)')
(12,'Rice production\u3000 (2017)')
(13,'Production of sweet potatoes\u3000 [2017]')
(14,'Production of potatoes \u3000 [2017]')
(15,'Soybean production \u3000 (2017)')
(16,'Peanut production\u3000 (2017)')
(17,'Cabbage production\u3000 [2017]')
(18,'Cucumber production \u3000 [2017]')
(19,'Production of watermelon \u3000 (2017)')
(20,'Daikon production \u3000 [2017]')
(21,'Production of rapeseed (2017)')
(22,'Carrot production \u3000 [2017]')
(23,'Production of green onions\u3000 (2017)')
(24,'Hakusai production \u3000 [2017]')
(25,'Production of bell pepper\u3000 [2017]')
(26,'Spinach production \u3000 (2017)')
(27,'Production of tea (rough tea) \u3000 [2017]')
(28,'Strawberry production \u3000 (2017)')
(29,'Ume production \u3000 (2017)')
(30,'Melon production \u3000 (2017)')
(31,'Production of persimmon \u3000 (2017)')
(32,'Cherry production \u3000 (2017)')
(33,'Manufacture of tangerines\u3000 (2017)')
(34,'Momo production \u3000 (2017)')
(35,'Apple production\u3000 [2017]')
(36,'Chrysanthemum shipments [2017]')
(37,'Pansy shipments [2017]')
(38,'Shipping volume of Western orchids (cut flowers)\u3000 [2017]')
(39,'Number of broiler breeding \u3000 (2018)')
(40,'Number of pigs raised\u3000 (2018)')
(41,'Number of beef cattle raised\u3000 (2018)')
(42,'Number of dairy cattle raised\u3000 (2018)')
(43,'Mayu production (2017)')
(44,'Agricultural output \u3000 (2017)')
(45,'Rice output\u3000 (2017)')
(46,'Amount of wheat produced\u3000 (2017)')
(47,'Bean production \u3000 [2017]')
(48,'Potato production \u3000 [2017]')
(49,'Vegetable output \u3000 [2017]')
(50,'Fruit output\u3000 [2017]')
(51,'Flower output \u3000 [2017]')
(52,'Production amount of industrial crops\u3000 (2017)')
(53,'Livestock production \u3000 (2017)')
(54,'Fishery production (fishery/aquaculture) [2016]')
(55,'Squid catch \u3000 [2016]')
(56,'Catch of bonito \u3000 [2016]')
(57,'pacific saury catch \u3000 (2016)')
(58,'Maewage catch \u3000 [2016]')
(59,'Tuna catch \u3000 (2016)')
(60,'Oyster culture \u3000 [2016]')
(61,'Scallop farming \u3000 [2016]')
(62,'Wakame farming \u3000 [2016]')
(63,'Production of raw material (wood) \u3000 [2016]')
(64,'Industrial shipment value\u3000 (2016)')
(65,'Production of fruit wine (2016)')
(66,'Production of yakichu (2016)')
(67,'Production of sake (including muddy sake) \u3000 (2016)')
(68,'Beer production\u3000 [2016]')
(69,'Production of petroleum and coal products [2016]')
(70,'Semiconductor production \u3000 [2016]')
(71,'Industrial robot production\u3000 [2016]')
(72,'Production of automobiles (including motorcycles) \u3000 [2016]')
(73,'Production of textiles \u3000 (2016)')
(74,'Steel production\u3000 (2016)')
(75,'Integrated circuit production\u3000 [2016]')
(76,'Prefectural income per person \u3000 [2015]')
(77,'Urban park area per person \u3000 (as of the end of March 2017)')
(78,'Power demand per person \u3000 [2015]')
(79,'Garbage discharge per person per day \u3000 [2016]')
(80,'Sewer penetration rate\u3000 (2018)')
(81,'Number of passenger cars per household \u3000 (2018)')
(82,'Annual retail sales \u3000 2015')
(83,'Number of pollution complaints\u3000 (2017)')
</code></pre>
<p>I will select an appropriate sheet</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sheet_index <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
<span style="color:#66d9ef">print</span>(excel<span style="color:#f92672">.</span>sheet_names[sheet_index])
sheet <span style="color:#f92672">=</span> excel<span style="color:#f92672">.</span>parse(excel<span style="color:#f92672">.</span>sheet_names[sheet_index], header<span style="color:#f92672">=</span>None) <span style="color:#75715e"># Make the contents of the second sheet pandas format</span>
</code></pre></div><pre><code>Population density [2018]
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sheet<span style="color:#f92672">.</span>head() <span style="color:#75715e"># Check the shape of the data</span>
<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#f92672">&lt;</span>table border<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1&#34;</span> class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dataframe&#34;</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;</span>thead<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span>tr style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-align: right;&#34;</span><span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span>tr<span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;/</span>thead<span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;</span>tbody<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span>tr<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span> Source: Basic Resident Register Population<span style="color:#f92672">/</span>Household Numbers List, <span style="color:#ae81ff">2018</span>, Area Adjustment by Prefectures, Municipalities, Japan<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>NaN<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>NaN<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span>tr<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span>tr<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>Country code<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>prefecture name<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>(persons<span style="color:#f92672">/</span>km2)<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span>tr<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span>tr<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>Hokkaido<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">64</span><span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span>tr<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span>tr<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>Aomori<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">136</span><span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span>tr<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span>tr<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>th<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">4</span><span style="color:#f92672">&lt;/</span>th<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span><span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span>Iwate<span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span>td<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">83</span><span style="color:#f92672">&lt;/</span>td<span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span>tr<span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;/</span>tbody<span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;/</span>table<span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;/</span>div<span style="color:#f92672">&gt;</span>


<span style="color:#75715e">## Data processing</span>

<span style="color:#e6db74">``</span><span style="color:#960050;background-color:#1e0010">`</span>python
sheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">49</span>, [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>]] <span style="color:#75715e"># Extract necessary parts</span>
</code></pre></div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>64</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>136</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>83</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4</td>
      <td>317</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>46</th>
      <td>45</td>
      <td>144</td>
    </tr>
    <tr>
      <th>47</th>
      <td>46</td>
      <td>180</td>
    </tr>
    <tr>
      <th>48</th>
      <td>47</td>
      <td>645</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">49</span>, [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>]]<span style="color:#f92672">.</span>values <span style="color:#75715e"># Convert pandas format to numpy format</span>
</code></pre></div><pre><code>array([[1, 64],
       [2, 136],
       [3, 83],
       [4, 317],
       [5, 87],
       ...,
       [46, 180],
       [47, 645]], dtype=object)
</code></pre>
<h1 id="color-japan-map-with-excel-data">Color Japan map with Excel data</h1>
<h2 id="data-processing">Data processing</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">values <span style="color:#f92672">=</span> sheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">49</span>, [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>]]<span style="color:#f92672">.</span>values
</code></pre></div><h2 id="specify-how-to-paint-colors">Specify how to paint colors</h2>
<p>The code below</p>
<ul>
<li>Maximum is red</li>
<li>Half the maximum value is yellow</li>
<li>Zero is blue</li>
<li>White without data</li>
</ul>
<p>Outputs the color code of.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">color_scale</span>(value, max_value):
    <span style="color:#66d9ef">try</span>:
        v <span style="color:#f92672">=</span> value <span style="color:#f92672">/</span> max_value
        <span style="color:#66d9ef">if</span> v <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1.0</span>:
            <span style="color:#66d9ef">return</span> (<span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">elif</span> v <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>:
            <span style="color:#66d9ef">return</span> (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>)
        <span style="color:#66d9ef">elif</span> v<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.5</span>:
            red <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
            green <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">255</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">2</span><span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> v))
            blue <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">return</span> (red, green, blue)
        <span style="color:#66d9ef">else</span>:
            red <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">255</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> v)
            green <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">255</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> v)
            blue <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">255</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> v))
            <span style="color:#66d9ef">return</span> (red, green, blue)
    <span style="color:#66d9ef">except</span>:
        <span style="color:#66d9ef">return</span> (<span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">255</span>)
</code></pre></div><p>The usage example is like this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> [<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">0.7</span>, <span style="color:#ae81ff">1.0</span>, <span style="color:#e6db74">&#34;string&#34;</span>]:
    <span style="color:#66d9ef">print</span>(v, color_scale(v, <span style="color:#ae81ff">1</span>))
</code></pre></div><pre><code>0.0 (0, 0, 255)
0.2 (102, 102, 153)
0.5 (255, 255, 0)
0.7 (1, 153, 0)
1.0 (255, 0, 0)
string (255, 255, 255)
</code></pre>
<p>Find the maximum value</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">max_value <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>max([a <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> values[:, <span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(a, str)])
</code></pre></div><p>Choose a color for each prefecture</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span>{}
<span style="color:#66d9ef">for</span> code, value <span style="color:#f92672">in</span> zip(values[:, <span style="color:#ae81ff">0</span>], values[:, <span style="color:#ae81ff">1</span>]):
    data[code] <span style="color:#f92672">=</span> color_scale(value, max_value)
</code></pre></div><p>Color Japan map</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> pylab <span style="color:#f92672">import</span> rcParams
 
<span style="color:#66d9ef">print</span>(excel<span style="color:#f92672">.</span>sheet_names[sheet_index])
plt<span style="color:#f92672">.</span>imshow(picture(data))
</code></pre></div><pre><code>Population density [2018]
</code></pre>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211162/369e34a7-ac1c-5bd5-a8e3-9fc647db2f9e.png" alt="output_21_2.png"></p>
<h2 id="summary">Summary</h2>
<p>It looks like this when painted with different data. The place without data is solidly white.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sheet_index <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>
<span style="color:#66d9ef">print</span>(excel<span style="color:#f92672">.</span>sheet_names[sheet_index])
sheet <span style="color:#f92672">=</span> excel<span style="color:#f92672">.</span>parse(excel<span style="color:#f92672">.</span>sheet_names[sheet_index], header<span style="color:#f92672">=</span>None)
values <span style="color:#f92672">=</span> sheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">49</span>, [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>]]<span style="color:#f92672">.</span>values
max_value <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>max([a <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> values[:, <span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(a, str)])

data <span style="color:#f92672">=</span>{}
<span style="color:#66d9ef">for</span> code, value <span style="color:#f92672">in</span> zip(values[:, <span style="color:#ae81ff">0</span>], values[:, <span style="color:#ae81ff">1</span>]):
    data[code] <span style="color:#f92672">=</span> color_scale(value, max_value)

plt<span style="color:#f92672">.</span>imshow(picture(data))
</code></pre></div><pre><code>Oyster culture [2016]
</code></pre>
<p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/211162/2a3369d8-f3cf-8490-5a34-39996680da26.png" alt="output_22_2.png"></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
