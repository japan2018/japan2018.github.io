<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] General Relativity in Python: Introduction | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] General Relativity in Python: Introduction</h1>
<p>
  <small class="text-secondary">
  
  
  Nov 26, 2019
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/einstein"> Einstein</a></code></small>


<small><code><a href="https://memotut.com/tags/relativity"> relativity</a></code></small>


<small><code><a href="https://memotut.com/tags/general-relativity"> general relativity</a></code></small>


<small><code><a href="https://memotut.com/tags/general-relativity"> general relativity</a></code></small>

</p>
<pre><code>In this article, using Python, is required in general relativity
</code></pre>
<p>ãƒ» **Calculation of various tensors including metric $g_{\mu \nu}$**</p>
<ul>
<li><strong>Simple calculation of Einstein equation</strong>
Introduce how to do.</li>
</ul>
<p><strong>[Reference]</strong>
For computing about tensor analysis and algebraic calculation in general relativity,
<a href="https://arxiv.org/pdf/gr-qc/0105094.pdf">Heinicke, C., <em>et.al.</em>- <strong>Computer Algebra in Gravity</strong></a>
<a href="https://arxiv.org/pdf/1402.6635.pdf">Korolkova, A., <em>et.al.</em>- <strong>Tensor computations in computer algebra systems</strong></a>
There are also handy Review papers, so please refer to them as appropriate.
Also, in a similar study using SageMath,
<a href="https://arxiv.org/abs/1804.07346">Gourgoulhon, E., <em>et.al.</em>-<strong>Symbolic tensor calculus on manifolds</strong></a>
Is known.</p>
<p>Introducing the #GraviPy module
GraviPy is a tensor calculation module that runs on Python3.</p>
<p>By working with SymPy, which specializes in symbolic processing of algebraic calculations, it enables a stress-free environment for tensor calculations on Python.</p>
<p>Download GraviPy module including SymPy according to the following
<a href="https://pypi.python.org/pypi/GraviPy.">GraviPy, Tensor Calculus Package for General Relativity (Version 0.1.0) (2014)</a>
(Access date: November 26, 2019)</p>
<p>You can actually use pip,</p>
<pre><code class="language-terminal:" data-lang="terminal:">$ pip install GraviPy
</code></pre><p>If everything works fine, it will be installed. SymPy should be installed at the same time if the Python environment is ver. 3.7 or higher.</p>
<h2 id="i-tried-to-calculate-the-schwarzschild-metric">I tried to calculate the Schwarzschild metric</h2>
<p>Derive a Schwarzschild solution from a Schwarzschild metric using GraviPy.</p>
<h3 id="introduction-of-schwarzschild-weighing">Introduction of Schwarzschild weighing</h3>
<p>The sign of the metric is set to $(+,-,-,-)$ according to MTW, and the line element is determined as follows.
$$ds^2=g_{\mu\nu}dx^\mu dx^\nu .$$
If we take $G=c=1$ for the gravitational constant and the speed of light, the Schwarzschild metric is written as</p>
<pre><code class="language-math" data-lang="math">g_{\mu\nu}=\left[\begin{array}{cccc}
\Big( 1- \frac{2M}{r} \Big) &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -\Big( 1- \frac{2M}{r} \Big)^{-1} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; -r^2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; -r^2sin^2\theta
\end{array}\right].
</code></pre><p>Here, the four-dimensional coordinate $(t, r,\theta,\phi)$ is taken as the coordinate system, and $M$ is the black hole mass. The Schwarzschild metric shows a singular point at $r=2M$ in the radial direction, which is known as the so-called &ldquo;event horizon&rdquo;.</p>
<h3 id="derivation-method-using-gravipy">Derivation method using GraviPy</h3>
<p>Let&rsquo;s derive the Schwarzschild solution from the above $g_{\mu\nu}$.
GraviPy can be used to calculate according to the following process.</p>
<ol>
<li>Definition of space-time (metric determination): $g_{\mu\nu}$</li>
<li>Christoffel symbol calculation: $\Gamma {}^\mu{}_{\nu\rho}$</li>
<li>Rich tensor calculation: $R_{\mu\nu}$</li>
<li>Einstein tensor calculation: $G_{\mu\nu}$</li>
</ol>
<h3 id="definition-of-space-time">Definition of space-time</h3>
<p>First, let&rsquo;s define space-time. As four-dimensional space-time coordinates, take $$x=x^\mu=(t,r,\theta,\phi)$$. GraviPy defines as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:GR.py" data-lang="python:GR.py"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#f92672">from</span> gravipy <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> gravipy <span style="color:#f92672">import</span> tensorial <span style="color:#66d9ef">as</span> ten
<span style="color:#f92672">from</span> sympy <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> inspect

<span style="color:#75715e"># Coordinates (\ chi is the four-vector of coordinates)</span>
t, r, theta, phi, M <span style="color:#f92672">=</span> symbols(<span style="color:#e6db74">&#39;t ,r ,theta ,phi ,M&#39;</span>)
x <span style="color:#f92672">=</span> ten<span style="color:#f92672">.</span>Coordinates(<span style="color:#e6db74">&#39;\chi&#39;</span>,[t, r, theta, phi])
</code></pre></div><p>Here, the first argument <code>'\chi'</code> of <code>ten.Coordinates()</code> specifies that the second argument is a quaternion vector. Also, I chose <code>ten.~</code> because it doesn&rsquo;t work unless this <code>Coordinates()</code> explicitly refers to <code>tensorial</code>.</p>
<p>After that, the tensors that appear will be referred to as &ldquo;ten.~&rdquo; across the board.</p>
<h3 id="definition-of-schwarzschild-weighing">Definition of Schwarzschild weighing</h3>
<p>Now let&rsquo;s define the metric $g_{\mu \nu}$. The Schwarzschild metric described above may be described as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:GR.py" data-lang="python:GR.py"><span style="color:#75715e"># Continued</span>
<span style="color:#75715e"># Metric tensor</span>
Metric <span style="color:#f92672">=</span> diag((<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span> M <span style="color:#f92672">/</span> r ), <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span> M <span style="color:#f92672">/</span> r ), <span style="color:#f92672">-</span>r <span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> ,<span style="color:#f92672">-</span>r <span style="color:#f92672">**</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span> sin( theta) <span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
g <span style="color:#f92672">=</span> ten<span style="color:#f92672">.</span>MetricTensor(<span style="color:#e6db74">&#39;g&#39;</span>, x ,Metric)
</code></pre></div><p>Here, the output result of <code>g = ten.MetricTensor('g',x,Metric)</code> is</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Metric
<span style="color:#75715e"># Or</span>
g(ten<span style="color:#f92672">.</span>All,ten<span style="color:#f92672">.</span>All)
</code></pre></div><p>It can be displayed with and looks like this:</p>
<pre><code class="language-math" data-lang="math">g_{\mu\nu}=
\displaystyle \left[\begin{matrix}- 2M/r + 1 &amp; 0 &amp; 0 &amp; 0\\0 &amp; \displaystyle- \frac{1}{- 2M/r + 1} &amp; 0 &amp; 0\\0 &amp; 0 &amp;-r^{2} &amp; 0\\0 &amp; 0 &amp; 0 &amp;-r^{2} \sin^{2}{\left(\theta \right)}\end{matrix}\right]
</code></pre><p>Although there are some differences in the expressions, the above definitions are accurately reflected.
For example, to refer to the radial component $g_{rr}=g_{11}$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">g(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>)
</code></pre></div><p>And can be obtained element by element as follows.</p>
<pre><code class="language-math" data-lang="math">g_{11}=- \frac{1}{\displaystyle- \frac{2M}{r} + 1}
</code></pre><h3 id="christoffels-calculation">Christoffel&rsquo;s calculation</h3>
<p>Next, let&rsquo;s calculate the Christoffel symbol $\Gamma^\mu{}<em>{\nu\rho}$ based on $g</em>{\mu \nu}$.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:GR.py" data-lang="python:GR.py"><span style="color:#75715e"># Continued</span>
<span style="color:#75715e"># Christoffel symbol</span>
Ga <span style="color:#f92672">=</span> ten<span style="color:#f92672">.</span>Christoffel(<span style="color:#e6db74">&#39;Ga&#39;</span>, g)
</code></pre></div><p><code>Ga</code> is a Christoffel symbol for $g_{\mu\nu}$. Christoffel is a third-order tensor, so if we limit it to $\mu=0$, we get a second-order tensor as follows.</p>
<pre><code class="language-math" data-lang="math">\Gamma^{ 0}{}_{\nu\rho}=
\left[
\begin{matrix}
0 &amp; \frac{M}{r^{2}} &amp; 0 &amp; 0 \\
\frac{M}{r^{2}} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0
\end{matrix}\right]
</code></pre><p>To get all ingredients</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Ga(ten<span style="color:#f92672">.</span>All,ten<span style="color:#f92672">.</span>All,ten<span style="color:#f92672">.</span>All)
</code></pre></div><p>You can do it as</p>
<pre><code class="language-math" data-lang="math">\displaystyle
\Gamma^\mu{}_{\nu\rho}=
 \left[\begin{matrix}\left[\begin{matrix}0 &amp; \frac{M}{r^{2}} &amp; 0 &amp; 0\\\frac{M}{r^{2}} &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 \end{matrix}\right] &amp; \left[\begin{matrix}- \frac{M}{r^{2 }} &amp; 0 &amp; 0 &amp; 0\\0 &amp; \frac{M}{\left(2 M-r\right)^{2}} &amp; 0 &amp; 0\\0 &amp; 0 &amp; r &amp; 0\\0 &amp; 0 &amp; 0 &amp; r \sin^{2}{\left(\theta \right)}\end{matrix}\right] &amp; \left[\begin{matrix}0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp;-r &amp; 0\\0 &amp;-r &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; \frac{r^{2} \sin{\left(2 \theta \right)}}{2}\end {matrix}\right] &amp; \left[\begin{matrix}0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp;-r \sin^{2}{\left(\theta \right)}\\ 0 &amp; 0 &amp; 0 &amp;-\frac{r^{2} \sin{\left(2 \theta \right)}}{2}\\0 &amp;-r \sin^{2}{\left(\theta \right)} &amp;-\frac{r^{2} \sin{\left(2 \theta \right)}}{2} &amp; 0\end{matrix}\right]\end{matrix}\right]
</code></pre><p>Becomes Since it is a third-order tensor, it can be obtained as a &ldquo;one-dimensional array of a two-dimensional array&rdquo; (= one-dimensional array whose elements are a two-dimensional array).</p>
<h3 id="rich-tensor-calculation">Rich tensor calculation</h3>
<p>Next, the rich tensor is calculated. (The name comes from the mathematician Ricci.)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Ricci tensor</span>
Ri <span style="color:#f92672">=</span> ten<span style="color:#f92672">.</span>Ricci (<span style="color:#e6db74">&#39;Ri&#39;</span>, g)
<span style="color:#75715e"># Display all compon</span>
Ri(ten<span style="color:#f92672">.</span>All,ten<span style="color:#f92672">.</span>All)
</code></pre></div><p>The Ricci tensor in the Schwarzschild metric drops all components to zero.</p>
<pre><code class="language-math" data-lang="math">R_{\mu\nu}=
\displaystyle \left[\begin{matrix}0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0\end{matrix}\ right]
</code></pre><p>Of course, this is a special thing, and in the Schwarzschild weighing formula
$$r \longrightarrow r^{3.5}$$
If you try to calculate the rich tensor by substituting for etc., the values will be completely different, so you can experiment.</p>
<h3 id="einstein-tensor-calculation">Einstein tensor calculation</h3>
<p>Finally, let&rsquo;s output the Einstein tensor using the Rich tensor.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Einstein tensor</span>
G <span style="color:#f92672">=</span> ten<span style="color:#f92672">.</span>Einstein (<span style="color:#e6db74">&#39;G&#39;</span>, Ri)
G(ten<span style="color:#f92672">.</span>All,ten<span style="color:#f92672">.</span>All)
</code></pre></div><p>Result is,</p>
<pre><code class="language-mathG_{\mu\nu}=" data-lang="mathG_{\mu\nu}=">\displaystyle \left[\begin{matrix}0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0\end{matrix}\ right]
</code></pre><p>Has become. This result is the assumption of Schwarzschild solution, <strong>vacuum condition</strong>
$$T_{\mu\nu}=0$$
Which also fits the Einstein equation
$$G_{\mu\nu}=8\pi T_{\mu\nu}$$
Meets</p>
<h1 id="references">References</h1>
<p>The GraviPy tutorial has been released, and I referred to the following.</p>
<p><a href="https://github.com/wojciechczaja/GraviPy">Https://github.com/wojciechczaja/GraviPy</a></p>
<p>The SymPy support page is below.</p>
<p>[Https://docs.sympy.org/dev/index.html]
(<a href="https://docs.sympy.org/dev/index.html">https://docs.sympy.org/dev/index.html</a>)</p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
