<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Django 1.11 LTS Summary of major changes | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Django 1.11 LTS Summary of major changes</h1>
<p>
  <small class="text-secondary">
  
  
  Apr 11, 2017
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/django">Django</a></code></small>

</p>
<pre><code>Django 1.11 LTS has been released on April 4, 2017!
</code></pre>
<p>Since this version is LTS (Long Term Support), the support period is longer than the non-LTS version. For details on the support period, please check the following URL &ldquo;Supported Versions&rdquo;.
<a href="https://www.djangoproject.com/download/">https://www.djangoproject.com/download/</a></p>
<p>Then, I will explain the major changes in <a href="https://docs.djangoproject.com/en/1.11/releases/1.11/">release notes</a>.</p>
<h2 id="python2-support-lasted-111">Python2 support lasted 1.11</h2>
<p><a href="https://docs.djangoproject.com/en/1.11/releases/1.11/#python-compatibility">1.11 is the last version that supports Python2</a>. From 2.0 below, only Python3 will be supported.
The support deadline for 1.11 is until April 2020**, so you need to finish the transition to Python 3 by that time. <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<h2 id="deprecating-warnings-disabled-by-default">Deprecating warnings disabled by default</h2>
<p><a href="https://docs.djangoproject.com/en/1.11/releases/1.11/#deprecating-warnings-are-no-longer-loud-by-default">Deprecating warnings are disabled by default</a>. According to the default behavior of Python itself.
This eliminates the need to write code to avoid warning messages when developing third party applications that support both 1.11 and 1.8.
If you want to include the upcoming 2.0 release in support of third-party applications we&rsquo;re publishing, here are the recommended migration steps for Django.</p>
<ol>
<li>Remove support for versions prior to version 1.11.</li>
<li>Run the test with <code>python -Wd</code> to get the Deprecating warnings.</li>
<li>If Deprecating warnings appear, fix them so that they do not appear.</li>
</ol>
<h2 id="major-new-features">Major new features</h2>
<p><a href="https://docs.djangoproject.com/en/1.11/releases/1.11/#what-s-new-in-django-1-11">What&rsquo;s new in Django 1.11</a>first3features+otherindividualsIwillexplainthefeaturesthatyouareinterestedin.(Otherdetailsareomittedbecausetheyarenumerous.)</p>
<h3 id="class-based-model-indexeshttpsdocsdjangoprojectcomen111releases111class-based-model-indexes"><a href="https://docs.djangoproject.com/en/1.11/releases/1.11/#class-based-model-indexes">Class-based model indexes</a></h3>
<p>Until now, the model index specification has been <a href="https://docs.djangoproject.com/en/1.11/ref/models/fields/#django.db.models.Field.db_index">Field.db_index</a>,or<a href="https://docs.djangoproject.com/en/1.11/ref/models/options/#django.db.models.Options.index_together">Meta.index_together</a>wasused,butfrom1.11.[Meta.indexes](httpsYoucannowspecifytheclassthatrepresentstheindexat(://docs.djangoproject.com/en/1.11/ref/models/options/#django.db.models.Options.indexes).
The following is a usage example.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-django:models.py" data-lang="django:models.py"><span style="color:#f92672">from</span> django.db <span style="color:#f92672">import</span> models


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Book</span>(models<span style="color:#f92672">.</span>Model):
    title <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
    author <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
    price <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>IntegerField()

    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Meta</span>:
        indexes <span style="color:#f92672">=</span> [
            models<span style="color:#f92672">.</span>Index(fields<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;title&#39;</span>,<span style="color:#e6db74">&#39;author&#39;</span>]),
            models<span style="color:#f92672">.</span>Index(fields<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;price&#39;</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;price_idx&#39;</span>), <span style="color:#75715e"># Index can be named</span>
        ]
</code></pre></div><p>This allows you to specify an index other than B-tree. For example, by using the <a href="https://docs.djangoproject.com/en/1.11/ref/contrib/postgres/indexes/#django.contrib.postgres.indexes.GinIndex">GinIndex</a> class, PostgreSQL
You can specify <a href="https://www.postgresql.org/docs/current/static/gin.html">Gin index</a> which is a unique function of.</p>
<h3 id="template-based-widget-renderinghttpsdocsdjangoprojectcomen111releases111template-based-widget-rendering"><a href="https://docs.djangoproject.com/en/1.11/releases/1.11/#template-based-widget-rendering">Template-based widget rendering</a></h3>
<p>When creating the original Widget class, you can now separate the HTML part into a template.
To see how useful it is, let&rsquo;s see how the 1.8 Widget class was written.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-django:widgets_1_8.py" data-lang="django:widgets_1_8.py"><span style="color:#f92672">from</span> django <span style="color:#f92672">import</span> forms
<span style="color:#f92672">from</span> django.forms.utils <span style="color:#f92672">import</span> flatatt
<span style="color:#f92672">from</span> django.utils.encoding <span style="color:#f92672">import</span> force_text
<span style="color:#f92672">from</span> django.utils.html <span style="color:#f92672">import</span> format_html


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RangeWidget</span>(forms<span style="color:#f92672">.</span>Widget):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">render</span>(self, name, value, attrs<span style="color:#f92672">=</span>None):
        final_attrs <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>build_attrs(attrs, name<span style="color:#f92672">=</span>name)
        <span style="color:#66d9ef">if</span> value <span style="color:#f92672">is</span> None:
            value <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
        <span style="color:#66d9ef">if</span> value <span style="color:#f92672">!=</span> <span style="color:#e6db74">``</span>:
            final_attrs[<span style="color:#e6db74">&#39;value&#39;</span>] <span style="color:#f92672">=</span> force_text(value)
        <span style="color:#66d9ef">return</span> format_html(<span style="color:#e6db74">&#39;&lt;input type=&#34;range&#34;{}&gt;&#39;</span>,
                           flatatt(final_attrs))
</code></pre></div><p>Until now, the HTML part also had to be written in the <code>render</code> method, which is a little difficult to read. It may become spaghetti code if the specification becomes more complicated.
Next, let&rsquo;s see how to write in 1.11.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-django:widgets.py" data-lang="django:widgets.py"><span style="color:#f92672">from</span> django <span style="color:#f92672">import</span> forms


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RangeWidget</span>(forms<span style="color:#f92672">.</span>Widget):
    template_name <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;forms/widgets/range.html&#39;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jinja:range.html" data-lang="jinja:range.html">&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;range&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ widget.name }}&#34;</span><span style="color:#960050;background-color:#1e0010">{%</span> <span style="color:#a6e22e">include</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">django</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">forms</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">widgets</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">attrs</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">html</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">%}{%</span> <span style="color:#a6e22e">if</span> <span style="color:#a6e22e">widget</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">value</span> <span style="color:#960050;background-color:#1e0010">%}</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ widget.value }}&#34;</span><span style="color:#960050;background-color:#1e0010">{%</span> <span style="color:#a6e22e">endif</span> <span style="color:#960050;background-color:#1e0010">%}</span>&gt;
</code></pre></div><p>The HTML part has been separated into a separate file, so the visibility of the code has improved considerably. You can refer to the html file under <code>forms/templates/django/forms/widgets/</code> in the Django source code for information on how to write templates.</p>
<h3 id="subquery-expressionshttpsdocsdjangoprojectcomen111releases111subquery-expressions"><a href="https://docs.djangoproject.com/en/1.11/releases/1.11/#subquery-expressions">Subquery expressions</a></h3>
<p>You can now use subqueries when working with models.
Searching with &ldquo;<a href="http://stackoverflow.com/search?q=django+subquery">django subquery</a>&rdquo; on stackoverflow seems to be a feature that has been in demand for quite some time, but it was finally implemented.
In order to verify what the Python code is and what the query is, I created the same model as the sample document and made the following diagram.
For verification, use <a href="https://django-debug-toolbar.readthedocs.io/en/stable/index.html">djsql-debug-toolbar</a><a href="https://django-debug-toolbar.readthedocs.io/en/stable/commands.html#debugsqlshell">debugsqlshell</a> command. The database uses SQLite, unlike the official documentation, but the queries thrown are roughly the same.</p>
<h4 id="subquery-usage-example">Subquery usage example</h4>
<p>Official documentation: <a href="https://docs.djangoproject.com/en/1.11/ref/models/expressions/#subquery-expressions">https://docs.djangoproject.com/en/1.11/ref/models/expressions/#subquery-expressions</a>
Python code:
<img width="1377" alt="Subquery-python.jpg" src="https://qiita-image-store.s3.amazonaws.com/0/7809/b5aeeb5f-d61e-b500-3193-43b158443ec6.jpeg">
Query:
<img width="821" alt="Subquery-sql.jpg" src="https://qiita-image-store.s3.amazonaws.com/0/7809/e5857e06-ee90-d7e9-97e4-44599e4418e1.jpeg"></p>
<h4 id="exists-usage-example">Exists usage example</h4>
<p>Official documentation: <a href="https://docs.djangoproject.com/en/1.11/ref/models/expressions/#exists-subqueries">https://docs.djangoproject.com/en/1.11/ref/models/expressions/#exists-subqueries</a>
Python code:<img width="1099" alt="Exists-python.jpg" src="https://qiita-image-store.s3.amazonaws.com/0/7809/326e8ec5-4d40-1581-2bff-2edce9e5f88b.jpeg">
Query:
<img width="1362" alt="Exists-sql.jpg" src="https://qiita-image-store.s3.amazonaws.com/0/7809/98e17b0f-c8a6-2bd6-ee8f-02f4c8b24357.jpeg"></p>
<h2 id="other">Other</h2>
<h3 id="personal-new-features">Personal new features</h3>
<p>&ldquo;<a href="https://docs.djangoproject.com/en/1.11/releases/1.11/#templates">The Jinja2 template backend now supports context processors by setting the&rsquo;context_processors&rsquo; option in OPTIONS.</a>&quot;(ThetemplatebackendisJinja2ButI&rsquo;minterestedincontext_processors).Previously,Icouldnotuseitfor<a href="http://qiita.com/ryu22e/items/e50f8a3fbd6fe836c1b4">whenverifiedwith1.8</a>, but it seems that Jinja2 can be easily adopted with this.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>However, since Python 2.7 will be supported until 2020, it is time to consider migrating to Python 3 regardless of Django support. <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
