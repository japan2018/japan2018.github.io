<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>Upload videos using YouTube API | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>Upload videos using YouTube API</h1>
<p>
  <small class="text-secondary">
  
  
  Jan 22, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/youtube">YouTube</a></code></small>


<small><code><a href="https://memotut.com/tags/youtubeapi">YouTubeAPI</a></code></small>

</p>
<pre><code>## Overview
</code></pre>
<p>This is an article that uploads videos using the youtube API. The language is Python3.
You should proceed according to the following official document, but I have added some addictive points.</p>
<p><a href="https://developers.google.com/youtube/v3/guides/uploading_a_video?hl=ja">YouTube API-Upload Video</a></p>
<h2 id="environment">Environment</h2>
<ul>
<li>MacOS</li>
<li>Python3.8</li>
<li>Pycharm</li>
</ul>
<p>As a premise, it is assumed that the project has been created with GCP.</p>
<h2 id="advance-preparation">Advance preparation</h2>
<h3 id="install-google-api-python-client">Install google-api-python-client</h3>
<p>Install the library to use google&rsquo;s API.</p>
<pre><code class="language-bash:" data-lang="bash:">$ pip install google-api-python-client
</code></pre><h3 id="gcp-application-registration">GCP application registration</h3>
<h4 id="1-create-approval-information">1. Create approval information</h4>
<p>Open the link below and create credentials from the GCP console. This time we will use OAuth 2.0.
<a href="https://console.developers.google.com/apis/credentials?hl=ja">GCP Console-Credentials</a></p>
<p>(1) Create credentials&gt; OAuth Client ID (select the project in the upper left)
<img width="765" alt="Screenshot 2020-01-21 23.30.36.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/2431fdc6-b76a-7d1c-fac1-a61e8e7def13.png"></p>
<p>(2) Select &ldquo;Other&rdquo;. Create a name by entering any value
<img width="642" alt="Screenshot 2020-01-21 23.31.32.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/dc4dd104-b943-4796-9e32-a793665005e9.png"></p>
<p>(3) Client ID and client secret can be obtained
<img width="739" alt="Screenshot 2020-01-21 23.32.38.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/bb2de800-1b86-4ccd-c8cb-832a1f64e8ad.png"></p>
<p>If the OAuth consent screen has not been created, create it.
<img width="813" alt="Screenshot 2020-01-22 0.13.48.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/866fe916-c117-0f35-4339-48a6504e9775.png"></p>
<p>Fill in the application name and support email fields and press the create button at the bottom of the screen.
<img width="837" alt="Screenshot 2020-01-22 0.14.13.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/614354cc-b3ce-e647-0f83-374a3d0fd16d.png"></p>
<h4 id="2-enable-youtube-api">2. Enable YouTube API</h4>
<p>Open the link below and search for YouTube Data API from the GCP console.
As of 2020.1, it is &ldquo;YouTube Data API v3&rdquo;. When it opens, there is an activation button, so activate it.
<a href="https://console.developers.google.com/apis/library?hl=ja">GCP Console-API Library</a></p>
<img width="885" alt="Screenshot 2020-01-21 23.43.01.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/e9c9852e-aeb5-bd39-55af-27a53c3c1467.png">
<h2 id="creating-upload-source">Creating upload source</h2>
<h3 id="folder-structure">Folder structure</h3>
<pre><code class="language-bash:" data-lang="bash:">$ tree
.
├── movies
│  └── sample001.MP4 # Video to be uploaded
├── client_secrets.json
└── upload_video.py

</code></pre><h3 id="source">Source</h3>
<p>The source prepares JSON and Python for authentication information.</p>
<h4 id="authentication-information">Authentication information</h4>
<p>Create client_secrets.json. For the <code>client_id</code> and <code>client_secret</code>, set the values of the client ID and client secret created in &ldquo;1. Creating authorization information&rdquo;.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json:client_secrets.json" data-lang="json:client_secrets.json">{
  <span style="color:#f92672">&#34;web&#34;</span>: {
    <span style="color:#f92672">&#34;client_id&#34;</span>: <span style="color:#e6db74">&#34;[[INSERT CLIENT ID HERE]]&#34;</span>,
    <span style="color:#f92672">&#34;client_secret&#34;</span>: <span style="color:#e6db74">&#34;[[INSERT CLIENT SECRET HERE]]&#34;</span>,
    <span style="color:#f92672">&#34;redirect_uris&#34;</span>: [],
    <span style="color:#f92672">&#34;auth_uri&#34;</span>: <span style="color:#e6db74">&#34;https://accounts.google.com/o/oauth2/auth&#34;</span>,
    <span style="color:#f92672">&#34;token_uri&#34;</span>: <span style="color:#e6db74">&#34;https://accounts.google.com/o/oauth2/token&#34;</span>
  }
}
</code></pre></div><h4 id="python">Python</h4>
<p>Basically, the source of <a href="https://developers.google.com/youtube/v3/guides/uploading_a_video?hl=ja">official</a> should be used, but if it is written in Python 2 and it is Python 3, it is as it is. It doesn&rsquo;t move. So I will rewrite it a little to work with Python3. The following two points are rewritten.
・Migrated from httplib to http.client
・Rewrite print statement
(Aside from this, change the indent to 4 bytes)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python:upload_video.py" data-lang="python:upload_video.py"><span style="color:#f92672">import</span> http.client <span style="color:#75715e"># httplib migrate Python3 to http.client</span>
<span style="color:#f92672">import</span> httplib2
<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> random
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> time

<span style="color:#f92672">from</span> apiclient.discovery <span style="color:#f92672">import</span> build
<span style="color:#f92672">from</span> apiclient.errors <span style="color:#f92672">import</span> HttpError
<span style="color:#f92672">from</span> apiclient.http <span style="color:#f92672">import</span> MediaFileUpload
<span style="color:#f92672">from</span> oauth2client.client <span style="color:#f92672">import</span> flow_from_clientsecrets
<span style="color:#f92672">from</span> oauth2client.file <span style="color:#f92672">import</span> Storage
<span style="color:#f92672">from</span> oauth2client.tools <span style="color:#f92672">import</span> argparser, run_flow


httplib2<span style="color:#f92672">.</span>RETRIES <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
MAX_RETRIES <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
RETRIABLE_EXCEPTIONS <span style="color:#f92672">=</span> (httplib2<span style="color:#f92672">.</span>HttpLib2Error,
                        <span style="color:#a6e22e">IOError</span>,
                        http<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>NotConnected,
                        http<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>IncompleteRead,
                        http<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>ImproperConnectionState,
                        http<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>CannotSendRequest,
                        http<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>CannotSendHeader,
                        http<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>ResponseNotReady,
                        (http<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>BadStatusLine)
RETRIABLE_STATUS_CODES <span style="color:#f92672">=</span> [<span style="color:#ae81ff">500</span>, <span style="color:#ae81ff">502</span>, <span style="color:#ae81ff">503</span>, <span style="color:#ae81ff">504</span>]
CLIENT_SECRETS_FILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;client_secrets.json&#34;</span>
MISSING_CLIENT_SECRETS_MESSAGE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">WARNING: Please configure OAuth 2.0
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">To make this sample run you will need to populate the client_secrets.json file
</span><span style="color:#e6db74">found at:
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">   </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">with information from the API Console
</span><span style="color:#e6db74">https://console.developers.google.com/
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">For more information about the client_secrets.json file format, please visit:
</span><span style="color:#e6db74">https://developers.google.com/api-client-library/python/guide/aaa_client_secrets
</span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#f92672">%</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>abspath(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(__file__),
                                   CLIENT_SECRETS_FILE))

YOUTUBE_UPLOAD_SCOPE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/youtube.upload&#34;</span>
YOUTUBE_API_SERVICE_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;youtube&#34;</span>
YOUTUBE_API_VERSION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;v3&#34;</span>


VALID_PRIVACY_STATUSES <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#34;public&#34;</span>, <span style="color:#e6db74">&#34;private&#34;</span>, <span style="color:#e6db74">&#34;unlisted&#34;</span>)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_authenticated_service</span>(args):
    flow <span style="color:#f92672">=</span> flow_from_clientsecrets(CLIENT_SECRETS_FILE,
                                   scope<span style="color:#f92672">=</span>YOUTUBE_UPLOAD_SCOPE,
                                   message<span style="color:#f92672">=</span>MISSING_CLIENT_SECRETS_MESSAGE)

    storage <span style="color:#f92672">=</span> Storage(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">-oauth2.json&#34;</span> <span style="color:#f92672">%</span>sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>])
    credentials <span style="color:#f92672">=</span> storage<span style="color:#f92672">.</span>get()

    <span style="color:#66d9ef">if</span> credentials <span style="color:#f92672">is</span> None <span style="color:#f92672">or</span> credentials<span style="color:#f92672">.</span>invalid:credentials <span style="color:#f92672">=</span> run_flow(flow, storage, args)

    <span style="color:#66d9ef">return</span> build(YOUTUBE_API_SERVICE_NAME,
                 YOUTUBE_API_VERSION,
                 http<span style="color:#f92672">=</span>credentials<span style="color:#f92672">.</span>authorize(httplib2<span style="color:#f92672">.</span>Http()))


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">initialize_upload</span>(youtube, options):
    tags <span style="color:#f92672">=</span> None
    <span style="color:#66d9ef">if</span> options<span style="color:#f92672">.</span>keywords:
        tags <span style="color:#f92672">=</span> options<span style="color:#f92672">.</span>keywords<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;,&#34;</span>)

    body <span style="color:#f92672">=</span> dict(
        snippet<span style="color:#f92672">=</span>dict(
            title<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>title,
            description<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>description,
            tags<span style="color:#f92672">=</span>tags,
            categoryId<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>category
        ),
        status<span style="color:#f92672">=</span>dict(
            privacyStatus<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>privacyStatus
        )
    )

    insert_request <span style="color:#f92672">=</span> youtube<span style="color:#f92672">.</span>videos()<span style="color:#f92672">.</span>insert(
        part<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">.</span>join(body<span style="color:#f92672">.</span>keys()),
        body<span style="color:#f92672">=</span>body,
        media_body<span style="color:#f92672">=</span>MediaFileUpload(options<span style="color:#f92672">.</span>file, chunksize<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>, resumable<span style="color:#f92672">=</span>True)
    )

    resumable_upload(insert_request)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">resumable_upload</span>(insert_request):
    response <span style="color:#f92672">=</span> None
    error <span style="color:#f92672">=</span> None
    retry <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">while</span> response <span style="color:#f92672">is</span> None:
        <span style="color:#66d9ef">try</span>:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Uploading file...&#34;</span>)  <span style="color:#75715e"># print文</span>
            status, response <span style="color:#f92672">=</span> insert_request<span style="color:#f92672">.</span>next_chunk()
            <span style="color:#66d9ef">if</span> response <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> None:
                <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">in</span> response:
                    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Video id &#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39; was successfully uploaded.&#34;</span> <span style="color:#f92672">%</span> response[<span style="color:#e6db74">&#39;id&#39;</span>])
                <span style="color:#66d9ef">else</span>:
                    exit(<span style="color:#e6db74">&#34;The upload failed with an unexpected response: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> response)
        <span style="color:#66d9ef">except</span> HttpError <span style="color:#66d9ef">as</span> e:
            <span style="color:#66d9ef">if</span> e<span style="color:#f92672">.</span>resp<span style="color:#f92672">.</span>status <span style="color:#f92672">in</span> RETRIABLE_STATUS_CODES:
                error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A retriable HTTP error </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> occurred:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> \
                        (e<span style="color:#f92672">.</span>resp<span style="color:#f92672">.</span>status, e<span style="color:#f92672">.</span>content)
            <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">raise</span>
        <span style="color:#66d9ef">except</span> RETRIABLE_EXCEPTIONS <span style="color:#66d9ef">as</span> e:
            error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A retriable error occurred: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> e
        <span style="color:#66d9ef">if</span> error <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> None:
            <span style="color:#66d9ef">print</span>(error)
            retry <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">if</span> retry <span style="color:#f92672">&gt;</span> MAX_RETRIES:
              exit(<span style="color:#e6db74">&#34;No longer attempting to retry.&#34;</span>)
            max_sleep <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> retry
            sleep_seconds <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random() <span style="color:#f92672">*</span> max_sleep
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Sleeping </span><span style="color:#e6db74">%f</span><span style="color:#e6db74"> seconds and then retrying...&#34;</span> <span style="color:#f92672">%</span> sleep_seconds)
            time<span style="color:#f92672">.</span>sleep(sleep_seconds)


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    argparser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--file&#34;</span>, required<span style="color:#f92672">=</span>True, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Video file to upload&#34;</span>)
    argparser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--title&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Video title&#34;</span>, default<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Test Title&#34;</span>)
    argparser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--description&#34;</span>,
                           help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Video description&#34;</span>,
                           default<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Test Description&#34;</span>)
    argparser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--category&#34;</span>, default<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;22&#34;</span>,
                           help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Numeric video category. &#34;</span> <span style="color:#f92672">+</span>
                                <span style="color:#e6db74">&#34;See https://developers.google.com/youtube/v3/docs/videoCategories/list&#34;</span>)
    argparser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--keywords&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Video keywords, comma separated&#34;</span>,
                           default<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
    argparser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;--privacyStatus&#34;</span>, choices<span style="color:#f92672">=</span>VALID_PRIVACY_STATUSES,
                           default<span style="color:#f92672">=</span>VALID_PRIVACY_STATUSES[<span style="color:#ae81ff">0</span>],
                           help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Video privacy status.&#34;</span>)
    args <span style="color:#f92672">=</span> argparser<span style="color:#f92672">.</span>parse_args()

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>exists(args<span style="color:#f92672">.</span>file):
        exit(<span style="color:#e6db74">&#34;Please specify a valid file using the --file= parameter.&#34;</span>)

    youtube <span style="color:#f92672">=</span> get_authenticated_service(args)
    <span style="color:#66d9ef">try</span>:
        initialize_upload(youtube, args)
    <span style="color:#66d9ef">except</span> HttpError <span style="color:#66d9ef">as</span> e:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;An HTTP error </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> occurred:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (e<span style="color:#f92672">.</span>resp<span style="color:#f92672">.</span>status, e<span style="color:#f92672">.</span>content))

</code></pre></div><h3 id="少しソース解説">少しソース解説</h3>
<ul>
<li>YouTube Data APIはsnippetに設定した内容がAPIに渡されます。<code>initialize_upload</code>内のbodyでsnippetとして渡す値のdictを作っています。</li>
<li>snippetに渡す値は引数から<code>args</code>として取得しています。</li>
<li><code>get_authenticated_service</code>では、YouTube Data APIのリソース名と操作名(insert等)から、APIを利用するオブジェクト(?)をbuildしてreturnしています。今回の場合、buildしたオブジェクトを<code>initialize_upload</code>に渡して、<code>youtube.videos().insert</code>でアップロードを実行します。</li>
</ul>
<h2 id="アップロードの実行">アップロードの実行</h2>
<p>コマンドラインからだと以下の通り実行します。引数が多いので、何回か実行する場合シェルスクリプトにした方が楽かもしれません。</p>
<pre><code class="language-bash:動画アップロードの実行" data-lang="bash:動画アップロードの実行">$ python upload_video.py --file=&quot;./movies/sample001.MP4&quot; \
                       --title=&quot;Sample Movie&quot; \
                       --description=&quot;This is a sample movie.&quot; \
                       --category=&quot;22&quot; \
                       --privacyStatus=&quot;private&quot;
</code></pre><p>引数の意味は以下の通りです。</p>
<ul>
<li>file: アップロードする動画のパス</li>
<li>title: アップロード後の動画タイトル</li>
<li>description: 動画の説明</li>
<li>category: カテゴリー。デフォルトが22</li>
<li>privacyStatus: 動画の公開設定。privateだと非公開で投稿</li>
</ul>
<p>snippetとして指定できる項目や意味は以下に記載があります。</p>
<p><a href="https://developers.google.com/youtube/v3/docs/videos?hl=ja#resource">YouTube Data API Videos</a>
[YouTube Data API Videos: insert]
(<a href="https://developers.google.com/youtube/v3/docs/videos/insert?hl=ja">https://developers.google.com/youtube/v3/docs/videos/insert?hl=ja</a>)</p>
<p>なお、初めて実行した際に、ブラウザに遷移してGoogleアカウントの選択とYouTubeの管理許可を求める画面が表示されるので、画面に従って許可してください。
<img width="649" alt="スクリーンショット 2020-01-22 1.06.45.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/20e89bdc-70ee-c4d9-0deb-d4d3a7b38d38.png"></p>
<p>Chromeで以下のような画面が表示された場合は、詳細を表示して左下の安全ではないページに移動</p>
<img width="718" alt="スクリーンショット 2020-01-22 1.07.11.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/f255d05a-c1a0-7b23-80e9-574a00597e58.png">
<p>動画の管理を許可する。（もう一画面表示されることがあるが、引き続き許可する。）<img width="558" alt="Screenshot 2020-01-22 1.07.22.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/1598028d-9cfe-e6cf-12f0-9b33a4ffcc0f.png"></p>
<p>Depending on the size of the video, the upload will be completed as follows after a little while.</p>
<pre><code class="language-bash:" data-lang="bash:">Uploading file...
Video id'[video id]' was successfully uploaded.
</code></pre><p>You can also confirm that the video is posted on the YouTube screen.
*The image is in the middle of posting
<img width="788" alt="Screenshot 2020-01-22 0.01.48.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/451175/1e82e5ec-3e0a-fbb6-9086-3fd9f8906428.png"></p>
<h2 id="im-addicted-api-usage-restrictions">I&rsquo;m addicted: API usage restrictions</h2>
<p>Originally, I wanted to use the API to upload a large number of videos all at once, but when I wrote and executed a program that repeatedly executed the API, the following error occurred.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Uploading file...
An HTTP error <span style="color:#ae81ff">403</span> occurred:
b<span style="color:#e6db74">&#39;{\n &#34;error&#34;: {\n &#34;errors&#34;: [\n {\n &#34;domain&#34;: &#34;youtube.quota&#34;,\n &#34;reason&#34;: &#34;quotaExceeded&#34;,\n &#34;message&#34;: &#34;The request cannot be completed because you have exceeded your \\u003ca href=\\&#34;/youtube/v3/getting-started#quota\\&#34;\\u003equota\\u003c/a\\u003e.&#34;\n }\n ], \n &#34;code&#34;: 403,\n &#34;message&#34;: &#34;The request cannot be completed because you have exceeded your \\u003ca href=\\&#34;/youtube/v3/getting-started#quota\\&#34;\\u003equota\ \u003c/a\\u003e.&#34;\n }\n}\n&#39;</span>
</code></pre></div><p>Upon investigation, the API limits it to 10,000 per day, and it uses about 1,600 units for uploading videos. So, it seems that about 6 videos can be uploaded to YouTube via API&hellip;</p>
<p><a href="https://developers.google.com/youtube/v3/docs/errors?hl=ja">YouTube Data API-Error</a>
<a href="https://developers.google.com/youtube/v3/getting-started?hl=ja#quota">YouTube Data API Overview-Quota Usage</a></p>
<p>An application is required to raise this, but I gave up because it was just for personal use. At least, I could do what I wanted to do if it was 30 pieces per day, but if it is 6 it may be faster to do the manual work &hellip;</p>
<p>It may be useful if you want to upload videos in your application.</p>
<h2 id="reference">Reference</h2>
<p><a href="https://developers.google.com/youtube/v3?hl=ja">(Official) YouTube Data API</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
