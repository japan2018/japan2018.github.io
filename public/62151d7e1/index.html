<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="generator" content="Hugo 0.72.0" />

  
  <meta name="description" content="Some description">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://memotut.com/apple-touch-icon.png">

  
  <link rel="icon" type="image/png" sizes="32x32" href="https://memotut.com/favicon-32x32.png">

  
  <link rel="icon" type="image/png" sizes="16x16" href="https://memotut.com/favicon-16x16.png">

  
  <link rel="manifest" href="https://memotut.com/site.webmanifest">

  
  <link rel="mask-icon" href="https://memotut.com/safari-pinned-tab.svg" color="#5bbad5">

  <meta name="msapplication-TileColor" content="#da532c">

  <meta name="theme-color" content="#ffffff">

  
  <link rel="stylesheet" href="https://memotut.com/css/bootstrap.min.css" />

  
  <title>[Python] Free version of DataRobot! ? Introduction to library PyCaret that automates machine learning | Memo Tut</title>
  

  <style>
body {
  min-width: 300px;
}

.custom-navbar {
  margin-bottom: 1em;
  height: 60px;
}

.custom-navbar a {
  display: inline-block; 
  padding: 18px 0;
  margin-right: 1em; 
  font-weight: bold; 
}

.custom-navbar a:hover,
.custom-navbar a:focus {
  text-decoration: none; 
}

@media print {
  .custom-navbar {
    display: none;
  }
}

article {
  padding-bottom: 1em;
}

img {
  max-width: 100%;
}


body {
  background-color: #fff;
}



body {
  color: #212529;
}



a {
  color: #007bff;
}



a:hover,
a:focus {
  color: #0056b3;
}



.custom-navbar {
  background-color: #212529;
}



.custom-navbar a {
  color: rgba(255, 255, 255, 0.75);
}



.custom-navbar a:hover,
.custom-navbar a:focus {
  color: rgba(255, 255, 255, 1);
}



.container {
  max-width: 800px;
}



pre {
  display: block;
  padding: 9.5px;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  white-space: pre-wrap;
  background-color: transparent;
  border: none;
  border-radius: 0;
}

code {
  padding: 2px 4px;
  color: inherit; 
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: .9em;
}



blockquote,
.blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 1em;
  border-left: 5px solid #6c757d;
}

</style>
</head>

<body>
  <nav class="custom-navbar">
  <div class="container">
    
    <a href="/">Posts</a>
    
    <a href="/tags/">Tags</a>
    
    <a href="/about/">About</a>
    
    <a href="/index.xml">RSS</a>
    
  </div>
</nav>
  
  <div class="container">
    <article>
      <h1>[Python] Free version of DataRobot! ? Introduction to library PyCaret that automates machine learning</h1>
<p>
  <small class="text-secondary">
  
  
  Apr 21, 2020
  </small>
  

<small><code><a href="https://memotut.com/tags/python">Python</a></code></small>


<small><code><a href="https://memotut.com/tags/machine-learning"> machine learning</a></code></small>


<small><code><a href="https://memotut.com/tags/data-analysis"> data analysis</a></code></small>


<small><code><a href="https://memotut.com/tags/ai-academy"> AI Academy</a></code></small>


<small><code><a href="https://memotut.com/tags/pycaret"> PyCaret</a></code></small>

</p>
<pre><code>What is #PyCaret
</code></pre>
<p>I recently saw an article called <a href="https://towardsdatascience.com/announcing-pycaret-an-open-source-low-code-machine-learning-library-in-python-4a1f1aad8d46">Announcing PyCaret 1.0.0</a> ..
It was an interesting library, so in this article I will explain how to use PyCaret.
**<a href="https://pycaret.org/">PyCaret</a> is a Python library that enables data pre-processing, visualization, and model development with a few lines of code in machine learning model development. **</p>
<p>PyCaret is a Python wrapper for some of the major machine learning libraries (scikit-learn, XGBoost, LightGBM, etc.).
It can handle classification, regression, clustering, anomaly detection, and natural language processing.
So to speak, PyCaret is like a free version of Data Robot.</p>
<p>Basically, it seems that preprocessing, modeling, performance evaluation, tuning, and visualization can all be done.
Furthermore, stacking etc. are possible.
(Some evaluation indicators such as time series analysis and log loss are lenient.)
<a href="https://github.com/pycaret/pycaret">PyCaret/Github</a></p>
<p>Also, the target audience has already introduced a series of machine learning using scikit-learn! Is the one who says.
(If you are a beginner in machine learning, you may not understand the content. Let&rsquo;s spend some time. I think it ends with feeling like that. I&rsquo;m sorry for my own service, <a href="https://aiacademy.Pleaseusejp/">AI Academy</a>togetstartedwithmachinelearningprogramming!)</p>
<p>There is also a video explaining how to use Kayggle&rsquo;s <a href="https://www.kaggle.com/mlg-ulb/creditcardfraud">Credit Card Fraud Detection</a> using PyCaret, so please take a look.</p>
<p>Let&rsquo;s do #PyCaret!</p>
<p>First, install PyCaret.</p>
<p>If you install from the terminal or command prompt, you can install with the following command.</p>
<pre><code>pip install pycaret
</code></pre><p>In Jupyter Notebook or Google Colab, you can install it by adding the!</p>
<pre><code>!pip install pycaret
</code></pre><h2 id="loading-required-modules--preparing-data">Loading required modules &amp; preparing data</h2>
<p>This time, I will try multi-class classification using the iris dataset.
First, load the necessary code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">import</span> warnings
<span style="color:#75715e"># Erase unnecessary warning texts</span>
warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#34;ignore&#34;</span>)
<span style="color:#75715e"># This time the protagonist! Load PyCaret.</span>
<span style="color:#f92672">from</span> pycaret.classification <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#75715e"># Load the Iris dataset.</span>
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> load_iris
<span style="color:#75715e"># It also handles Pandas as it handles dataframes.</span>
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
</code></pre></div><p>Next, prepare the data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">iris <span style="color:#f92672">=</span> load_iris()
X <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(iris<span style="color:#f92672">.</span>data, columns<span style="color:#f92672">=</span>iris<span style="color:#f92672">.</span>feature_names)
y <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(iris<span style="color:#f92672">.</span>target, columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;target&#34;</span>])
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([X,y], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><p>Display the first 5 items.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">df<span style="color:#f92672">.</span>head()
</code></pre></div><h2 id="preprocessing">Preprocessing</h2>
<p>Now! Preprocessing.</p>
<p>If you use <strong>setup()</strong>, it will handle missing values, split data, etc.</p>
<p>Pass the target variable in target.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">exp1 <span style="color:#f92672">=</span> setup(df, target <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;target&#39;</span>)
</code></pre></div><h2 id="compare-models">Compare models</h2>
<p>To compare models, just use <strong>compare_models()</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">compare_models()
</code></pre></div><img width="518" alt="Screenshots 2020-04-21 0.14.17.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/6299a843-aa29-0677-3558-445ba78d96a3.png">
<h2 id="modeling">Modeling</h2>
<p>Enter the name of the algorithm used for learning by referring to <a href="https://pycaret.org/create-model/">https://pycaret.org/create-model/</a>.
This time, we will use the quadratic discriminant analysis and the decision tree, which have the highest accuracy rate.
For Quadratic Discriminant Analysis, it seems that you can enter&rsquo;qda&rsquo;, so enter qda this time.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">qda <span style="color:#f92672">=</span> create_model(<span style="color:#e6db74">&#39;qda&#39;</span>)
</code></pre></div><img width="412" alt="Screenshot 2020-04-21 0.14.38.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/bd3f44e5-6a94-297c-f2c3-aebc06b47837.png">
<p>Let&rsquo;s try a decision tree as well.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">tree <span style="color:#f92672">=</span> create_model(<span style="color:#e6db74">&#39;dt&#39;</span>)
</code></pre></div><img width="393" alt="Screenshot 2020-04-21 0.14.44.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/60295efc-7f99-d1d8-e904-e6dd9d49dd5e.png">
<h2 id="tuning">Tuning</h2>
<p>Let&rsquo;s tune the decision tree.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">tuned_tree <span style="color:#f92672">=</span> tune_model(<span style="color:#e6db74">&#39;dt&#39;</span>)
</code></pre></div><img width="393" alt="Screenshot 2020-04-21 0.14.44.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/72fd2122-f98c-db4f-96ad-f3dd34420f85.png">
<h2 id="get-parameters">Get parameters</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">tuned_tree<span style="color:#f92672">.</span>get_params
</code></pre></div><h2 id="model-visualization">Model visualization</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">plot_model(tuned_qda)
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/0bbe7b8e-5b6a-dfb5-9565-10feaeb802bc.png" alt="download.png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">plot_model(tuned_tree)
</code></pre></div><p><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/f601c983-2272-689b-6175-e4dd2a5c250c.png" alt="download-1.png"></p>
<h2 id="ensemble-learning">Ensemble learning</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">lgbm <span style="color:#f92672">=</span> create_model(<span style="color:#e6db74">&#39;lightgbm&#39;</span>)
xgboost <span style="color:#f92672">=</span> create_model(<span style="color:#e6db74">&#39;xgboost&#39;</span>)

ensemble <span style="color:#f92672">=</span> blend_models([lgbm, xgboost])
</code></pre></div><img width="350" alt="Screenshot 2020-04-21 0.15.43.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/8af38f87-ccfa-569f-1f4f-2526f0fe65d9.png">
<h2 id="stacking">Stacking</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">stack <span style="color:#f92672">=</span> stack_models(estimator_list <span style="color:#f92672">=</span> [xgboost], meta_model <span style="color:#f92672">=</span> lgbm)
</code></pre></div><img width="344" alt=" screenshot 2020-04-21 0.15.48.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195675/9093fd3c-ec89-ec88-c3e8-04535f8ee34f.png">
<h2 id="forecast">Forecast</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">pred <span style="color:#f92672">=</span> predict_model(qda)
</code></pre></div><p>Yes, it&rsquo;s convenient.</p>
<h1 id="finally">Finally</h1>
<p>All done in a few lines. ..
I will try to use it little by little from now on.</p>
<h1 id="reference-site">Reference site</h1>
<p>This article is for reference only.
Please use it as a reference other than this article.</p>
<p><a href="https://towardsdatascience.com/announcing-pycaret-an-open-source-low-code-machine-learning-library-in-python-4a1f1aad8d46">Reference article 1</a>
<a href="https://qiita.com/s_fukuzawa/items/5dd40a008dac76595eea">Reference article 2</a>
<a href="https://techtech-sorae.com/%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%81%AE%E8%87%AA%E5%8B%95%E5%8C%96%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%80%8Cpycaret%E3%80%8D%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F/">Reference article 3</a></p>
<h1 id="the-person-who-wrote-this-article">The person who wrote this article</h1>
<p>Cyber Brain Co., Ltd.
Kazunori Tani, Representative Director and CEO
We look forward to your follow!
<a href="https://twitter.com/tankazunori0914">Twitter</a>
<a href="https://www.facebook.com/takazunori">Facebook</a>
We also run an AI community where over 5000 people participate.
We are providing information about AI every day, so we look forward to your participation!
<a href="https://www.facebook.com/groups/1892746874314837/">Artificial Intelligence Research Community</a>
<a href="https://aiacademy.jp/">AI Academy</a></p>

    </article>
  </div>

  
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-169005401-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#216942",
      "text": "#b2d192"
    },
    "button": {
      "background": "#afed71"
    }
  }
})});
</script>

</body>

</html>
